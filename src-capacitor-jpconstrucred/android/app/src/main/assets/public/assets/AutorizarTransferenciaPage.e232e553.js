var ra=Object.defineProperty;var na=(e,a,r)=>a in e?ra(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var i=(e,a,r)=>(na(e,typeof a!="symbol"?a+"":a,r),r);import{Q as sa}from"./QPage.f3b97ac0.js";import{A as ia,s as T,bG as y,by as O,d as F,bc as U,m as $,u as G,R as ta,c as M,_ as D,t as _,v as c,P as H,F as f,z as n,a5 as la,y as s,x as m,I as g,J as v,G as ua,H as ca,K as N,L as da,O as A,B as k,D as E,bh as ma,dm as fa,p as pa,dn as R}from"./index.70185135.js";import{E as ba}from"./EssentialTableTabs.a1f1bc4b.js";import{C as j}from"./ContenedorSimpleMixin.0ef3239b.js";import{G as va}from"./Gasto.2c5038cc.js";import{S as J,u as ga}from"./utils.2eab62de.js";import{M as Ta}from"./ModalEntidad.7d323d29.js";import{C as Ea,a as za}from"./ComponenteModal.domain.9bc16b73.js";import{Q as Ca}from"./QForm.0c8c3b68.js";import{T as Va}from"./TabLayout.dfee7537.js";import{S as _a}from"./EssentialTable.c4a035e4.js";import{u as ha}from"./index.004ff2d8.js";import{r as q,m as I}from"./i18n-validators.ea544161.js";import{u as K,c as wa}from"./transferenciaSaldo.49f792f3.js";import{E as Sa}from"./entidadAuditable.75a46700.js";import"./QBadge.5bb69fff.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QSelect.b1759751.js";import"./QChip.a6a2afa6.js";import"./QItemSection.1a41b826.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./EssentialTablePagination.959d4e60.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./configuracion_general.27135600.js";import"./ConfiguracionController.40960b9d.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QPopupProxy.c164d2ac.js";import"./buttonSubmits.f728eedc.js";import"./QFile.f60a5ba1.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./index.9f64ebda.js";const ya=[{name:"usuario_envia_info",field:"usuario_envia_info",label:"Enviado por",align:"left",sortable:!0},{name:"usuario_recibe_info",field:"usuario_recibe_info",label:"Recibido por",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"left",sortable:!0},{name:"motivo",field:"motivo",label:"Motivo",align:"left",sortable:!0}];class Aa{constructor(){i(this,"axios");this.axios=ia.getInstance()}async aprobarTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.aprobar_trnasferencia),a)}catch(r){const t=r;throw new y(t)}}async rechazarTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.rechazar_transferencia),a)}catch(r){const t=r;throw new y(t)}}async anularTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.anular_transferencia),a)}catch(r){const t=r;throw new y(t)}}}class ka extends O{constructor(){super(T.transferencia)}}class qa extends Sa{constructor(){super();i(this,"usuario_envia_info");i(this,"usuario_recibe_info");i(this,"usuario_envia");i(this,"usuario_recibe");i(this,"monto");i(this,"motivo");i(this,"cuenta");i(this,"tarea");i(this,"tarea_info");i(this,"comprobante");i(this,"estado_info");i(this,"es_devolucion");this.comprobante=null,this.usuario_envia_info=null,this.es_devolucion=!1,this.usuario_envia=null,this.usuario_recibe=null,this.monto=null,this.motivo="DEVOLUCION",this.cuenta=null,this.usuario_recibe_info=null,this.tarea=null,this.tarea_info=null,this.estado_info=null}}var $a=F({components:{TabLayout:Va,SelectorImagen:_a},emits:["guardado","cerrar-modal"],setup(e,{emit:a}){U().setQuasar($());const t=G().user,p=K(),u=new J,d=new j(qa,new ka),l=new Aa,{entidad:o,disabled:h,accion:w}=d.useReferencias(),{setValidador:b,consultar:z}=d.useComportamiento(),{confirmar:C,prompt:W,notificarCorrecto:X,notificarAdvertencia:B,notificarError:S}=ta(),P=M(!0),Y=M(!1),Z={usuario_recibe:{requiredIf:o.es_devolucion},monto:{required:q,maxLength:I(50)},cuenta:{required:q,maxLength:I(50)},tarea:{requiredIf:o.es_devolucion},comprobante:{required:q}},x=ha(Z,o);b(x.value),p.id_transferencia&&(z({id:p.id_transferencia}),P.value=!1,Y.value=!0);async function aa(V,ea){switch(ea){case"aprobar":try{u.activar(),await l.aprobarTransferencia(V),X("Se aprob\xF3 la Transferencia Exitosamente"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{S("No se pudo aprobar, debes ingresar un motivo para la anulaci\xF3n")}break;case"rechazar":C("\xBFEst\xE1 seguro de rechazar la transferencia?",async()=>{try{u.activar(),await l.rechazarTransferencia(V),B("Se rechazado Transferencia Exitosamente"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{S("No se pudo rechazar, debes ingresar un motivo para la anulaci\xF3n")}});break;case"anular":C("\xBFEst\xE1 seguro de anular la transferencia?",()=>{W({titulo:"Anular Transferencia",mensaje:"Ingrese motivo de anulacion",accion:async oa=>{try{u.activar(),V.detalle_estado=oa,await l.anularTransferencia(V),B("Se anulado Transferencia Exitosamente"),a("cerrar-modal"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{S("No se pudo anular, debes ingresar un motivo para la anulaci\xF3n")}}})});break}}return{mixin:d,transferencia:o,disabled:h,accion:w,v$:x,usuario:t,mostrarListado:P,actualizarTransferencia:aa,configuracionColumnas:wa}}});const Ma={class:"row q-col-gutter-sm q-mb-md"},Na={key:0,class:"col-12 col-md-3 q-mb-md"},Ba={key:1,class:"col-12 col-md-3 q-mb-md"},Pa={class:"col-12 col-md-3"},xa={class:"col-12 col-md-3"},Qa={class:"error-msg"},Ra={key:2,class:"col-12 col-md-3"},Ia={class:"col-12 col-md-3"},La={class:"col-12 col-md-3 q-mb-xl"},Oa={key:0,class:"q-pa-md q-gutter-sm flex flex-center"},Fa={key:1,class:"q-pa-md q-gutter-sm flex flex-center"};function Ua(e,a,r,t,p,u){const d=_("selector-imagen"),l=_("tab-layout");return c(),H(l,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,mostrarListado:!1,mostrarButtonSubmits:!1},{formulario:f(()=>[n(Ca,{onSubmit:a[7]||(a[7]=la(()=>{},["prevent"]))},{default:f(()=>[s("div",Ma,[e.transferencia.usuario_envia_info?(c(),m("div",Na,[a[11]||(a[11]=s("label",{class:"q-mb-sm block"},"Empleado Emisor",-1)),n(g,{modelValue:e.transferencia.usuario_envia_info,"onUpdate:modelValue":a[0]||(a[0]=o=>e.transferencia.usuario_envia_info=o),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):v("",!0),e.transferencia.es_devolucion?v("",!0):(c(),m("div",Ba,[a[12]||(a[12]=s("label",{class:"q-mb-sm block"},"Empleado Receptor",-1)),n(g,{modelValue:e.transferencia.usuario_recibe_info,"onUpdate:modelValue":a[1]||(a[1]=o=>e.transferencia.usuario_recibe_info=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])),s("div",Pa,[a[13]||(a[13]=s("label",{class:"q-mb-sm block"},"Monto:",-1)),n(g,{modelValue:e.transferencia.monto,"onUpdate:modelValue":a[2]||(a[2]=o=>e.transferencia.monto=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])]),s("div",xa,[a[14]||(a[14]=s("label",{class:"q-mb-sm block"},"Cuenta:",-1)),n(g,{modelValue:e.transferencia.cuenta,"onUpdate:modelValue":a[3]||(a[3]=o=>e.transferencia.cuenta=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},{error:f(()=>[(c(!0),m(ua,null,ca(e.v$.cuenta.$errors,o=>(c(),m("div",{key:o.$uid},[s("div",Qa,N(o.$message),1)]))),128))]),_:1},8,["modelValue"])]),e.transferencia.es_devolucion?v("",!0):(c(),m("div",Ra,[a[15]||(a[15]=s("label",{class:"q-mb-sm block"},"Tareas",-1)),n(g,{modelValue:e.transferencia.tarea_info,"onUpdate:modelValue":a[4]||(a[4]=o=>e.transferencia.tarea_info=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])),s("div",Ia,[a[16]||(a[16]=s("label",{class:"q-mb-sm block"},"Comprobante ",-1)),n(d,{imagen:e.transferencia.comprobante,disable:"","onUpdate:modelValue":a[5]||(a[5]=o=>e.transferencia.comprobante=o)},null,8,["imagen"])]),s("div",La,[n(da,{class:"q-mt-lg q-pt-md",modelValue:e.transferencia.es_devolucion,"onUpdate:modelValue":a[6]||(a[6]=o=>e.transferencia.es_devolucion=o),label:"\xBFEs devolucion?",disable:"",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e.usuario.id==e.transferencia.usuario_recibe&&e.transferencia.estado_info=="POR APROBAR"?(c(),m("div",Oa,[n(A,{color:"positive",onClick:a[8]||(a[8]=o=>e.actualizarTransferencia(e.transferencia,"aprobar"))},{default:f(()=>[n(k,{name:"bi-check-circle",size:"xs"}),a[17]||(a[17]=E(" Aceptar "))]),_:1}),n(A,{color:"negative",onClick:a[9]||(a[9]=o=>e.actualizarTransferencia(e.transferencia,"rechazar"))},{default:f(()=>[n(k,{name:"bi-x-circle",size:"xs"}),a[18]||(a[18]=E(" Rechazar "))]),_:1})])):v("",!0),e.usuario.id==e.transferencia.usuario_recibe&&e.transferencia.estado_info=="APROBADO"?(c(),m("div",Fa,[n(A,{color:"negative",onClick:a[10]||(a[10]=o=>e.actualizarTransferencia(e.transferencia,"anular"))},{default:f(()=>[n(k,{name:"bi-x-circle",size:"xs"}),a[19]||(a[19]=E(" Anular "))]),_:1})])):v("",!0)]),_:1},8,["mixin","configuracionColumnas"])}var Ga=D($a,[["render",Ua]]);class Da{constructor(){i(this,"VisualizarTransferenciaPage");this.VisualizarTransferenciaPage=ma(new Ea("VisualizarTransferencia",Ga))}}class Ha extends za{constructor(){super(new Da)}}class L extends O{constructor(){super(T.autorizaciones_transferencia)}}var ja=F({name:"AutorizarGastoPage",components:{EssentialTableTabs:ba,ModalEntidad:Ta},setup(){const e=new L,a=M("3"),r=new j(va,e),{listado:t}=r.useReferencias(),p=G(),u=K();U().setQuasar($()),ga().setQuasar($());const d=new L;async function l(b){const z=new J;z.activar();const{result:C}=await d.listar({estado:b});t.value=C,a.value=b,z.desactivar()}l(R.PENDIENTE);const o=new Ha,h={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:({entidad:b})=>{u.id_transferencia=b.id,o.abrirModalEntidad("VisualizarTransferenciaPage")}};async function w(){await l(R.PENDIENTE)}return{configuracionColumnasAutorizarTransferencia:ya,listado:t,tabAutorizarTransferenciaSaldo:fa,botonVerModalTransferencia:h,accionesTabla:pa,filtrarAutorizacionesTransferencia:l,guardado:w,authenticationStore:p,modales:o}}});const Ja={class:"text-center q-pb-md"},Ka={class:"q-mb-md"},Wa={key:0,class:"q-mb-md"};function Xa(e,a,r,t,p,u){const d=_("essential-table-tabs"),l=_("modal-entidad");return c(),H(sa,{padding:!e.$q.screen.xs},{default:f(()=>{var o;return[s("div",Ja,[s("div",Ka,[a[0]||(a[0]=E(" Bienvenido, ")),s("strong",null,N(e.authenticationStore.nombreUsuario),1)]),(o=e.authenticationStore.user)!=null&&o.grupo?(c(),m("div",Wa,[a[1]||(a[1]=E(" Grupo, ")),s("strong",null,N(e.authenticationStore.user.grupo),1)])):v("",!0)]),n(d,{configuracionColumnas:[...e.configuracionColumnasAutorizarTransferencia,e.accionesTabla],datos:e.listado,accion1:e.botonVerModalTransferencia,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!1,"mostrar-botones":!1,"tab-options":e.tabAutorizarTransferenciaSaldo,onTabSeleccionado:e.filtrarAutorizacionesTransferencia,"tab-defecto":"3"},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"]),n(l,{comportamiento:e.modales,persistente:!1,mostrarListado:!1,onGuardado:e.guardado},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var Le=D(ja,[["render",Xa]]);export{Le as default};

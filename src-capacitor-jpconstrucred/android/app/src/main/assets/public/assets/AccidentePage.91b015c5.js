var Ve=Object.defineProperty;var $e=(e,o,n)=>o in e?Ve(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n;var d=(e,o,n)=>($e(e,typeof o!="symbol"?o+"":o,n),n);import{by as ne,s as re,d as ae,u as ue,bg as he,c as U,bz as I,p as ye,n as se,_ as me,t as v,v as g,P as ce,F as t,z as i,y as a,O as W,Q as J,M as x,N as ee,D as C,K as y,L as pe,I as f,B as X,f as qe,x as h,V as le,de as te,j as be,E as Ce,a5 as Ae,G,H as L,b1 as Se}from"./index.70185135.js";import{Q as oe,a as R}from"./QSelect.b1759751.js";import{Q as H,a as O}from"./QItemSection.1a41b826.js";import{Q as ke}from"./QForm.0c8c3b68.js";import{u as ge}from"./filtrosListadosGenerales.6ad178d9.js";import{h as we}from"./utils.7dcda2a3.js";import{r as F}from"./i18n-validators.ea544161.js";import{u as Ee}from"./index.004ff2d8.js";import{Q as K}from"./QExpansionItem.b5d3a973.js";import{S as Ue,E as De,B as je}from"./EssentialTable.c4a035e4.js";import{M as Me}from"./MultiplePageLayout.ad01fe8d.js";import{D as ze}from"./DiagnosticoRecetaPage.469eeaca.js";import{S as Pe}from"./SimpleLayout.f041788f.js";import{G as ve}from"./GestorArchivos.86e356d7.js";import Te from"./CitaMedicaPage.3988474c.js";import{E as Be}from"./EssentialEditor.ca19f1f6.js";import{C as fe}from"./ContenedorSimpleMixin.0ef3239b.js";import{E as de}from"./Empleado.20234ba0.js";import{E as _e}from"./entidadAuditable.75a46700.js";import{S as Qe}from"./SubtareaController.eaf3fca7.js";import{T as Fe}from"./TabLayoutFilterTabs2.0c89493b.js";import{C as Ie}from"./CoordenadasInput.864336d8.js";import{Q as Oe,a as Ge,C as Le}from"./QPopupProxy.c164d2ac.js";import{Q as Re}from"./QTime.e26b745b.js";import{A as He}from"./ArchivoController.b46f2c35.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./utils.2eab62de.js";import"./index.9f64ebda.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QScrollArea.7f9f49f9.js";import"./QScrollObserver.0842fd40.js";import"./TouchPan.fefe3f7c.js";import"./DetallePaciente.ff468c25.js";import"./buttonSubmits.f728eedc.js";import"./CieController.269d986a.js";import"./QUploader.128864d5.js";import"./QCircularProgress.d0f86e92.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./QBtnToggle.1aba8b9d.js";import"./EssentialTableTabs.a1f1bc4b.js";import"./EssentialTablePagination.959d4e60.js";import"./ModalEntidad.7d323d29.js";import"./configuracion_general.27135600.js";import"./ConfiguracionController.40960b9d.js";import"./ComponenteModal.domain.9bc16b73.js";import"./QPage.f3b97ac0.js";import"./extend.4a22771d.js";const Ne=[{name:"empleado",field:"empleado",label:"Empleado",align:"left",sortable:!0},{name:"telefono",field:"telefono",label:"Telefono",align:"left",sortable:!0},{name:"grupo",field:"grupo",label:"Grupo",align:"left",sortable:!0},{name:"cargo",field:"cargo",label:"Cargo",align:"left",sortable:!0},{name:"dias_descanso",field:"dias_descanso",label:"D\xEDas de descanso",align:"left",sortable:!0},{name:"dado_alta",field:"dado_alta",label:"Dado de alta",align:"left",sortable:!0}];class Je extends ne{constructor(){super(re.seguimientos_accidentes)}}class Ke extends _e{constructor(){super();d(this,"condiciones_climatologicas");d(this,"condiciones_laborales");d(this,"autorizaciones_permisos_texto");d(this,"autorizaciones_permisos_foto");d(this,"se_notifica_riesgos_trabajo");d(this,"actividades_desarrolladas");d(this,"descripcion_amplia_accidente");d(this,"antes_accidente");d(this,"instantes_previos");d(this,"durante_accidente");d(this,"despues_accidente");d(this,"hipotesis_causa_accidente");d(this,"causas_inmediatas");d(this,"causas_basicas");d(this,"medidas_preventivas");d(this,"seguimiento_sso");d(this,"seguimiento_trabajo_social");d(this,"seguimiento_rrhh");d(this,"tarea");d(this,"subtarea");d(this,"accidente");d(this,"metodologia_utilizada");d(this,"consultas_medicas");d(this,"fecha_hora_accidente");this.condiciones_climatologicas=null,this.condiciones_laborales=null,this.autorizaciones_permisos_texto=null,this.autorizaciones_permisos_foto=null,this.se_notifica_riesgos_trabajo=!1,this.actividades_desarrolladas=null,this.descripcion_amplia_accidente="",this.antes_accidente="",this.instantes_previos="",this.durante_accidente="",this.despues_accidente="",this.hipotesis_causa_accidente="",this.causas_inmediatas="",this.causas_basicas="",this.medidas_preventivas="",this.seguimiento_sso=null,this.seguimiento_trabajo_social="",this.seguimiento_rrhh="",this.tarea=null,this.subtarea=null,this.accidente=null,this.metodologia_utilizada=null,this.consultas_medicas=[],this.fecha_hora_accidente=null}}var We=ae({components:{MultiplePageLayout:Me,SimpleLayout:Pe,SelectorImagen:Ue,EssentialEditor:Be,GestorArchivos:ve,EssentialTable:De,CitaMedicaPage:Te,DiagnosticoRecetaPage:ze},setup(){const e=ue(),o=new fe(Ke,new Je),{entidad:n,disabled:D,accion:b,tabsPage:V,listadosAuxiliares:p}=o.useReferencias(),{consultar:u,listar:j,cargarVista:A,obtenerListados:S,editarParcial:k}=o.useComportamiento(),{onReestablecer:w,onConsultado:E,onModificado:s}=o.useHooks();A(()=>S({tareas:{controller:new he,params:{campos:"id,codigo_tarea,titulo,cliente_id","f_params[orderBy][field]":"id","f_params[orderBy][type]":"DESC","f_params[limit]":50}}}));const q=U(),_=U(),c=U(),$=U(),M=e.esSso||e.esAdministrador,{tareas:P,filtrarTareas:T}=ge(p),B=r=>{A(()=>S({subtareas:{controller:new Qe,params:{campos:"id,codigo_subtarea,titulo","f_params[orderBy][field]":"id","f_params[orderBy][type]":"DESC",tarea_id:r}}}))},z=async()=>await _.value.subir(),l=r=>{V.value="1";const Q=n.consultas_medicas.findIndex(N=>N.empleado_id===r.paciente_id);n.consultas_medicas[Q].cita_medica=r.id},m=()=>{j({export:"pdf",seguimiento_accidente_id:n.id,titulo:`Informe de seguimiento de accidente ${n.id}`})},Y=(r,Q)=>{k(n.id,{[r]:Q})},Z={titulo:({entidad:r})=>`${r.cita_medica?"Consultar":"Solicitar"} cita m\xE9dica`,icono:({entidad:r})=>`${r.cita_medica?"bi-eye":"bi-calendar-check-fill"} cita m\xE9dica`,color:({entidad:r})=>`${r.cita_medica?"positive":"primary"}`,accion:async({entidad:r})=>{V.value="2",se(()=>{var Q,N;c.value.reestablecer(),c.value.citaMedica.paciente=r.empleado_id,c.value.citaMedica.tipo_cita_medica=je.ACCIDENTE_DE_TRABAJO.value,c.value.citaMedica.accidente=n.accidente,c.value.citaMedica.fecha_accidente=(Q=n.fecha_hora_accidente)==null?void 0:Q.split(" ")[0],c.value.citaMedica.hora_accidente=(N=n.fecha_hora_accidente)==null?void 0:N.split(" ")[1],r.cita_medica&&(c.value.consultar({id:r.cita_medica}),c.value.accion=I.consultar),c.value.empleado.hydrate(new de),c.value.consultarEmpleado(r.empleado_id)})}},ie={titulo:"Consultar diagn\xF3stico y recomendaciones",icono:"bi-capsule-pill",color:"blue-grey",visible:({entidad:r})=>r.cita_medica_atendida,accion:async({entidad:r})=>{V.value="3",se(()=>{$.value.reestablecer(),$.value.empleado.hydrate(new de),$.value.consulta.cita_medica=r.cita_medica,$.value.consultarEmpleado(r.empleado_id),$.value.consultarConsulta({cita_medica_id:r.cita_medica}),$.value.accion=I.consultar})}};return E(()=>{setTimeout(()=>_.value.listarArchivosAlmacenados(n.id),1)}),s(r=>{q.value=r,setTimeout(()=>z(),1)}),w(async()=>{await _.value.limpiarListado(),b.value=I.editar,await u({id:q.value})}),b.value=I.editar,{mixin:o,disabled:D,seguimiento:n,accion:b,acciones:I,idEntidad:q,refArchivo:_,refCitaMedica:c,refDiagnosticoReceta:$,consultar:u,tabsPage:V,columnas:[...Ne,ye],btnSolicitarCitaMedica:Z,btnConsultarDiagnosticoRecomendaciones:ie,guardadoCitaMedica:l,descargarInformePdf:m,consultarSubtareas:B,listadosAuxiliares:p,tareas:P,filtrarTareas:T,puedeGestionarSso:M,editarSeguimientoParcial:Y}}});const Xe={class:"row q-col-gutter-sm q-pa-md"},Ye={class:"col-12 q-mb-xl"},Ze={class:"row q-col-gutter-sm q-pa-md"},xe={class:"col-12 q-mb-md"},eo={class:"col-12 text-right"},oo={class:"row q-col-gutter-sm q-pa-md"},ao={class:"col-12 q-mb-md"},io={class:"col-12 text-right"},so={class:"row q-col-gutter-xs"},lo={class:"col-12 q-mb-md"},to={class:"col-12 col-md-6"},no={class:"col-12 col-md-6"},ro={class:"col-12 col-md-6"},uo={class:"col-12 col-md-6"},mo={class:"col-12 col-md-6"},co={class:"col-12 col-md-6"},po={class:"col-12 col-md-6"},bo={class:"col-12 col-md-6"},go={class:"col-12 q-mb-xl"},vo={class:"col-12 q-mb-md"},fo={class:"col-12 q-mb-md"},_o={class:"col-12 q-mb-md"},Vo={class:"col-12 q-mb-md"},$o={class:"col-12 q-mb-md"},ho={class:"col-12 q-mb-xl"},yo={class:"col-12 q-mb-md"},qo={class:"col-12 col-md-6"},Co={class:"col-12 col-md-6"},Ao={class:"col-12 col-md-6 q-mb-xl"},So={class:"col-12 q-mb-md"},ko={class:"col-12 q-mb-md"},wo={class:"col-12"},Eo={class:"q-my-lg text-grey-8 text-right"},Uo={class:"q-my-lg text-grey-8 text-right"};function Do(e,o,n,D,b,V){const p=v("essential-table"),u=v("essential-editor"),j=v("selector-imagen"),A=v("gestor-archivos"),S=v("simple-layout"),k=v("cita-medica-page"),w=v("diagnostico-receta-page"),E=v("multiple-page-layout");return g(),ce(E,{mixin:e.mixin,"regresar-principio":""},{tab1:t(()=>[i(K,{class:"overflow-hidden q-mb-md rounded bg-desenfoque-2",label:"Seguimiento realizado \xE1rea m\xE9dica","header-class":"text-bold bg-solid text-primary",icon:"bi-clipboard2-pulse",disable:!e.puedeGestionarSso},{default:t(()=>[a("div",Xe,[a("div",Ye,[i(p,{titulo:"Diagn\xF3stico m\xE9dico y recomendaciones de los empleados involucrados en el accidente",configuracionColumnas:e.columnas,datos:e.seguimiento.consultas_medicas,"alto-fijo":!1,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-footer":!1,"mostrar-botones":!1,"permitir-buscar":!1,ajustarCeldas:"",accion1:e.btnSolicitarCitaMedica,accion2:e.btnConsultarDiagnosticoRecomendaciones},null,8,["configuracionColumnas","datos","accion1","accion2"])])])]),_:1},8,["disable"]),i(K,{class:"overflow-hidden q-mb-md rounded bg-desenfoque-2",label:"Seguimiento realizado por responsable de trabajo social","header-class":"text-bold bg-solid text-primary",icon:"bi-people"},{default:t(()=>[a("div",Ze,[a("div",xe,[i(u,{modelValue:e.seguimiento.seguimiento_trabajo_social,"onUpdate:modelValue":o[0]||(o[0]=s=>e.seguimiento.seguimiento_trabajo_social=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",eo,[i(W,{color:"primary",label:"Guardar seguimiento trabajo social",icon:"save",onClick:o[1]||(o[1]=s=>e.editarSeguimientoParcial("seguimiento_trabajo_social",e.seguimiento.seguimiento_trabajo_social)),push:"","no-caps":""})])])]),_:1}),i(K,{class:"overflow-hidden q-mb-md rounded bg-desenfoque-2",label:"Seguimiento realizado por responsable de recursos humanos","header-class":"text-bold bg-solid text-primary",icon:"bi-person-gear"},{default:t(()=>[a("div",oo,[a("div",ao,[i(u,{modelValue:e.seguimiento.seguimiento_rrhh,"onUpdate:modelValue":o[2]||(o[2]=s=>e.seguimiento.seguimiento_rrhh=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",io,[i(W,{color:"primary",label:"Guardar seguimiento recursos humanos",icon:"save",onClick:o[3]||(o[3]=s=>e.editarSeguimientoParcial("seguimiento_rrhh",e.seguimiento.seguimiento_rrhh)),push:"","no-caps":""})])])]),_:1}),i(K,{class:"overflow-hidden q-mb-md rounded bg-desenfoque-2",label:"Seguimiento responsable SSO","header-class":"text-bold bg-solid text-primary",icon:"bi-person-arms-up"},{default:t(()=>[i(S,{mixin:e.mixin,"permitir-cancelar":!1,"forzar-editar":"","label-editar":"Actualizar el seguimiento del accidente seleccionado"},{formulario:t(()=>[a("div",so,[a("div",lo,[o[24]||(o[24]=a("small",{class:"text-bold"},"Informaci\xF3n general",-1)),i(J)]),a("div",to,[o[26]||(o[26]=a("label",{class:"q-mb-sm block"},"Tarea",-1)),i(oe,{modelValue:e.seguimiento.tarea,"onUpdate:modelValue":[o[4]||(o[4]=s=>e.seguimiento.tarea=s),o[5]||(o[5]=s=>e.consultarSubtareas(e.seguimiento.tarea))],options:e.tareas,onFilter:e.filtrarTareas,"use-input":"","input-debounce":"0","transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Tarea #",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,"option-label":s=>s.codigo_tarea+" - "+s.titulo,"option-value":s=>s.id,"emit-value":"","map-options":""},{option:t(s=>[i(H,x(ee(s.itemProps)),{default:t(()=>[i(O,null,{default:t(()=>[i(R,null,{default:t(()=>[C(y(s.opt.codigo_tarea),1)]),_:2},1024),i(R,{caption:""},{default:t(()=>[C(y(s.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[i(H,null,{default:t(()=>[i(O,{class:"text-grey"},{default:t(()=>o[25]||(o[25]=[C(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","readonly","option-label","option-value"])]),a("div",no,[o[28]||(o[28]=a("label",{class:"q-mb-sm block"},"Subtarea",-1)),i(oe,{modelValue:e.seguimiento.subtarea,"onUpdate:modelValue":o[6]||(o[6]=s=>e.seguimiento.subtarea=s),options:e.listadosAuxiliares.subtareas,"use-input":"","input-debounce":"0","transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Subtarea #",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,"option-label":s=>s.codigo_subtarea+" - "+s.titulo,"option-value":s=>s.id,"emit-value":"","map-options":""},{option:t(s=>[i(H,x(ee(s.itemProps)),{default:t(()=>[i(O,null,{default:t(()=>[i(R,null,{default:t(()=>[C(y(s.opt.codigo_subtarea),1)]),_:2},1024),i(R,{caption:""},{default:t(()=>[C(y(s.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[i(H,null,{default:t(()=>[i(O,{class:"text-grey"},{default:t(()=>o[27]||(o[27]=[C(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","option-label","option-value"])]),a("div",ro,[i(pe,{class:"q-mb-lg",modelValue:e.seguimiento.se_notifica_riesgos_trabajo,"onUpdate:modelValue":o[7]||(o[7]=s=>e.seguimiento.se_notifica_riesgos_trabajo=s),disable:e.disabled,label:"\xBFSe notifica a riesgos de trabajo?",dense:""},null,8,["modelValue","disable"])]),a("div",uo,[o[29]||(o[29]=a("label",{class:"q-mb-sm block"},"Actividad espec\xEDfica en el momento del accidente",-1)),i(f,{modelValue:e.seguimiento.actividades_desarrolladas,"onUpdate:modelValue":o[8]||(o[8]=s=>e.seguimiento.actividades_desarrolladas=s),disable:e.disabled,autofocus:"",outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",mo,[o[30]||(o[30]=a("label",{class:"q-mb-sm block"},"Condiciones clim\xE1ticas y de entorno",-1)),i(f,{modelValue:e.seguimiento.condiciones_climatologicas,"onUpdate:modelValue":o[9]||(o[9]=s=>e.seguimiento.condiciones_climatologicas=s),disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",co,[o[31]||(o[31]=a("label",{class:"q-mb-sm block"},"Condiciones laborales",-1)),i(f,{modelValue:e.seguimiento.condiciones_laborales,"onUpdate:modelValue":o[10]||(o[10]=s=>e.seguimiento.condiciones_laborales=s),disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",po,[o[32]||(o[32]=a("label",{class:"q-mb-sm block"},"Autorizaciones y permisos de trabajos en la l\xEDnea",-1)),i(f,{modelValue:e.seguimiento.autorizaciones_permisos_texto,"onUpdate:modelValue":o[11]||(o[11]=s=>e.seguimiento.autorizaciones_permisos_texto=s),disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",bo,[o[33]||(o[33]=a("label",{class:"q-mb-sm block"},"Fotograf\xEDa del art\xEDculo",-1)),i(j,{file_extensiones:".jpg, image/*",imagen:e.seguimiento.autorizaciones_permisos_foto,alto:"200px","onUpdate:modelValue":o[12]||(o[12]=s=>e.seguimiento.autorizaciones_permisos_foto=s)},null,8,["imagen"])]),a("div",go,[o[34]||(o[34]=a("label",{class:"q-mb-sm block"},"Descripci\xF3n del accidente paso a paso (Parte policial)",-1)),i(u,{modelValue:e.seguimiento.descripcion_amplia_accidente,"onUpdate:modelValue":o[13]||(o[13]=s=>e.seguimiento.descripcion_amplia_accidente=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",vo,[o[35]||(o[35]=a("small",{class:"text-bold"},"Antes del accidente. Distibuci\xF3n de los fuentes de trabajo",-1)),i(J)]),a("div",fo,[o[36]||(o[36]=a("label",{class:"q-mb-sm block"},"Antes del accidente",-1)),i(u,{modelValue:e.seguimiento.antes_accidente,"onUpdate:modelValue":o[14]||(o[14]=s=>e.seguimiento.antes_accidente=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",_o,[o[37]||(o[37]=a("label",{class:"q-mb-sm block"},"Instantes previos al accidente",-1)),i(u,{modelValue:e.seguimiento.instantes_previos,"onUpdate:modelValue":o[15]||(o[15]=s=>e.seguimiento.instantes_previos=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",Vo,[o[38]||(o[38]=a("label",{class:"q-mb-sm block"},"Durante el accidente",-1)),i(u,{modelValue:e.seguimiento.durante_accidente,"onUpdate:modelValue":o[16]||(o[16]=s=>e.seguimiento.durante_accidente=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",$o,[o[39]||(o[39]=a("label",{class:"q-mb-sm block"},"Despu\xE9s del accidente",-1)),i(u,{modelValue:e.seguimiento.despues_accidente,"onUpdate:modelValue":o[17]||(o[17]=s=>e.seguimiento.despues_accidente=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",ho,[o[40]||(o[40]=a("label",{class:"q-mb-sm block"},"Hip\xF3tesos de causa del accidente",-1)),i(u,{modelValue:e.seguimiento.hipotesis_causa_accidente,"onUpdate:modelValue":o[18]||(o[18]=s=>e.seguimiento.hipotesis_causa_accidente=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",yo,[o[41]||(o[41]=a("small",{class:"text-bold"},"An\xE1lisis de las causas",-1)),i(J)]),a("div",qo,[o[42]||(o[42]=a("label",{class:"q-mb-sm block"},"Metolog\xEDa utilizada",-1)),i(f,{modelValue:e.seguimiento.metodologia_utilizada,"onUpdate:modelValue":o[19]||(o[19]=s=>e.seguimiento.metodologia_utilizada=s),disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",Co,[o[43]||(o[43]=a("label",{class:"q-mb-sm block"},"Causas inmediatas",-1)),i(f,{modelValue:e.seguimiento.causas_inmediatas,"onUpdate:modelValue":o[20]||(o[20]=s=>e.seguimiento.causas_inmediatas=s),disable:e.disabled,autogrow:"",outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",Ao,[o[44]||(o[44]=a("label",{class:"q-mb-sm block"},"Causas b\xE1sicas",-1)),i(f,{modelValue:e.seguimiento.causas_basicas,"onUpdate:modelValue":o[21]||(o[21]=s=>e.seguimiento.causas_basicas=s),disable:e.disabled,autogrow:"",outlined:"",dense:""},null,8,["modelValue","disable"])]),a("div",So,[o[45]||(o[45]=a("small",{class:"text-bold"},"Medidas preventivas a aplicar a ra\xEDz de este accidente",-1)),i(J)]),a("div",ko,[o[46]||(o[46]=a("label",{class:"q-mb-sm block"},"Prevenci\xF3n de riesgos laborales, operativos y t\xE9cnicas",-1)),i(u,{modelValue:e.seguimiento.medidas_preventivas,"onUpdate:modelValue":o[22]||(o[22]=s=>e.seguimiento.medidas_preventivas=s),disable:e.disabled},null,8,["modelValue","disable"])]),a("div",wo,[o[47]||(o[47]=a("label",{class:"q-mb-sm block"},"Adjuntar fotograf\xEDas/evidencias (Adjuntar fotos del \xE1rea del accidente, diagramas, videos u otros tipos de evidencias)",-1)),i(A,{ref:"refArchivo",label:"Adjuntar archivos",mixin:e.mixin,disable:e.disabled,formato:"image/*",listarAlGuardar:!1,"permitir-eliminar":e.accion==e.acciones.nuevo||e.accion==e.acciones.editar,idModelo:e.idEntidad},null,8,["mixin","disable","permitir-eliminar","idModelo"])])])]),"custom-buttons":t(()=>[i(W,{class:"text-white bg-negative",icon:"bi-file-pdf-fill",label:"Descargar informe PDF",onClick:o[23]||(o[23]=s=>e.descargarInformePdf()),push:"","no-caps":""})]),_:1},8,["mixin"])]),_:1})]),tab2:t(()=>[a("div",Eo,[i(X,{name:"bi-calendar-check-fill",class:"q-mr-sm"}),o[48]||(o[48]=C(" Solicitud de cita m\xE9dica "))]),i(k,{ref:"refCitaMedica",onGuardado:e.guardadoCitaMedica},null,8,["onGuardado"])]),tab3:t(()=>[a("div",Uo,[i(X,{name:"bi-capsule-pill",class:"q-mr-sm"}),o[49]||(o[49]=C(" Diagn\xF3stico y recomendaciones "))]),i(w,{ref:"refDiagnosticoReceta"},null,512)]),_:1},8,["mixin"])}var jo=me(We,[["render",Do]]);const Mo={class:"row"},zo={class:"col-12"},Po={class:"q-mb-sm block"},To={class:"q-gutter-md row items-start"},Bo={class:"row items-center justify-end"},Qo=ae({__name:"FechaHoraInput",props:{options:{type:Object,required:!1},minuteOptions:{type:Object,required:!1},modelValue:{type:String,default:""},disable:{type:Boolean,default:!1},label:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:o}){const n=o,D=e,b=qe({get:()=>D.modelValue,set:V=>{n("update:modelValue",V)}});return(V,p)=>(g(),h("div",Mo,[a("div",zo,[a("label",Po,y(e.label),1),i(f,{modelValue:b.value,"onUpdate:modelValue":p[2]||(p[2]=u=>b.value=u),placeholder:"Obligatorio",disable:e.disable,readonly:"",outlined:"",dense:""},{append:t(()=>[i(X,{name:"event",class:"cursor-pointer"},{default:t(()=>[i(Oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[a("div",To,[i(Ge,{modelValue:b.value,"onUpdate:modelValue":p[0]||(p[0]=u=>b.value=u),mask:le(te),options:e.options,"today-btn":""},{default:t(()=>[a("div",Bo,[be(i(W,{label:"Cerrar",color:"primary",flat:""},null,512),[[Le]])])]),_:1},8,["modelValue","mask","options"]),i(Re,{modelValue:b.value,"onUpdate:modelValue":p[1]||(p[1]=u=>b.value=u),"minute-options":e.minuteOptions,mask:le(te),color:"primary"},null,8,["modelValue","minute-options","mask"])])]),_:1})]),_:1})]),_:1},8,["modelValue","disable"])])]))}});var Fo=Qo;const Io=[{name:"titulo",field:"titulo",label:"T\xEDtulo",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha de accidente",align:"left",sortable:!0}];class Oo extends ne{constructor(){super(re.accidentes)}}class Go extends _e{constructor(){super();d(this,"titulo");d(this,"descripcion");d(this,"medidas_preventivas");d(this,"empleados_involucrados");d(this,"fecha_hora_ocurrencia");d(this,"coordenadas");d(this,"consecuencias");d(this,"lugar_accidente");d(this,"estado");d(this,"empleado_reporta");d(this,"seguimiento_accidente");this.titulo=null,this.descripcion=null,this.medidas_preventivas=null,this.empleados_involucrados=null,this.fecha_hora_ocurrencia=null,this.coordenadas=null,this.consecuencias=null,this.lugar_accidente=null,this.estado=null,this.empleado_reporta=null,this.seguimiento_accidente=null}}var Lo=ae({components:{TabLayoutFilterTabs2:Fe,CoordenadasInput:Ie,FechaHora:Fo,GestorArchivos:ve,SeguimientoAccidentePage:jo},setup(){const e=ue(),o=new fe(Go,new Oo,new He),{entidad:n,disabled:D,listadosAuxiliares:b,accion:V}=o.useReferencias(),{setValidador:p,listar:u,cargarVista:j,obtenerListados:A}=o.useComportamiento(),{onConsultado:S,onGuardado:k,onModificado:w,onReestablecer:E}=o.useHooks();j(async()=>{await A({empleados:{controller:new Ce,params:{campos:"id,nombres,apellidos",estado:1}}})});const s=U(),q=U(),_=U(),c=U(),M=Ee({titulo:{required:F},descripcion:{required:F},coordenadas:{required:F},lugar_accidente:{required:F},consecuencias:{required:F},empleados_involucrados:{required:F}},n);p(M.value);const{empleados:P,filtrarEmpleados:T}=ge(b);function B(l){u({estado:l}),s.value=l}const z=async()=>await _.value.subir();return S(()=>{setTimeout(()=>_.value.listarArchivosAlmacenados(n.id),1),c.value.consultar({id:n.seguimiento_accidente}),c.value.tabsPage="1",console.log("consultado")}),k(l=>{q.value=l,setTimeout(()=>z(),1)}),w(l=>{q.value=l,setTimeout(()=>z(),1)}),E(()=>{_.value.limpiarListado(),n.empleado_reporta=e.user.apellidos+" "+e.user.nombres}),n.empleado_reporta=e.user.apellidos+" "+e.user.nombres,{v$:M,mixin:o,accidente:n,disabled:D,tabActual:s,idEntidad:q,refArchivo:_,refSeguimiento:c,filtrarAccidentes:B,configuracionColumnasAccidente:Io,tabOptionsEstadosAccidentes:we,empleados:P,filtrarEmpleados:T,accion:V,acciones:I}}});const Ro={class:"row q-col-gutter-sm q-py-md"},Ho={class:"col-12 col-md-3"},No={class:"error-msg"},Jo={class:"col-12 col-md-9"},Ko={class:"error-msg"},Wo={class:"col-12 col-md-3"},Xo={class:"col-12 col-md-3"},Yo={class:"col-12 col-md-3"},Zo={class:"col-12 col-md-3"},xo={class:"error-msg"},ea={class:"col-12 col-md-6"},oa={class:"error-msg"},aa={class:"col-12 col-md-6"},ia={class:"error-msg"},sa={class:"col-12"},la={class:"row bg-desenfoque rounded q-py-md"},ta={class:"col-12"},da={class:"q-ml-md q-px-md q-py-xs rounded text-bold bg-grey-4 inline-block"},na={class:"col-12"};function ra(e,o,n,D,b,V){const p=v("fecha-hora"),u=v("coordenadas-input"),j=v("gestor-archivos"),A=v("seguimiento-accidente-page"),S=v("tab-layout-filter-tabs2");return g(),ce(S,{mixin:e.mixin,"configuracion-columnas":e.configuracionColumnasAccidente,tabOptions:e.tabOptionsEstadosAccidentes,filtrar:e.filtrarAccidentes,tabDefecto:e.tabActual,"ajustar-celdas":"","forzar-listar":"","label-guardar":"Guardar accidente","label-editar":"Actualizar accidente"},{formulario:t(()=>[i(ke,{onSubmit:o[8]||(o[8]=Ae(()=>{},["prevent"]))},{default:t(()=>{var k,w,E,s,q,_,c,$,M,P,T,B,z;return[a("div",Ro,[a("div",Ho,[o[9]||(o[9]=a("label",{class:"q-mb-sm block"},"T\xEDtulo",-1)),i(f,{modelValue:e.accidente.titulo,"onUpdate:modelValue":o[0]||(o[0]=l=>e.accidente.titulo=l),placeholder:"Obligatorio",disable:e.disabled,autofocus:"",outlined:"",dense:"",error:!!((w=(k=e.v$.titulo)==null?void 0:k.$errors)!=null&&w.length),onBlur:(E=e.v$.titulo)==null?void 0:E.$touch},{error:t(()=>{var l;return[(g(!0),h(G,null,L((l=e.v$.titulo)==null?void 0:l.$errors,m=>(g(),h("div",{key:m.$uid},[a("div",No,y(m.$message),1)]))),128))]}),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",Jo,[o[10]||(o[10]=a("label",{class:"q-mb-sm block"},"Descripci\xF3n",-1)),i(f,{modelValue:e.accidente.descripcion,"onUpdate:modelValue":o[1]||(o[1]=l=>e.accidente.descripcion=l),placeholder:"Obligatorio",disable:e.disabled,outlined:"",dense:"",error:!!((s=e.v$.descripcion)!=null&&s.$errors.length),onBlur:(q=e.v$.descripcion)==null?void 0:q.$touch},{error:t(()=>{var l;return[(g(!0),h(G,null,L((l=e.v$.descripcion)==null?void 0:l.$errors,m=>(g(),h("div",{key:m.$uid},[a("div",Ko,y(m.$message),1)]))),128))]}),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",Wo,[i(p,{modelValue:e.accidente.fecha_hora_ocurrencia,"onUpdate:modelValue":o[2]||(o[2]=l=>e.accidente.fecha_hora_ocurrencia=l),label:"Fecha y hora de ocurrencia",disable:e.disabled},null,8,["modelValue","disable"])]),a("div",Xo,[o[11]||(o[11]=a("label",{class:"q-mb-sm block"},"Empleado que reporta el accidente",-1)),i(f,{modelValue:e.accidente.empleado_reporta,"onUpdate:modelValue":o[3]||(o[3]=l=>e.accidente.empleado_reporta=l),disable:"",outlined:"",dense:""},null,8,["modelValue"])]),a("div",Yo,[i(u,{modelValue:e.accidente.coordenadas,"onUpdate:modelValue":o[4]||(o[4]=l=>e.accidente.coordenadas=l),disable:e.disabled,validador:e.v$},null,8,["modelValue","disable","validador"])]),a("div",Zo,[o[12]||(o[12]=a("label",{class:"q-mb-sm block"},"Lugar del accidente",-1)),i(f,{modelValue:e.accidente.lugar_accidente,"onUpdate:modelValue":o[5]||(o[5]=l=>e.accidente.lugar_accidente=l),placeholder:"Obligatorio",disable:e.disabled,outlined:"",dense:"",error:!!((c=(_=e.v$.lugar_accidente)==null?void 0:_.$errors)!=null&&c.length),onBlur:($=e.v$.lugar_accidente)==null?void 0:$.$touch},{error:t(()=>{var l;return[(g(!0),h(G,null,L((l=e.v$.lugar_accidente)==null?void 0:l.$errors,m=>(g(),h("div",{key:m.$uid},[a("div",xo,y(m.$message),1)]))),128))]}),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",ea,[o[13]||(o[13]=a("label",{class:"q-mb-sm block"},"Consecuencias del accidente",-1)),i(f,{modelValue:e.accidente.consecuencias,"onUpdate:modelValue":o[6]||(o[6]=l=>e.accidente.consecuencias=l),placeholder:"Obligatorio",disable:e.disabled,outlined:"",dense:"",error:!!((P=(M=e.v$.consecuencias)==null?void 0:M.$errors)!=null&&P.length),onBlur:(T=e.v$.consecuencias)==null?void 0:T.$touch},{error:t(()=>{var l;return[(g(!0),h(G,null,L((l=e.v$.consecuencias)==null?void 0:l.$errors,m=>(g(),h("div",{key:m.$uid},[a("div",oa,y(m.$message),1)]))),128))]}),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",aa,[o[14]||(o[14]=a("label",{class:"q-mb-sm block"},"Empleados involucrados",-1)),i(oe,{modelValue:e.accidente.empleados_involucrados,"onUpdate:modelValue":o[7]||(o[7]=l=>e.accidente.empleados_involucrados=l),options:e.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",multiple:"","use-input":"","use-chips":"","input-debounce":"0",disable:e.disabled,error:!!((B=e.v$.empleados_involucrados)!=null&&B.$errors.length),onBlur:(z=e.v$.empleados_involucrados)==null?void 0:z.$touch,onFilter:e.filtrarEmpleados,"option-label":l=>l.apellidos+" "+l.nombres,"option-value":l=>l.id,"emit-value":"","map-options":""},{option:t(({itemProps:l,opt:m,selected:Y,toggleOption:Z})=>[i(H,x(ee(l)),{default:t(()=>[i(O,null,{default:t(()=>[C(y(`${m.apellidos} ${m.nombres}`)+" ",1),i(R,{"inner-h-t-m-l":m.label},null,8,["inner-h-t-m-l"])]),_:2},1024),i(O,{side:""},{default:t(()=>[i(pe,{"model-value":Y,dense:"","onUpdate:modelValue":ie=>Z(m)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),error:t(()=>{var l;return[(g(!0),h(G,null,L((l=e.v$.empleados_involucrados)==null?void 0:l.$errors,m=>(g(),h("div",{key:m.$uid},[a("div",ia,y(m.$message),1)]))),128))]}),_:1},8,["modelValue","options","disable","error","onBlur","onFilter","option-label","option-value"])]),a("div",sa,[i(j,{ref:"refArchivo",label:"Adjuntar archivos",mixin:e.mixin,disable:e.disabled,listarAlGuardar:!1,"permitir-eliminar":e.accion==e.acciones.nuevo||e.accion==e.acciones.editar,idModelo:e.idEntidad},null,8,["mixin","disable","permitir-eliminar","idModelo"])])])]}),_:1})]),"formulario-2":t(()=>[be(a("div",la,[a("div",ta,[a("span",da,[i(X,{name:"bi-clock-history",class:"q-mr-sm"}),o[15]||(o[15]=C(" Seguimiento del accidente "))])]),a("div",na,[i(A,{ref:"refSeguimiento"},null,512)])],512),[[Se,e.accidente.id]])]),_:1},8,["mixin","configuracion-columnas","tabOptions","filtrar","tabDefecto"])}var Vi=me(Lo,[["render",ra]]);export{Vi as default};

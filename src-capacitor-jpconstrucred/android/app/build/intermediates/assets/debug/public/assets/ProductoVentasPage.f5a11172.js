var O=Object.defineProperty;var I=(o,e,s)=>e in o?O(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var n=(o,e,s)=>(I(o,typeof e!="symbol"?e+"":e,s),s);import{Q as T,a as _}from"./QItemSection.1a41b826.js";import{Q as U}from"./QSelect.b1759751.js";import{A as j,s as R,d as z,bc as H,m as M,u as G,R as J,c as E,bz as K,_ as W,t as X,v as i,P as Y,F as l,z as u,y as a,x as d,H as V,G as h,D as Z,I as w,J as x,a5 as oo,K as y}from"./index.70185135.js";import{Q as eo}from"./QForm.0c8c3b68.js";import{E as ro}from"./entidadAuditable.75a46700.js";import{T as to}from"./TabLayoutFilterTabs2.0c89493b.js";import{u as ao}from"./index.004ff2d8.js";import{C as so}from"./ContenedorSimpleMixin.0ef3239b.js";import{P as io}from"./ProductoVentasController.b68a63c5.js";import{P as lo}from"./PlanesController.a1b177e4.js";import{S as no}from"./utils.2eab62de.js";import{t as uo}from"./ventas.utils.b757673b.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QPopupProxy.c164d2ac.js";import"./QPage.f3b97ac0.js";import"./EssentialTableTabs.a1f1bc4b.js";import"./QBadge.5bb69fff.js";import"./EssentialTablePagination.959d4e60.js";import"./EssentialTable.c4a035e4.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./i18n-validators.ea544161.js";import"./index.9f64ebda.js";import"./buttonSubmits.f728eedc.js";class co extends ro{constructor(){super();n(this,"plan");n(this,"plan_info");n(this,"nombre");n(this,"bundle");n(this,"precio");n(this,"activo");this.plan=null,this.plan_info=null,this.nombre=null,this.bundle=null,this.precio=null,this.activo=!0}}const po=[{name:"plan_info",field:"plan_info",label:"Plan",align:"left",sortable:!0},{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"bundle",field:"bundle",label:"Bundle",align:"left",sortable:!0},{name:"precio",field:"precio",label:"Precio",align:"left",sortable:!0},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class N{constructor(){n(this,"axios");this.axios=j.getInstance()}async anular(e){return this.solicitud("/desactivar/",e)}async solicitud(e,s,m){const f=this.axios.getEndpoint(R.productos_ventas)+e+s,b=await this.axios.post(f,m);return{response:b,result:b.data.modelo}}}var mo=z({components:{TabLayoutFilterTabs2:to},setup(){H().setQuasar(M());const o=new no,e=G(),s=new so(co,new io),{entidad:m,disabled:f,accion:b,listadosAuxiliares:v,listado:r}=s.useReferencias(),{setValidador:Q,obtenerListados:A,cargarVista:q,listar:S}=s.useComportamiento(),{confirmar:C,notificarCorrecto:P,notificarError:B}=J(),g=E([]),k=E("1");q(async()=>{await A({planes:{controller:new lo,params:{campos:"id,nombre"}}}),g.value=v.planes});const D=ao({plan:{required:!0},nombre:{required:!0},bundle:{required:!0},precio:{required:!0}},m);Q(D.value);function F(t){k.value=t,S({activo:t})}function L(t,c){if(t===""){c(()=>{g.value=v.planes});return}c(()=>{const p=t.toLowerCase();g.value=v.planes.filter($=>$.nombres.toLowerCase().indexOf(p)>-1||$.apellidos.toLowerCase().indexOf(p)>-1)})}return{mixin:s,producto:m,filtrarPlanes:L,planes:g,tabDefecto:k,disabled:f,accion:b,v$:D,acciones:K,configuracionColumnas:po,tabOptionsProductos:uo,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar",accion:({entidad:t,posicion:c})=>{C("\xBFEst\xE1 seguro de desactivar este producto?",async()=>{try{o.activar();const{result:p,response:$}=await new N().anular(t.id);r.value.splice(c,1),P("Desactivado correctamente")}catch{B("No se pudo desactivar el producto!")}finally{o.desactivar()}})},visible:({entidad:t})=>!t.activo&&e.can("puede.activar.productos_ventas")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar",accion:({entidad:t,posicion:c})=>{C("\xBFEst\xE1 seguro de desactivar este producto?",async()=>{try{o.activar();const{result:p,response:$}=await new N().anular(t.id);r.value.splice(c,1),P("Desactivado correctamente")}catch{B("No se pudo desactivar el producto!")}finally{o.desactivar()}})},visible:({entidad:t})=>t.activo&&e.can("puede.desactivar.productos_ventas")},filtrarProductos:F}}});const bo={class:"row q-col-gutter-sm q-mb-md"},vo={class:"col-12 col-md-3"},fo={class:"error-msg"},go={class:"col-12 col-md-3"},$o={class:"error-msg"},Vo={class:"col-12 col-md-3"},ho={class:"error-msg"},yo={class:"col-12 col-md-3"},wo={class:"error-msg"};function Co(o,e,s,m,f,b){const v=X("tab-layout-filter-tabs-2");return i(),Y(v,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,ajustarCeldas:!0,accion1:o.btnDesactivar,accion2:o.btnActivar,"tab-options":o.tabOptionsProductos,tabDefecto:o.tabDefecto,filtrar:o.filtrarProductos},{formulario:l(()=>[u(eo,{onSubmit:e[5]||(e[5]=oo(()=>{},["prevent"]))},{default:l(()=>[a("div",bo,[a("div",vo,[e[7]||(e[7]=a("label",{class:"q-mb-sm block"},"Plan",-1)),u(U,{modelValue:o.producto.plan,"onUpdate:modelValue":e[0]||(e[0]=r=>o.producto.plan=r),options:o.planes,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.plan.$errors.length,onBlur:o.v$.plan.$touch,"error-message":"Debes seleccionar un plan","use-input":"","input-debounce":"0",onFilter:o.filtrarPlanes,"option-value":r=>r.id,"option-label":r=>r.nombre,"emit-value":"","map-options":""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.plan.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",fo,y(r.$message),1)]))),128))]),"no-option":l(()=>[u(T,null,{default:l(()=>[u(_,{class:"text-grey"},{default:l(()=>e[6]||(e[6]=[Z(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),a("div",go,[e[8]||(e[8]=a("label",{class:"q-mb-sm block"},"Nombre",-1)),u(w,{modelValue:o.producto.nombre,"onUpdate:modelValue":e[1]||(e[1]=r=>o.producto.nombre=r),placeholder:"Obligatorio",disable:o.disabled,error:!!o.v$.nombre.$errors.length,autogrow:"",onBlur:o.v$.nombre.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.nombre.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",$o,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",Vo,[e[9]||(e[9]=a("label",{class:"q-mb-sm block"},"Bundle",-1)),u(w,{modelValue:o.producto.bundle,"onUpdate:modelValue":e[2]||(e[2]=r=>o.producto.bundle=r),placeholder:"Obligatorio",type:"textarea",disable:o.disabled,error:!!o.v$.bundle.$errors.length,autogrow:"",onBlur:o.v$.bundle.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.bundle.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",ho,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",yo,[e[10]||(e[10]=a("label",{class:"q-mb-sm block"},"Precio",-1)),u(w,{modelValue:o.producto.precio,"onUpdate:modelValue":e[3]||(e[3]=r=>o.producto.precio=r),placeholder:"Obligatorio",type:"number",disable:o.disabled,error:!!o.v$.precio.$errors.length,onBlur:o.v$.precio.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.precio.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",wo,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),x("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var pe=W(mo,[["render",Co]]);export{pe as default};

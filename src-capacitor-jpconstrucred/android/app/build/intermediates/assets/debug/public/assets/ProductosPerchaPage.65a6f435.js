var R=Object.defineProperty;var A=(e,o,s)=>o in e?R(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s;var S=(e,o,s)=>(A(e,typeof o!="symbol"?o+"":o,s),s);import{Q as C,a as k}from"./QItemSection.1a41b826.js";import{Q as h,a as P}from"./QSelect.b1759751.js";import{by as K,s as M,R as O,c as b,d as z,cy as G,_ as H,t as q,v as f,P as J,F as i,z as n,a5 as W,y as t,D as g,I as B,a3 as X,O as Y,M as Z,N as x,K as v,x as y,G as E,H as L}from"./index.70185135.js";import{Q as oo}from"./QForm.0c8c3b68.js";import{r as w,c as eo}from"./index.9f64ebda.js";import{u as ao}from"./index.004ff2d8.js";import{c as so}from"./configuracionColumnasInventarios.ec051713.js";import{T as io}from"./TabLayout.dfee7537.js";import{E as no}from"./EssentialSelectableTable.ee506d87.js";import{C as to}from"./ContenedorSimpleMixin.0ef3239b.js";import{E as ro}from"./entidadAuditable.75a46700.js";import{U as lo}from"./UbicacionController.acd2bd98.js";import{S as uo}from"./SelectorController.c365d743.js";import{S as co}from"./utils.2eab62de.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QPopupProxy.c164d2ac.js";import"./QPage.f3b97ac0.js";import"./buttonSubmits.f728eedc.js";import"./EssentialTable.c4a035e4.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./i18n-validators.ea544161.js";import"./EssentialTablePagination.959d4e60.js";const mo=[{name:"inventario",field:"inventario",label:"Item",align:"left",sortable:!0},{name:"stock",field:"stock",label:"Cantidad",align:"left",sortable:!0},{name:"ubicacion",field:"ubicacion",label:"Ubicaci\xF3n",align:"left",sortable:!0}];class po extends ro{constructor(){super();S(this,"stock");S(this,"ubicacion");S(this,"inventario");this.stock=null,this.ubicacion=null,this.inventario=null}}class vo extends K{constructor(){super(M.productos_perchas)}}function bo(e){const o=new uo(e.endpoint),s=new co;return{listar:async(r,l)=>{const p={search:r};let a;if(r||delete p.search,l){s.activar();const{response:u}=await o.listar(l);a=u.data.results,s.desactivar()}else{s.activar();const{response:u}=await o.listar(p);a=u.data.results,s.desactivar()}if(a.length===0){const{notificarAdvertencia:u}=O();u("No se encontraron coincidencias");return}e.listadoSeleccionable.value=[...a],e.refListadoSeleccionable.value.mostrar()},seleccionar:async r=>{s.activar();const{result:l}=await o.consultar(r);e.seleccionar(l),s.desactivar()}}}function fo(e,o){const s=b(),c=b([]),d=b(),r={refListadoSeleccionable:s,listadoSeleccionable:c,endpoint:o,limpiar:()=>{e.inventario=null,d.value=null},seleccionar:m=>{e.inventario=m[0].id,d.value=m[0].producto}},l=bo(r);return{refListadoSeleccionable:s,listado:c,listar:m=>l.listar(d.value,m),limpiar:()=>r.limpiar(),seleccionar:m=>{r.seleccionar(m)},criterioBusqueda:d}}var go=z({components:{TabLayout:io,EssentialSelectableTable:no},setup(){const e=new to(po,new vo),{entidad:o,disabled:s,listadosAuxiliares:c}=e.useReferencias(),{setValidador:d,obtenerListados:r,cargarVista:l}=e.useComportamiento(),{onGuardado:p,onReestablecer:a}=e.useHooks();let u=b();const{refListadoSeleccionable:m,criterioBusqueda:Q,listado:U,listar:N,limpiar:T,seleccionar:_}=fo(o,"inventarios"),j={inventario:{required:w},ubicacion:{required:w},stock:{required:w,minimo:eo(1)}},V=ao(j,o);d(V.value);const I=b([]),$=b([]);l(async()=>{await r({sucursales:{controller:new G,params:{campos:"id,lugar"}}})}),I.value=c.ubicaciones,$.value=c.sucursales,p(()=>{u.value=""}),a(()=>{u.value=""});function D(F){l(async()=>{await r({ubicaciones:{controller:new lo,params:{sucursal:u.value}}}),I.value=c.ubicaciones})}return{mixin:e,producto_percha:o,v$:V,disabled:s,configuracionColumnas:mo,opciones_ubicaciones:I,opciones_sucursales:$,sucursal:u,refListadoSeleccionableInventarios:m,criterioBusquedaInventario:Q,listadoInventarios:U,listarInventarios:N,limpiarInventario:T,seleccionarInventario:_,configuracionColumnasInventarios:so,SucursalSeleccionada(F){D()}}}});const So={class:"row q-col-gutter-sm q-py-md"},yo={class:"col-12 col-md-6"},Io={class:"col-12 col-md-6"},Co={class:"row"},ko={class:"col-12 col-md-8 q-mb-md"},wo={class:"col-12 col-md-4"},Vo={class:"col-12 col-md-6"},$o={class:"error-msg"},ho={class:"col-12 col-md-6"},Po={class:"error-msg"};function qo(e,o,s,c,d,r){const l=q("essential-selectable-table"),p=q("tab-layout");return f(),J(p,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Control de productos en perchas"},{formulario:i(()=>[n(oo,{onSubmit:o[7]||(o[7]=W(()=>{},["prevent"]))},{default:i(()=>[t("div",So,[t("div",yo,[o[9]||(o[9]=t("label",{class:"q-mb-sm block"},"Sucursal",-1)),n(h,{modelValue:e.sucursal,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.sucursal=a),e.SucursalSeleccionada],options:e.opciones_sucursales,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","error-message":"Debes seleccionar una sucursal","option-label":a=>a.lugar,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":i(()=>[n(C,null,{default:i(()=>[n(k,{class:"text-grey"},{default:i(()=>o[8]||(o[8]=[g(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","option-label","option-value"])]),t("div",Io,[o[11]||(o[11]=t("label",{class:"q-mb-sm block"},"Inventario",-1)),t("div",Co,[t("div",ko,[n(B,{modelValue:e.criterioBusquedaInventario,"onUpdate:modelValue":o[1]||(o[1]=a=>e.criterioBusquedaInventario=a),placeholder:"Producto del inventario",hint:"Presiona Enter para seleccionar un producto",onKeydown:o[2]||(o[2]=X(a=>e.listarInventarios({sucursal_id:e.sucursal}),["enter"])),onBlur:o[3]||(o[3]=a=>e.criterioBusquedaInventario===""?e.limpiarInventario():null),dense:"",outlined:""},null,8,["modelValue"])]),t("div",wo,[n(Y,{onClick:o[4]||(o[4]=a=>e.listarInventarios({sucursal_id:e.sucursal})),icon:"search",unelevated:"",color:"secondary",class:"full-width",style:{height:"40px"},"no-caps":""},{default:i(()=>o[10]||(o[10]=[g("Buscar")])),_:1})])])]),t("div",Vo,[o[13]||(o[13]=t("label",{class:"q-mb-sm block"},"Ubicaci\xF3n",-1)),n(h,{modelValue:e.producto_percha.ubicacion,"onUpdate:modelValue":o[5]||(o[5]=a=>e.producto_percha.ubicacion=a),options:e.opciones_ubicaciones,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",error:!!e.v$.ubicacion.$errors.length,"error-message":"Debes seleccionar una ubicaci\xF3n","option-label":a=>a.codigo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:i(a=>[n(C,Z(x(a.itemProps)),{default:i(()=>[n(k,null,{default:i(()=>[n(P,null,{default:i(()=>[g(v(a.opt.codigo),1)]),_:2},1024),n(P,{caption:""},{default:i(()=>[g("Piso:"+v(a.opt.piso)+" | Percha:"+v(a.opt.percha)+" | Sucursal:"+v(a.opt.sucursal),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:i(()=>[(f(!0),y(E,null,L(e.v$.ubicacion.$errors,a=>(f(),y("div",{key:a.$uid},[t("div",$o,v(a.$message),1)]))),128))]),"no-option":i(()=>[n(C,null,{default:i(()=>[n(k,{class:"text-grey"},{default:i(()=>o[12]||(o[12]=[g(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","option-label","option-value"])]),t("div",ho,[o[14]||(o[14]=t("label",{class:"q-mb-sm block"},"Cantidad",-1)),n(B,{type:"number",modelValue:e.producto_percha.stock,"onUpdate:modelValue":o[6]||(o[6]=a=>e.producto_percha.stock=a),placeholder:"Obligatorio",readonly:e.disabled,error:!!e.v$.stock.$errors.length,outlined:"",dense:""},{error:i(()=>[(f(!0),y(E,null,L(e.v$.stock.$errors,a=>(f(),y("div",{key:a.$uid},[t("div",Po,v(a.$message),1)]))),128))]),_:1},8,["modelValue","readonly","error"])])])]),_:1}),n(l,{ref:"refListadoSeleccionableInventarios","configuracion-columnas":e.configuracionColumnasInventarios,datos:e.listadoInventarios,onSelected:e.seleccionarInventario},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas"])}var pe=H(go,[["render",qo]]);export{pe as default};

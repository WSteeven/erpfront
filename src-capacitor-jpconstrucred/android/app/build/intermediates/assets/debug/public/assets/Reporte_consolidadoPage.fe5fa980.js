var wo=Object.defineProperty;var go=(o,e,f)=>e in o?wo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var g=(o,e,f)=>(go(o,typeof e!="symbol"?e+"":e,f),f);import{by as Fo,s as N,d as So,bc as yo,m as P,c as v,ds as B,E as j,a1 as V,q as C,dt as ho,a2 as _o,A as Ao,dr as G,bH as z,_ as Io,v as p,P as Oo,F as l,z as i,bd as Vo,be as M,y as d,x as m,G as $,H as k,K as E,D as F,J as T,O as S,B as y,I as H,j as J,L as K,Q as $o,ca as ko}from"./index.70185135.js";import{Q as L,a as D}from"./QItemSection.1a41b826.js";import{Q}from"./QSelect.b1759751.js";import{Q as W,a as X,C as Y}from"./QPopupProxy.c164d2ac.js";import{Q as Eo}from"./QPage.f3b97ac0.js";import{T as To}from"./TabLayout.dfee7537.js";import{u as Lo}from"./index.004ff2d8.js";import{C as Do}from"./ContenedorSimpleMixin.0ef3239b.js";import{T as Qo}from"./TipoFonfoController.def192fb.js";import{u as Ro,W as Z,M as No,L as h,s as Uo,A as x}from"./utils.2eab62de.js";import{E as qo}from"./entidadAuditable.75a46700.js";import{r as R}from"./i18n-validators.ea544161.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./buttonSubmits.f728eedc.js";import"./EssentialTable.c4a035e4.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./EssentialTablePagination.959d4e60.js";import"./index.9f64ebda.js";class Po extends qo{constructor(){super();g(this,"empleado");g(this,"tipo_saldo");g(this,"fecha_inicio");g(this,"fecha_fin");this.empleado=null,this.tipo_saldo=null,this.fecha_inicio=null,this.fecha_fin=null}}class Bo extends Fo{constructor(){super(N.fondo_rotativo_autorizaciones_fecha_pdf)}}var jo=So({components:{TabLayout:To},setup(){yo().setQuasar(P()),Ro().setQuasar(P());const o=new Do(Po,new Bo),{entidad:e,disabled:f,accion:U,listadosAuxiliares:t}=o.useReferencias(),{setValidador:q,obtenerListados:s,cargarVista:oo}=o.useComportamiento(),eo={tipo_saldo:{required:R},fecha_inicio:{required:R},fecha_fin:{required:R}},I=v(!1),so=v(!1),w=v();w.value=B,t.tipos_saldos=w;const O=Lo(eo,e);q(O.value);const b=v([]),c=v(),_=v([]),A=v([]);b.value=t.usuarios,oo(async()=>{await s({usuarios:{controller:new j,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Qo,params:{campos:"id,descripcion"}}}),b.value=t.usuarios,c.value=V.getItem("usuariosInactivos")==null?[]:JSON.parse(V.getItem("usuariosInactivos").toString()),t.usuariosInactivos=c.value,_.value=t.tiposFondos,A.value=t.tiposFondoRotativoFechas;const a=Z(new Date),n=No(a,-1),r=Z(n);e.fecha_inicio=h(r,C),e.fecha_fin=h(n,C)});function ao(a,n){if(a===""){n(()=>{b.value=t.usuarios});return}n(()=>{const r=a.toLowerCase();b.value=t.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(r)>-1||u.apellidos.toLowerCase().indexOf(r)>-1)})}function io(a,n){if(a===""){n(()=>{c.value=t.usuariosInactivos});return}n(()=>{const r=a.toLowerCase();c.value=t.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(r)>-1||u.apellidos.toLowerCase().indexOf(r)>-1)})}function lo(a,n){if(a===""){n(()=>{_.value=t.tiposFondos});return}n(()=>{const r=a.toLowerCase();_.value=t.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(r)>-1)})}function no(a,n){if(a===""){n(()=>{A.value=t.tiposFondoRotativoFechas});return}n(()=>{const r=a.toLowerCase();A.value=t.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(r)>-1)})}function to(a,n){if(a===""){n(()=>{t.tipos_saldos=B,w.value=t.tipos_saldos});return}n(()=>{const r=a.toLowerCase();w.value=t.tipos_saldos.filter(u=>u.label.toLowerCase().indexOf(r)>-1)})}function ro(){const a=b.value.filter(n=>n.id===e.empleado)[0];return(a==null?void 0:a.nombres)+" "+(a==null?void 0:a.apellidos)}async function uo(a,n){if(await O.value.$validate()){const r=Ao.getInstance(),u="Reporte consolidado de "+ro()+" del "+a.fecha_inicio+" al "+a.fecha_fin;switch(n){case G.EXCEL:const bo=z.URL_BASE+"/"+r.getEndpoint(N.consolidado_excel);x(bo,"POST","blob","xlsx",u,a);break;case G.PDF:const Co=z.URL_BASE+"/"+r.getEndpoint(N.consolidado_pdf);x(Co,"POST","blob","pdf",u,a);break}}}function po(){e.empleado=null,console.log(I.value)}async function mo(){c.value=(await new j().listar({campos:"id,nombres,apellidos",estado:0})).result,t.usuariosInactivos=c.value,V.set("usuariosInactivos",JSON.stringify(c.value))}function fo(a){const n=h(new Date,C);return a<=n}function co(a){const n=h(new Date,C),r=h(e.fecha_inicio!==null?e.fecha_inicio:new Date,C);return a>=r&&a<=n}function vo(){I.value=!1}return{mixin:o,consolidado:e,disabled:f,accion:U,v$:O,maskFecha:C,usuarios:b,usuariosInactivos:c,tiposFondos:_,tiposFondoRotativoFechas:A,tipos_saldos_consolidado:w,tipo_saldo:ho,is_all_empleados:I,is_inactivo:so,ordenarLista:Uo,generar_reporte:uo,filtrarUsuarios:ao,filtrarUsuariosInactivos:io,filtrarTiposFondos:lo,filtrarTiposFondoRotativoFechas:no,filtarTiposSaldos:to,mostrarEmpleados:po,watchEffect:_o,optionsFechaInicio:fo,optionsFechaFin:co,recargarEmpleadosInactivos:mo,limpiar:vo}}});const Go={class:"col-12 col-md-3"},zo={class:"error-msg"},Mo={key:0,class:"col-12 col-md-3"},Ho={key:1,class:"col-12 col-md-3"},Jo={class:"col-6 col-md-3"},Ko={class:"row items-center justify-end"},Wo={class:"error-msg"},Xo={class:"col-6 col-md-3"},Yo={class:"row items-center justify-end"},Zo={class:"error-msg"},xo={key:2,class:"col-12 col-md-3"},oe={class:"col-12 col-md-3"},ee={class:"col-md-6"},se={class:"col-md-6"};function ae(o,e,f,U,t,q){return p(),Oo(Eo,{padding:"",class:"flex flex-center"},{default:l(()=>[i(Vo,{flat:"",bordered:"",class:"my-card bg-desenfoque"},{default:l(()=>[i(M,null,{default:l(()=>e[15]||(e[15]=[d("div",{class:"row items-center no-wrap"},[d("div",{class:"col"},[d("div",{class:"text-h6"},"Generar Reporte Consolidado de Saldo")])],-1)])),_:1}),i(M,null,{default:l(()=>[d("div",Go,[e[17]||(e[17]=d("label",{class:"q-mb-sm block"},"Tipo de Reporte",-1)),i(Q,{modelValue:o.consolidado.tipo_saldo,"onUpdate:modelValue":[e[0]||(e[0]=s=>o.consolidado.tipo_saldo=s),e[2]||(e[2]=s=>o.limpiar())],options:o.tipos_saldos_consolidado,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.tipo_saldo.$errors.length,"error-message":"Debes seleccionar un tipo de saldo","use-input":"","input-debounce":"0",onPopupShow:e[1]||(e[1]=s=>o.ordenarLista(o.tipos_saldos_consolidado,"label")),onBlur:o.v$.tipo_saldo.$touch,onFilter:o.filtarTiposSaldos,"option-value":s=>s.value,"option-label":s=>s.label,"emit-value":"","map-options":""},{error:l(()=>[(p(!0),m($,null,k(o.v$.tipo_saldo.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",zo,E(s.$message),1)]))),128))]),"no-option":l(()=>[i(L,null,{default:l(()=>[i(D,{class:"text-grey"},{default:l(()=>e[16]||(e[16]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),(o.consolidado.tipo_saldo==o.tipo_saldo.ACREDITACIONES||o.consolidado.tipo_saldo==o.tipo_saldo.GASTO||o.consolidado.tipo_saldo==o.tipo_saldo.GASTOS_FOTOGRAFIA||o.consolidado.tipo_saldo==o.tipo_saldo.CONSOLIDADO||o.consolidado.tipo_saldo==o.tipo_saldo.ESTADO_CUENTA||o.consolidado.tipo_saldo==o.tipo_saldo.TRANSFERENCIA_SALDOS)&&!o.is_inactivo?(p(),m("div",Mo,[e[19]||(e[19]=d("label",{class:"q-mb-sm block"},"Empleado",-1)),i(Q,{modelValue:o.consolidado.empleado,"onUpdate:modelValue":e[3]||(e[3]=s=>o.consolidado.empleado=s),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onFilter:o.filtrarUsuarios,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":l(()=>[i(L,null,{default:l(()=>[i(D,{class:"text-grey"},{default:l(()=>e[18]||(e[18]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])])):T("",!0),(o.consolidado.tipo_saldo==o.tipo_saldo.ACREDITACIONES||o.consolidado.tipo_saldo==o.tipo_saldo.GASTO||o.consolidado.tipo_saldo==o.tipo_saldo.GASTOS_FOTOGRAFIA||o.consolidado.tipo_saldo==o.tipo_saldo.CONSOLIDADO||o.consolidado.tipo_saldo==o.tipo_saldo.ESTADO_CUENTA||o.consolidado.tipo_saldo==o.tipo_saldo.TRANSFERENCIA_SALDOS)&&o.is_inactivo?(p(),m("div",Ho,[e[21]||(e[21]=d("label",{class:"q-mb-sm block"},"Empleado",-1)),i(Q,{modelValue:o.consolidado.empleado,"onUpdate:modelValue":e[5]||(e[5]=s=>o.consolidado.empleado=s),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":l(()=>[i(L,null,{default:l(()=>[i(D,{class:"text-grey"},{default:l(()=>e[20]||(e[20]=[F(" No hay resultados ")])),_:1})]),_:1})]),after:l(()=>[i(S,{color:"positive",onClick:e[4]||(e[4]=s=>o.recargarEmpleadosInactivos())},{default:l(()=>[i(y,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])])):T("",!0),d("div",Jo,[e[22]||(e[22]=d("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(H,{modelValue:o.consolidado.fecha_inicio,"onUpdate:modelValue":e[7]||(e[7]=s=>o.consolidado.fecha_inicio=s),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:l(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(X,{modelValue:o.consolidado.fecha_inicio,"onUpdate:modelValue":e[6]||(e[6]=s=>o.consolidado.fecha_inicio=s),mask:o.maskFecha,"today-btn":""},{default:l(()=>[d("div",Ko,[J(i(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[Y]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(p(!0),m($,null,k(o.v$.fecha_inicio.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",Wo,E(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),d("div",Xo,[e[23]||(e[23]=d("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(H,{modelValue:o.consolidado.fecha_fin,"onUpdate:modelValue":e[9]||(e[9]=s=>o.consolidado.fecha_fin=s),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:l(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(X,{modelValue:o.consolidado.fecha_fin,"onUpdate:modelValue":e[8]||(e[8]=s=>o.consolidado.fecha_fin=s),mask:o.maskFecha,"today-btn":""},{default:l(()=>[d("div",Yo,[J(i(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[Y]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(p(!0),m($,null,k(o.v$.fecha_fin.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",Zo,E(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),o.consolidado.tipo_saldo==1||o.consolidado.tipo_saldo==2||o.consolidado.tipo_saldo==6?(p(),m("div",xo,[i(K,{modelValue:o.is_all_empleados,"onUpdate:modelValue":[e[10]||(e[10]=s=>o.is_all_empleados=s),e[11]||(e[11]=s=>o.mostrarEmpleados())],color:"secondary",label:"Todos los empleados","true-value":!0,"false-value":!1},null,8,["modelValue"])])):T("",!0),d("div",oe,[i(K,{modelValue:o.is_inactivo,"onUpdate:modelValue":e[12]||(e[12]=s=>o.is_inactivo=s),color:"secondary",label:"Inactivo"},null,8,["modelValue"])])]),_:1}),i($o),i(ko,{align:"around",class:"row q-col-gutter-xs"},{default:l(()=>[d("div",ee,[i(S,{color:"positive",onClick:e[13]||(e[13]=s=>o.generar_reporte(o.consolidado,"excel")),class:"full-width",unelevated:"",square:""},{default:l(()=>[i(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[24]||(e[24]=F("Excel"))]),_:1})]),d("div",se,[i(S,{color:"negative",onClick:e[14]||(e[14]=s=>o.generar_reporte(o.consolidado,"pdf")),class:"full-width",unelevated:"",square:""},{default:l(()=>[i(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[25]||(e[25]=F("PDF"))]),_:1})])]),_:1})]),_:1})]),_:1})}var Ue=Io(jo,[["render",ae]]);export{Ue as default};

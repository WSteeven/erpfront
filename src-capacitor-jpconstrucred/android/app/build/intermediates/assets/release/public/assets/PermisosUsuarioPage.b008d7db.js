import{Q as so}from"./QSelect.b1759751.js";import{by as U,s as H,d as io,bc as ao,m as to,$ as ro,c as d,E as F,_ as lo,t as L,v as m,P as E,F as s,z as o,be as u,y as t,x as p,bd as c,G as M,H as O,J as k,O as N,B as f,D as Q,K as q}from"./index.70185135.js";import{Q as z,a as b}from"./QItemSection.1a41b826.js";import{Q as G}from"./QScrollArea.7f9f49f9.js";import{Q as no}from"./QPage.f3b97ac0.js";import{E as mo}from"./EssentialTable.c4a035e4.js";import{M as uo}from"./ModalEntidad.7d323d29.js";import{C as po}from"./ContenedorSimpleMixin.0ef3239b.js";import{P as co,c as fo}from"./Permiso.405aa895.js";import{P as vo,C as go}from"./ComportamientoModalesPermisoNuevo.6e83dc4e.js";import{S as bo}from"./utils.2eab62de.js";import{u as _o}from"./filtrosListadosGenerales.6ad178d9.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./QResizeObserver.721a0e6c.js";import"./QScrollObserver.0842fd40.js";import"./TouchPan.fefe3f7c.js";import"./touch.9135741d.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./QPopupProxy.c164d2ac.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./i18n-validators.ea544161.js";import"./index.9f64ebda.js";import"./configuracion_general.27135600.js";import"./ConfiguracionController.40960b9d.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.9bc16b73.js";import"./QForm.0c8c3b68.js";import"./index.004ff2d8.js";import"./TabLayout.dfee7537.js";import"./QTabs.4ee0c65d.js";import"./QTabPanels.0148950e.js";import"./buttonSubmits.f728eedc.js";import"./EssentialTablePagination.959d4e60.js";import"./RolController.f1b9f070.js";class T extends U{constructor(){super(H.permisos_roles_usuario)}}class Co extends U{constructor(){super(H.asignar_permisos_individual)}}var Po=io({components:{EssentialTable:mo,ModalEntidad:uo},setup(){ao().setQuasar(to());const e=new po(co,new T),{entidad:i,listadosAuxiliares:v,listado:_}=e.useReferencias(),I=ro(),{cargarVista:V,obtenerListados:g,listar:C}=e.useComportamiento(),a=d(),r=d(),{empleados:R,filtrarEmpleados:j,roles:h}=_o(v),J=new vo,$=new Co,B=new bo,P=d([]),K=d([]),S=d(),w=d();V(async()=>{await g({empleados:{controller:new F,params:{campos:"id,nombres,apellidos,identificacion",estado:1}}})}),R.value=v.empleados;async function x(l){await C({id_rol:l,tipo:"ASIGNADOS"});const{result:n}=await J.listar({id_rol:l,tipo:"NO ASIGNADOS"});P.value=n}function W(){S.value.seleccionar(),S.value.clearSelection()}function X(){w.value.seleccionar(),w.value.clearSelection()}function Y(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),A()}function Z(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),A()}const D=new go;function oo(){D.abrirModalEntidad("PermisoNuevoPage")}const eo=()=>{I.replace("/roles")};async function A(){B.activar();const{result:l}=await new F().consultar(r.value);h.value=l.roles,a.value=[...l.permisos];const{response:n}=await new T().listar({empleado_id:r.value,tipo:"NO ASIGNADOS"});P.value=n.data.results,_.value=[...n.data.permisos_usuario],B.desactivar()}return{fecha:d(),mixin:e,permiso:i,modales:D,configuracionColumnasPermisos:fo,empleado:r,listado:_,permisosSinAsignar:P,crearRol:eo,crear_permiso:oo,obtenerPermisoRol:x,asignarPermiso:Y,eliminarPermiso:Z,botonAsignarPermisos:W,botonEliminarPermisos:X,listadosAuxiliares:v,roles:h,permisos:a,empleados:R,permisosAsignados:K,refPermisosSinAsignar:S,refPermisosAsignados:w,filtrarEmpleados:j,filtrarRolesEmpleados:A}}});const So={class:"row q-col-gutter-sm q-mb-md"},wo={class:"col-12 col-md-5"},Ao={class:"col-12 col-md-5 q-mb-md"},yo={key:0,class:"col-12 col-md-5 q-mb-md"},Eo={class:"row"},ko={key:0,class:"col-12 col-md-5"},No={key:0,class:"col-12 col-md-5 q-mb-md"},Qo={class:"q-py-xs"},qo={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},Io={class:"col-12 col-md-5 q-gutter-y-sm"},Vo={class:"col-md-2 column justify-center q-gutter-y-md"},Ro={class:"col-12 col-md-5 q-mb-md"};function ho(e,i,v,_,I,V){const g=L("essential-table"),C=L("modal-entidad");return m(),E(no,{padding:"",class:"q-pa-lg"},{default:s(()=>[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[t("div",So,[t("div",wo,[t("div",Ao,[i[4]||(i[4]=t("label",{class:"q-mb-sm block"},null,-1)),o(so,{modelValue:e.empleado,"onUpdate:modelValue":[i[0]||(i[0]=a=>e.empleado=a),e.filtrarRolesEmpleados],options:e.empleados,"options-dense":"",dense:"",outlined:"","error-message":"Debe seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","onUpdate:modelValue","option-value","option-label"])]),e.roles?(m(),p("div",yo,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[5]||(i[5]=t("div",{class:"text-h6"},"Roles",-1)),o(G,{style:{height:"100px"}},{default:s(()=>[t("div",Eo,[(m(!0),p(M,null,O(e.roles,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"})]),_:1}),o(b,null,{default:s(()=>[Q(q(a),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)]),i[7]||(i[7]=t("div",{class:"col-12 col-md-2"},null,-1)),e.permisos?(m(),p("div",ko,[e.listado?(m(),p("div",No,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[6]||(i[6]=t("div",{class:"text-h6"}," Todos los permisos asignados (roles y directamente) ",-1)),o(G,{style:{height:"164px"}},{default:s(()=>[t("div",Qo,[(m(!0),p(M,null,O(e.permisos,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"},{default:s(()=>[Q(" \xA0"+q(r+1),1)]),_:2},1024)]),_:2},1024),o(b,null,{default:s(()=>[Q(q(a.name),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)])):k("",!0)]),t("div",qo,[t("div",Io,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[8]||(i[8]=t("div",{class:"text-h6"},"No Asignados",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,datos:e.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarHeader:!0,mostrarFooter:!0,mostrarColumnasVisibles:!1,ref:"refPermisosSinAsignar",onSelected:e.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})]),t("div",Vo,[o(N,{class:"full-width block",color:"secondary",onClick:i[1]||(i[1]=a=>e.crear_permiso())},{default:s(()=>[o(f,{name:"bi-plus"})]),_:1}),o(N,{class:"full-width block",color:"primary",onClick:i[2]||(i[2]=a=>e.botonAsignarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-right"})]),_:1}),o(N,{class:"full-width block",color:"accent",onClick:i[3]||(i[3]=a=>e.botonEliminarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-left"})]),_:1})]),t("div",Ro,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[9]||(i[9]=t("div",{class:"text-h6"},"Asignados directamente",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:e.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,ref:"refPermisosAsignados",onSelected:e.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})])])]),_:1})]),_:1}),o(C,{comportamiento:e.modales,persistente:!1},null,8,["comportamiento"])]),_:1})}var ye=lo(Po,[["render",ho]]);export{ye as default};

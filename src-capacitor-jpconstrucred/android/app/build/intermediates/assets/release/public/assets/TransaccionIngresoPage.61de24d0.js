var ie=Object.defineProperty;var ne=(o,e,b)=>e in o?ie(o,e,{enumerable:!0,configurable:!0,writable:!0,value:b}):o[e]=b;var _=(o,e,b)=>(ne(o,typeof e!="symbol"?e+"":e,b),b);import{c as g,d as le,R as mo,bc as se,m as po,u as re,E as te,bz as D,dB as F,A as de,a1 as Y,f as ce,dd as ue,c0 as me,cy as pe,bg as bo,_ as be,t as I,v as d,x as c,z as i,F as l,a5 as ve,y as s,J as u,I as w,B as vo,j as fe,O as x,a3 as oo,L as eo,a8 as ge,M as fo,N as go,D as M,K as U,G as Ve}from"./index.70185135.js";import{Q as ye,a as Pe,C as we}from"./QPopupProxy.c164d2ac.js";import{Q as k,a as H}from"./QSelect.b1759751.js";import{Q as Vo,a as yo}from"./QItemSection.1a41b826.js";import{E as Ce,k as $e}from"./EssentialTable.c4a035e4.js";import{Q as Se}from"./QForm.0c8c3b68.js";import{C as ke,u as Te,S as qe,i as Ee,n as he,a5 as De,a6 as Ie,s as Le,a7 as Po}from"./utils.2eab62de.js";import{c as Be,a as Fe}from"./VisualizarIngresoPage.af7a91bc.js";import{r as R,a as T}from"./index.9f64ebda.js";import{u as Me}from"./index.004ff2d8.js";import{c as Ue}from"./configuracionColumnasProductos.4f52212a.js";import{u as je}from"./selector.0fae7bb3.js";import{u as Ne}from"./transaccion.7423526a.js";import{u as Qe}from"./devolucion.243b3973.js";import{T as Oe}from"./TabLayout.dfee7537.js";import{E as ze}from"./EssentialSelectableTable.ee506d87.js";import{M as Ae}from"./ModalEntidad.7d323d29.js";import{C as Ye}from"./ContenedorSimpleMixin.0ef3239b.js";import{P as He}from"./ProveedorController.c7194da5.js";import{M as Re}from"./MotivoController.1d8b946d.js";import{C as Je}from"./ClienteController.71ac4dd6.js";import{T as Ke}from"./Transaccion.ef293505.js";import{T as Ge}from"./TransaccionIngresoController.32d98dc7.js";import{u as Xe}from"./transferencia.d001291d.js";import{C as We}from"./ComportamientoModalesGestionarIngreso.25f32888.js";import{u as Ze}from"./filtrosListadosGenerales.6ad178d9.js";import{i as wo}from"./iconos.5bc406be.js";import{N as _e}from"./NoOptionComponent.4eefbc12.js";import{E as xe}from"./ErrorComponent.60ce3364.js";import"./format.8ac60962.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./QChip.a6a2afa6.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./SelectorController.c365d743.js";import"./entidadAuditable.75a46700.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QPage.f3b97ac0.js";import"./buttonSubmits.f728eedc.js";import"./EssentialTablePagination.959d4e60.js";import"./configuracion_general.27135600.js";import"./ConfiguracionController.40960b9d.js";import"./Transferencia.f2b64659.js";import"./ComponenteModal.domain.9bc16b73.js";import"./DetalleProductoPage.ca346a83.js";import"./configuracionColumnasDetallesProductos.d6dcbc18.js";import"./detalle.e5e2a7f2.js";import"./DetalleProducto.7fc57c43.js";import"./PermisoArma.2f16dcc8.js";import"./i18n-validators.ea544161.js";import"./TabLayoutFilterTabs2.0c89493b.js";import"./EssentialTableTabs.a1f1bc4b.js";import"./DetalleProductoController.a611786a.js";import"./ProductoController.b9a401ce.js";import"./MarcaController.f486f997.js";import"./ModeloController.51be2649.js";import"./TipoFibraController.8469860c.js";import"./HiloController.16471b68.js";import"./DetalleProductoPage.2272d833.js";import"./LabelAbrirModal.8cde336f.js";import"./PermisoArmaPage.2b58e42f.js";import"./FormularioPermisoArma.97aead60.js";import"./ProductoPage.06990be0.js";import"./CategoriaController.fe431db6.js";import"./UnidadMedidaController.494f7e1a.js";import"./MarcaPage.4b5fa3f1.js";import"./ModeloPage.d4a8a332.js";const oa=[{name:"producto",field:"producto",label:"Producto",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!1},{name:"categoria",field:"categoria",label:"Categoria",align:"left",sortable:!0},{name:"condiciones",field:"condiciones",label:"Condici\xF3n",align:"left",sortable:!1},{name:"observacion",field:"observacion",label:"Observaci\xF3n",align:"left",sortable:!1},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",sortable:!1},{name:"devuelto",field:"devuelto",label:"Devuelto",align:"left",sortable:!1},{name:"pendiente",field:"pendiente",label:"Pendiente",align:"left",sortable:!1}],ea=[{name:"producto",field:"producto",label:"Producto",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 600px; overflow: auto;",align:"left",sortable:!0},{name:"id",field:"id",label:"Id Detalle",align:"left",visible:!1,editable:!1},{name:"modelo",field:"modelo",label:"Modelo",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!0},{name:"fibra",field:"fibra",label:"Fibra",align:"left",sortable:!0},{name:"puntas",field:"puntas",label:"Detalles Fibra",align:"left",sortable:!0},{name:"adicionales",field:"adicionales",label:"Campos adicionales",align:"left",sortable:!0}];function aa(o,e){const b=g(),f=g([]),v=g([]),E=g(),p={refListadoSeleccionable:b,listadoPrecargado:v,listadoSeleccionable:f,endpoint:e,limpiar:()=>{o.id=null,E.value=null},seleccionarMultiple:C=>{o.listadoProductosTransaccion=[...o.listadoProductosTransaccion,...C],o.listadoProductosTransaccion.forEach(a=>{a.id=ke(o.listadoProductosTransaccion)+1})}},V=je(p);return{refListadoSeleccionable:b,listado:f,listar:C=>V.listar(E.value,C),limpiar:()=>p.limpiar(),seleccionar:C=>{let a=[];a=o.listadoProductosTransaccion.map(S=>{var z;(z=S.condiciones)!=null||S.id});const O=C.filter(S=>!a.includes(S.id));O.forEach(S=>{S.cantidad=1}),p.seleccionarMultiple(O)},criterioBusqueda:E}}class ia{constructor(e,b){_(this,"transaccion");_(this,"listadoDevolucion",g([]));this.transaccion=e,this.listadoDevolucion=b}async validar(){if(this.transaccion.listadoProductosTransaccion.length===0)throw new Error("Debe agregar al menos un producto al listado");if(this.transaccion.listadoProductosTransaccion.some(b=>b.cantidad<=0))throw new Error("La cantidad de los productos del listado debe ser mayor a 0");if(!this.transaccion.ingreso_masivo&&!this.transaccion.listadoProductosTransaccion.every(f=>f.hasOwnProperty("condiciones")))throw new Error("Debes seleccionar un estado para cada \xEDtem");return!0}}var na=le({name:"transacciones_ingresos",components:{ErrorComponent:xe,NoOptionComponent:_e,TabLayout:Oe,EssentialTable:Ce,ModalesEntidad:Ae,EssentialSelectableTable:ze},setup(){const o=new Ye(Ke,new Ge),{entidad:e,disabled:b,accion:f,listadosAuxiliares:v}=o.useReferencias(),{setValidador:E,obtenerListados:p,cargarVista:V,listar:j,guardar:N,editar:Q,eliminar:C,reestablecer:a}=o.useComportamiento(),{onConsultado:O,onReestablecer:S,onGuardado:z,onBeforeGuardar:Co,onBeforeModificar:$o}=o.useHooks(),{confirmar:ao,prompt:io}=mo(),J=new We;se().setQuasar(po()),Te().setQuasar(po());const y=re(),$=Ne(),r=Qe(),h=Xe(),no=new qe,So=y.esCoordinador||y.esBodeguero;z(()=>{P.value=[],r.resetearDevolucion()}),O(()=>{e.solicitante=e.solicitante_id,$.transaccion.hydrate(e)}),S(()=>{P.value=[],e.condicion=null,r.resetearDevolucion(),q.value=!1}),Co(()=>{e.proveedor=e.proveedor_id?v.proveedores.find(n=>n.id===e.proveedor_id).razon_social:e.proveedor}),$o(()=>{e.proveedor=e.proveedor_id?v.proveedores.find(n=>n.id===e.proveedor_id).razon_social:e.proveedor});const{refListadoSeleccionable:ko,criterioBusqueda:To,listado:qo,listar:Eo,limpiar:K,seleccionar:ho}=aa(e,"detalles"),Do=g(!1),Io=g(!0),q=g(!1),A=g(!1),P=g(),G=g([]),{clientes:X,filtrarClientes:Lo,empleados:lo,filtrarEmpleados:Bo,sucursales:L,filtrarSucursalesPorBodeguero:Fo,motivos:so,filtrarMotivos:Mo,tareas:W,proveedores:ro,filtrarProveedores:Uo}=Ze(v);V(async()=>{await p({motivos:{controller:new Re,params:{tipo_transaccion_id:1}},clientes:{controller:new Je,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}},empleados:{controller:new te,params:{campos:"id,nombres,apellidos"}},proveedores:new He}),r.devolucion.id?(e.tiene_devolucion=!0,e.tarea=Number.isInteger(r.devolucion.tarea)?r.devolucion.tarea:r.devolucion.tarea_id,await co()):e.solicitante=y.user.id,ro.value=v.proveedores});const jo={justificacion:{required:R},sucursal:{required:R},num_comprobante:{required:T(()=>q.value)},fecha_compra:{required:T(()=>q.value)},proveedor_id:{required:T(()=>q.value&&e.modo_seleccion)},proveedor:{required:T(()=>q.value&&!e.modo_seleccion)},motivo:{requiredIfRol:T(y.esBodeguero)},estado:{requiredIfRol:T(f.value===D.editar)},observacion_est:{requiredIfObsEstado:T(function(){return e.tiene_obs_estado})},listadoProductosTransaccion:{required:R},cliente:{required:R},condicion:{requiredIfMasivo:T(e.ingreso_masivo)}},to=Me(jo,e);E(to.value);const No=new ia(e,P);o.agregarValidaciones(No);const Qo={titulo:"Agregar nuevo detalle",icono:"bi-plus-lg",color:"positive",accion:()=>{J.abrirModalEntidad("DetalleProductoPage")},visible:()=>f.value==D.nuevo||f.value==D.editar};async function Oo(n){B(),K(),Po(P.value),r.resetearDevolucion();try{await r.cargarDevolucion(n),await co()}catch{B(),K(),Po(P.value),r.resetearDevolucion()}}async function co(){e.devolucion=r.devolucion.id,e.justificacion=r.devolucion.justificacion,e.solicitante=Number.isInteger(r.devolucion.solicitante)?r.devolucion.solicitante:r.devolucion.solicitante_id,e.sucursal=Number.isInteger(r.devolucion.sucursal)?r.devolucion.sucursal:r.devolucion.sucursal_id,e.cliente=Number.isInteger(r.devolucion.cliente)?r.devolucion.cliente:r.devolucion.cliente_id,e.es_para_stock=r.devolucion.es_para_stock,r.devolucion.listadoProductos.forEach(n=>{n.detalle_id=n.id,n.pendiente=n.cantidad-n.devuelto}),P.value=[...r.devolucion.listadoProductos.filter(n=>n.cantidad!==n.devuelto)],P.value.sort((n,t)=>n.id-t.id),e.listadoProductosTransaccion=P.value.map(n=>({...n,cantidad:n.pendiente})),r.devolucion.tarea&&(e.es_tarea=!0,e.tarea=Number.isInteger(r.devolucion.tarea)?r.devolucion.tarea:r.devolucion.tarea_id)}async function zo(n){B(),await h.cargarTransferencia(n),Ao()}function Ao(){e.sucursal=h.transferencia.sucursal_destino,e.justificacion=h.transferencia.justificacion,e.cliente=h.transferencia.cliente,e.per_autoriza=h.transferencia.per_autoriza,e.listadoProductosTransaccion=h.transferencia.listadoProductos}function B(){e.devolucion=null,e.justificacion="",e.solicitante=null,e.sucursal=null,e.listadoProductosTransaccion=[],P.value=[]}function Yo(n){const t=L.value.filter(m=>m.id===n);e.cliente=t[0].cliente_id}function Ho({entidad:n}){const t=e.listadoProductosTransaccion.findIndex(m=>m.id===n.id);ao("\xBFEsta seguro de continuar?",()=>{e.listadoProductosTransaccion.splice(t,1)})}const Ro={titulo:"Actualizar",icono:"bi-arrow-clockwise",accion:()=>{j()},visible:()=>!1},Jo={titulo:"Editar cantidad",accion:({posicion:n})=>{const t={titulo:"Confirmaci\xF3n",mensaje:"Ingresa la cantidad",defecto:e.listadoProductosTransaccion[n].cantidad,tipo:"number",validacion:m=>m>0,accion:m=>{e.listadoProductosTransaccion[n].cantidad=m}};io(t)},visible:()=>f.value===D.nuevo&&e.ingreso_masivo||f.value===D.editar&&e.ingreso_masivo||!Io.value&&e.ingreso_masivo||e.ingreso_masivo},Ko={titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:n})=>{$.idTransaccion=n.id,await $.imprimirIngreso()}},Go={titulo:"Editar",color:"orange-3",icono:wo.editar,visible:()=>y.esCoordinadorBodega,accion:async({entidad:n})=>{console.log("diste clic en botonEditarIngreso"),$.idTransaccion=n.id,await $.showPreviewEgreso(),J.abrirModalEntidad("ModificarIngresoPage")}},Xo={titulo:"Editar fecha de compra",color:"amber-8",icono:wo.editar,visible:({entidad:n})=>n.motivo===F.compraProveedor,accion:async({entidad:n,posicion:t})=>{var uo;const m={titulo:"Fecha de compra",mensaje:"Ingresa la nueva fecha",defecto:(uo=e.listadoProductosTransaccion[t])==null?void 0:uo.fecha_compra,tipo:"text",accion:async ee=>{try{await de.getInstance().put("api/transacciones-ingresos-editar-fecha-compra/"+n.id,{fecha_compra:ee})}catch(Z){if(Ee(Z)){const ae=Z.erroresValidacion;await he(ae,mo())}}}};io(m)}},Wo={titulo:"Anular",color:"red",icono:"bi-x",accion:async({entidad:n})=>{ao("\xBFEst\xE1 seguro que desea anular la transacci\xF3n?. Esta acci\xF3n restar\xE1 al inventario los materiales ingresados previamente",async()=>{$.idTransaccion=n.id,await $.anularIngreso(),n.estado=$.transaccion.estado})},visible:({entidad:n})=>y.can("puede.anular.transacciones_ingresos")&&n.estado===me.completa};G.value=JSON.parse(Y.getItem("condiciones").toString()),L.value=JSON.parse(Y.getItem("sucursales").toString()),v.sucursales=L.value,so.value=v.motivos,W.value=v.tareas,X.value=v.clientes,lo.value=v.empleados;const Zo=ce(()=>[...Be,{name:"condiciones",field:"condiciones",label:"Estado del producto",align:"left",sortable:!1,visible:!0,type:"select",options:G.value.map(n=>({label:n.nombre}))},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",type:"number",sortable:!1},{name:"acciones",field:"acciones",label:"Acciones",align:"center"}]);function _o(n){const t=v.tareas.filter(m=>m.id===n);e.cliente=t[0].cliente_id}async function xo(){const n=(await new pe().listar({campos:"id,lugar"})).result;Y.set("sucursales",JSON.stringify(n)),n.value=JSON.parse(Y.getItem("sucursales").toString()),v.sucursales=n.value}async function oe(n=!0,t=null){no.activar();let m;n&&(e.tarea=null),t?m=await new bo().listar({id:t}):m=await new bo().listar({activas_empleado:1,empleado_id:e.solicitante,campos:"id,codigo_tarea,titulo",finalizado:0}),v.tareas=m.result,W.value=m.result,no.desactivar()}return{mixin:o,transaccion:e,disabled:b,accion:f,v$:to,soloLectura:Do,configuracionColumnas:Fe,motivos:so,filtrarMotivos:Mo,estados:ue,tareas:W,clientes:X,empleados:lo,filtrarEmpleados:Bo,sucursales:L,filtrarSucursales:Fo,condiciones:G,listadoDevolucion:P,acciones:D,tareaSeleccionada:_o,motivoSeleccionado(n){A.value=!1;const t=v.motivos.filter(m=>m.id===n);q.value=t[0].nombre===F.compraProveedor,A.value=t[0].nombre===F.mercaderiaClienteTarea||t[0].nombre===F.devolucionTarea,e.es_transferencia=t[0].nombre==F.ingresoTransferenciaBodegas,A.value&&oe(!1,e.tarea)},checkMasivo(n){n||(e.condicion=null)},checkDevolucion(n){n||B()},configuracionColumnasProductosSeleccionadosAccion:Zo,configuracionColumnasDetallesProductosSeleccionables:ea,botonEditarCantidad:Jo,botonActualizar:Ro,botonImprimir:Ko,botonAnular:Wo,botonEditarFechaCompra:Xo,botonEditarIngreso:Go,eliminarItem:Ho,configuracionColumnasListadoProductosDevolucion:oa,pagination:g({rowsPerPage:0}),modales:J,abrirModalDetalle:Qo,refListadoSeleccionableProductos:ko,criterioBusquedaProducto:To,listadoProductos:qo,listarProductos:Eo,limpiarProducto:K,seleccionarProducto:ho,configuracionColumnasProductos:Ue,rolSeleccionado:So,llenarTransaccion:Oo,limpiarTransaccion:B,llenarTransferencia:zo,esVisibleComprobante:q,esVisibleTarea:A,transaccionStore:$,guardar:N,editar:Q,eliminar:C,reestablecer:a,esBodeguero:y.esBodeguero,esCoordinador:y.esCoordinador,seleccionarClientePropietario:Yo,recargarSucursales:xo,filtrarClientes:Lo,ordenarClientes(){De(X,y.esBodegueroTelconet)},ordenarSucursales(){Ie(L,y.esBodegueroTelconet)},ordenarLista:Le,proveedores:ro,filtrarProveedores:Uo}}});const la={class:"row q-col-gutter-sm q-py-md"},sa={key:0,class:"col col-12"},ra={key:1,class:"col-12 col-md-3"},ta={key:2,class:"col-12 col-md-3"};const da={class:"col-12 col-md-3 q-mb-md"},ca={key:4,class:"col-12 col-md-3 q-mb-md"},ua={key:5,class:"col-12 col-md-3"},ma={key:6,class:"col-12 col-md-3 q-mb-md"},pa={key:7,class:"col-12 col-md-3 q-mb-md"},ba={key:8,class:"col-12 col-md-3 col-sm-3"},va={key:9,class:"col-12 col-md-3"},fa={key:10,class:"col-12 col-md-3 q-mb-md"},ga={key:11,class:"col-12 col-md-3 q-mb-md"},Va={class:"row items-center justify-end"},ya={class:"col-12 col-md-3 q-mb-md"},Pa={class:"col-12 col-md-3"},wa={class:"col-12 col-md-3"},Ca={key:12,class:"col-12 col-md-3"},$a={key:13,class:"col-12 col-md-3 q-mb-md"},Sa={key:14,class:"col-12 col-md-3"},ka={key:15,class:"col-12 col-md-3"},Ta={class:"col-12 col-md-3"},qa={key:16,class:"col-12 col-md-3"},Ea={key:17,class:"col-12 col-md-3"},ha={key:18,class:"col-12 col-md-12"},Da={class:"col-12 col-md-12"},Ia={class:"row q-col-gutter-xs"},La={class:"col-12 col-md-10 q-mb-md"},Ba={class:"col-12 col-md-2"},Fa={class:"col-12"};function Ma(o,e,b,f,v,E){const p=I("error-component"),V=I("no-option-component"),j=I("essential-table"),N=I("essential-selectable-table"),Q=I("tab-layout"),C=I("modales-entidad");return d(),c(Ve,null,[i(Q,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Transacciones - Ingresos",permitirEditar:!1,ajustarCeldas:!0,accion1:o.botonImprimir,accion2:o.botonAnular,accion3:o.botonEditarFechaCompra,accion4:o.botonEditarIngreso,accion1Header:o.botonActualizar,paginate:""},{formulario:l(()=>[i(Se,{onSubmit:e[34]||(e[34]=ve(()=>{},["prevent"]))},{default:l(()=>[s("div",la,[o.transaccion.es_para_stock?(d(),c("div",sa,e[35]||(e[35]=[s("span",null,"Se realizar\xE1 un egreso automatico al stock del solicitante",-1)]))):u("",!0),o.transaccion.id?(d(),c("div",ra,[e[36]||(e[36]=s("label",{class:"q-mb-sm block"},"Transacci\xF3n N\xB0",-1)),i(w,{modelValue:o.transaccion.id,"onUpdate:modelValue":e[0]||(e[0]=a=>o.transaccion.id=a),placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly","disable"])])):u("",!0),o.transaccion.created_at?(d(),c("div",ta,[e[37]||(e[37]=s("label",{class:"q-mb-sm block"},"Fecha",-1)),i(w,{modelValue:o.transaccion.created_at,"onUpdate:modelValue":e[1]||(e[1]=a=>o.transaccion.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),u("",!0),s("div",da,[e[39]||(e[39]=s("label",{class:"q-mb-sm block"},"Motivo",-1)),i(k,{modelValue:o.transaccion.motivo,"onUpdate:modelValue":[e[4]||(e[4]=a=>o.transaccion.motivo=a),o.motivoSeleccionado],options:o.motivos,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarMotivos,onPopupShow:e[5]||(e[5]=a=>o.ordenarLista(o.motivos,"nombre")),readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.motivo.$errors.length,"error-message":"Debes seleccionar un motivo","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"motivo",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","readonly","disable","error","option-value","option-label"])]),o.transaccion.es_transferencia?(d(),c("div",ca,[e[40]||(e[40]=s("label",{class:"q-mb-sm block"},"N\xB0 transferencia",-1)),i(w,{type:"number",modelValue:o.transaccion.transferencia,"onUpdate:modelValue":e[6]||(e[6]=a=>o.transaccion.transferencia=a),placeholder:"Opcional",hint:"Ingresa un numero de transferencia y presiona Enter",onKeyup:e[7]||(e[7]=oo(a=>o.llenarTransferencia(o.transaccion.transferencia),["enter"])),readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])])):u("",!0),o.accion==="NUEVO"&&!o.transaccion.es_transferencia&&!o.esVisibleComprobante||o.transaccion.tiene_devolucion&&!o.transaccion.es_transferencia?(d(),c("div",ua,[i(eo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.tiene_devolucion,"onUpdate:modelValue":[e[8]||(e[8]=a=>o.transaccion.tiene_devolucion=a),o.checkDevolucion],label:"\xBFHay devoluci\xF3n?",outlined:"",disable:o.disabled,dense:""},null,8,["modelValue","onUpdate:modelValue","disable"])])):u("",!0),o.transaccion.tiene_devolucion||o.transaccion.devolucion?(d(),c("div",ma,[e[41]||(e[41]=s("label",{class:"q-mb-sm block"},"N\xB0 devoluci\xF3n",-1)),i(w,{type:"number",modelValue:o.transaccion.devolucion,"onUpdate:modelValue":e[9]||(e[9]=a=>o.transaccion.devolucion=a),placeholder:"Opcional",hint:"Ingresa un numero de devoluci\xF3n y presiona Enter",onKeyup:e[10]||(e[10]=oo(a=>o.llenarTransaccion(o.transaccion.devolucion),["enter"])),readonly:o.disabled,disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly","disable"])])):u("",!0),o.esVisibleComprobante||o.transaccion.num_comprobante?(d(),c("div",pa,[e[42]||(e[42]=s("label",{class:"q-mb-sm block"},"N\xB0 Factura/Comprobante",-1)),i(w,{modelValue:o.transaccion.num_comprobante,"onUpdate:modelValue":e[11]||(e[11]=a=>o.transaccion.num_comprobante=a),type:"number",placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,rules:[a=>a>0||"Ingresa un numero de comprobante v\xE1lido"],"lazy-rules":!0,error:!!o.v$.num_comprobante.$errors.length,outlined:"",dense:""},{error:l(()=>[i(p,{clave:"num_comprobante",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","readonly","disable","rules","error"])])):u("",!0),o.esVisibleComprobante?(d(),c("div",ba,[e[43]||(e[43]=s("label",{class:"q-mb-sm block"},"Modo de selecci\xF3n de Proveedor",-1)),i(ge,{label:o.transaccion.modo_seleccion?"LISTADO":"TEXTO",modelValue:o.transaccion.modo_seleccion,"onUpdate:modelValue":[e[12]||(e[12]=a=>o.transaccion.modo_seleccion=a),e[13]||(e[13]=a=>o.transaccion.proveedor=null)],icon:"bi-check2-circle","unchecked-icon":"clear",disable:o.disabled,color:"primary","keep-color":""},null,8,["label","modelValue","disable"])])):u("",!0),o.esVisibleComprobante&&o.transaccion.modo_seleccion||o.transaccion.proveedor_id?(d(),c("div",va,[e[44]||(e[44]=s("label",{class:"q-mb-sm block"},"Proveedor",-1)),i(k,{modelValue:o.transaccion.proveedor_id,"onUpdate:modelValue":e[14]||(e[14]=a=>o.transaccion.proveedor_id=a),options:o.proveedores,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarProveedores,disable:o.disabled||o.soloLectura,"option-label":a=>a.razon_social+" - "+a.sucursal,"option-value":a=>a.id,error:!!o.v$.proveedor_id.$errors.length,"emit-value":"","map-options":""},{option:l(a=>[i(Vo,fo(go(a.itemProps)),{default:l(()=>[i(yo,null,{default:l(()=>[i(H,null,{default:l(()=>[M(U(a.opt.razon_social),1)]),_:2},1024),i(H,{caption:""},{default:l(()=>[M(U(a.opt.nombre_comercial)+" - Sucursal: "+U(a.opt.sucursal||a.opt.direccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[i(V)]),default:l(()=>[s("template",null,[i(p,{clave:"proveedor_id",v$:o.v$},null,8,["v$"])])]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","error"])])):u("",!0),o.esVisibleComprobante&&!o.transaccion.modo_seleccion||o.transaccion.proveedor?(d(),c("div",fa,[e[45]||(e[45]=s("label",{class:"q-mb-sm block"},"Proveedor",-1)),i(w,{modelValue:o.transaccion.proveedor,"onUpdate:modelValue":e[15]||(e[15]=a=>o.transaccion.proveedor=a),placeholder:"Obligatorio",disable:o.disabled||o.soloLectura,error:!!o.v$.proveedor.$errors.length,outlined:"",dense:""},{default:l(()=>[s("template",null,[i(p,{clave:"proveedor",v$:o.v$},null,8,["v$"])])]),_:1},8,["modelValue","disable","error"])])):u("",!0),o.esVisibleComprobante||o.transaccion.fecha_compra?(d(),c("div",ga,[e[46]||(e[46]=s("label",{class:"q-mb-sm block"},"Fecha de compra",-1)),i(w,{modelValue:o.transaccion.fecha_compra,"onUpdate:modelValue":e[17]||(e[17]=a=>o.transaccion.fecha_compra=a),placeholder:"YYYY-MM-DD",hint:"Opcional",disable:o.disabled,error:!!o.v$.fecha_compra.$errors.length,"error-message":"Debes ingresar la fecha de compra",clearable:"",outlined:"",dense:""},{append:l(()=>[i(vo,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(ye,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(Pe,{modelValue:o.transaccion.fecha_compra,"onUpdate:modelValue":e[16]||(e[16]=a=>o.transaccion.fecha_compra=a),mask:"YYYY-MM-DD","today-btn":""},{default:l(()=>[s("div",Va,[fe(i(x,{label:"Cerrar",color:"primary",flat:""},null,512),[[we]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),error:l(()=>[i(p,{clave:"fecha_compra",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error"])])):u("",!0),s("div",ya,[e[47]||(e[47]=s("label",{class:"q-mb-sm block"},"Sucursal",-1)),i(k,{modelValue:o.transaccion.sucursal,"onUpdate:modelValue":[e[18]||(e[18]=a=>o.transaccion.sucursal=a),o.seleccionarClientePropietario],options:o.sucursales,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.sucursal.$errors.length,"error-message":"Debes seleccionar una sucursal","use-input":"","input-debounce":"0",onFilter:o.filtrarSucursales,onPopupShow:o.ordenarSucursales,"option-value":a=>a.id,"option-label":a=>a.lugar,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"sucursal",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),after:l(()=>[i(x,{color:"positive",onClick:o.recargarSucursales},{default:l(()=>[i(vo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","readonly","disable","error","onFilter","onPopupShow","onUpdate:modelValue","option-value","option-label"])]),s("div",Pa,[e[48]||(e[48]=s("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),i(w,{modelValue:o.transaccion.justificacion,"onUpdate:modelValue":e[19]||(e[19]=a=>o.transaccion.justificacion=a),placeholder:"Obligatorio",type:"textarea",autogrow:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.justificacion.$errors.length,outlined:"",dense:""},{error:l(()=>[i(p,{clave:"justificacion",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","readonly","disable","error"])]),s("div",wa,[e[49]||(e[49]=s("label",{class:"q-mb-sm block"},"Solicitante",-1)),i(k,{modelValue:o.transaccion.solicitante,"onUpdate:modelValue":e[20]||(e[20]=a=>o.transaccion.solicitante=a),options:o.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:o.disabled||o.soloLectura,"use-input":"","input-debounce":"0",onFilter:o.filtrarEmpleados,onPopupShow:e[21]||(e[21]=a=>o.ordenarLista(o.empleados,"apellidos")),readonly:o.disabled||o.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","disable","onFilter","readonly","option-label","option-value"])]),o.esVisibleTarea?(d(),c("div",Ca,[e[50]||(e[50]=s("label",{class:"q-mb-sm block"},"Tarea",-1)),i(k,{modelValue:o.transaccion.tarea,"onUpdate:modelValue":[e[22]||(e[22]=a=>o.transaccion.tarea=a),o.tareaSeleccionada],options:o.tareas,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Tarea #",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,"option-label":a=>a.titulo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[i(Vo,fo(go(a.itemProps)),{default:l(()=>[i(yo,null,{default:l(()=>[i(H,null,{default:l(()=>[M(U(a.opt.codigo_tarea),1)]),_:2},1024),i(H,{caption:""},{default:l(()=>[M(U(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","readonly","disable","onUpdate:modelValue","option-label","option-value"])])):u("",!0),o.accion===o.acciones.consultar||o.accion===o.acciones.editar?(d(),c("div",$a,[e[51]||(e[51]=s("label",{class:"q-mb-sm block"},"Estado",-1)),i(k,{modelValue:o.transaccion.estado,"onUpdate:modelValue":e[23]||(e[23]=a=>o.transaccion.estado=a),options:o.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled||o.soloLectura,disable:o.disabled||o.soloLectura,error:!!o.v$.estado.$errors.length,"error-message":"Debes seleccionar un estado para la transacci\xF3n","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"estado",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","readonly","disable","error","option-value","option-label"])])):u("",!0),o.rolSeleccionado?(d(),c("div",Sa,[i(eo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.tiene_obs_estado,"onUpdate:modelValue":e[24]||(e[24]=a=>o.transaccion.tiene_obs_estado=a),label:"Tiene observaci\xF3n",outlined:"",disable:o.disabled||o.soloLectura,dense:""},null,8,["modelValue","disable"])])):u("",!0),o.transaccion.tiene_obs_estado?(d(),c("div",ka,[e[52]||(e[52]=s("label",{class:"q-mb-sm block"},"Observacion",-1)),i(w,{type:"textarea",autogrow:"",modelValue:o.transaccion.observacion_est,"onUpdate:modelValue":e[25]||(e[25]=a=>o.transaccion.observacion_est=a),placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.observacion_est.$errors.length,outlined:"",dense:""},{error:l(()=>[i(p,{clave:"observacion_est",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","readonly","disable","error"])])):u("",!0),s("div",Ta,[e[53]||(e[53]=s("label",{class:"q-mb-sm block"},"Cliente",-1)),i(k,{modelValue:o.transaccion.cliente,"onUpdate:modelValue":e[26]||(e[26]=a=>o.transaccion.cliente=a),options:o.clientes,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.cliente.$errors.length,"error-message":"Debes seleccionar un cliente","use-input":"","input-debounce":"0",onPopupShow:o.ordenarClientes,onFilter:o.filtrarClientes,"option-value":a=>a.id,"option-label":a=>a.razon_social,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"cliente",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","readonly","disable","error","onPopupShow","onFilter","option-value","option-label"])]),o.accion===o.acciones.nuevo?(d(),c("div",qa,[i(eo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.ingreso_masivo,"onUpdate:modelValue":[e[27]||(e[27]=a=>o.transaccion.ingreso_masivo=a),o.checkMasivo],label:"\xBFIngreso masivo?",disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue","disable"])])):u("",!0),o.transaccion.ingreso_masivo?(d(),c("div",Ea,[e[54]||(e[54]=s("label",{class:"q-mb-sm block"},"Estado de los productos",-1)),i(k,{modelValue:o.transaccion.condicion,"onUpdate:modelValue":e[28]||(e[28]=a=>o.transaccion.condicion=a),options:o.condiciones,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,error:!!o.v$.condicion.$errors.length,"error-message":"Debes seleccionar una condici\xF3n","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"condicion",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","readonly","error","option-value","option-label"])])):u("",!0),o.listadoDevolucion!==void 0&&o.listadoDevolucion.length>0?(d(),c("div",ha,[i($e,{"flat.bordered":"",style:{height:"300px"},title:"Listado de la devoluci\xF3n",class:"bg-body-table custom-border",rows:o.listadoDevolucion,columns:o.configuracionColumnasListadoProductosDevolucion,"row-key":"id","hide-bottom":!0,pagination:o.pagination,"onUpdate:pagination":e[29]||(e[29]=a=>o.pagination=a),"rows-per-page-options":[0],"wrap-cells":"","virtual-scroll":"",dense:""},null,8,["rows","columns","pagination"])])):u("",!0),s("div",Da,[e[56]||(e[56]=s("label",{class:"q-mb-sm block"},"Agregar productos",-1)),s("div",Ia,[s("div",La,[i(w,{modelValue:o.criterioBusquedaProducto,"onUpdate:modelValue":e[30]||(e[30]=a=>o.criterioBusquedaProducto=a),placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",disable:o.disabled||o.soloLectura,onKeydown:e[31]||(e[31]=oo(a=>o.listarProductos(),["enter"])),onBlur:e[32]||(e[32]=a=>o.criterioBusquedaProducto===""?o.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","disable"])]),s("div",Ba,[i(x,{onClick:e[33]||(e[33]=a=>o.listarProductos()),icon:"search",unelevated:"",disable:o.disabled||o.soloLectura,color:"positive",class:"full-width",style:{height:"40px"},"no-caps":"",glossy:""},{default:l(()=>e[55]||(e[55]=[M("Buscar")])),_:1},8,["disable"])])])]),s("div",Fa,[i(j,{titulo:"Productos Seleccionados",configuracionColumnas:o.configuracionColumnasProductosSeleccionadosAccion,datos:o.transaccion.listadoProductosTransaccion,permitirConsultar:!1,permitirEditar:!o.transaccion.ingreso_masivo&&o.accion===o.acciones.nuevo,permitirEliminar:o.accion==o.acciones.nuevo||o.accion==o.acciones.editar,mostrarBotones:!1,accion1:o.botonEditarCantidad,accion1Header:o.abrirModalDetalle,altoFijo:!1,ajustarCeldas:!0,onEliminar:o.eliminarItem,permitirEditarModal:!0,modalMaximized:!1},null,8,["configuracionColumnas","datos","permitirEditar","permitirEliminar","accion1","accion1Header","onEliminar"])])])]),_:1}),i(N,{ref:"refListadoSeleccionableProductos","configuracion-columnas":o.configuracionColumnasDetallesProductosSeleccionables,datos:o.listadoProductos,"tipo-seleccion":"multiple",onSelected:o.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","accion3","accion4","accion1Header"]),i(C,{comportamiento:o.modales},null,8,["comportamiento"])],64)}var rn=be(na,[["render",Ma]]);export{rn as default};

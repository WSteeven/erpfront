import{Q as p}from"./QSelect.b1759751.js";import{d as E,E as w,R as $,bc as g,m as k,u as q,c as x,e as F,q as I,A as R,bH as S,s as U,_ as D,v as A,P as L,F as r,z as s,bd as O,y as t,L as T,B as j,O as z,J as n}from"./index.70185135.js";import"./QPopupProxy.c164d2ac.js";import{E as M,c as H}from"./EssentialTable.c4a035e4.js";import{Q as G}from"./QPage.f3b97ac0.js";import{Q as J,a as K}from"./QLayout.3c96c6fd.js";import{u as W,S as X,s as Y,A as C}from"./utils.2eab62de.js";import{M as Z}from"./ModalEntidad.7d323d29.js";import{E as ee}from"./Empleado.20234ba0.js";import{P as oe}from"./PeriodoController.6a0888d3.js";import{C as ae}from"./ContenedorSimpleMixin.0ef3239b.js";import{u as te}from"./filtrosListadosGenerales.6ad178d9.js";import{o as Q}from"./recursosHumanos.utils.f01cf672.js";import"./QChip.a6a2afa6.js";import"./QItemSection.1a41b826.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./i18n-validators.ea544161.js";import"./index.9f64ebda.js";import"./QScrollObserver.0842fd40.js";import"./QResizeObserver.721a0e6c.js";import"./configuracion_general.27135600.js";import"./ConfiguracionController.40960b9d.js";import"./entidadAuditable.75a46700.js";var se=E({components:{EssentialTable:M,ModalEntidad:Z},setup(){const a=new ae(ee,new w),{listadosAuxiliares:o}=a.useReferencias(),{obtenerListados:m,cargarVista:u}=a.useComportamiento(),{notificarError:f,notificarAdvertencia:h}=$();g().setQuasar(k()),W().setQuasar(k());const e=new X,B=q(),_=x([]),v=x([]),l=F({empleado:null,tipo:null,fecha_inicio:"",fecha_fin:"",fecha_corte:"",solicitante:null,periodo:null,sucursal:null,motivo:null,devolucion:null,todos:!1,tarea:null,transferencia:null,accion:""}),{empleados:V,filtrarEmpleados:N}=te(o);u(async()=>{await m({periodos:{controller:new oe,params:{activo:1}},empleados:{controller:new w,params:{estado:1}}}),v.value=o.periodos,V.value=o.empleados});async function y(P){try{e.activar();const c=R.getInstance(),d=S.URL_BASE+"/"+c.getEndpoint(U.vacaciones)+"/reporte",b="Reporte "+Q.filter(i=>i.value==l.tipo)[0].label;switch(P){case"excel":l.accion="excel",await C(d,"POST","blob","xlsx",b,l);break;case"pdf":l.accion="pdf",e.activar(),await C(d,"POST","blob","pdf",b,l),e.desactivar();break;default:l.accion="";const i=await c.post(d,l);i.data.results&&(_.value=i.data.results,i.data.results.length<1&&h("No se obtuvieron resultados"))}e.desactivar()}catch(c){console.log(c),f("Error al obtener reporte")}finally{e.desactivar()}}return{mixin:a,reporte:l,store:B,maskFecha:I,listado:_,periodos:v,empleados:V,filtrarEmpleados:N,opcionesReporteVacaciones:Q,buscarReporte:y,ordenarLista:Y}}});const le={class:"row q-col-gutter-sm q-pa-sm q-py-md"},re={class:"col-12 col-md-3"},ie={class:"col-12 col-md-3"},ne={class:"col-12 col-md-3"},ce={class:"col-12 col-md-3 q-mb-xl"};const de={class:"col-12 col-md-12 q-mt-md"},pe={class:"text-center"};function me(a,o,m,u,f,h){return A(),L(K,null,{default:r(()=>[s(J,null,{default:r(()=>[s(G,{padding:""},{default:r(()=>[s(O,{class:"rounded-card custom-shadow"},{default:r(()=>[t("div",le,[t("div",re,[o[15]||(o[15]=t("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),s(p,{modelValue:a.reporte.tipo,"onUpdate:modelValue":o[0]||(o[0]=e=>a.reporte.tipo=e),options:a.opcionesReporteVacaciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.label,"option-value":e=>e.value,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ie,[o[16]||(o[16]=t("label",{class:"q-mb-sm block"},"Per\xEDodo",-1)),s(p,{modelValue:a.reporte.periodo,"onUpdate:modelValue":o[1]||(o[1]=e=>a.reporte.periodo=e),options:a.periodos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ne,[o[17]||(o[17]=t("label",{class:"q-mb-sm block"},"Empleado",-1)),s(p,{modelValue:a.reporte.empleado,"onUpdate:modelValue":o[2]||(o[2]=e=>a.reporte.empleado=e),options:a.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"","use-input":"","input-debounce":"0",outlined:"",clearable:"",onFilter:a.filtrarEmpleados,onPopupShow:o[3]||(o[3]=e=>a.ordenarLista(a.empleados,"apellidos")),"option-label":e=>e.apellidos+" "+e.nombres,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])]),t("div",ce,[s(T,{class:"q-mt-lg q-pt-md",modelValue:a.reporte.todos,"onUpdate:modelValue":[o[4]||(o[4]=e=>a.reporte.todos=e),o[5]||(o[5]=()=>a.reporte.empleado=a.reporte.todos?a.reporte.empleado=null:a.reporte.empleado=a.store.user.id)],label:"Todos los empleados",outlined:"",dense:""},null,8,["modelValue"])]),n("",!0),n("",!0),n("",!0),t("div",de,[t("div",pe,[s(H,{push:""},{default:r(()=>[n("",!0),s(z,{color:"positive",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[13]||(o[13]=e=>a.buscarReporte("excel"))},{default:r(()=>[s(j,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),o[22]||(o[22]=t("span",null,"Excel",-1))]),_:1}),n("",!0)]),_:1})])])])]),_:1})]),_:1})]),_:1})]),_:1})}var Ze=D(se,[["render",me]]);export{Ze as default};

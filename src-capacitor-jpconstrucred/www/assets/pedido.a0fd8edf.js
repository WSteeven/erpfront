var I=Object.defineProperty;var R=(s,o,n)=>o in s?I(s,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[o]=n;var e=(s,o,n)=>(R(s,typeof o!="symbol"?o+"":o,n),n);import{S as T,A as h}from"./utils.19b149f6.js";import{m as L,f as U,e as j,U as B,bA as D,b_ as H,A as c,t as l,bH as m,bZ as N}from"./index.846478c1.js";import{E as O}from"./entidadAuditable.75a46700.js";class v extends O{constructor(){super();e(this,"justificacion");e(this,"fecha_limite");e(this,"observacion_aut");e(this,"observacion_est");e(this,"observacion_bodega");e(this,"solicitante");e(this,"solicitante_id");e(this,"responsable");e(this,"responsable_id");e(this,"autorizacion");e(this,"per_autoriza");e(this,"per_autoriza_id");e(this,"per_retira");e(this,"per_retira_id");e(this,"evidencia1");e(this,"evidencia2");e(this,"proyecto");e(this,"etapa");e(this,"tarea");e(this,"tarea_id");e(this,"cliente");e(this,"cliente_id");e(this,"sucursal");e(this,"sucursal_id");e(this,"estado");e(this,"created_at");e(this,"estado_orden_compra");e(this,"listadoProductos");e(this,"es_tarea");e(this,"tiene_fecha_limite");e(this,"tiene_observacion_aut");e(this,"tiene_observacion_est");e(this,"retira_tercero");e(this,"tiene_evidencia");e(this,"para_cliente");this.justificacion=null,this.fecha_limite=null,this.observacion_aut=null,this.observacion_est=null,this.observacion_bodega=null,this.solicitante=null,this.solicitante_id=null,this.responsable=null,this.responsable_id=null,this.autorizacion=null,this.per_autoriza=null,this.per_autoriza_id=null,this.per_retira=null,this.per_retira_id=null,this.evidencia1=null,this.evidencia2=null,this.proyecto=null,this.etapa=null,this.tarea=null,this.tarea_id=null,this.cliente=null,this.cliente_id=null,this.sucursal=null,this.sucursal_id=null,this.estado=null,this.created_at=null,this.estado_orden_compra=null,this.listadoProductos=[],this.es_tarea=!1,this.tiene_fecha_limite=!1,this.tiene_observacion_aut=!1,this.tiene_observacion_est=!1,this.retira_tercero=!1,this.tiene_evidencia=!1,this.para_cliente=!1}}const q=L("pedido",()=>{const s=U(new v),o=new v,n=j(),{notificarAdvertencia:p,notificarError:b}=B(),g=D.nuevo,d=new T;async function w(i){const t=c.getInstance(),a=t.getEndpoint(l.pedidos)+"/show-preview/"+i,r=await t.get(a);if(r.data.modelo.autorizacion===N.aprobado)return r.data.modelo}async function y(i){try{d.activar();const t=await w(i);t.estado===H.completa?p("El pedido ya ha sido completado!"):s.hydrate(t)}catch{p("Pedido no encontrado"),s.hydrate(o)}finally{d.desactivar()}}async function E(){const i=c.getInstance(),t=i.getEndpoint(l.pedidos)+"/show-preview/"+n.value,a=await i.get(t);s.hydrate(a.data.modelo)}async function P(){const i=c.getInstance(),t=m.URL_BASE+"/"+i.getEndpoint(l.pedidos)+"/imprimir/"+n.value,a="pedido_"+n.value+"_"+Date.now();await h(t,"GET","blob","pdf",a),console.log("Pedido impreso con \xE9xito")}async function x(i){const t=c.getInstance(),a=t.getEndpoint(l.pedidos)+"/corregir-pedido/"+n.value;return await t.put(a,i)}async function A(i,t){const a=c.getInstance(),r=a.getEndpoint(l.pedidos)+"/eliminar-item";return await a.post(r,{pedido_id:t,detalle_id:i})}function z(){s.hydrate(o)}async function S(i,t,a){try{d.activar();const r=c.getInstance(),u=m.URL_BASE+"/"+r.getEndpoint(l.pedidos)+"/reportes",f="reporte_pedidos";switch(i){case"excel":return t.accion="excel",await h(u,"POST","blob","xlsx",f,t),a;case"pdf":return t.accion="pdf",await h(u,"POST","blob","pdf",f,t),a;default:t.accion="";const _=await r.post(u,t);return _.data.results?(_.data.results.length<1&&p("No se obtuvieron resultados"),_.data.results):a}}catch(r){console.log(r),b("Error al obtener el reporte")}finally{d.desactivar()}}return{pedido:s,accionPedido:g,cargarPedido:y,resetearPedido:z,idPedido:n,showPreview:E,imprimirPdf:P,modificarPedido:x,eliminarDetalle:A,buscarReporte:S}});export{v as P,q as u};

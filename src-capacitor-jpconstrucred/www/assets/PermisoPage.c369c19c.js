import{Q as G,a as O}from"./QItemSection.ca64420c.js";import{bz as j,t as z,c as T,be as U,p as H,a1 as x,e as p,v as J,x as V,y as P,S as w,H as i,D as r,bg as S,B as a,G as K,R as c,F as f,bf as A,L as _}from"./index.846478c1.js";import{Q as W}from"./QSelect.d8222f79.js";import{Q as X}from"./QPage.b0adedad.js";import{E as Y}from"./EssentialTable.01bbad48.js";import{M as Z}from"./ModalEntidad.5edc5f68.js";import{R as h}from"./RolController.c16c13cc.js";import{C as oo}from"./ContenedorSimpleMixin.1a882cca.js";import{P as eo,c as ro}from"./Permiso.405aa895.js";import{P as q,C as so}from"./ComportamientoModalesPermisoNuevo.72e4e029.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QFile.c3222262.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./utils.19b149f6.js";import"./QPopupProxy.7844573b.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./i18n-validators.06501904.js";import"./index.209eea81.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.3bd8db1f.js";import"./QForm.0a21c4a5.js";import"./index.15c331c5.js";import"./TabLayout.b05b8b79.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./buttonSubmits.31738227.js";import"./EssentialTablePagination.3349ebcb.js";import"./filtrosListadosGenerales.c330183b.js";class io extends j{constructor(){super(z.asignar_permisos)}}var to=T({components:{EssentialTable:Y,ModalEntidad:Z},setup(){U().setQuasar(H());const o=new oo(eo,new q),{entidad:e,listadosAuxiliares:l,listado:y}=o.useReferencias(),N=x(),{cargarVista:R,obtenerListados:u,listar:g}=o.useComportamiento(),s=p(),d=p([]),I=new q,k=new io,E=p([]),b=p(),C=p();R(async()=>{await u({roles:{controller:new h,params:{campos:"id,name"}}})}),d.value=l.roles;async function v(t){t&&(g({id_rol:t,tipo:"ASIGNADOS"}),E.value=(await I.listar({id_rol:t,tipo:"NO ASIGNADOS"})).result)}async function $(){await b.value.seleccionar(),await b.value.clearSelection()}async function M(){await C.value.seleccionar(),await C.value.clearSelection()}async function B(t){const n=t.map(m=>m.id);await k.guardar({id_rol:s.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),await v(s.value)}function L(t){const n=t.map(m=>m.id);k.guardar({id_rol:s.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),v(s.value)}const Q=new so;function D(){Q.abrirModalEntidad("PermisoNuevoPage")}return{mixin:o,permiso:e,modales:Q,configuracionColumnasPermisos:ro,rol:s,listado:y,permisosSinAsignar:E,crearRol:()=>{N.replace("/roles")},crear_permiso:D,obtenerPermisoRol:v,asignarPermiso:B,eliminarPermiso:L,botonAsignarPermisos:$,botonEliminarPermisos:M,listadosAuxiliares:l,roles:d,refPermisosSinAsignar:b,refPermisosAsignados:C,filtrarRol(t,n){if(t===""){n(()=>{d.value=l.roles});return}n(()=>{const m=t.toLowerCase();d.value=l.roles.filter(F=>F.nombre.toLowerCase().indexOf(m)>-1)})}}}});const ao={class:"text-h6"},no={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},lo={class:"col-12 col-md-5 q-gutter-y-sm"},mo={class:"col-md-2 column justify-center q-gutter-y-md"},po={class:"col-12 col-md-5 q-mb-md"};function uo(o,e,l,y,N,R){const u=V("essential-table"),g=V("modal-entidad");return P(),w(X,{padding:"",class:"q-pa-lg"},{default:i(()=>[r(A,null,{default:i(()=>[r(S,null,{default:i(()=>[a("div",ao,[e[6]||(e[6]=a("label",{class:"q-mb-sm block"},"Roles",-1)),r(W,{modelValue:o.rol,"onUpdate:modelValue":[e[1]||(e[1]=s=>o.rol=s),o.obtenerPermisoRol],options:o.roles,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","error-message":"Debes seleccionar un rol","use-input":"","input-debounce":"0",onFilter:o.filtrarRol,"option-value":s=>s.id,"option-label":s=>s.name,"emit-value":"","map-options":""},{"no-option":i(()=>[r(G,null,{default:i(()=>[r(O,{class:"text-grey"},{default:i(()=>e[5]||(e[5]=[K(" No hay resultados ")])),_:1})]),_:1})]),after:i(()=>[r(c,{class:"block",color:"secondary",onClick:e[0]||(e[0]=s=>o.crearRol())},{default:i(()=>[r(f,{name:"bi-plus"})]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","onFilter","option-value","option-label"])]),a("div",no,[a("div",lo,[r(A,null,{default:i(()=>[r(S,null,{default:i(()=>[e[7]||(e[7]=a("div",{class:"text-h6"},"No Asignados",-1)),r(u,{configuracionColumnas:o.configuracionColumnasPermisos,datos:o.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarFooter:!0,mostrarColumnasVisibles:!1,mostrarExportar:!0,ref:"refPermisosSinAsignar",onSelected:o.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})]),a("div",mo,[r(c,{class:"full-width block",color:"secondary",onClick:e[2]||(e[2]=s=>o.crear_permiso())},{default:i(()=>[r(f,{name:"bi-plus"})]),_:1}),o.rol!==void 0?(P(),w(c,{key:0,class:"full-width block",color:"primary",onClick:e[3]||(e[3]=s=>o.botonAsignarPermisos())},{default:i(()=>[r(f,{name:"bi-arrow-right"})]),_:1})):_("",!0),o.rol!==void 0?(P(),w(c,{key:1,class:"full-width block",color:"accent",onClick:e[4]||(e[4]=s=>o.botonEliminarPermisos())},{default:i(()=>[r(f,{name:"bi-arrow-left"})]),_:1})):_("",!0)]),a("div",po,[r(A,null,{default:i(()=>[r(S,null,{default:i(()=>[e[8]||(e[8]=a("div",{class:"text-h6"},"Asignados",-1)),r(u,{configuracionColumnas:o.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:o.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarExportar:!0,ref:"refPermisosAsignados",onSelected:o.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})])])]),_:1})]),_:1}),r(g,{comportamiento:o.modales},null,8,["comportamiento"])]),_:1})}var ie=J(to,[["render",uo]]);export{ie as default};

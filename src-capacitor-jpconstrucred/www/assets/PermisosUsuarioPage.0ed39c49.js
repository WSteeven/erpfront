import{Q as so}from"./QSelect.d8222f79.js";import{bz as U,t as H,c as io,be as ao,p as to,a1 as ro,e as d,E as z,v as lo,x as B,y as m,S as E,H as s,D as o,bg as u,B as t,z as p,bf as c,I as D,J as F,L as k,R as N,F as f,G as Q,M as q}from"./index.846478c1.js";import{Q as G,a as b}from"./QItemSection.ca64420c.js";import{Q as O}from"./QScrollArea.23ee706d.js";import{Q as no}from"./QPage.b0adedad.js";import{E as mo}from"./EssentialTable.01bbad48.js";import{M as uo}from"./ModalEntidad.5edc5f68.js";import{C as po}from"./ContenedorSimpleMixin.1a882cca.js";import{P as co,c as fo}from"./Permiso.405aa895.js";import{P as vo,C as go}from"./ComportamientoModalesPermisoNuevo.72e4e029.js";import{S as bo}from"./utils.19b149f6.js";import{u as _o}from"./filtrosListadosGenerales.c330183b.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QResizeObserver.847ee253.js";import"./QScrollObserver.5aff62ae.js";import"./TouchPan.efa9afab.js";import"./touch.9135741d.js";import"./QFile.c3222262.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./QPopupProxy.7844573b.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./i18n-validators.06501904.js";import"./index.209eea81.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.3bd8db1f.js";import"./QForm.0a21c4a5.js";import"./index.15c331c5.js";import"./TabLayout.b05b8b79.js";import"./QTabs.19bbf6a5.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./buttonSubmits.31738227.js";import"./EssentialTablePagination.3349ebcb.js";import"./RolController.c16c13cc.js";class T extends U{constructor(){super(H.permisos_roles_usuario)}}class Co extends U{constructor(){super(H.asignar_permisos_individual)}}var Po=io({components:{EssentialTable:mo,ModalEntidad:uo},setup(){ao().setQuasar(to());const e=new po(co,new T),{entidad:i,listadosAuxiliares:v,listado:_}=e.useReferencias(),I=ro(),{cargarVista:R,obtenerListados:g,listar:C}=e.useComportamiento(),a=d(),r=d(),{empleados:V,filtrarEmpleados:j,roles:h}=_o(v),J=new vo,L=new Co,M=new bo,P=d([]),x=d([]),S=d(),w=d();R(async()=>{await g({empleados:{controller:new z,params:{campos:"id,nombres,apellidos,identificacion",estado:1}}})}),V.value=v.empleados;async function K(l){await C({id_rol:l,tipo:"ASIGNADOS"});const{result:n}=await J.listar({id_rol:l,tipo:"NO ASIGNADOS"});P.value=n}function W(){S.value.seleccionar(),S.value.clearSelection()}function X(){w.value.seleccionar(),w.value.clearSelection()}function Y(l){const n=l.map(y=>y.id);L.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),A()}function Z(l){const n=l.map(y=>y.id);L.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),A()}const $=new go;function oo(){$.abrirModalEntidad("PermisoNuevoPage")}const eo=()=>{I.replace("/roles")};async function A(){M.activar();const{result:l}=await new z().consultar(r.value);h.value=l.roles,a.value=[...l.permisos];const{response:n}=await new T().listar({empleado_id:r.value,tipo:"NO ASIGNADOS"});P.value=n.data.results,_.value=[...n.data.permisos_usuario],M.desactivar()}return{fecha:d(),mixin:e,permiso:i,modales:$,configuracionColumnasPermisos:fo,empleado:r,listado:_,permisosSinAsignar:P,crearRol:eo,crear_permiso:oo,obtenerPermisoRol:K,asignarPermiso:Y,eliminarPermiso:Z,botonAsignarPermisos:W,botonEliminarPermisos:X,listadosAuxiliares:v,roles:h,permisos:a,empleados:V,permisosAsignados:x,refPermisosSinAsignar:S,refPermisosAsignados:w,filtrarEmpleados:j,filtrarRolesEmpleados:A}}});const So={class:"row q-col-gutter-sm q-mb-md"},wo={class:"col-12 col-md-5"},Ao={class:"col-12 col-md-5 q-mb-md"},yo={key:0,class:"col-12 col-md-5 q-mb-md"},Eo={class:"row"},ko={key:0,class:"col-12 col-md-5"},No={key:0,class:"col-12 col-md-5 q-mb-md"},Qo={class:"q-py-xs"},qo={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},Io={class:"col-12 col-md-5 q-gutter-y-sm"},Ro={class:"col-md-2 column justify-center q-gutter-y-md"},Vo={class:"col-12 col-md-5 q-mb-md"};function ho(e,i,v,_,I,R){const g=B("essential-table"),C=B("modal-entidad");return m(),E(no,{padding:"",class:"q-pa-lg"},{default:s(()=>[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[t("div",So,[t("div",wo,[t("div",Ao,[i[4]||(i[4]=t("label",{class:"q-mb-sm block"},null,-1)),o(so,{modelValue:e.empleado,"onUpdate:modelValue":[i[0]||(i[0]=a=>e.empleado=a),e.filtrarRolesEmpleados],options:e.empleados,"options-dense":"",dense:"",outlined:"","error-message":"Debe seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","onUpdate:modelValue","option-value","option-label"])]),e.roles?(m(),p("div",yo,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[5]||(i[5]=t("div",{class:"text-h6"},"Roles",-1)),o(O,{style:{height:"100px"}},{default:s(()=>[t("div",Eo,[(m(!0),p(D,null,F(e.roles,(a,r)=>(m(),E(G,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"})]),_:1}),o(b,null,{default:s(()=>[Q(q(a),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)]),i[7]||(i[7]=t("div",{class:"col-12 col-md-2"},null,-1)),e.permisos?(m(),p("div",ko,[e.listado?(m(),p("div",No,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[6]||(i[6]=t("div",{class:"text-h6"}," Todos los permisos asignados (roles y directamente) ",-1)),o(O,{style:{height:"164px"}},{default:s(()=>[t("div",Qo,[(m(!0),p(D,null,F(e.permisos,(a,r)=>(m(),E(G,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"},{default:s(()=>[Q(" \xA0"+q(r+1),1)]),_:2},1024)]),_:2},1024),o(b,null,{default:s(()=>[Q(q(a.name),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)])):k("",!0)]),t("div",qo,[t("div",Io,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[8]||(i[8]=t("div",{class:"text-h6"},"No Asignados",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,datos:e.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarHeader:!0,mostrarFooter:!0,mostrarColumnasVisibles:!1,ref:"refPermisosSinAsignar",onSelected:e.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})]),t("div",Ro,[o(N,{class:"full-width block",color:"secondary",onClick:i[1]||(i[1]=a=>e.crear_permiso())},{default:s(()=>[o(f,{name:"bi-plus"})]),_:1}),o(N,{class:"full-width block",color:"primary",onClick:i[2]||(i[2]=a=>e.botonAsignarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-right"})]),_:1}),o(N,{class:"full-width block",color:"accent",onClick:i[3]||(i[3]=a=>e.botonEliminarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-left"})]),_:1})]),t("div",Vo,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[9]||(i[9]=t("div",{class:"text-h6"},"Asignados directamente",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:e.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,ref:"refPermisosAsignados",onSelected:e.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})])])]),_:1})]),_:1}),o(C,{comportamiento:e.modales,persistente:!1},null,8,["comportamiento"])]),_:1})}var Ne=lo(Po,[["render",ho]]);export{Ne as default};

var O=Object.defineProperty;var R=(a,o,r)=>o in a?O(a,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[o]=r;var E=(a,o,r)=>(R(a,typeof o!="symbol"?o+"":o,r),r);import{Q as $}from"./QPage.f3b97ac0.js";import{by as k,s as Q,bh as L,d as x,c as n,bc as U,m as w,u as j,dg as i,dh as J,p as K,E as H,bz as h,bg as W,_ as X,t as G,v as z,P as Z,F as aa,y as u,D as y,K as A,x as ea,J as oa,a4 as ta,z as M}from"./index.70185135.js";import{M as ra}from"./ModalEntidad.7d323d29.js";import{C as sa}from"./ConfirmarDialog.33b39190.js";import{E as ia}from"./EssentialTableTabs.a1f1bc4b.js";import{C as na}from"./ContenedorSimpleMixin.0ef3239b.js";import{G as la}from"./Gasto.2c5038cc.js";import{S as ca,u as ua,P as ma}from"./utils.2eab62de.js";import{C as da,a as pa}from"./ComponenteModal.domain.9bc16b73.js";import{V as fa}from"./VisualizarGastoPage.5ca9399f.js";import{u as ba}from"./fondo_rotativo.c674c6d5.js";import{V as ga}from"./VehiculoController.656ab648.js";import{P as _a}from"./ProyectoController.680a0daf.js";import"./QToolbar.f2167ded.js";import"./position-engine.f244a0db.js";import"./configuracion_general.27135600.js";import"./ConfiguracionController.40960b9d.js";import"./EssentialTable.c4a035e4.js";import"./QSelect.b1759751.js";import"./QChip.a6a2afa6.js";import"./QItemSection.1a41b826.js";import"./QMenu.7527c31d.js";import"./format.8ac60962.js";import"./QFile.f60a5ba1.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./QPopupProxy.c164d2ac.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./i18n-validators.ea544161.js";import"./index.9f64ebda.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./EssentialTablePagination.959d4e60.js";import"./entidadAuditable.75a46700.js";import"./QForm.0c8c3b68.js";import"./TabLayout.dfee7537.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./buttonSubmits.f728eedc.js";import"./index.004ff2d8.js";import"./configuracionColumnasGasto.bbc5ae20.js";import"./GastoPusherEvent.f67a5491.js";import"./notificationRealtime.db55820a.js";import"./AprobarGastoController.b03a2a3b.js";import"./GastoController.8c00f2b7.js";const va=[{name:"id",field:"id",label:"Id",align:"left",sortable:!0},{name:"fecha_viat",field:"fecha_viat",label:"Fecha",align:"left",sortable:!0},{name:"tarea_info",field:"tarea_info",label:"Tarea",align:"left",sortable:!0},{name:"tarea_cliente",field:"tarea_cliente",label:"Tarea cliente",align:"left",sortable:!0},{name:"factura",field:"factura",label:"#Factura",align:"left",sortable:!0},{name:"num_comprobante",field:"num_comprobante",label:"#Comprobante",align:"left",sortable:!0},{name:"ruc",field:"ruc",label:"RUC.",align:"left",sortable:!0},{name:"aut_especial_user",field:"aut_especial_user",label:"Autorizaci\xF3n Especial",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"detalle_info",field:"detalle_info",label:"Detalle",align:"left",sortable:!0},{name:"sub_detalle_info",field:"sub_detalle_info",label:"SubDetalle",align:"left",sortable:!0},{name:"centro_costo",field:"centro_costo",label:"Centro de Costo",align:"left",sortable:!0},{name:"subcentro_costo",field:"subcentro_costo",label:"Sub Centro de Costo",align:"left",sortable:!0},{name:"estado_info",field:"estado_info",label:"Estado	",align:"left",sortable:!0},{name:"detalle_estado",field:"detalle_estado",label:"Descripcion",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha de Creaci\xF3n",align:"left",sortable:!0}];class P extends k{constructor(){super(Q.autorizaciones_gastos)}}class Ca{constructor(){E(this,"VisualizarGastoPage");this.VisualizarGastoPage=L(new da("Gastos",fa))}}class Da extends pa{constructor(){super(new Ca)}}var Ea=x({name:"AutorizarGastoPage",components:{EssentialTableTabs:ia,ConfirmarDialog:sa,ModalEntidad:ra},setup(){const a=new P,o=n(),r=new na(la,a),{listado:p}=r.useReferencias(),s=new ca;U().setQuasar(w()),ua().setQuasar(w());const l=j(),t=ba(),m=n([]),c=n([]),g=n([]),_=n([]),S=new P;async function f(e){s.activar();const{result:d}=await S.listar({estado:e});p.value=d,o.value=e,s.desactivar()}async function T(){m.value=(await new ga().listar({campos:"id,placa"})).result,c.value=(await new H().listar({estado:1})).result}async function N(e){s.activar(),g.value=(await new _a().listar({campos:"id,nombre,codigo_proyecto",finalizado:0,empleado_id:e})).result,_.value=(await new W().listar({campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id",empleado_id:e,activas_empleado:1,formulario:!0})).result,s.desactivar()}f(i.PENDIENTE),T();const v=new Da,V=n(),F={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:async({entidad:e})=>{s.activar(),t.gasto=e,t.vehiculos=m.value,t.empleados=c.value,t.habilitar_observacion_autorizador=l.user.id===e.aut_especial&&[i.PENDIENTE,i.APROBADO].includes(e.estado)&&q(e.fecha_viat),t.accion_form=l.user.id===e.aut_especial&&e.estado===i.PENDIENTE?h.editar:h.consultar,e.estado===i.PENDIENTE&&await N(e.id_usuario),t.proyectos=g.value,t.tareas=_.value,v.abrirModalEntidad("VisualizarGastoPage"),s.desactivar()}};function q(e){const d=new Date,C=new Date(d.getFullYear(),d.getMonth(),1),b=new Date(C);b.setDate(C.getDate()-1);const Y=new Date(b.getFullYear(),b.getMonth(),1),I=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),D=ma(e,"YYYY-MM-DD","America/Guayaquil");return D>=Y&&D<=I||l.esAdministrador}async function B(){f(i.PENDIENTE)}return{configuracionColumnasAutorizarGasto:va,listado:p,estadosGastos:i,tabAutorizarGasto:J,botonVerModalGasto:F,accionesTabla:K,estaSemanAC:V,guardado:B,filtrarAutorizacionesGasto:f,authenticationStore:l,modales:v}}});const wa={class:"text-center q-pb-md"},ha={class:"q-my-md"},Ga={key:0,class:"q-mb-md"};function za(a,o,r,p,s,l){const t=G("essential-table-tabs"),m=G("modal-entidad");return z(),Z($,{padding:!a.$q.screen.xs},{default:aa(()=>{var c;return[u("div",wa,[u("div",ha,[o[0]||(o[0]=y(" Bienvenido, ")),u("strong",null,A(a.authenticationStore.nombreUsuario),1)]),(c=a.authenticationStore.user)!=null&&c.grupo?(z(),ea("div",Ga,[o[1]||(o[1]=y(" Grupo, ")),u("strong",null,A(a.authenticationStore.user.grupo),1)])):oa("",!0)]),u("div",{class:ta([{"bg-desenfoque rounded q-pa-sm":a.$q.screen.xs},"borde custom-shadow rounded"])},[M(t,{configuracionColumnas:[...a.configuracionColumnasAutorizarGasto,a.accionesTabla],datos:a.listado,accion1:a.botonVerModalGasto,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!0,"mostrar-botones":!1,"tab-options":a.tabAutorizarGasto,onTabSeleccionado:a.filtrarAutorizacionesGasto,tabDefecto:"3",ajustarCeldas:""},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"])],2),M(m,{comportamiento:a.modales,onGuardado:a.guardado,mostrarListado:!1},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var we=X(Ea,[["render",za]]);export{we as default};

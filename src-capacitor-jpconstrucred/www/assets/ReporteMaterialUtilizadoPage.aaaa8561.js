var M=Object.defineProperty;var Q=(e,o,s)=>o in e?M(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s;var u=(e,o,s)=>(Q(e,typeof o!="symbol"?o+"":o,s),s);import{Q as y,a as m}from"./QSelect.b1759751.js";import{Q as c,a as f}from"./QItemSection.1a41b826.js";import{by as S,s as D,d as F,bg as L,bH as N,A as h,_ as O,v as l,P as j,F as r,y as i,z as a,x as d,G as R,H as V,K as p,bf as w,D as n,J as C,O as I}from"./index.70185135.js";import{Q as H}from"./QPage.f3b97ac0.js";import{g as G,o as J}from"./tareas.utils.309e0dff.js";import{u as K}from"./filtrosListadosGenerales.6ad178d9.js";import{r as b}from"./i18n-validators.ea544161.js";import{u as Y}from"./index.004ff2d8.js";import{C as W}from"./ContenedorSimpleMixin.0ef3239b.js";import{P as X}from"./ProyectoController.680a0daf.js";import{E as Z}from"./entidadAuditable.75a46700.js";import{A as x}from"./utils.2eab62de.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./index.9f64ebda.js";class oo extends S{constructor(){super(D.reporte_materiales_utilizados)}}class eo extends Z{constructor(){super();u(this,"tipo_reporte");u(this,"proyecto_id");u(this,"tarea_id");this.tipo_reporte=null,this.proyecto_id=null,this.tarea_id=null}}var to=F({setup(){const e=new W(eo,new oo),{entidad:o,listadosAuxiliares:s}=e.useReferencias(),{obtenerListados:g,cargarVista:_,setValidador:v,listar:t}=e.useComportamiento();_(async()=>{await g({proyectos:{controller:new X,params:{campos:"id,nombre,codigo_proyecto"}},tareas:{controller:new L,params:{campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id"}}})});const{tareas:P,filtrarTareas:T,proyectos:k,filtrarProyectos:z}=K(s);async function U(){const q=new Date,A="reporte_material_utilizado_"+q.toLocaleString(),B=e.getController().getEndpoint(),E=N.URL_BASE+"/"+h.getInstance().getEndpoint(B,o);x(E,"GET","blob","xlsx",A)}const $=Y({tipo_reporte:{required:b},tarea_id:{required:b},proyecto_id:{required:b}},o);return v($.value),{v$:$,filtro:o,tiposReportesMaterialUtilizado:G,opcionesTipoReporteMaterialUtilizado:J,tareas:P,filtrarTareas:T,proyectos:k,filtrarProyectos:z,consultarDescargar:U}}});const ro={class:"row q-col-gutter-sm q-pa-sm bg-desenfoque rounded border-white"},ao={class:"col-12 col-md-3"},io={key:0,class:"col-12 col-md-6"},so={class:"error-msg"},lo={key:1,class:"col-12 col-md-6"},no={class:"error-msg"},po={class:"col-12 col-md-3"};function uo(e,o,s,g,_,v){return l(),j(H,{padding:""},{default:r(()=>[i("div",ro,[o[11]||(o[11]=i("div",{class:"col-12 text-primary q-mb-sm"}," Reporte de materiales utilizados ",-1)),i("div",ao,[o[4]||(o[4]=i("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),a(y,{modelValue:e.filtro.tipo_reporte,"onUpdate:modelValue":o[0]||(o[0]=t=>e.filtro.tipo_reporte=t),options:e.opcionesTipoReporteMaterialUtilizado,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:""},null,8,["modelValue","options"])]),e.filtro.tipo_reporte===e.tiposReportesMaterialUtilizado.POR_TAREA?(l(),d("div",io,[o[6]||(o[6]=i("label",{class:"q-mb-sm block"},"Tareas",-1)),a(y,{modelValue:e.filtro.tarea_id,"onUpdate:modelValue":o[1]||(o[1]=t=>e.filtro.tarea_id=t),options:e.tareas,onFilter:e.filtrarTareas,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",error:!!e.v$.tarea_id.$errors.length,onBlur:e.v$.tarea_id.$touch,"error-message":"Debes seleccionar una Tarea","use-input":"","input-debounce":"0","option-value":t=>t.id,"option-label":t=>t.codigo_tarea+" - "+t.titulo,"emit-value":"","map-options":""},{error:r(()=>[(l(!0),d(R,null,V(e.v$.tarea_id.$errors,t=>(l(),d("div",{key:t.$uid},[i("div",so,p(t.$message),1)]))),128))]),option:r(t=>[a(c,w(t.itemProps,{class:"q-my-sm"}),{default:r(()=>[a(f,null,{default:r(()=>[a(m,{class:"text-bold text-primary"},{default:r(()=>[n(p(t.opt.codigo_tarea),1)]),_:2},1024),a(m,{caption:""},{default:r(()=>[n(p(t.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[a(c,null,{default:r(()=>[a(f,{class:"text-grey"},{default:r(()=>o[5]||(o[5]=[n(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","error","onBlur","option-value","option-label"])])):C("",!0),e.filtro.tipo_reporte===e.tiposReportesMaterialUtilizado.POR_PROYECTO?(l(),d("div",lo,[o[8]||(o[8]=i("label",{class:"q-mb-sm block"},"Proyectos",-1)),a(y,{modelValue:e.filtro.proyecto_id,"onUpdate:modelValue":o[2]||(o[2]=t=>e.filtro.proyecto_id=t),options:e.proyectos,onFilter:e.filtrarProyectos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",error:!!e.v$.proyecto_id.$errors.length,onBlur:e.v$.proyecto_id.$touch,"error-message":"Debes seleccionar un proyecto","use-input":"","input-debounce":"0","option-value":t=>t.id,"option-label":t=>t.nombre,"emit-value":"","map-options":""},{error:r(()=>[(l(!0),d(R,null,V(e.v$.proyecto_id.$errors,t=>(l(),d("div",{key:t.$uid},[i("div",no,p(t.$message),1)]))),128))]),option:r(t=>[a(c,w(t.itemProps,{class:"q-my-sm"}),{default:r(()=>[a(f,null,{default:r(()=>[a(m,{class:"text-bold text-primary"},{default:r(()=>[n(p(t.opt.codigo_proyecto),1)]),_:2},1024),a(m,{caption:""},{default:r(()=>[n(p(t.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[a(c,null,{default:r(()=>[a(f,{class:"text-grey"},{default:r(()=>o[7]||(o[7]=[n(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","error","onBlur","option-value","option-label"])])):C("",!0),i("div",po,[o[10]||(o[10]=i("label",{class:"block q-mb-sm"},"\xA0",-1)),a(I,{color:"primary",class:"full-width",icon:"bi-search","no-caps":"",unelevated:"",onClick:o[3]||(o[3]=t=>e.consultarDescargar())},{default:r(()=>o[9]||(o[9]=[n("Consultar y descargar")])),_:1})])])]),_:1})}var Bo=O(to,[["render",uo]]);export{Bo as default};

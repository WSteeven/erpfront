var A=Object.defineProperty;var R=(o,n,s)=>n in o?A(o,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[n]=s;var t=(o,n,s)=>(R(o,typeof n!="symbol"?n+"":n,s),s);import{bz as L,t as l,m as B,f as C,e as U,U as I,bA as T,A as u,bH as f}from"./index.846478c1.js";import{S as D,A as g}from"./utils.19b149f6.js";import{E as N}from"./entidadAuditable.75a46700.js";const G=[{name:"id",field:"id",label:"N\xB0",align:"left",sortable:!0},{name:"codigo",field:"codigo",label:"Codigo",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0},{name:"solicitante",field:"solicitante",label:"Solicitante",align:"left",sortable:!0},{name:"cliente",field:"cliente",label:"Cliente",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];class _ extends N{constructor(){super();t(this,"codigo");t(this,"solicitante");t(this,"cliente");t(this,"proforma");t(this,"descripcion");t(this,"forma");t(this,"tiempo");t(this,"estado");t(this,"created_at");t(this,"iva");t(this,"listadoProductos");t(this,"descuento_general");t(this,"tiene_proforma");t(this,"tiene_pedido");t(this,"modificar_iva");t(this,"modificar_descuento");this.codigo=null,this.solicitante=null,this.cliente=null,this.proforma=null,this.descripcion=null,this.forma=null,this.created_at=null,this.tiempo=null,this.estado=null,this.iva=null,this.listadoProductos=[],this.tiene_proforma=!1,this.tiene_pedido=!1,this.modificar_iva=!1,this.descuento_general=0,this.modificar_descuento=!1}}class j extends L{constructor(){super(l.prefacturas)}}const k=B("prefactura",()=>{const o=C(new _),n=new _,s=U(),{notificarAdvertencia:h,notificarError:d}=I(),v=T.nuevo,i=new D;async function E(){try{const a=u.getInstance(),e=f.URL_BASE+"/"+a.getEndpoint(l.prefacturas)+"/imprimir/"+s.value,r="prefactura_"+s.value+"_"+Date.now();await g(e,"GET","blob","pdf",r),console.log("Prefactura impresa con \xE9xito")}catch(a){h("Error al imprimir la prefactura. "+a)}}async function x(){try{i.activar();const a=u.getInstance(),e=f.URL_BASE+"/"+a.getEndpoint(l.prefacturas)+"/"+s.value,r=await a.get(e);return o.hydrate(r.data.modelo),r}catch(a){d(a)}finally{i.desactivar()}}async function y(a){try{i.activar();const e=u.getInstance(),r=f.URL_BASE+"/"+e.getEndpoint(l.prefacturas)+"/anular/"+s.value;return await e.post(r,a)}catch(e){d(e)}finally{i.desactivar()}}function w(){o.hydrate(n)}async function P(a){try{i.activar();const e=u.getInstance(),r=f.URL_BASE+"/"+e.getEndpoint(l.dashboard_ventas_empresa);return(await e.post(r,a)).data.results}catch(e){d("Error al consultar el dashboard"+e)}finally{i.desactivar()}}async function S(a,e,r){try{const c=u.getInstance(),p=f.URL_BASE+"/"+c.getEndpoint(l.prefacturas)+"/reportes",b="reporte_prefacturas";switch(a){case"excel":return e.accion="excel",await g(p,"POST","blob","xlsx",b,e),r;case"pdf":return e.accion="pdf",await g(p,"POST","blob","pdf",b,e),r;default:i.activar(),e.accion="";const m=await c.post(p,e);return m.data.results?(m.data.results.length<1&&h("No se obtuvieron resultados"),m.data.results):r}}catch(c){console.log(c),d("Error al obtener el reporte")}finally{i.desactivar()}}return{prefactura:o,accionPrefactura:v,idPrefactura:s,anularPrefactura:y,resetearprefactura:w,imprimirPdf:E,consultarDashboard:P,buscarReporte:S,consultar:x}});export{_ as P,j as a,G as c,k as u};

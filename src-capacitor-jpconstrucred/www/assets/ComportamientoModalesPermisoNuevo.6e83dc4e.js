var M=Object.defineProperty;var T=(o,e,i)=>e in o?M(o,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[e]=i;var y=(o,e,i)=>(T(o,typeof e!="symbol"?e+"":e,i),i);import{C as F,a as O}from"./ComponenteModal.domain.9bc16b73.js";import{by as D,s as A,d as j,bc as G,m as H,R as N,c as V,A as J,_ as K,t as Z,v as d,P as W,F as r,y as a,z as l,B as X,a8 as k,I as Y,x as u,G as Q,H as z,K as g,L as n,J as h,M as x,N as _,D as U,a5 as ee,bh as oe}from"./index.70185135.js";import{Q as se,a as le}from"./QSelect.b1759751.js";import{Q as R,a as C}from"./QItemSection.1a41b826.js";import{Q as ae}from"./QForm.0c8c3b68.js";import{r as S}from"./i18n-validators.ea544161.js";import{C as re}from"./ContenedorSimpleMixin.0ef3239b.js";import{u as ie}from"./index.004ff2d8.js";import{T as ne}from"./TabLayout.dfee7537.js";import{B as de}from"./buttonSubmits.f728eedc.js";import{P as me}from"./Permiso.405aa895.js";import{R as te}from"./RolController.f1b9f070.js";import{u as ue}from"./filtrosListadosGenerales.6ad178d9.js";class pe extends D{constructor(){super(A.permisos_administrar)}}var be=j({components:{TabLayout:ne,ButtonSubmits:de},emits:["guardado","cerrar-modal"],setup(o,{emit:e}){G().setQuasar(H());const i=N(),p=new re(me,new pe),{entidad:b,disabled:q,listadosAuxiliares:m}=p.useReferencias(),{cargarVista:s,obtenerListados:t}=p.useComportamiento(),{notificarError:c}=N(),f=ie({name:{required:S},roles:{required:S}},b),{roles:$,filtrarRoles:I}=ue(m);s(async()=>{await t({roles:{controller:new te,params:{campos:"id,name"}}}),$.value=m.roles});const B=()=>{};async function E(){if(await f.value.$validate()){const w=J.getInstance(),L=w.getEndpoint(A.crear_permiso);await w.post(L,b).then(function(v){i.notificarCorrecto(v.data.mensaje),e("cerrar-modal",!1)}).catch(v=>{c(v)})}}return{mixin:p,onSubmit:B,isPwdCurent:V(!0),isPwd:V(!0),isPwdConfirmation:V(!0),permiso:b,disabled:q,v$:f,roles:$,filtrarRoles:I,listadosAuxiliares:m,crear:E}}});const ce={class:"col-12 col-md-12 rounded-card q-py-sm text-center text-info bg-light-blue-1"},fe={class:"row q-col-gutter-sm q-mb-md q-mt-md"},ve={class:"col-12 col-md-2"},Ve={class:"col-12 col-md-2 q-mb-md"},ge={class:"error-msg"},Ce={key:0,class:"col-12 col-md-5"},qe={class:"row q-pt-md"},Pe={class:"col-12 col-md-3"},$e={class:"error-msg"};function we(o,e,i,p,b,q){const m=Z("button-submits");return d(),W(ae,{onSubmit:e[11]||(e[11]=ee(()=>{},["prevent"]))},{default:r(()=>[a("div",ce,[l(X,{name:"bi-info-circle-fill",class:"q-mr-sm",size:"1em"}),e[12]||(e[12]=a("b",null,"\xA0 Informaci\xF3n",-1)),e[13]||(e[13]=a("p",{class:"q-mb-xs"}," Tipo de permiso normal: Crea un permiso ingresando el nombre de un m\xF3dulo (mismo nombre que est\xE1 en el controlador del backend), selecciona las acciones que puede realizar y los roles asociados al nuevo permiso. ",-1)),e[14]||(e[14]=a("p",{class:"q-mb-xs"},' Tipo de permiso personalizado: crea un permiso personalizado en el formato "puede.accion.permiso" y los roles asociados a dicho permiso ',-1))]),a("div",fe,[a("div",ve,[e[15]||(e[15]=a("label",{class:"q-mb-sm block"},"Tipo de permiso",-1)),l(k,{label:o.permiso.permiso_personalizado?"PERSONALIZADO":"NORMAL",modelValue:o.permiso.permiso_personalizado,"onUpdate:modelValue":e[0]||(e[0]=s=>o.permiso.permiso_personalizado=s),color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear",disable:o.disabled},null,8,["label","modelValue","disable"])]),a("div",Ve,[e[16]||(e[16]=a("label",{class:"q-mb-sm block"},"Nombre",-1)),l(Y,{hint:"Escribe un nombre de un modulo",modelValue:o.permiso.name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.permiso.name=s),placeholder:"Obligatorio",error:!!o.v$.name.$errors.length,disable:o.disabled,outlined:"",dense:"",type:"text"},{error:r(()=>[(d(!0),u(Q,null,z(o.v$.name.$errors,s=>(d(),u("div",{key:s.$uid},[a("div",ge,g(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),o.permiso.permiso_personalizado?h("",!0):(d(),u("div",Ce,[e[17]||(e[17]=a("label",{class:"block"},"Acciones",-1)),a("div",qe,[l(n,{class:"",modelValue:o.permiso.boton,"onUpdate:modelValue":e[2]||(e[2]=s=>o.permiso.boton=s),label:"Boton",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"]),l(n,{class:"q-ml-lg",modelValue:o.permiso.autorizar,"onUpdate:modelValue":e[3]||(e[3]=s=>o.permiso.autorizar=s),label:"Autorizar",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"]),l(n,{class:"q-ml-lg",modelValue:o.permiso.acceder,"onUpdate:modelValue":e[4]||(e[4]=s=>o.permiso.acceder=s),label:"Acceder",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"]),l(n,{class:"q-ml-lg",modelValue:o.permiso.ver,"onUpdate:modelValue":e[5]||(e[5]=s=>o.permiso.ver=s),label:"Ver",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"]),l(n,{class:"q-ml-lg",modelValue:o.permiso.crear,"onUpdate:modelValue":e[6]||(e[6]=s=>o.permiso.crear=s),label:"Crear",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"]),l(n,{class:"q-ml-lg",modelValue:o.permiso.editar,"onUpdate:modelValue":e[7]||(e[7]=s=>o.permiso.editar=s),label:"Editar",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"]),l(n,{class:"q-ml-lg",modelValue:o.permiso.eliminar,"onUpdate:modelValue":e[8]||(e[8]=s=>o.permiso.eliminar=s),label:"Eliminar",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])])])),a("div",Pe,[e[19]||(e[19]=a("label",{class:"q-mb-sm block"},"Roles",-1)),l(se,{modelValue:o.permiso.roles,"onUpdate:modelValue":e[9]||(e[9]=s=>o.permiso.roles=s),options:o.roles,"transition-show":"jump-up","transition-hide":"jump-down",disable:o.disabled,"options-dense":"",multiple:"",dense:"","use-chips":"",outlined:"",onFilter:o.filtrarRoles,"use-input":"","input-debounce":"0",error:!!o.v$.roles.$errors.length,"error-message":"Debes seleccionar uno o varios roles","option-value":s=>s.id,"option-label":s=>s.name,"emit-value":"","map-options":""},{option:r(({itemProps:s,opt:t,selected:c,toggleOption:P})=>[l(R,x(_(s)),{default:r(()=>[l(C,null,{default:r(()=>[U(g(t.name)+" ",1),l(le,{"inner-h-t-m-l":t.name},null,8,["inner-h-t-m-l"])]),_:2},1024),l(C,{side:""},{default:r(()=>[l(k,{"model-value":c,"onUpdate:modelValue":f=>P(t)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),error:r(()=>[(d(!0),u(Q,null,z(o.v$.roles.$errors,s=>(d(),u("div",{key:s.$uid},[a("div",$e,g(s.$message),1)]))),128))]),"no-option":r(()=>[l(R,null,{default:r(()=>[l(C,{class:"text-grey"},{default:r(()=>e[18]||(e[18]=[U(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter","error","option-value","option-label"])])]),l(m,{accion:"NUEVO",permitirCancelar:!1,onGuardar:e[10]||(e[10]=s=>o.crear())})]),_:1})}var ye=K(be,[["render",we]]);class Ne{constructor(){y(this,"PermisoNuevoPage");this.PermisoNuevoPage=oe(new F("Nuevo Permiso",ye))}}class Oe extends O{constructor(){super(new Ne)}}export{Oe as C,pe as P};

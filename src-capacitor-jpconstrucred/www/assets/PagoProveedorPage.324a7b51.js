var D=Object.defineProperty;var M=(o,e,r)=>e in o?D(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var n=(o,e,r)=>(M(o,typeof e!="symbol"?e+"":e,r),r);import{a as R}from"./QToolbar.2bb5adc4.js";import{bz as U,t as y,c as $,U as G,be as H,p as P,e as L,g as Y,bA as V,q as j,A as K,bH as J,v as O,x as k,y as t,S as z,H as u,D as l,a7 as W,B as s,z as m,G as b,R as X,F as Z,L as d,K as f,a9 as x,M as oo}from"./index.846478c1.js";import{Q as eo}from"./QChip.697486c2.js";import{Q as ao}from"./QForm.0a21c4a5.js";import{u as io}from"./index.15c331c5.js";import{T as lo}from"./TabLayout.b05b8b79.js";import{G as ro}from"./GestorDocumentos.f493bb1c.js";import{E as to}from"./EssentialPopupEditableTable.1016d059.js";import{E as so}from"./entidadAuditable.75a46700.js";import{C as no}from"./ContenedorSimpleMixin.1a882cca.js";import{u as mo,L as uo,A as po}from"./utils.19b149f6.js";import"./position-engine.456d5331.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QSelect.d8222f79.js";import"./QItemSection.ca64420c.js";import"./QMenu.c0bc1e4b.js";import"./format.8ac60962.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./QPopupProxy.7844573b.js";import"./QPage.b0adedad.js";import"./buttonSubmits.31738227.js";import"./EssentialTable.01bbad48.js";import"./QFile.c3222262.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./i18n-validators.06501904.js";import"./index.209eea81.js";import"./EssentialTablePagination.3349ebcb.js";import"./QUploader.c061fd0f.js";import"./QCircularProgress.b5ba4a87.js";const p=[{name:"id",field:"id",label:"id",align:"left",visible:!1,sortable:!0},{name:"razon_social",field:"razon_social",label:"Raz\xF3n Social",align:"left",sortable:!0},{name:"num_documento",field:"num_documento",label:"# Doc.",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n.",align:"left",sortable:!0},{name:"fecha_emision",field:"fecha_emision",label:"F. Emisi\xF3n",align:"left",sortable:!0},{name:"fecha_vencimiento",field:"fecha_vencimiento",label:"F. Vencimiento",align:"left",sortable:!0},{name:"plazo",field:"plazo",label:"Plazo",align:"left",sortable:!0},{name:"total",field:"total",label:"Total",align:"left",sortable:!0},{name:"valor_pagar",field:"valor_pagar",label:"V. Pagar",align:"left",sortable:!0}],co=[{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"realizador",field:"realizador",label:"Subido Por",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0},{name:"cant_elementos",field:"cant_elementos",label:"Cant. Facturas",align:"left",sortable:!0}];class bo extends so{constructor(){super();n(this,"archivo");n(this,"nombre");n(this,"realizador");n(this,"estado");n(this,"cant_elementos");n(this,"listado");this.archivo=null,this.nombre=null,this.realizador=null,this.estado=null,this.cant_elementos=null,this.listado=[]}}class fo extends U{constructor(){super(y.pagos_proveedores)}}var go=$({components:{TabLayout:lo,GestorDocumentos:ro,EssentialPopupEditableTable:to},setup(){const o=new no(bo,new fo),{entidad:e,accion:r,disabled:E,listado:S}=o.useReferencias(),{setValidador:F,listar:g}=o.useComportamiento(),{confirmar:v}=G(),{onConsultado:C}=o.useHooks();H().setQuasar(P()),mo().setQuasar(P());const i=L(),h=Y(()=>e.listado.reduce((a,c)=>a+parseFloat(c.valor_pagar),0).toFixed(2)),w=io({},e);F(w.value),C(()=>{r.value==V.editar?(p.find(a=>a.field==="valor_pagar").visible=!0,p.find(a=>a.field==="valor_pagar").editable=!0,p.find(a=>a.field==="valor_pagar").type="number",p.find(a=>a.field==="valor_pagar").hint="Ingresa el valor a pagar"):p.find(a=>a.field==="valor_pagar").editable=!1});const A={titulo:"Eliminar",icono:"bi-x",color:"negative",accion:({entidad:a,posicion:c})=>{T({posicion:c})},visible:()=>r.value==V.editar},q={titulo:"Cash",icono:"bi-file-earmark-excel-fill",color:"positive",accion:async({entidad:a})=>{await Q(a)}};async function Q(a){const c="pago_a_proveedores_"+uo(new Date,"D-MM-YYYY"),_=K.getInstance(),I=J.URL_BASE+"/"+_.getEndpoint(y.pagos_proveedores)+"/cash/"+a.id;await po(I,"GET","blob","xlsx",c,null)}function T({posicion:a}){v("\xBFEst\xE1 seguro de continuar?",()=>e.listado.splice(a,1))}async function B(){await i.value.subir(),console.log(i.value),g()}function N(a){a.valor_pagar=Number(a.valor_pagar).toFixed(2),a.total<a.valor_pagar&&(a.valor_pagar=a.total)}return{pago:e,mixin:o,accion:r,acciones:V,disabled:E,configuracionColumnas:co,columnasItems:p,accionesTabla:j,refArchivo:i,endpoint:y.pagos_proveedores,btnEliminarFila:A,btnCash:q,subirArchivos:B,calcularValores:N,total:h}}});const vo={class:"row q-col-gutter-sm q-py-md"},Co={key:0,class:"col-12 col-md-12"},Vo={class:"q-mb-sm block"},ko={key:1,class:"col-12 col-md-3"},yo={key:2,class:"col-12 col-md-3"},Eo={key:3,class:"col-12 col-md-3"},Fo={key:4,class:"col-12 col-md-3"},Po={key:5,class:"col-12 col-md-3 col-sm-6"},zo={key:6,class:"col-12"};function So(o,e,r,E,S,F){const g=k("gestor-documentos"),v=k("essential-popup-editable-table"),C=k("tab-layout");return t(),z(C,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Pago a Proveedores",mostrarButtonSubmits:o.accion!=o.acciones.nuevo,accion1:o.btnCash},{formulario:u(()=>[l(ao,{onSubmit:e[5]||(e[5]=W(()=>{},["prevent"]))},{default:u(()=>[s("div",vo,[o.accion==o.acciones.nuevo?(t(),m("div",Co,[s("label",Vo,[e[7]||(e[7]=b("Reporte de contifico ")),e[8]||(e[8]=s("i",{class:"bi bi-info-circle"},null,-1)),l(R,{class:"bg-light-blue-7"},{default:u(()=>e[6]||(e[6]=[b("Suba el reporte de cartera por pagar emitida por contifico")])),_:1})]),l(g,{ref:"refArchivo",mixin:o.mixin,endpoint:o.endpoint,disable:o.disabled,"permitir-eliminar":!1,"mostrar-listado":!1,"listar-al-guardar":!1,esMultiple:!1},{"boton-subir":u(()=>[(t(),z(X,{key:0,color:"positive",push:"","no-caps":"",class:"full-width q-mb-lg",onClick:e[0]||(e[0]=i=>o.subirArchivos())},{default:u(()=>[l(Z,{name:"bi-upload",class:"q-mr-sm",size:"xs"}),e[9]||(e[9]=b(" Subir archivos seleccionados"))]),_:1}))]),_:1},8,["mixin","endpoint","disable"])])):d("",!0),o.pago.id?(t(),m("div",ko,[e[10]||(e[10]=s("label",{class:"q-mb-sm block"},"Documento N\xB0",-1)),l(f,{modelValue:o.pago.id,"onUpdate:modelValue":e[1]||(e[1]=i=>o.pago.id=i),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):d("",!0),o.pago.created_at?(t(),m("div",yo,[e[11]||(e[11]=s("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),l(f,{modelValue:o.pago.created_at,"onUpdate:modelValue":e[2]||(e[2]=i=>o.pago.created_at=i),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):d("",!0),o.pago.nombre?(t(),m("div",Eo,[e[12]||(e[12]=s("label",{class:"q-mb-sm block"},"Archivo",-1)),l(f,{modelValue:o.pago.nombre,"onUpdate:modelValue":e[3]||(e[3]=i=>o.pago.nombre=i),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):d("",!0),o.pago.realizador?(t(),m("div",Fo,[e[13]||(e[13]=s("label",{class:"q-mb-sm block"},"Subido por",-1)),l(f,{modelValue:o.pago.realizador,"onUpdate:modelValue":e[4]||(e[4]=i=>o.pago.realizador=i),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):d("",!0),o.total>0?(t(),m("div",Po,[e[14]||(e[14]=s("label",{class:"q-mb-sm block"},"Total a Pagar:",-1)),l(eo,{square:""},{default:u(()=>[l(x,{icon:"bi-currency-dollar",color:"green","text-color":"white"}),b(" "+oo(o.total),1)]),_:1})])):d("",!0),o.accion!==o.acciones.nuevo?(t(),m("div",zo,[l(v,{ref:"refItems",titulo:"Facturas por pagar",configuracionColumnas:o.accion==o.acciones.consultar?o.columnasItems:[...o.columnasItems,o.accionesTabla],datos:o.pago.listado,separador:"cell",permitirEditarCeldas:o.accion==o.acciones.editar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,altoFijo:"",accion1:o.btnEliminarFila,onFilaModificada:o.calcularValores},null,8,["configuracionColumnas","datos","permitirEditarCeldas","accion1","onFilaModificada"])])):d("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","mostrarButtonSubmits","accion1"])}var fe=O(go,[["render",So]]);export{fe as default};

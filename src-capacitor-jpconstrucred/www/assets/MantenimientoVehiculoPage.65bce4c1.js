var j=Object.defineProperty;var G=(e,o,d)=>o in e?j(e,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[o]=d;var r=(e,o,d)=>(G(e,typeof o!="symbol"?o+"":o,d),d);import{by as Z,s as K,d as H,R as J,bc as W,m as R,u as X,c as Y,E as _,bz as x,p as ee,q as oe,_ as ae,t as F,v as t,P as ie,F as l,z as i,a5 as le,y as s,x as n,I as m,J as p,D as b,M as se,N as te,K as u,B as ne,j as re,O as de,G as f,H as g}from"./index.70185135.js";import{Q as V,a as h}from"./QItemSection.1a41b826.js";import{Q as k,a as Q}from"./QSelect.b1759751.js";import{Q as me,a as ue,C as pe}from"./QPopupProxy.c164d2ac.js";import{Q as be}from"./QForm.0c8c3b68.js";import{a as $}from"./i18n-validators.ea544161.js";import{u as ve,S as ce}from"./utils.2eab62de.js";import{u as fe}from"./index.004ff2d8.js";import{T as ge}from"./TabLayoutFilterTabs2.0c89493b.js";import{S as Ve}from"./EssentialTable.c4a035e4.js";import{C as he}from"./ContenedorSimpleMixin.0ef3239b.js";import{E as ke}from"./entidadAuditable.75a46700.js";import{u as $e}from"./filtrosListadosGenerales.6ad178d9.js";import{V as ye}from"./VehiculoController.656ab648.js";import{S as Ee}from"./ServicioController.1320570d.js";import{v as Oe,w as Se}from"./vehiculos.utils.c31e027d.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./index.9f64ebda.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QPage.f3b97ac0.js";import"./EssentialTableTabs.a1f1bc4b.js";import"./QBadge.5bb69fff.js";import"./EssentialTablePagination.959d4e60.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./buttonSubmits.f728eedc.js";import"./QFile.f60a5ba1.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";const ze=[{name:"vehiculo",field:"vehiculo",label:"Placa",align:"left",sortable:!0},{name:"empleado",field:"empleado",label:"Chofer",align:"left",sortable:!0},{name:"servicio",field:"servicio",label:"Servicio",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];class qe extends ke{constructor(){super();r(this,"vehiculo");r(this,"servicio");r(this,"empleado");r(this,"supervisor");r(this,"fecha_realizado");r(this,"km_realizado");r(this,"imagen_evidencia");r(this,"estado");r(this,"km_retraso");r(this,"dias_postergado");r(this,"motivo_postergacion");r(this,"observacion");this.vehiculo=null,this.servicio=null,this.empleado=null,this.supervisor=null,this.fecha_realizado=null,this.km_realizado=null,this.imagen_evidencia=null,this.estado=null,this.km_retraso=null,this.dias_postergado=null,this.motivo_postergacion=null,this.observacion=null}}class Ce extends Z{constructor(){super(K.mantenimientos_vehiculos)}}var Ie=H({components:{TabLayoutFilterTabs2:ge,SelectorImagen:Ve},setup(){const e=new he(qe,new Ce),{entidad:o,disabled:d,listadosAuxiliares:v,accion:z}=e.useReferencias(),{setValidador:q,cargarVista:E,obtenerListados:O,reestablecer:a,listar:B,editar:Ye}=e.useComportamiento();e.useHooks(),J(),W().setQuasar(R()),ve().setQuasar(R()),X(),new ce;const C=Y("PENDIENTE"),y="REALIZADO",S="POSTERGADO",{vehiculos:I,filtrarVehiculos:P,empleados:w,filtrarEmpleados:N,servicios:D,filtrarServicios:U}=$e(v);E(async()=>{await O({empleados:{controller:new _,params:{estado:1}},vehiculos:{controller:new ye,params:{estado:1}},servicios:{controller:new Ee,params:{tipo:"PREVENTIVO",estado:1}}}),w.value=v.empleados,I.value=v.vehiculos,D.value=v.servicios});const M={fecha_realizado:{requiredIf:$(()=>o.estado===y)},km_realizado:{requiredIf:$(()=>o.estado===y)},dias_postergado:{requiredIf:$(()=>o.estado===S)},motivo_postergacion:{requiredIf:$(()=>o.estado===S)},observacion:{requiredIf:$(()=>o.estado==="NO REALIZADO")}},A=fe(M,o);q(A.value);function T(c){C.value=c,B({estado:c})}function L(c){console.log(c),c!==y&&(o.fecha_realizado=null,o.km_realizado=null)}return{mixin:e,v$:A,mantenimiento:o,disabled:d,accion:z,acciones:x,configuracionColumnas:ze,accionesTabla:ee,tabDefecto:C,maskFecha:oe,REALIZADO:y,POSTERGADO:S,vehiculos:I,filtrarVehiculos:P,empleados:w,filtrarEmpleados:N,servicios:D,filtrarServicios:U,estadosMantenimientosVehiculos:Oe,tabOptions:Se,filtrarMantenimientos:T,estadoSeleccionado:L}}});const we={class:"row q-col-gutter-sm q-py-md"},De={key:0,class:"col-12 col-md-3"},Ae={class:"col-12 col-md-3"},Re={class:"col-12 col-md-3 q-mb-md"},Fe={class:"col-12 col-md-3 q-mb-md"},Qe={class:"col-12 col-md-3"},Be={class:"col-12 col-md-3"},Pe={key:1,class:"col-6 col-md-3"},Ne={key:2,class:"col-12 col-md-3"},Ue={class:"row items-center justify-end"},Me={class:"error-msg"},Te={key:3,class:"col-6 col-md-3"},Le={class:"error-msg"},je={key:4,class:"col-6 col-md-3"},Ge={class:"error-msg"},Ze={key:5,class:"col-12 col-md-3 col-sm-6"},Ke={class:"error-msg"},He={class:"col-12 col-md-3 col-sm-3"},Je={class:"col-12 col-md-3 col-sm-6"},We={class:"error-msg"};function Xe(e,o,d,v,z,q){const E=F("selector-imagen"),O=F("tab-layout-filter-tabs2");return t(),ie(O,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Mantenimientos de Veh\xEDculos","tab-options":e.tabOptions,ajustarCeldas:"",tabDefecto:e.tabDefecto,filtrar:e.filtrarMantenimientos,permitirEliminar:!1},{formulario:l(()=>[i(be,{onSubmit:o[14]||(o[14]=le(()=>{},["prevent"]))},{default:l(()=>[s("div",we,[e.mantenimiento.created_at?(t(),n("div",De,[o[15]||(o[15]=s("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),i(m,{modelValue:e.mantenimiento.created_at,"onUpdate:modelValue":o[0]||(o[0]=a=>e.mantenimiento.created_at=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):p("",!0),s("div",Ae,[o[17]||(o[17]=s("label",{class:"q-mb-sm block"},"Empleado",-1)),i(k,{modelValue:e.mantenimiento.empleado,"onUpdate:modelValue":o[1]||(o[1]=a=>e.mantenimiento.empleado=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"",onFilter:e.filtrarEmpleados,disable:"","option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[16]||(o[16]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Re,[o[19]||(o[19]=s("label",{class:"q-mb-sm block"},"Veh\xEDculo",-1)),i(k,{modelValue:e.mantenimiento.vehiculo,"onUpdate:modelValue":o[2]||(o[2]=a=>e.mantenimiento.vehiculo=a),options:e.vehiculos,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",dense:"",outlined:"",disable:"","use-input":"","input-debounce":"0",onFilter:e.filtrarVehiculos,"option-label":a=>a.placa,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[i(V,se(te(a.itemProps)),{default:l(()=>[i(h,null,{default:l(()=>[i(Q,null,{default:l(()=>[b(u(a.opt.placa),1)]),_:2},1024),i(Q,{caption:""},{default:l(()=>[b(u(a.opt.marca+" "+a.opt.modelo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[18]||(o[18]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Fe,[o[21]||(o[21]=s("label",{class:"q-mb-sm block"},"Servicio",-1)),i(k,{modelValue:e.mantenimiento.servicio,"onUpdate:modelValue":o[3]||(o[3]=a=>e.mantenimiento.servicio=a),options:e.servicios,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",dense:"",outlined:"",disable:"","use-input":"","input-debounce":"0",onFilter:e.filtrarServicios,"option-label":a=>a.nombre,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[20]||(o[20]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Qe,[o[23]||(o[23]=s("label",{class:"q-mb-sm block"},"Supervisor",-1)),i(k,{modelValue:e.mantenimiento.supervisor,"onUpdate:modelValue":o[4]||(o[4]=a=>e.mantenimiento.supervisor=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"",onFilter:e.filtrarEmpleados,disable:"","option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[22]||(o[22]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Be,[o[24]||(o[24]=s("label",{class:"q-mb-sm block"},"Estado",-1)),i(k,{modelValue:e.mantenimiento.estado,"onUpdate:modelValue":[o[5]||(o[5]=a=>e.mantenimiento.estado=a),e.estadoSeleccionado],options:e.estadosMantenimientosVehiculos,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":a=>a.label,"option-value":a=>a.label,"emit-value":"","map-options":""},null,8,["modelValue","options","disable","onUpdate:modelValue","option-label","option-value"])]),e.mantenimiento.estado==="RETRASADO"?(t(),n("div",Pe,[o[25]||(o[25]=s("label",{class:"q-mb-sm block"},"Kms Retrasado",-1)),i(m,{type:"number",modelValue:e.mantenimiento.km_retraso,"onUpdate:modelValue":o[6]||(o[6]=a=>e.mantenimiento.km_retraso=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):p("",!0),e.mantenimiento.estado===e.REALIZADO?(t(),n("div",Ne,[o[26]||(o[26]=s("label",{class:"q-mb-sm block"},"Fecha Realizado",-1)),i(m,{modelValue:e.mantenimiento.fecha_realizado,"onUpdate:modelValue":o[8]||(o[8]=a=>e.mantenimiento.fecha_realizado=a),placeholder:"Obligatorio",error:!!e.v$.fecha_realizado.$errors.length,onBlur:e.v$.fecha_realizado.$touch,disable:e.disabled,outlined:"",dense:""},{append:l(()=>[i(ne,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(me,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(ue,{modelValue:e.mantenimiento.fecha_realizado,"onUpdate:modelValue":o[7]||(o[7]=a=>e.mantenimiento.fecha_realizado=a),mask:e.maskFecha,"today-btn":""},{default:l(()=>[s("div",Ue,[re(i(de,{label:"Cerrar",color:"primary",flat:""},null,512),[[pe]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(t(!0),n(f,null,g(e.v$.fecha_realizado.$errors,a=>(t(),n("div",{style:{clear:"inherit"},key:a.$uid},[s("div",Me,u(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur","disable"])])):p("",!0),e.mantenimiento.estado===e.REALIZADO?(t(),n("div",Te,[o[27]||(o[27]=s("label",{class:"q-mb-sm block"},"Km Realizado",-1)),i(m,{type:"number",modelValue:e.mantenimiento.km_realizado,"onUpdate:modelValue":o[9]||(o[9]=a=>e.mantenimiento.km_realizado=a),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.km_realizado.$errors.length,onBlur:e.v$.km_realizado.$touch,outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.km_realizado.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",Le,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])):p("",!0),e.mantenimiento.estado===e.POSTERGADO?(t(),n("div",je,[o[28]||(o[28]=s("label",{class:"q-mb-sm block"},"D\xEDas de postergaci\xF3n",-1)),i(m,{type:"number",modelValue:e.mantenimiento.dias_postergado,"onUpdate:modelValue":o[10]||(o[10]=a=>e.mantenimiento.dias_postergado=a),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.dias_postergado.$errors.length,onBlur:e.v$.dias_postergado.$touch,outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.dias_postergado.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",Ge,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])):p("",!0),e.mantenimiento.estado===e.POSTERGADO?(t(),n("div",Ze,[o[29]||(o[29]=s("label",{class:"q-mb-sm block"},"Motivo Postergaci\xF3n",-1)),i(m,{autogrow:"",modelValue:e.mantenimiento.motivo_postergacion,"onUpdate:modelValue":o[11]||(o[11]=a=>e.mantenimiento.motivo_postergacion=a),placeholder:"Obligatorio",disable:e.disabled,hint:"Ingresa alguna observaci\xF3n o novedad presentada con este mantenimiento preventivo",error:!!e.v$.motivo_postergacion.$errors.length,onBlur:e.v$.motivo_postergacion.$touch,outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.motivo_postergacion.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",Ke,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])):p("",!0),s("div",He,[o[30]||(o[30]=s("label",{for:"q-mb-xl block"},"Imagen Evidencia",-1)),i(E,{file_extensiones:".jpg, image/*",imagen:e.mantenimiento.imagen_evidencia,alto:"80px","onUpdate:modelValue":o[12]||(o[12]=a=>e.mantenimiento.imagen_evidencia=a)},null,8,["imagen"])]),s("div",Je,[o[31]||(o[31]=s("label",{class:"q-mb-sm block"},"Observaci\xF3n",-1)),i(m,{autogrow:"",modelValue:e.mantenimiento.observacion,"onUpdate:modelValue":o[13]||(o[13]=a=>e.mantenimiento.observacion=a),placeholder:"Opcional",disable:e.disabled,error:!!e.v$.observacion.$errors.length,onBlur:e.v$.observacion.$touch,hint:"Ingresa alguna observaci\xF3n o novedad presentada con este mantenimiento preventivo",outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.observacion.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",We,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar"])}var No=ae(Ie,[["render",Xe]]);export{No as default};

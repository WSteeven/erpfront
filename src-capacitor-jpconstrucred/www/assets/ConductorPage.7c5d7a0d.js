import{Q as L,a as $}from"./QSelect.d8222f79.js";import{Q as N,a as B}from"./QItemSection.ca64420c.js";import{c as _,U as oo,f as eo,e as ao,a3 as U,bA as b,q as lo,s as to,E as io,v as no,x as h,y as s,S as so,H as t,D as l,a7 as ro,B as n,z as d,I as mo,J as uo,M as g,O as co,P as po,G as k,R as fo,F as bo,K as C,L as u}from"./index.846478c1.js";import{Q as go}from"./QExpansionItem.a87f342e.js";import{Q as Co}from"./QForm.0a21c4a5.js";import{I as vo,C as wo,c as Eo}from"./InformacionLicencia.05af2d2e.js";import{r as M,d as Vo,c as yo}from"./i18n-validators.06501904.js";import{u as ko}from"./index.15c331c5.js";import{T as Mo}from"./TabLayout.b05b8b79.js";import{G as So}from"./GestorArchivos.33ade07b.js";import{E as Fo}from"./EssentialTable.01bbad48.js";import{M as qo}from"./ModalEntidad.5edc5f68.js";import{S as Io}from"./SolicitarFecha.333e91d1.js";import{E as O}from"./EmpleadoRolesController.89b1a3b6.js";import{C as Qo}from"./ContenedorSimpleMixin.1a882cca.js";import{u as Po,a as Lo}from"./MultaConductorPage.0e380e81.js";import{S as $o}from"./utils.19b149f6.js";import{g as No,t as Bo}from"./vehiculos.utils.c31e027d.js";import{C as Uo}from"./ConductorController.f5ed7b77.js";import{u as ho}from"./filtrosListadosGenerales.c330183b.js";import{E as R}from"./Empleado.20234ba0.js";import{C as Oo}from"./Conductor.978d1863.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QPopupProxy.7844573b.js";import"./QToolbar.2bb5adc4.js";import"./ComponenteModal.domain.3bd8db1f.js";import"./entidadAuditable.75a46700.js";import"./index.209eea81.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./QPage.b0adedad.js";import"./buttonSubmits.31738227.js";import"./EssentialTablePagination.3349ebcb.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./QUploader.c061fd0f.js";import"./QCircularProgress.b5ba4a87.js";import"./QFile.c3222262.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./VehiculoController.8465b13a.js";const Ro=[{name:"empleado",field:"empleado",label:"Empleado",align:"left",sortable:!0},{name:"identificacion",field:"identificacion",label:"Identificaci\xF3n",align:"left",sortable:!0},{name:"licencias",field:"licencias",label:"Cant. Licencias",align:"left",sortable:!0,editable:!1},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0,editable:!1},{name:"multas",field:"multas",label:"Multas",align:"left",sortable:!0}];var Ao=_({components:{TabLayout:Mo,ModalesEntidad:qo,EssentialTable:Fo,GestorArchivos:So,SolicitarFecha:Io,InformacionLicencia:vo},setup(){const e=new Qo(Oo,new Uo),{entidad:o,disabled:S,listadosAuxiliares:r,accion:m}=e.useReferencias(),{setValidador:F,obtenerListados:v,cargarVista:w,consultar:a}=e.useComportamiento(),{onReestablecer:A,onConsultado:T}=e.useHooks(),{confirmar:j,prompt:D}=oo(),c=eo(new R),E=Po(),p=new $o,q=new wo,f={fecha_pago:null,comentario:null},I=ao(!1);w(async()=>{await v({empleados:{controller:new O,params:{roles:["CHOFER"]}}}),r.cantones=JSON.parse(U.getItem("cantones").toString()),y.value=JSON.parse(U.getItem("cantones").toString())});const G={empleado:{required:M},tipo_licencia:{required:M},puntos:{required:M,maximo:Vo(30),minimo:yo(0)}},Q=ko(G,o);F(Q.value),T(async()=>{c.hydrate(o.info_empleado),await z(),E.conductor=o}),A(()=>{c.hydrate(new R),f.comentario=null,f.fecha_pago=null,E.resetearConductor()});async function H(i){switch(i){case"MultaConductorPage":console.log("Antes de consultar",o.id),await a(o),console.log("Luego de consultar",o.id);break;default:console.log("No se recibio data")}}async function z(){const{result:i}=await new Lo().listar({empleado_id:o.empleado});o.multas=i}async function J(i){if(i!=null){p.activar();const{result:P}=await new io().consultar(i);c.hydrate(P),p.desactivar()}}async function K(){p.activar(),r.empleados=(await new O().listar({roles:["CHOFER"]})).result,V.value=r.empleados,p.desactivar()}const{empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,cantones:y}=ho(r),Y={titulo:"Agregar multa",icono:"bi-file-text",color:"positive",tooltip:"Agregar multa asociado al conductor",accion:()=>{q.abrirModalEntidad("MultaConductorPage")},visible:()=>m.value==b.editar},Z={titulo:"Editar",icono:"bi-pencil-square",color:"secondary",tooltip:"Editar",accion:({entidad:i})=>{j("\xBFEst\xE1 seguro de marcar como pagada la multa?",async()=>{D({titulo:"Fecha de pago",mensaje:"\xBFTienes alguna observaci\xF3n al respecto?",accion:async x=>{E.idMulta=i.id,f.comentario=x,f.fecha_pago==null&&(I.value=!0)}})})},visible:({entidad:i})=>(m.value==b.nuevo||m.value==b.editar)&&!i.estado};return V.value=r.empleados,y.value=r.cantones,{mixin:e,conductor:o,disabled:S,accion:m,v$:Q,acciones:b,configuracionColumnas:Ro,columnasMultasConductor:Eo,accionesTabla:lo,empleado:c,maskFecha:to,modales:q,mostrarSolicitarFecha:I,abrirModalMultaConductor:Y,btnEditarMulta:Z,tabOptionsConductores:No,empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,obtenerEmpleado:J,cantones:y,tiposLicencias:Bo,guardado:H,recargarChoferes:K}}});const To={class:"row q-col-gutter-sm q-pa-sm"},jo={class:"col-12 col-md-3"},Do={class:"error-msg"},Go={key:0,class:"col-12 col-md-3"},Ho={key:1,class:"col-12 col-md-3"},zo={key:2,class:"col-12 col-md-3"},Jo={key:3,class:"col-12 col-md-3"},Ko={key:4,class:"col-12 col-md-3"};function Wo(e,o,S,r,m,F){const v=h("informacion-licencia"),w=h("tab-layout");return s(),so(w,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:"","titulo-pagina":"Conductores"},{formulario:t(()=>[l(Co,{onSubmit:o[7]||(o[7]=ro(()=>{},["prevent"]))},{default:t(()=>[l(go,{class:"overflow-hidden q-mb-md expansion",label:"Informaci\xF3n Personal","header-class":"text-bold bg-header-collapse","default-opened":""},{default:t(()=>[n("div",To,[n("div",jo,[o[9]||(o[9]=n("label",{class:"q-mb-sm block"},"Chofer",-1)),l(L,{modelValue:e.conductor.empleado,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.conductor.empleado=a),e.obtenerEmpleado],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:e.ordenarEmpleados,error:!!e.v$.empleado.$errors.length,"error-message":"Debes seleccionar un empleado para convertirlo en chofer","option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:t(()=>[(s(!0),d(mo,null,uo(e.v$.empleado.$errors,a=>(s(),d("div",{key:a.$uid},[n("div",Do,g(a.$message),1)]))),128))]),option:t(a=>[l(N,co(po(a.itemProps)),{default:t(()=>[l(B,null,{default:t(()=>[l($,null,{default:t(()=>[k(g(a.opt.apellidos)+" "+g(a.opt.nombres),1)]),_:2},1024),l($,{caption:""},{default:t(()=>[k(g(a.opt.identificacion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[l(N,null,{default:t(()=>[l(B,{class:"text-grey"},{default:t(()=>o[8]||(o[8]=[k(" No hay resultados ")])),_:1})]),_:1})]),after:t(()=>[l(fo,{color:"positive",onClick:e.recargarChoferes},{default:t(()=>[l(bo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disable","onFilter","onPopupShow","onUpdate:modelValue","error","option-value","option-label"])]),e.empleado.identificacion?(s(),d("div",Go,[o[10]||(o[10]=n("label",{class:"q-mb-sm block"},"Identificacion",-1)),l(C,{mask:"#############",modelValue:e.empleado.identificacion,"onUpdate:modelValue":o[1]||(o[1]=a=>e.empleado.identificacion=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.canton?(s(),d("div",Ho,[o[11]||(o[11]=n("label",{class:"q-mb-sm block"},"Ciudad",-1)),l(L,{modelValue:e.empleado.canton,"onUpdate:modelValue":o[2]||(o[2]=a=>e.empleado.canton=a),options:e.cantones,disable:"",dense:"",outlined:"","option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):u("",!0),e.empleado.direccion?(s(),d("div",zo,[o[12]||(o[12]=n("label",{class:"q-mb-sm block"},"Direcci\xF3n",-1)),l(C,{modelValue:e.empleado.direccion,"onUpdate:modelValue":o[3]||(o[3]=a=>e.empleado.direccion=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.celular?(s(),d("div",Jo,[o[13]||(o[13]=n("label",{class:"q-mb-sm block"},"Celular",-1)),l(C,{modelValue:e.empleado.celular,"onUpdate:modelValue":o[4]||(o[4]=a=>e.empleado.celular=a),disable:"",dense:"",outlined:""},null,8,["modelValue"])])):u("",!0),e.empleado.email?(s(),d("div",Ko,[o[14]||(o[14]=n("label",{class:"q-mb-sm block"},"Correo",-1)),l(C,{modelValue:e.empleado.email,"onUpdate:modelValue":o[5]||(o[5]=a=>e.empleado.email=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0)])]),_:1}),l(v,{mixin:e.mixin,conductor:e.conductor,identificacion:e.empleado.identificacion,consultarMultas:!1,onGuardado:o[6]||(o[6]=a=>e.guardado(a))},null,8,["mixin","conductor","identificacion"])]),_:1})]),_:1},8,["mixin","configuracionColumnas"])}var Ye=no(Ao,[["render",Wo]]);export{Ye as default};

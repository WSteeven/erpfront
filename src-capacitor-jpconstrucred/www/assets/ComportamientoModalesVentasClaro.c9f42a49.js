var K=Object.defineProperty;var J=(o,e,l)=>e in o?K(o,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[e]=l;var a=(o,e,l)=>(J(o,typeof e!="symbol"?e+"":e,l),l);import{C as P,a as W}from"./ComponenteModal.domain.3bd8db1f.js";import{a as X}from"./ClienteClaroPage.1a6ee607.js";import Y from"./VendedorPage.8f0684e7.js";import{bz as Z,t as y,m as ee,f as z,e as h,U as oe,A,c as R,g as F,v as T,x as $,y as I,S as M,H as C,B as n,D as s,bf as ae,R as H,F as x,G as te,L as ne,a4 as se,bH as N,a as B,z as ie,K as v,k as le,bi as k}from"./index.846478c1.js";import{Q as re}from"./QPage.b0adedad.js";import{u as de}from"./index.15c331c5.js";import{_ as ce}from"./TablaFilasDinamicas.4d54c4da.js";import{V as ue}from"./VisorImagen.93b8e0f6.js";import{G as me}from"./GestorArchivos.33ade07b.js";import{C as U}from"./ContenedorSimpleMixin.1a882cca.js";import{c as pe}from"./configuracionColumnasSeguimientoOrdenCompra.eb4feb2f.js";import{E as G}from"./entidadAuditable.75a46700.js";import{A as fe}from"./ArchivoController.689a40cd.js";import{S as ve,z as D}from"./utils.19b149f6.js";import{V as L}from"./VentaController.706593a5.js";import{Q as be,a as ge,C as Ve}from"./QPopupProxy.7844573b.js";import{E as he,a as _e}from"./EssentialTable.01bbad48.js";import{M as Ce}from"./ModalEntidad.5edc5f68.js";import{A as we}from"./ArchivoSeguimiento.5a3d8353.js";const fo=[{name:"id",field:"id",label:"#",align:"left",sortable:!0},{name:"orden_id",field:"orden_id",label:"#Orden",align:"left",sortable:!0},{name:"vendedor_info",field:"vendedor_info",label:"Vendedor",align:"left",sortable:!0},{name:"cliente_info",field:"cliente_info",label:"Cliente",align:"left",sortable:!0},{name:"plan",field:"plan",label:"Plan",align:"left",sortable:!0},{name:"producto_info",field:"producto_info",label:"Producto",align:"left",sortable:!0},{name:"fecha_activacion",field:"fecha_activacion",label:"Fecha de Activacion",align:"left",sortable:!0},{name:"estado_activacion",field:"estado_activacion",label:"Estado",align:"left",sortable:!0},{name:"forma_pago",field:"forma_pago",label:"Forma de Pago",align:"left",sortable:!0},{name:"comisiona",field:"comisiona",label:"Comisiona",align:"left",sortable:!0},{name:"novedades",field:"novedades",label:"Novedades",align:"left",sortable:!0}];class q extends G{constructor(){super();a(this,"id");a(this,"orden_id");a(this,"orden_interna");a(this,"vendedor");a(this,"vendedor_info");a(this,"cliente");a(this,"cliente_info");a(this,"producto");a(this,"producto_info");a(this,"producto_precio");a(this,"plan");a(this,"fecha_activacion");a(this,"mes");a(this,"estado_activacion");a(this,"forma_pago");a(this,"comisiona");a(this,"comision");a(this,"comision_info");a(this,"chargeback");a(this,"comision_vendedor");a(this,"activo");a(this,"observacion");a(this,"primer_mes");a(this,"fecha_pago_primer_mes");a(this,"novedades");this.id=null,this.orden_id=null,this.orden_interna=null,this.vendedor=null,this.vendedor_info=null,this.cliente=null,this.cliente_info=null,this.producto=null,this.producto_info=null,this.producto_precio=null,this.plan=null,this.fecha_activacion=null,this.mes=null,this.estado_activacion=null,this.forma_pago=null,this.comisiona=!1,this.comision=null,this.comision_info=null,this.chargeback=null,this.comision_vendedor=null,this.activo=!0,this.observacion=null,this.primer_mes=!1,this.fecha_pago_primer_mes=null,this.novedades=0}}class Q extends G{constructor(){super();a(this,"fecha_hora");a(this,"actividad");a(this,"observacion");a(this,"fotografia");a(this,"venta");this.fecha_hora=null,this.actividad=null,this.observacion=null,this.fotografia=null,this.venta=null}}class ye extends Z{constructor(){super(y.novedades_ventas)}}const j=ee("venta",()=>{const o=z(new q),e=z(new q),l=h(),u=h(),b=h(),w=h(!0),{notificarCorrecto:t}=oe(),m=new ve;async function p(i,r,d){const g=A.getInstance(),V=g.getEndpoint(y.obtener_comision)+"/"+i+"/"+r+"/"+d;return(await g.get(V)).data.comision_value}async function _(i){const r=A.getInstance(),d=r.getEndpoint(y.ventas)+"/suspender/"+b.value,g=await r.post(d,i);return{response:g,result:g.data.modelo}}async function E(){try{m.activar();const i=A.getInstance(),r=i.getEndpoint(y.ventas)+"/marcar-pagado/"+b.value,d=await i.post(r);return d.status===200&&t("Primer mes pagado correctamente"),{response:d,result:d.data.modelo}}catch(i){await D(i)}finally{m.desactivar()}}async function f(){try{m.activar();const i=A.getInstance(),r=i.getEndpoint(y.actualizar_comisiones_ventas),d=await i.get(r,{params:{fecha:l.value}});t(d.data.mensaje)}catch(i){await D(i)}finally{m.desactivar()}}return{filaVenta:e,posicionFilaVenta:u,venta:o,idVenta:b,permitirSubir:w,fechaActualizacion:l,obtenerComision:p,suspenderVenta:_,marcarPrimerMesPagado:E,actualizarCalculoComisiones:f}});var Ae=R({components:{TablaFilasDinamicas:ce,GestorArchivos:me,VisorImagen:ue},setup(){const o=j(),e=new U(q,new L,new fe),l=new U(Q,new ye),{entidad:u,listado:b}=l.useReferencias(),{guardar:w,setValidador:t,listar:m}=l.useComportamiento(),p=h();h();const _=h(),E=o.permitirSubir;m({venta_id:o.idVenta});const f={titulo:"Ver fotograf\xEDa",icono:"bi-image-fill",color:"secondary",visible:({entidad:c})=>c.fotografia,accion:async({entidad:c})=>{_.value.abrir(c.fotografia)}},r=de({},u);t(r.value);function d(c){u.hydrate(c),u.venta=o.idVenta,w(u)}async function g(){await p.value.subir()}function V(){p.value.listarArchivosAlmacenados(o.idVenta)}return{refVisorImagen:_,mixin:l,mixinVenta:e,refArchivo:p,columnas:pe,listado:b,NovedadVenta:Q,verFotografia:f,guardarFilaActividad:d,subirArchivos:g,mostrarBotonSubir:F(()=>{var c;return(c=p.value)==null?void 0:c.quiero_subir_archivos}),permitirSubir:E,cargarArchivos:V,idModelo:F(()=>o.idVenta)}}});const Se={class:"row"},Ee={class:"col-12 q-mb-md"},Pe={class:"col-12 q-mb-md"};function ke(o,e,l,u,b,w){const t=$("tabla-filas-dinamicas"),m=$("gestor-archivos"),p=$("visor-imagen");return I(),M(re,null,{default:C(()=>[e[3]||(e[3]=n("div",{class:"text-center text-subtitle2 q-mb-md"},"Ingreso de novedad",-1)),s(ae,{class:"rounded-card custom-shadow q-pa-md"},{default:C(()=>[n("div",Se,[n("div",Ee,[s(t,{listado:o.listado,"configuracion-columnas":o.columnas,entidad:o.NovedadVenta,accion1:o.verFotografia,mostrarAccion1Header:o.permitirSubir,onGuardarFila:e[0]||(e[0]=_=>o.guardarFilaActividad(_))},null,8,["listado","configuracion-columnas","entidad","accion1","mostrarAccion1Header"])]),n("div",Pe,[s(m,{ref:"refArchivo",mixin:o.mixinVenta,"permitir-subir":o.permitirSubir,"permitir-eliminar":!1,idModelo:o.idModelo,onInicializado:o.cargarArchivos},{"boton-subir":C(()=>[o.mostrarBotonSubir?(I(),M(H,{key:0,color:"positive",push:"","no-caps":"",class:"full-width q-mb-lg",onClick:e[1]||(e[1]=_=>o.subirArchivos())},{default:C(()=>[s(x,{name:"bi-upload",class:"q-mr-sm",size:"xs"}),e[2]||(e[2]=te(" Subir archivos seleccionados"))]),_:1})):ne("",!0)]),_:1},8,["mixin","permitir-subir","idModelo","onInicializado"])])])]),_:1}),s(p,{ref:"refVisorImagen"},null,512)]),_:1})}var qe=T(Ae,[["render",ke]]),Oe=R({components:{EssentialTable:he,ModalesEntidad:Ce,ArchivoSeguimiento:we,EstadosSubtareas:_e},setup(){const o=j(),e=new U(q,new L),{listadosAuxiliares:l,accion:u,disabled:b}=e.useReferencias(),{guardar:w,editar:t,eliminar:m,reestablecer:p,obtenerListados:_,cargarVista:E}=e.useComportamiento(),f=o.filaVenta,i=h(0),r=h(0);function d(){const V=A.getInstance(),c=N.URL_BASE+"/"+V.getEndpoint(y.productos_ventas)+"/"+f.producto;B({url:c,method:"GET",responseType:"json",headers:{Authorization:V.getOptions().headers.Authorization}}).then(O=>{const{data:S}=O;S&&(i.value=S.modelo.precio)})}function g(){const V=A.getInstance(),c=N.URL_BASE+"/"+V.getEndpoint(y.obtener_comision)+"/"+f.producto+"/"+f.forma_pago;B({url:c,method:"GET",responseType:"json",headers:{Authorization:V.getOptions().headers.Authorization}}).then(O=>{const{data:S}=O;S&&(r.value=S.comision_value)})}return se(()=>{f.producto!=null&&f.forma_pago!=null&&(d(),g())}),{accion:u,disabled:b,ventas:f,precio_producto:i,comision_vendedor:r,guardar:w,editar:t,eliminar:m,reestablecer:p,listadosAuxiliares:l,mixin:e}}});const $e={class:"q-pa-md"},Ie={class:"row q-col-gutter-sm q-mb-md"},Ue={class:"col-12 col-md-3"},ze={class:"col-12 col-md-3"},Fe={class:"col-12 col-md-3"},Me={class:"col-12 col-md-3"},Ne={class:"col-12 col-md-3"},Be={class:"col-12 col-md-3"},De={class:"col-12 col-md-3"},Qe={class:"col-12 col-md-3"},Re={class:"col-12 col-md-3"},Te={class:"row items-center justify-end"},He={class:"col-12 col-md-3"};function xe(o,e,l,u,b,w){return I(),ie("div",$e,[n("div",Ie,[n("div",Ue,[e[11]||(e[11]=n("label",{class:"q-mb-sm block"},"Vendedor",-1)),s(v,{modelValue:o.ventas.vendedor_info,"onUpdate:modelValue":e[0]||(e[0]=t=>o.ventas.vendedor_info=t),placeholder:"Obligatorio",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",ze,[e[12]||(e[12]=n("label",{class:"q-mb-sm block"},"#Orden",-1)),s(v,{modelValue:o.ventas.orden_id,"onUpdate:modelValue":e[1]||(e[1]=t=>o.ventas.orden_id=t),placeholder:"Obligatorio",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",Fe,[e[13]||(e[13]=n("label",{class:"q-mb-sm block"},"Orden Interna",-1)),s(v,{modelValue:o.ventas.orden_interna,"onUpdate:modelValue":e[2]||(e[2]=t=>o.ventas.orden_interna=t),placeholder:"Obligatorio",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",Me,[e[14]||(e[14]=n("label",{class:"q-mb-sm block"},"Forma de Pago",-1)),s(v,{modelValue:o.ventas.forma_pago,"onUpdate:modelValue":e[3]||(e[3]=t=>o.ventas.forma_pago=t),placeholder:"Obligatorio",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",Ne,[e[15]||(e[15]=n("label",{class:"q-mb-sm block"},"Producto",-1)),s(v,{modelValue:o.ventas.producto_info,"onUpdate:modelValue":e[4]||(e[4]=t=>o.ventas.producto_info=t),placeholder:"Obligatorio",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",Be,[e[16]||(e[16]=n("label",{class:"q-mb-sm block"},"Plan",-1)),s(v,{modelValue:o.ventas.plan,"onUpdate:modelValue":e[5]||(e[5]=t=>o.ventas.plan=t),placeholder:"Opcional",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",De,[e[17]||(e[17]=n("label",{class:"q-mb-sm block"},"Precio",-1)),s(v,{modelValue:o.precio_producto,"onUpdate:modelValue":e[6]||(e[6]=t=>o.precio_producto=t),placeholder:"Opcional",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",Qe,[e[18]||(e[18]=n("label",{class:"q-mb-sm block"},"Estado Activacion",-1)),s(v,{modelValue:o.ventas.estado_activacion,"onUpdate:modelValue":e[7]||(e[7]=t=>o.ventas.estado_activacion=t),placeholder:"Obligatorio",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),n("div",Re,[e[19]||(e[19]=n("label",{class:"q-mb-sm block"},"Fecha de Activacion",-1)),s(v,{modelValue:o.ventas.fecha_activacion,"onUpdate:modelValue":e[9]||(e[9]=t=>o.ventas.fecha_activacion=t),placeholder:"Opcional",disable:"",readonly:"",outlined:"",dense:""},{append:C(()=>[s(x,{name:"event",class:"cursor-pointer"},{default:C(()=>[s(be,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:C(()=>[s(ge,{modelValue:o.ventas.fecha_activacion,"onUpdate:modelValue":e[8]||(e[8]=t=>o.ventas.fecha_activacion=t),mask:o.maskFecha,"today-btn":"",disable:""},{default:C(()=>[n("div",Te,[le(s(H,{label:"Cerrar",color:"primary",flat:"",disable:""},null,512),[[Ve]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",He,[e[20]||(e[20]=n("label",{class:"q-mb-sm block"},"Comision",-1)),s(v,{modelValue:o.comision_vendedor,"onUpdate:modelValue":e[10]||(e[10]=t=>o.comision_vendedor=t),placeholder:"Opcional",type:"textarea",disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])])])}var Ge=T(Oe,[["render",xe]]);class Le{constructor(){a(this,"ClientePage");a(this,"VendedorPage");a(this,"SeguimientoVentaPage");a(this,"DetalleCompletoVentas");this.ClientePage=k(new P("Clientes Claro",X)),this.VendedorPage=k(new P("Vendedores",Y)),this.SeguimientoVentaPage=k(new P("Novedades de la venta",qe)),this.DetalleCompletoVentas=k(new P("Detalles de ventas",Ge))}}class vo extends W{constructor(){super(new Le)}}export{vo as C,q as V,fo as c,j as u};

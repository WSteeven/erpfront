var R=Object.defineProperty;var $=(a,o,r)=>o in a?R(a,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[o]=r;var E=(a,o,r)=>($(a,typeof o!="symbol"?o+"":o,r),r);import{Q as k}from"./QPage.b0adedad.js";import{bz as L,t as Q,bi as x,c as U,e as i,be as j,p as G,u as H,dh as n,di as J,q as K,E as W,bA as h,v as X,x as z,y as A,S as Z,H as aa,B as u,G as y,M,z as ea,L as oa,a6 as ta,D as S}from"./index.846478c1.js";import{M as ra}from"./ModalEntidad.5edc5f68.js";import{C as sa}from"./ConfirmarDialog.279f9a75.js";import{E as ia}from"./EssentialTableTabs.d6bee6af.js";import{C as na}from"./ContenedorSimpleMixin.1a882cca.js";import{G as la}from"./Gasto.edc5bb42.js";import{S as ca,u as ua,P as ma}from"./utils.19b149f6.js";import{C as da,a as pa}from"./ComponenteModal.domain.3bd8db1f.js";import{V as fa}from"./VisualizarGastoPage.c624c7f5.js";import{u as ba}from"./fondo_rotativo.edb2f055.js";import{V as ga}from"./VehiculoController.8465b13a.js";import{P as _a}from"./ProyectoController.13ba2d04.js";import{T as Ca}from"./TareaController.4af45b78.js";import{C as va}from"./ClienteController.b9526fcf.js";import"./QToolbar.2bb5adc4.js";import"./position-engine.456d5331.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./EssentialTable.01bbad48.js";import"./QSelect.d8222f79.js";import"./QChip.697486c2.js";import"./QItemSection.ca64420c.js";import"./QMenu.c0bc1e4b.js";import"./format.8ac60962.js";import"./QFile.c3222262.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./QPopupProxy.7844573b.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./i18n-validators.06501904.js";import"./index.209eea81.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./EssentialTablePagination.3349ebcb.js";import"./entidadAuditable.75a46700.js";import"./QForm.0a21c4a5.js";import"./TabLayout.b05b8b79.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./buttonSubmits.31738227.js";import"./index.15c331c5.js";import"./configuracionColumnasGasto.bbc5ae20.js";import"./GastoPusherEvent.c587add4.js";import"./notificationRealtime.6b124300.js";import"./AprobarGastoController.6b2db89c.js";import"./GastoController.81d2c626.js";import"./NoOptionComponent.5e086980.js";const Da=[{name:"id",field:"id",label:"Id",align:"left",sortable:!0},{name:"fecha_viat",field:"fecha_viat",label:"Fecha",align:"left",sortable:!0},{name:"tarea_info",field:"tarea_info",label:"Tarea",align:"left",sortable:!0},{name:"tarea_cliente",field:"tarea_cliente",label:"Tarea cliente",align:"left",sortable:!0},{name:"factura",field:"factura",label:"#Factura",align:"left",sortable:!0},{name:"num_comprobante",field:"num_comprobante",label:"#Comprobante",align:"left",sortable:!0},{name:"ruc",field:"ruc",label:"RUC.",align:"left",sortable:!0},{name:"aut_especial_user",field:"aut_especial_user",label:"Autorizaci\xF3n Especial",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"detalle_info",field:"detalle_info",label:"Detalle",align:"left",sortable:!0},{name:"sub_detalle_info",field:"sub_detalle_info",label:"SubDetalle",align:"left",sortable:!0},{name:"centro_costo",field:"centro_costo",label:"Centro de Costo",align:"left",sortable:!0},{name:"subcentro_costo",field:"subcentro_costo",label:"Sub Centro de Costo",align:"left",sortable:!0},{name:"estado_info",field:"estado_info",label:"Estado	",align:"left",sortable:!0},{name:"detalle_estado",field:"detalle_estado",label:"Descripcion",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha de Creaci\xF3n",align:"left",sortable:!0}];class P extends L{constructor(){super(Q.autorizaciones_gastos)}}class wa{constructor(){E(this,"VisualizarGastoPage");this.VisualizarGastoPage=x(new da("Gastos",fa))}}class Ea extends pa{constructor(){super(new wa)}}var Ga=U({name:"AutorizarGastoPage",components:{EssentialTableTabs:ia,ConfirmarDialog:sa,ModalEntidad:ra},setup(){const a=new P,o=i(),r=new na(la,a),{listado:p}=r.useReferencias(),s=new ca;j().setQuasar(G()),ua().setQuasar(G());const l=H(),t=ba(),m=i([]),c=i([]),g=i([]),_=i([]),C=i([]),T=new P;async function f(e){s.activar();const{result:d}=await T.listar({estado:e});p.value=d,o.value=e,s.desactivar()}async function N(){m.value=(await new ga().listar({campos:"id,placa"})).result,c.value=(await new W().listar({estado:1})).result}async function V(e){s.activar(),g.value=(await new _a().listar({campos:"id,nombre,codigo_proyecto",finalizado:0,empleado_id:e})).result,C.value=(await new Ca().listar({campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id",empleado_id:e,activas_empleado:1,formulario:!0})).result,_.value=(await new va().listar({estado:1,requiere_fr:1})).result,s.desactivar()}f(n.PENDIENTE),N();const v=new Ea,q=i(),F={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:async({entidad:e})=>{console.log("boton ",e),s.activar(),t.gasto=e,t.vehiculos=m.value,t.empleados=c.value,t.habilitar_observacion_autorizador=l.user.id===e.aut_especial&&[n.PENDIENTE,n.APROBADO].includes(e.estado)&&B(e.fecha_viat),t.accion_form=l.user.id===e.aut_especial&&e.estado===n.PENDIENTE?h.editar:h.consultar,e.estado===n.PENDIENTE&&await V(e.id_usuario),t.proyectos=g.value,t.tareas=C.value,t.clientes=_.value,v.abrirModalEntidad("VisualizarGastoPage"),s.desactivar()}};function B(e){const d=new Date,D=new Date(d.getFullYear(),d.getMonth(),1),b=new Date(D);b.setDate(D.getDate()-1);const I=new Date(b.getFullYear(),b.getMonth(),1),O=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),w=ma(e,"YYYY-MM-DD","America/Guayaquil");return w>=I&&w<=O||l.esAdministrador}async function Y(){f(n.PENDIENTE)}return{configuracionColumnasAutorizarGasto:Da,listado:p,estadosGastos:n,tabAutorizarGasto:J,botonVerModalGasto:F,accionesTabla:K,estaSemanAC:q,guardado:Y,filtrarAutorizacionesGasto:f,authenticationStore:l,modales:v}}});const ha={class:"text-center q-pb-md"},za={class:"q-my-md"},Aa={key:0,class:"q-mb-md"};function ya(a,o,r,p,s,l){const t=z("essential-table-tabs"),m=z("modal-entidad");return A(),Z(k,{padding:!a.$q.screen.xs},{default:aa(()=>{var c;return[u("div",ha,[u("div",za,[o[0]||(o[0]=y(" Bienvenido, ")),u("strong",null,M(a.authenticationStore.nombreUsuario),1)]),(c=a.authenticationStore.user)!=null&&c.grupo?(A(),ea("div",Aa,[o[1]||(o[1]=y(" Grupo, ")),u("strong",null,M(a.authenticationStore.user.grupo),1)])):oa("",!0)]),u("div",{class:ta([{"bg-desenfoque rounded q-pa-sm":a.$q.screen.xs},"borde custom-shadow rounded"])},[S(t,{configuracionColumnas:[...a.configuracionColumnasAutorizarGasto,a.accionesTabla],datos:a.listado,accion1:a.botonVerModalGasto,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!0,"mostrar-botones":!1,"tab-options":a.tabAutorizarGasto,onTabSeleccionado:a.filtrarAutorizacionesGasto,tabDefecto:"3",ajustarCeldas:""},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"])],2),S(m,{comportamiento:a.modales,onGuardado:a.guardado,mostrarListado:!1},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var Pe=X(Ga,[["render",ya]]);export{Pe as default};

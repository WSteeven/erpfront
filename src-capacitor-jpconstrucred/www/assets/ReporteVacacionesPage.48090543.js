import{Q as p}from"./QSelect.d8222f79.js";import{c as E,E as w,U as $,be as g,p as k,u as q,e as Q,f as S,s as F,A as R,bH as U,t as I,v as D,y as A,S as L,H as r,D as s,bf as O,B as t,N as T,F as z,R as j,L as n}from"./index.846478c1.js";import"./QPopupProxy.7844573b.js";import{Q as H}from"./QBtnGroup.b7cc3fd9.js";import{Q as M}from"./QPage.b0adedad.js";import{Q as G,a as K}from"./QLayout.a706f694.js";import{u as J,S as W,s as X,A as C}from"./utils.19b149f6.js";import{M as Y}from"./ModalEntidad.5edc5f68.js";import{E as Z}from"./EssentialTable.01bbad48.js";import{E as ee}from"./Empleado.20234ba0.js";import{P as oe}from"./PeriodoController.1fedde87.js";import{C as ae}from"./ContenedorSimpleMixin.1a882cca.js";import{u as te}from"./filtrosListadosGenerales.c330183b.js";import{o as x}from"./recursosHumanos.utils.706e72b6.js";import"./QChip.697486c2.js";import"./QItemSection.ca64420c.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QScrollObserver.5aff62ae.js";import"./QResizeObserver.847ee253.js";import"./QToolbar.2bb5adc4.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./QFile.c3222262.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QBadge.60ffdb76.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./i18n-validators.06501904.js";import"./index.209eea81.js";import"./entidadAuditable.75a46700.js";var se=E({components:{EssentialTable:Z,ModalEntidad:Y},setup(){const a=new ae(ee,new w),{listadosAuxiliares:o}=a.useReferencias(),{obtenerListados:m,cargarVista:u}=a.useComportamiento(),{notificarError:f,notificarAdvertencia:h}=$();g().setQuasar(k()),J().setQuasar(k());const e=new W,B=q(),_=Q([]),v=Q([]),l=S({empleado:null,tipo:null,fecha_inicio:"",fecha_fin:"",fecha_corte:"",solicitante:null,periodo:null,sucursal:null,motivo:null,devolucion:null,todos:!1,tarea:null,transferencia:null,accion:""}),{empleados:V,filtrarEmpleados:N}=te(o);u(async()=>{await m({periodos:{controller:new oe,params:{activo:1}},empleados:{controller:new w,params:{estado:1}}}),v.value=o.periodos,V.value=o.empleados});async function y(P){try{e.activar();const c=R.getInstance(),d=U.URL_BASE+"/"+c.getEndpoint(I.vacaciones)+"/reporte",b="Reporte "+x.filter(i=>i.value==l.tipo)[0].label;switch(P){case"excel":l.accion="excel",await C(d,"POST","blob","xlsx",b,l);break;case"pdf":l.accion="pdf",e.activar(),await C(d,"POST","blob","pdf",b,l),e.desactivar();break;default:l.accion="";const i=await c.post(d,l);i.data.results&&(_.value=i.data.results,i.data.results.length<1&&h("No se obtuvieron resultados"))}e.desactivar()}catch(c){console.log(c),f("Error al obtener reporte")}finally{e.desactivar()}}return{mixin:a,reporte:l,store:B,maskFecha:F,listado:_,periodos:v,empleados:V,filtrarEmpleados:N,opcionesReporteVacaciones:x,buscarReporte:y,ordenarLista:X}}});const le={class:"row q-col-gutter-sm q-pa-sm q-py-md"},re={class:"col-12 col-md-3"},ie={class:"col-12 col-md-3"},ne={class:"col-12 col-md-3"},ce={class:"col-12 col-md-3 q-mb-xl"};const de={class:"col-12 col-md-12 q-mt-md"},pe={class:"text-center"};function me(a,o,m,u,f,h){return A(),L(K,null,{default:r(()=>[s(G,null,{default:r(()=>[s(M,{padding:""},{default:r(()=>[s(O,{class:"rounded-card custom-shadow"},{default:r(()=>[t("div",le,[t("div",re,[o[15]||(o[15]=t("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),s(p,{modelValue:a.reporte.tipo,"onUpdate:modelValue":o[0]||(o[0]=e=>a.reporte.tipo=e),options:a.opcionesReporteVacaciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.label,"option-value":e=>e.value,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ie,[o[16]||(o[16]=t("label",{class:"q-mb-sm block"},"Per\xEDodo",-1)),s(p,{modelValue:a.reporte.periodo,"onUpdate:modelValue":o[1]||(o[1]=e=>a.reporte.periodo=e),options:a.periodos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ne,[o[17]||(o[17]=t("label",{class:"q-mb-sm block"},"Empleado",-1)),s(p,{modelValue:a.reporte.empleado,"onUpdate:modelValue":o[2]||(o[2]=e=>a.reporte.empleado=e),options:a.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"","use-input":"","input-debounce":"0",outlined:"",clearable:"",onFilter:a.filtrarEmpleados,onPopupShow:o[3]||(o[3]=e=>a.ordenarLista(a.empleados,"apellidos")),"option-label":e=>e.apellidos+" "+e.nombres,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])]),t("div",ce,[s(T,{class:"q-mt-lg q-pt-md",modelValue:a.reporte.todos,"onUpdate:modelValue":[o[4]||(o[4]=e=>a.reporte.todos=e),o[5]||(o[5]=()=>a.reporte.empleado=a.reporte.todos?a.reporte.empleado=null:a.reporte.empleado=a.store.user.id)],label:"Todos los empleados",outlined:"",dense:""},null,8,["modelValue"])]),n("",!0),n("",!0),n("",!0),t("div",de,[t("div",pe,[s(H,{push:""},{default:r(()=>[n("",!0),s(j,{color:"positive",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[13]||(o[13]=e=>a.buscarReporte("excel"))},{default:r(()=>[s(z,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),o[22]||(o[22]=t("span",null,"Excel",-1))]),_:1}),n("",!0)]),_:1})])])])]),_:1})]),_:1})]),_:1})]),_:1})}var oo=D(se,[["render",me]]);export{oo as default};

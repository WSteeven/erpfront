var to=Object.defineProperty;var no=(o,e,f)=>e in o?to(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var F=(o,e,f)=>(no(o,typeof e!="symbol"?e+"":e,f),f);import{by as lo,s as Q,d as uo,bc as fo,m as S,u as po,c as b,E as co,a1 as E,q as mo,a2 as vo,A as bo,dr as R,bH as U,_ as ho,v as p,P as _o,F as s,z as i,bd as Fo,be as O,y as n,x as c,G as g,H as w,K as C,D as $,J as Y,I as P,B as y,j as q,O as k,Q as go,ca as wo}from"./index.70185135.js";import{Q as A,a as B}from"./QItemSection.1a41b826.js";import{Q as T}from"./QSelect.b1759751.js";import{Q as N,a as j,C as M}from"./QPopupProxy.c164d2ac.js";import{Q as Co}from"./QPage.f3b97ac0.js";import{T as $o}from"./TabLayout.dfee7537.js";import{u as yo}from"./index.004ff2d8.js";import{C as ko}from"./ContenedorSimpleMixin.0ef3239b.js";import{T as Vo}from"./TipoFonfoController.def192fb.js";import{E as Io}from"./entidadAuditable.75a46700.js";import{u as Qo,A as z,L as I}from"./utils.2eab62de.js";import{a as Lo,r as H}from"./i18n-validators.ea544161.js";import"./QChip.a6a2afa6.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./format.8ac60962.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./buttonSubmits.f728eedc.js";import"./EssentialTable.c4a035e4.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./QBadge.5bb69fff.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./EssentialTablePagination.959d4e60.js";import"./index.9f64ebda.js";class Do extends lo{constructor(){super(Q.fondo_rotativo_fecha_pdf)}}class So extends Io{constructor(){super();F(this,"usuario");F(this,"fecha_inicio");F(this,"fecha_fin");this.usuario=null,this.fecha_inicio=null,this.fecha_fin=null}}var Eo=uo({components:{TabLayout:$o},setup(){fo().setQuasar(S()),Qo().setQuasar(S());const o=po(),e=new ko(So,new Do),{entidad:f,disabled:L,accion:D,listadosAuxiliares:l}=e.useReferencias(),{setValidador:a,obtenerListados:G,cargarVista:J}=e.useComportamiento(),K={usuario:{requiredIfUsuario:Lo(()=>o.can("puede.ver.campo.empleado.fondo_rotativo"))},fecha_inicio:{required:H},fecha_fin:{required:H}},V=yo(K,f);a(V.value);const m=b([]),v=b(),h=b([]),X=b("false"),_=b([]);m.value=l.usuarios,J(async()=>{await G({usuarios:{controller:new co,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Vo,params:{campos:"id,descripcion"}}}),m.value=l.usuarios,v.value=E.getItem("usuariosInactivos")==null?[]:JSON.parse(E.getItem("usuariosInactivos").toString()),l.usuariosInactivos=v.value,h.value=l.tiposFondos,_.value=l.tiposFondoRotativoFechas});function W(r,t){if(r===""){t(()=>{m.value=l.usuarios});return}t(()=>{const d=r.toLowerCase();m.value=l.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function Z(r,t){if(r===""){t(()=>{v.value=l.usuariosInactivos});return}t(()=>{const d=r.toLowerCase();v.value=l.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function x(r,t){if(r===""){t(()=>{h.value=l.tiposFondos});return}t(()=>{const d=r.toLowerCase();h.value=l.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}function oo(r,t){if(r===""){t(()=>{_.value=l.tiposFondoRotativoFechas});return}t(()=>{const d=r.toLowerCase();_.value=l.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}async function eo(r,t){if(await V.value.$validate()){const d=bo.getInstance(),u="reporte_semanal_gastos_del_"+r.fecha_inicio+"_al_"+r.fecha_fin;switch(t){case R.EXCEL:const io=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_excel);z(io,"POST","blob","xlsx",u,r);break;case R.PDF:const ro=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_pdf);z(ro,"POST","blob","pdf",u,r);break}}}function ao(r){const t=I(new Date,"YYYY/MM/DD");return r<=t}function so(r){const t=I(new Date,"YYYY/MM/DD"),d=I(f.fecha_inicio!==null?f.fecha_inicio:new Date,"YYYY/MM/DD");return r>=d&&r<=t}return{mixin:e,fondo_rotativo_fecha:f,disabled:L,accion:D,store:o,v$:V,usuarios:m,usuariosInactivos:v,tiposFondos:h,tiposFondoRotativoFechas:_,maskFecha:mo,is_inactivo:X,generar_reporte:eo,filtrarUsuarios:W,filtrarUsuariosInactivos:Z,filtrarTiposFondos:x,filtrarTiposFondoRotativoFechas:oo,watchEffect:vo,optionsFechaInicio:ao,optionsFechaFin:so}}});const Ro={key:0,class:"col-12 col-md-3"},Uo={class:"error-msg"},Oo={key:1,class:"col-12 col-md-3"},Yo={class:"error-msg"},Po={class:"col-6 col-md-3"},qo={class:"row items-center justify-end"},Ao={class:"error-msg"},Bo={class:"col-6 col-md-3"},To={class:"row items-center justify-end"},No={class:"error-msg"};function jo(o,e,f,L,D,l){return p(),_o(Co,{class:"flex flex-center"},{default:s(()=>[i(Fo,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:s(()=>[i(O,null,{default:s(()=>e[8]||(e[8]=[n("div",{class:"row items-center no-wrap"},[n("div",{class:"col"},[n("div",{class:"text-h6"},"Generar Reporte Fondo Rotativo")])],-1)])),_:1}),i(O,null,{default:s(()=>[o.store.can("puede.ver.campo.empleado.fondo_rotativo")&&o.is_inactivo=="false"?(p(),c("div",Ro,[e[10]||(e[10]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(T,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[0]||(e[0]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onBlur:o.v$.usuario.$touch,onFilter:o.filtrarUsuarios,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),c(g,null,w(o.v$.usuario.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",Uo,C(a.$message),1)]))),128))]),"no-option":s(()=>[i(A,null,{default:s(()=>[i(B,{class:"text-grey"},{default:s(()=>e[9]||(e[9]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onBlur","onFilter","option-value","option-label"])])):Y("",!0),o.is_inactivo=="true"?(p(),c("div",Oo,[e[12]||(e[12]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(T,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[1]||(e[1]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un usuario","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),c(g,null,w(o.v$.usuario.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",Yo,C(a.$message),1)]))),128))]),"no-option":s(()=>[i(A,null,{default:s(()=>[i(B,{class:"text-grey"},{default:s(()=>e[11]||(e[11]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])):Y("",!0),n("div",Po,[e[13]||(e[13]=n("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(P,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(j,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[2]||(e[2]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:s(()=>[n("div",qo,[q(i(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),c(g,null,w(o.v$.fecha_inicio.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",Ao,C(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),n("div",Bo,[e[14]||(e[14]=n("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(P,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=a=>o.fondo_rotativo_fecha.fecha_fin=a),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(j,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[4]||(e[4]=a=>o.fondo_rotativo_fecha.fecha_fin=a),mask:o.maskFecha,"today-btn":"",options:o.optionsFechaFin},{default:s(()=>[n("div",To,[q(i(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),c(g,null,w(o.v$.fecha_fin.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",No,C(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])])]),_:1}),i(go),i(wo,{align:"around"},{default:s(()=>[i(k,{color:"positive",onClick:e[6]||(e[6]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"excel"))},{default:s(()=>[i(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[15]||(e[15]=$("Excel"))]),_:1}),i(k,{color:"negative",onClick:e[7]||(e[7]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"pdf"))},{default:s(()=>[i(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[16]||(e[16]=$("PDF"))]),_:1})]),_:1})]),_:1})]),_:1})}var ye=ho(Eo,[["render",jo]]);export{ye as default};

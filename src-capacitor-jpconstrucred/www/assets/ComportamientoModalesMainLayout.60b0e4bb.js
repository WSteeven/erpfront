var na=Object.defineProperty;var la=(e,a,v)=>a in e?na(e,a,{enumerable:!0,configurable:!0,writable:!0,value:v}):e[a]=v;var se=(e,a,v)=>(la(e,typeof a!="symbol"?a+"":a,v),v);import{Q as ia}from"./QResizeObserver.847ee253.js";import{ad as Qe,b9 as xe,ba as K,bb as Fe,e as V,g as b,w,j as Se,ak as ua,l as W,h as Oe,aI as da,ae as ca,aL as va,ag as fa,aN as ma,aP as pa,bc as ba,n as Be,i as Ae,k as _e,b6 as Me,al as ga,bd as ha,v as oe,c as de,y as h,S as U,H as n,D as i,F as G,R as ae,L as le,b3 as Ee,Y as ke,z as S,B as c,p as De,G as M,a6 as Ce,x as Ie,M as Q,I as j,J as R,u as Ne,be as ya,bf as Ve,bg as wa,bh as $a,K as Le,a7 as ka,E as Ca,V as Sa,a1 as _a,U as Ta,f as qa,A as za,t as Ba,bi as ye}from"./index.846478c1.js";import{T as we}from"./TouchPan.efa9afab.js";import{b as ne}from"./format.8ac60962.js";import{Q as Ma}from"./QCircularProgress.b5ba4a87.js";import{S as Va,a as La}from"./utils.19b149f6.js";import{a as E,Q as Y}from"./QItemSection.ca64420c.js";import{a as ie,Q as ue}from"./QSelect.d8222f79.js";import{Q as Pa}from"./QExpansionItem.a87f342e.js";import{C as $e,a as Qa}from"./ComponenteModal.domain.3bd8db1f.js";import{Q as xa}from"./QForm.0a21c4a5.js";import{m as Fa}from"./tareas.utils.309e0dff.js";import{r as J}from"./i18n-validators.06501904.js";import{u as je}from"./index.15c331c5.js";import{T as Oa}from"./TabLayout.b05b8b79.js";import{E as He}from"./EssentialTable.01bbad48.js";import{T as Aa}from"./TrabajoAsignadoController.e0393075.js";import{C as We}from"./ContenedorSimpleMixin.1a882cca.js";import{M as Ea}from"./MovilizacionSubtareaController.362ed692.js";import{u as Da}from"./movilizacionSubtarea.b7ad97cf.js";import{M as Ia}from"./MovilizacionSubtarea.9a93287f.js";import{c as Na}from"./configuracionColumnasTarea.bcb4cc35.js";import{u as ja}from"./FiltrosListadosTarea.67667058.js";import{T as Ha}from"./TareaController.4af45b78.js";import{u as Wa,T as Ra}from"./tarea.f1f77aea.js";import Ua from"./ModoNoDisponiblePage.f912e6d4.js";var tt=Qe({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:a,emit:v}){const{proxy:{$q:g}}=Oe(),u=xe(Fe,K);if(u===K)return console.error("QHeader needs to be child of QLayout"),K;const f=V(parseInt(e.heightHint,10)),r=V(!0),s=b(()=>e.reveal===!0||u.view.value.indexOf("H")!==-1||g.platform.is.ios&&u.isContainer.value===!0),_=b(()=>{if(e.modelValue!==!0)return 0;if(s.value===!0)return r.value===!0?f.value:0;const l=f.value-u.scroll.value.position;return l>0?l:0}),x=b(()=>e.modelValue!==!0||s.value===!0&&r.value!==!0),t=b(()=>e.modelValue===!0&&x.value===!0&&e.reveal===!0),F=b(()=>"q-header q-layout__section--marginal "+(s.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(x.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),T=b(()=>{const l=u.rows.value.top,y={};return l[0]==="l"&&u.left.space===!0&&(y[g.lang.rtl===!0?"right":"left"]=`${u.left.size}px`),l[2]==="r"&&u.right.space===!0&&(y[g.lang.rtl===!0?"left":"right"]=`${u.right.size}px`),y});function $(l,y){u.update("header",l,y)}function m(l,y){l.value!==y&&(l.value=y)}function k({height:l}){m(f,l),$("size",l)}function C(l){t.value===!0&&m(r,!0),v("focusin",l)}w(()=>e.modelValue,l=>{$("space",l),m(r,!0),u.animate()}),w(_,l=>{$("offset",l)}),w(()=>e.reveal,l=>{l===!1&&m(r,e.modelValue)}),w(r,l=>{u.animate(),v("reveal",l)}),w(u.scroll,l=>{e.reveal===!0&&m(r,l.direction==="up"||l.position<=e.revealOffset||l.position-l.inflectionPoint<100)});const p={};return u.instances.header=p,e.modelValue===!0&&$("size",f.value),$("space",e.modelValue),$("offset",_.value),Se(()=>{u.instances.header===p&&(u.instances.header=void 0,$("size",0),$("offset",0),$("space",!1))}),()=>{const l=ua(a.default,[]);return e.elevated===!0&&l.push(W("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(W(ia,{debounce:0,onResize:k})),W("header",{class:F.value,style:T.value,onFocusin:C},l)}}});const Pe=150;var rt=Qe({name:"QDrawer",inheritAttrs:!1,props:{...da,...ca,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...va,"onLayout","miniState"],setup(e,{slots:a,emit:v,attrs:g}){const u=Oe(),{proxy:{$q:f}}=u,r=fa(e,f),{preventBodyScroll:s}=ha(),{registerTimeout:_,removeTimeout:x}=ma(),t=xe(Fe,K);if(t===K)return console.error("QDrawer needs to be child of QLayout"),K;let F,T=null,$;const m=V(e.behavior==="mobile"||e.behavior!=="desktop"&&t.totalWidth.value<=e.breakpoint),k=b(()=>e.mini===!0&&m.value!==!0),C=b(()=>k.value===!0?e.miniWidth:e.width),p=V(e.showIfAbove===!0&&m.value===!1?!0:e.modelValue===!0),l=b(()=>e.persistent!==!0&&(m.value===!0||Re.value===!0));function y(o,d){if(ce(),o!==!1&&t.animate(),B(0),m.value===!0){const q=t.instances[te.value];q!==void 0&&q.belowBreakpoint===!0&&q.hide(!1),I(1),t.isContainer.value!==!0&&s(!0)}else I(0),o!==!1&&be(!1);_(()=>{o!==!1&&be(!0),d!==!0&&v("show",o)},Pe)}function H(o,d){ve(),o!==!1&&t.animate(),I(0),B(z.value*C.value),ge(),d!==!0?_(()=>{v("hide",o)},Pe):x()}const{show:D,hide:O}=pa({showing:p,hideOnRouteChange:l,handleShow:y,handleHide:H}),{addToHistory:ce,removeFromHistory:ve}=ba(p,O,l),X={belowBreakpoint:m,hide:O},L=b(()=>e.side==="right"),z=b(()=>(f.lang.rtl===!0?-1:1)*(L.value===!0?1:-1)),A=V(0),P=V(!1),Z=V(!1),Te=V(C.value*z.value),te=b(()=>L.value===!0?"left":"right"),fe=b(()=>p.value===!0&&m.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:C.value:0),me=b(()=>e.overlay===!0||e.miniToOverlay===!0||t.view.value.indexOf(L.value?"R":"L")!==-1||f.platform.is.ios===!0&&t.isContainer.value===!0),ee=b(()=>e.overlay===!1&&p.value===!0&&m.value===!1),Re=b(()=>e.overlay===!0&&p.value===!0&&m.value===!1),Ue=b(()=>"fullscreen q-drawer__backdrop"+(p.value===!1&&P.value===!1?" hidden":"")),Je=b(()=>({backgroundColor:`rgba(0,0,0,${A.value*.4})`})),qe=b(()=>L.value===!0?t.rows.value.top[2]==="r":t.rows.value.top[0]==="l"),Ke=b(()=>L.value===!0?t.rows.value.bottom[2]==="r":t.rows.value.bottom[0]==="l"),Ye=b(()=>{const o={};return t.header.space===!0&&qe.value===!1&&(me.value===!0?o.top=`${t.header.offset}px`:t.header.space===!0&&(o.top=`${t.header.size}px`)),t.footer.space===!0&&Ke.value===!1&&(me.value===!0?o.bottom=`${t.footer.offset}px`:t.footer.space===!0&&(o.bottom=`${t.footer.size}px`)),o}),Ge=b(()=>{const o={width:`${C.value}px`,transform:`translateX(${Te.value}px)`};return m.value===!0?o:Object.assign(o,Ye.value)}),Xe=b(()=>"q-drawer__content fit "+(t.isContainer.value!==!0?"scroll":"overflow-auto")),Ze=b(()=>`q-drawer q-drawer--${e.side}`+(Z.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(r.value===!0?" q-drawer--dark q-dark":"")+(P.value===!0?" no-transition":p.value===!0?"":" q-layout--prevent-focus")+(m.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${k.value===!0?"mini":"standard"}`+(me.value===!0||ee.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(qe.value===!0?" q-drawer--top-padding":""))),ea=b(()=>{const o=f.lang.rtl===!0?e.side:te.value;return[[we,ra,void 0,{[o]:!0,mouse:!0}]]}),aa=b(()=>{const o=f.lang.rtl===!0?te.value:e.side;return[[we,ze,void 0,{[o]:!0,mouse:!0}]]}),oa=b(()=>{const o=f.lang.rtl===!0?te.value:e.side;return[[we,ze,void 0,{[o]:!0,mouse:!0,mouseAllDir:!0}]]});function pe(){sa(m,e.behavior==="mobile"||e.behavior!=="desktop"&&t.totalWidth.value<=e.breakpoint)}w(m,o=>{o===!0?(F=p.value,p.value===!0&&O(!1)):e.overlay===!1&&e.behavior!=="mobile"&&F!==!1&&(p.value===!0?(B(0),I(0),ge()):D(!1))}),w(()=>e.side,(o,d)=>{t.instances[d]===X&&(t.instances[d]=void 0,t[d].space=!1,t[d].offset=0),t.instances[o]=X,t[o].size=C.value,t[o].space=ee.value,t[o].offset=fe.value}),w(t.totalWidth,()=>{(t.isContainer.value===!0||document.qScrollPrevented!==!0)&&pe()}),w(()=>e.behavior+e.breakpoint,pe),w(t.isContainer,o=>{p.value===!0&&s(o!==!0),o===!0&&pe()}),w(t.scrollbarWidth,()=>{B(p.value===!0?0:void 0)}),w(fe,o=>{N("offset",o)}),w(ee,o=>{v("onLayout",o),N("space",o)}),w(L,()=>{B()}),w(C,o=>{B(),he(e.miniToOverlay,o)}),w(()=>e.miniToOverlay,o=>{he(o,C.value)}),w(()=>f.lang.rtl,()=>{B()}),w(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(ta(),t.animate())}),w(k,o=>{v("miniState",o)});function B(o){o===void 0?Be(()=>{o=p.value===!0?0:C.value,B(z.value*o)}):(t.isContainer.value===!0&&L.value===!0&&(m.value===!0||Math.abs(o)===C.value)&&(o+=z.value*t.scrollbarWidth.value),Te.value=o)}function I(o){A.value=o}function be(o){const d=o===!0?"remove":t.isContainer.value!==!0?"add":"";d!==""&&document.body.classList[d]("q-body--drawer-toggle")}function ta(){T!==null&&clearTimeout(T),u.proxy&&u.proxy.$el&&u.proxy.$el.classList.add("q-drawer--mini-animate"),Z.value=!0,T=setTimeout(()=>{T=null,Z.value=!1,u&&u.proxy&&u.proxy.$el&&u.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function ra(o){if(p.value!==!1)return;const d=C.value,q=ne(o.distance.x,0,d);if(o.isFinal===!0){q>=Math.min(75,d)===!0?D():(t.animate(),I(0),B(z.value*d)),P.value=!1;return}B((f.lang.rtl===!0?L.value!==!0:L.value)?Math.max(d-q,0):Math.min(0,q-d)),I(ne(q/d,0,1)),o.isFirst===!0&&(P.value=!0)}function ze(o){if(p.value!==!0)return;const d=C.value,q=o.direction===e.side,re=(f.lang.rtl===!0?q!==!0:q)?ne(o.distance.x,0,d):0;if(o.isFinal===!0){Math.abs(re)<Math.min(75,d)===!0?(t.animate(),I(1),B(0)):O(),P.value=!1;return}B(z.value*re),I(ne(1-re/d,0,1)),o.isFirst===!0&&(P.value=!0)}function ge(){s(!1),be(!0)}function N(o,d){t.update(e.side,o,d)}function sa(o,d){o.value!==d&&(o.value=d)}function he(o,d){N("size",o===!0?e.miniWidth:d)}return t.instances[e.side]=X,he(e.miniToOverlay,C.value),N("space",ee.value),N("offset",fe.value),e.showIfAbove===!0&&e.modelValue!==!0&&p.value===!0&&e["onUpdate:modelValue"]!==void 0&&v("update:modelValue",!0),Ae(()=>{v("onLayout",ee.value),v("miniState",k.value),F=e.showIfAbove===!0;const o=()=>{(p.value===!0?y:H)(!1,!0)};if(t.totalWidth.value!==0){Be(o);return}$=w(t.totalWidth,()=>{$(),$=void 0,p.value===!1&&e.showIfAbove===!0&&m.value===!1?D(!1):o()})}),Se(()=>{$!==void 0&&$(),T!==null&&(clearTimeout(T),T=null),p.value===!0&&ge(),t.instances[e.side]===X&&(t.instances[e.side]=void 0,N("size",0),N("offset",0),N("space",!1))}),()=>{const o=[];m.value===!0&&(e.noSwipeOpen===!1&&o.push(_e(W("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),ea.value)),o.push(Me("div",{ref:"backdrop",class:Ue.value,style:Je.value,"aria-hidden":"true",onClick:O},void 0,"backdrop",e.noSwipeBackdrop!==!0&&p.value===!0,()=>oa.value)));const d=k.value===!0&&a.mini!==void 0,q=[W("div",{...g,key:""+d,class:[Xe.value,g.class]},d===!0?a.mini():ga(a.default))];return e.elevated===!0&&p.value===!0&&q.push(W("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),o.push(Me("aside",{ref:"content",class:Ze.value,style:Ge.value},q,"contentclose",e.noSwipeClose!==!0&&m.value===!0,()=>aa.value)),W("div",{class:"q-drawer-container"},o)}}});const Ja=de({setup(){const e=V(!1);function a(){window.scrollTo({top:0,behavior:"smooth"})}const v=()=>{e.value=window.scrollY>100};return Ae(()=>{window.addEventListener("scroll",v)}),Se(()=>{window.removeEventListener("scroll",v)}),{scrollToTop:a,showButton:e}}});function Ka(e,a,v,g,u,f){return e.showButton?(h(),U(ae,{key:0,onClick:e.scrollToTop,class:"scroll-to-top-button"},{default:n(()=>[i(G,{name:"bi-arrow-up-short"})]),_:1},8,["onClick"])):le("",!0)}var st=oe(Ja,[["render",Ka],["__scopeId","data-v-2e198660"]]);const Ya={class:"loading-background"},Ga={__name:"EssentialLoading",setup(e){const a=new Va;return(v,g)=>_e((h(),S("section",Ya,[i(Ma,{indeterminate:"",size:"75px",thickness:.6,color:"primary","center-color":"grey-2",class:"q-ma-md"}),g[0]||(g[0]=c("b",{class:"text-primary"},"Espere, por favor...",-1))],512)),[[Ee,ke(a).estaCargando.value]])}};var nt=Ga;const Xa={__name:"FooterComponent",setup(e){const a=De();return(v,g)=>(h(),S("div",{class:Ce(["footer q-pa-xs text-grey-8 text-uppercase q-safe-area-bottom",{"text-right":!ke(a).platform.is.mobile,"text-center q-mt-lg":ke(a).platform.is.mobile}])},g[0]||(g[0]=[c("small",null,[c("strong",null,"Copyright \xA9 2023"),M(". Todos los derechos reservados por "),c("strong",null,"JP Construcred c. ltda.")],-1)]),2))}};var lt=oe(Xa,[["__scopeId","data-v-7f0a8b00"]]);const Za=de({name:"EssentialLink",props:{title:{type:String,required:!0},link:{type:String,default:"#"},icon:{type:String,default:""},children:{type:Object,required:!1},can:{type:Boolean,default:!0},hasParent:{type:Boolean,default:!1}}}),eo={key:0};function ao(e,a,v,g,u,f){const r=Ie("EssentialLink",!0);return e.can?(h(),S("div",eo,[e.children?(h(),U(Pa,{key:1,clickable:"",tag:"a","active-class":"link-active",exact:"",class:Ce({"bg-desenfoque border-white rounded q-mb-xs":!1,"border-left q-ml-lg":e.hasParent})},{header:n(()=>[e.icon?(h(),U(E,{key:0,avatar:""},{default:n(()=>[i(G,{name:e.icon,size:"xs",class:"text-color-drawer"},null,8,["name"])]),_:1})):le("",!0),i(E,null,{default:n(()=>[i(ie,{class:"text-color-drawer-bold textf-bold"},{default:n(()=>[M(Q(e.title),1)]),_:1})]),_:1})]),default:n(()=>[(h(!0),S(j,null,R(e.children,s=>{var _;return h(),S("div",{key:s.title},[i(r,{title:(_=s.title)!=null?_:"",link:s.link,icon:s.icon,children:s.children,can:s.can,hasParent:""},null,8,["title","link","icon","children","can"])])}),128))]),_:1},8,["class"])):(h(),U(Y,{key:0,clickable:"",tag:"a",to:e.link,"active-class":"link-active",class:Ce([{"border-left q-ml-lg":e.hasParent},"text-color-drawer"]),exact:""},{default:n(()=>[e.icon?(h(),U(E,{key:0,avatar:""},{default:n(()=>[i(G,{name:e.icon,size:"xs"},null,8,["name"])]),_:1})):le("",!0),i(E,null,{default:n(()=>[i(ie,null,{default:n(()=>[M(Q(e.title),1)]),_:1})]),_:1})]),_:1},8,["to","class"]))])):le("",!0)}var it=oe(Za,[["render",ao]]),oo=de({components:{TabLayout:Oa,EssentialTable:He},emits:["cerrar-modal"],setup(e,{emit:a}){const v=Da(),g=Ne();ya().setQuasar(De());const u=new We(Ia,new Ea),{entidad:f,disabled:r,accion:s,listadosAuxiliares:_}=u.useReferencias(),{cargarVista:x,obtenerListados:t,setValidador:F,guardar:T}=u.useComportamiento();x(async()=>{await t({subtareas:{controller:new Aa,params:{estado:"MOVILIZACION"}}}),k.value=_.subtareas});const m=je({subtarea:{required:J},motivo:{required:J},longitud:{required:J},latitud:{required:J}},f);F(m.value);const k=V();function C(y,H){if(y===""){H(()=>{k.value=_.clientes});return}H(()=>{const D=y.toLowerCase();k.value=_.subtareas.filter(O=>O.codigo_subtarea.toLowerCase().indexOf(D)>-1)})}async function p(){await T(f)&&(v.getSubtareaDestino(g.user.id),a("cerrar-modal",!1))}function l(){La(y=>{f.latitud=y.coords.latitude,f.longitud=y.coords.longitude})}return{mixin:u,movilizacion:f,disabled:r,accion:s,v$:m,filtrarSubtareas:C,subtareas:k,comenzar:p,motivosMovilizacion:Fa,obtenerCoordenadas:l}}});const to={class:"row q-col-gutter-xs"},ro={class:"col-12 col-md-6"},so={class:"error-msg"},no={class:"col-12 col-md-6"},lo={class:"error-msg"},io={class:"col-12 col-md-4 q-mx-auto q-mb-xl"},uo={class:"col-12"},co={class:"error-msg"},vo={class:"col-12"},fo={class:"error-msg"},mo={class:"row"};function po(e,a,v,g,u,f){return h(),U(xa,{onSubmit:a[6]||(a[6]=ka(()=>{},["prevent"])),class:""},{default:n(()=>[i(Ve,{class:"rounded-card custom-shadow"},{default:n(()=>[i(wa,null,{default:n(()=>[c("div",to,[c("div",ro,[a[8]||(a[8]=c("label",{class:"q-mb-sm block"},"Me dirijo al siguiente trabajo",-1)),i(ue,{modelValue:e.movilizacion.subtarea,"onUpdate:modelValue":a[0]||(a[0]=r=>e.movilizacion.subtarea=r),options:e.subtareas,error:!!e.v$.subtarea.$errors.length,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":r=>r.codigo_subtarea+" - "+r.titulo,"option-value":r=>r.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{option:n(r=>[i(Y,$a(r.itemProps,{class:"q-my-sm"}),{default:n(()=>[i(E,null,{default:n(()=>[i(ie,{class:"text-bold text-primary"},{default:n(()=>[M(Q(r.opt.codigo_subtarea),1)]),_:2},1024),i(ie,{caption:""},{default:n(()=>[M(Q(r.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":n(()=>[i(Y,null,{default:n(()=>[i(E,{class:"text-grey"},{default:n(()=>a[7]||(a[7]=[M(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,R(e.v$.subtarea.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",so,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","options","error","disable","option-label","option-value"])]),c("div",no,[a[10]||(a[10]=c("label",{class:"q-mb-sm block"},"Motivo",-1)),i(ue,{modelValue:e.movilizacion.motivo,"onUpdate:modelValue":a[1]||(a[1]=r=>e.movilizacion.motivo=r),options:e.motivosMovilizacion,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":r=>r.descripcion,"option-value":r=>r.id,"emit-value":"","map-options":"",error:!!e.v$.motivo.$errors.length,onBlur:e.v$.motivo.$touch},{"no-option":n(()=>[i(Y,null,{default:n(()=>[i(E,{class:"text-grey"},{default:n(()=>a[9]||(a[9]=[M(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,R(e.v$.motivo.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",lo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","options","option-label","option-value","error","onBlur"])]),c("div",io,[i(Ve,{flat:"",class:"custom-shadows nso-border q-pa-md"},{default:n(()=>[a[14]||(a[14]=c("label",{class:"q-mb-sm text-center block text-bold"},"Coordenadas",-1)),c("div",uo,[a[11]||(a[11]=c("label",{class:"q-mb-sm block"},"Longitud",-1)),i(Le,{modelValue:e.movilizacion.longitud,"onUpdate:modelValue":a[2]||(a[2]=r=>e.movilizacion.longitud=r),error:!!e.v$.longitud.$errors.length,outlined:"",dense:"",disable:""},{error:n(()=>[(h(!0),S(j,null,R(e.v$.longitud.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",co,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),c("div",vo,[a[12]||(a[12]=c("label",{class:"q-mb-sm block"},"Latitud",-1)),i(Le,{modelValue:e.movilizacion.latitud,"onUpdate:modelValue":a[3]||(a[3]=r=>e.movilizacion.latitud=r),error:!!e.v$.latitud.$errors.length,outlined:"",dense:"",disable:""},{error:n(()=>[(h(!0),S(j,null,R(e.v$.latitud.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",fo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),i(ae,{color:"positive","no-caps":"","no-wrap":"",class:"full-width",onClick:a[4]||(a[4]=r=>e.obtenerCoordenadas()),disable:e.disabled},{default:n(()=>[i(G,{name:"bi-geo-alt",size:"xs",class:"q-mr-xs"}),a[13]||(a[13]=M(" Actualizar ubicaci\xF3n"))]),_:1},8,["disable"])]),_:1})])]),c("div",mo,[i(ae,{class:"col-12",color:"primary",type:"submit","no-caps":"",onClick:a[5]||(a[5]=r=>e.comenzar())},{default:n(()=>[i(G,{name:"bi-car-front-fill",size:"xs",class:"q-pr-sm"}),a[15]||(a[15]=c("span",null,"Comenzar viaje",-1))]),_:1})])]),_:1})]),_:1})]),_:1})}var bo=oe(oo,[["render",po]]),go=de({components:{EssentialTable:He},emits:["cerrar-modal","guardado"],setup(e,{emit:a}){const v=Wa(),g=Ne(),u=new We(Ra,new Ha),{listar:f,cargarVista:r,obtenerListados:s}=u.useComportamiento(),{listado:_,listadosAuxiliares:x}=u.useReferencias();r(async()=>{await s({coordinadores:{controller:new Ca,params:{rol:Sa.coordinador,campos:"id,nombres,apellidos"}}}),y.value=x.coordinadores});const t=V(),F=_a(),{notificarAdvertencia:T,notificarCorrecto:$,confirmar:m}=Ta(),k=qa({actual_coordinador:null,nuevo_coordinador:null}),C=g.esCoordinadorBackup||g.esJefeTecnico;g.esCoordinador&&!g.esCoordinadorBackup&&!g.esJefeTecnico&&(f({finalizado:!1}),k.actual_coordinador=g.user.id);const l=je({actual_coordinador:{required:J},nuevo_coordinador:{required:J}},k),{coordinadores:y,filtrarCoordinadores:H}=ja(x);async function D(z){if(!z.length)return T("Debe seleccionar al menos una tarea para transferir");if(await l.value.$validate())try{m("\xBFEst\xE1 seguro de realizar la transferencia?",async()=>{const A=za.getInstance(),P=A.getEndpoint(Ba.transferir_mis_tareas_activas),Z=await A.post(P,{nuevo_coordinador:k.nuevo_coordinador,ids_tareas:z});$(Z.data.mensaje),v.recargaTareasActivas=!0,a("cerrar-modal",!1)})}catch(A){T(A)}}function O(){f({coordinador_id:k.actual_coordinador,finalizado:!1}),t.value.clearSelection()}async function ce(){a("cerrar-modal",!1),await F.replace({name:"tareas"})}function ve(){a("cerrar-modal",!1)}return{v$:l,refTareas:t,transferencia:k,coordinadores:y,filtrarCoordinadores:H,listado:_,irControlTareas:ce,configuracionColumnasTarea:Na,puedeSeleccionarActualCoordinador:C,transferir:D,cancelar:ve,filtrarTareasPorCoordinador:O,seleccionarTareas:()=>{t.value.seleccionar()},tareasSeleccionadas:z=>{console.log(z);const A=z.map(P=>P.id);D(A)}}}});const ho={class:"row q-col-gutter-sm"},yo={class:"col-12 col-md-6"},wo={class:"error-msg"},$o={class:"col-12 col-md-6"},ko={class:"error-msg"},Co={class:"row justify-end q-gutter-x-xs q-mb-md"},So={class:"row justify-center q-mb-md"},_o={class:"col-12"};function To(e,a,v,g,u,f){const r=Ie("essential-table");return h(),S(j,null,[c("div",ho,[c("div",yo,[a[6]||(a[6]=c("label",{class:"q-mb-sm block"},"Actual coordinador responsable",-1)),i(ue,{modelValue:e.transferencia.actual_coordinador,"onUpdate:modelValue":[a[0]||(a[0]=s=>e.transferencia.actual_coordinador=s),a[1]||(a[1]=s=>e.filtrarTareasPorCoordinador())],options:e.coordinadores,onFilter:e.filtrarCoordinadores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:!e.puedeSeleccionarActualCoordinador,"option-label":s=>s.nombres+" "+s.apellidos,"option-value":s=>s.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",onBlur:e.v$.actual_coordinador.$touch,error:!!e.v$.actual_coordinador.$errors.length},{"no-option":n(()=>[i(Y,null,{default:n(()=>[i(E,{class:"text-grey"},{default:n(()=>a[5]||(a[5]=[M(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,R(e.v$.actual_coordinador.$errors,s=>(h(),S("div",{key:s.$uid},[c("div",wo,Q(s.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","onBlur","error"])]),c("div",$o,[a[8]||(a[8]=c("label",{class:"q-mb-sm block"},"Nuevo coordinador responsable",-1)),i(ue,{modelValue:e.transferencia.nuevo_coordinador,"onUpdate:modelValue":a[2]||(a[2]=s=>e.transferencia.nuevo_coordinador=s),options:e.coordinadores,onFilter:e.filtrarCoordinadores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":s=>s.nombres+" "+s.apellidos,"option-value":s=>s.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",onBlur:e.v$.nuevo_coordinador.$touch,error:!!e.v$.nuevo_coordinador.$errors.length},{"no-option":n(()=>[i(Y,null,{default:n(()=>[i(E,{class:"text-grey"},{default:n(()=>a[7]||(a[7]=[M(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,R(e.v$.nuevo_coordinador.$errors,s=>(h(),S("div",{key:s.$uid},[c("div",ko,Q(s.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","option-label","option-value","onBlur","error"])])]),c("div",Co,[i(ae,{color:"primary","no-caps":"",push:"",onClick:a[3]||(a[3]=s=>e.seleccionarTareas()),disable:!e.listado.length},{default:n(()=>[i(G,{name:"bi-arrow-left-right",class:"q-mr-sm",size:"xs"}),a[9]||(a[9]=M(" Transferir al nuevo coordinador"))]),_:1},8,["disable"]),i(ae,{color:"negative","no-caps":"",push:"",icon:"bi-x",onClick:a[4]||(a[4]=s=>e.cancelar())},{default:n(()=>a[10]||(a[10]=[M("Cancelar")])),_:1})]),c("div",So,[c("div",_o,[_e(i(r,{ref:"refTareas",titulo:"Hay un total de "+e.listado.length+" tareas activas.",configuracionColumnas:e.configuracionColumnasTarea,datos:e.listado,separador:"cell",permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-botones":!1,permitirFiltrar:!1,mostrarFooter:!1,"alto-fijo":!1,"ajustar-celdas":!0,"tipo-seleccion":"multiple",onSelected:e.tareasSeleccionadas},null,8,["titulo","configuracionColumnas","datos","onSelected"]),[[Ee,e.listado.length]])])])],64)}var qo=oe(go,[["render",To]]);class zo{constructor(){se(this,"MovilizacionSubtareaPage");se(this,"TranferirTareaPage");se(this,"ModoNoDisponiblePage");this.MovilizacionSubtareaPage=ye(new $e("Movilizaci\xF3n entre trabajos",bo)),this.TranferirTareaPage=ye(new $e("Transferir tareas activas",qo)),this.ModoNoDisponiblePage=ye(new $e("Configurar modo No Disponible",Ua))}}class ut extends Qa{constructor(){super(new zo)}}export{ut as C,it as E,lt as F,tt as Q,st as S,nt as a,rt as b};

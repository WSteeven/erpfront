var W=Object.defineProperty;var X=(e,o,d)=>o in e?W(e,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[o]=d;var r=(e,o,d)=>(X(e,typeof o!="symbol"?o+"":o,d),d);import{Q as b,a as g}from"./QItemSection.ca64420c.js";import{Q as V}from"./QSelect.d8222f79.js";import{A as Y,t as Z,c as x,be as ee,p as oe,u as ae,U as ie,e as de,E as te,cA as se,v as re,x as le,y as n,S as ne,H as i,D as t,B as s,z as m,J as $,I as y,G as f,aa as me,L as _,K as ue,a7 as pe,M as j}from"./index.846478c1.js";import{Q as ve}from"./QForm.0a21c4a5.js";import{E as ce}from"./entidadAuditable.75a46700.js";import{T as fe}from"./TabLayoutFilterTabs2.94e4b3e1.js";import{u as be}from"./index.15c331c5.js";import{C as ge}from"./ContenedorSimpleMixin.1a882cca.js";import{V as Ve}from"./VendedorController.a532027a.js";import{M as $e}from"./ModalidadController.3de0df0d.js";import{r as w}from"./i18n-validators.06501904.js";import{u as ye}from"./filtrosListadosGenerales.c330183b.js";import{S as je,s as we}from"./utils.19b149f6.js";import{t as Ce}from"./ventas.utils.b757673b.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./QPopupProxy.7844573b.js";import"./QPage.b0adedad.js";import"./EssentialTableTabs.d6bee6af.js";import"./QBadge.60ffdb76.js";import"./EssentialTablePagination.3349ebcb.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBtnGroup.b7cc3fd9.js";import"./EssentialTable.01bbad48.js";import"./QFile.c3222262.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./buttonSubmits.31738227.js";import"./index.209eea81.js";class Ee extends ce{constructor(){super();r(this,"id");r(this,"empleado");r(this,"empleado_id");r(this,"empleado_info");r(this,"modalidad");r(this,"modalidad_id");r(this,"modalidad_info");r(this,"tipo_vendedor");r(this,"jefe_inmediato");r(this,"jefe_inmediato_info");r(this,"causa_desactivacion");r(this,"activo");this.id=null,this.empleado=null,this.empleado_id=null,this.empleado_info=null,this.modalidad=null,this.modalidad_id=null,this.modalidad_info=null,this.tipo_vendedor=null,this.jefe_inmediato=null,this.jefe_inmediato_info=null,this.causa_desactivacion=null,this.activo=!0}}const he=[{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"modalidad_info",field:"modalidad_info",label:"Modalidad",align:"left",sortable:!0},{name:"tipo_vendedor",field:"tipo_vendedor",label:"Tipo Vendedor",align:"left",sortable:!0},{name:"jefe_inmediato_info",field:"jefe_inmediato_info",label:"Jefe Inmediato",align:"left",sortable:!0},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class M{constructor(){r(this,"axios");this.axios=Y.getInstance()}async anular(o,d){return this.solicitud("/desactivar/",o,d)}async solicitud(o,d,p){const v=this.axios.getEndpoint(Z.vendedores_claro)+o+d,u=await this.axios.post(v,p);return{response:u,result:u.data.modelo}}}var ke=x({components:{TabLayoutFilterTabs2:fe},setup(e,{emit:o}){ee().setQuasar(oe());const d=new je,p=ae(),v=new ge(Ee,new Ve),{entidad:u,disabled:C,accion:a,listadosAuxiliares:E,listado:k}=v.useReferencias(),{setValidador:I,obtenerListados:L,cargarVista:T,listar:U}=v.useComportamiento(),{onGuardado:O,onModificado:P,onReestablecer:H}=v.useHooks(),{confirmar:B,notificarCorrecto:D,prompt:F,notificarError:A}=ie();H(()=>u.jefe_inmediato=p.user.id),O((l,c)=>{o("cerrar-modal",!1),o("guardado",{formulario:"VendedorPage",id:l,modelo:c.modelo})}),P(()=>u.jefe_inmediato=p.user.id);const S=de("1"),{empleados:q,filtrarEmpleados:J,modalidades:N,filtrarModalidades:R}=ye(E);T(async()=>{await L({empleados:{controller:new te,params:{departamento_id:9,"or[departamento_id]":13,estado:1}},modalidades:{controller:new $e,params:{campos:"id,nombre"}}}),u.jefe_inmediato=p.user.id,q.value=E.empleados,N.value=E.modalidades});const Q=be({empleado:{required:w},modalidad:{required:w},tipo_vendedor:{required:w},jefe_inmediato:{required:w}},u);I(Q.value);function G(l){S.value=l,U({activo:l})}return{mixin:v,vendedor:u,disabled:C,accion:a,v$:Q,configuracionColumnas:he,tabOptionsVendedores:Ce,tabDefecto:S,empleados:q,modalidades:N,tipos_vendedores:se,ordenarLista:we,filtrarEmpleados:J,filtrarModalidades:R,filtrarVendedores:G,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar Vendedor",accion:({entidad:l,posicion:c})=>{B("\xBFEst\xE1 seguro de activar el proveedor?",()=>{F({titulo:"Causa de activaci\xF3n",mensaje:"Ingresa el motivo por el que quieres activar este proveedor?",accion:async h=>{try{d.activar(),await new M().anular(l.id,{causa_desactivacion:h}),k.value.splice(c,1),D("Activado correctamente")}catch{A("No se pudo activar el vendedor!")}finally{d.desactivar()}}})})},visible:({entidad:l})=>!l.activo&&p.can("puede.activar.vendedores_claro")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar Vendedor",accion:({entidad:l,posicion:c})=>{B("\xBFEst\xE1 seguro de desactivar el vendedor?",()=>{F({titulo:"Causa de desactivaci\xF3n",mensaje:"Ingresa el motivo por el que quieres desactivar este vendedor?",accion:async h=>{try{d.activar(),await new M().anular(l.id,{causa_desactivacion:h}),k.value.splice(c,1),D("Desactivado correctamente")}catch{A("No se pudo desactivar el vendedor!")}finally{d.desactivar()}}})})},visible:({entidad:l})=>l.activo&&p.can("puede.desactivar.vendedores_claro")}}}});const Be={class:"row q-col-gutter-sm q-mb-md"},De={class:"col-12 col-md-3 col-sm-6"},Fe={class:"error-msg"},Ae={class:"col-12 col-md-3 col-sm-6"},Se={class:"error-msg"},qe={class:"col-12 col-md-3 col-sm-6"},Ne={class:"error-msg"},Qe={class:"col-12 col-md-3 col-sm-6"},_e={class:"error-msg"},Me={key:0,class:"col-12 col-md-3"},Ie={key:1,class:"col-12 col-md-3"};function Le(e,o,d,p,v,u){const C=le("tab-layout-filter-tabs-2");return n(),ne(C,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:!0,accion1:e.btnDesactivar,accion2:e.btnActivar,puedeExportar:"","tab-options":e.tabOptionsVendedores,tabDefecto:e.tabDefecto,filtrar:e.filtrarVendedores},{formulario:i(()=>[t(ve,{onSubmit:o[8]||(o[8]=pe(()=>{},["prevent"]))},{default:i(()=>[s("div",Be,[s("div",De,[o[10]||(o[10]=s("label",{class:"q-mb-sm block"},"Jefe inmediato",-1)),t(V,{modelValue:e.vendedor.jefe_inmediato,"onUpdate:modelValue":o[0]||(o[0]=a=>e.vendedor.jefe_inmediato=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.jefe_inmediato.$errors.length,onBlur:e.v$.jefe_inmediato.$touch,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onPopupShow:o[1]||(o[1]=a=>e.ordenarLista(e.empleados,"apellidos")),onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.jefe_inmediato.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Fe,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[9]||(o[9]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",Ae,[o[12]||(o[12]=s("label",{class:"q-mb-sm block"},"Empleado",-1)),t(V,{modelValue:e.vendedor.empleado,"onUpdate:modelValue":o[2]||(o[2]=a=>e.vendedor.empleado=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.empleado.$errors.length,onBlur:e.v$.empleado.$touch,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onPopupShow:o[3]||(o[3]=a=>e.ordenarLista(e.empleados,"apellidos")),onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.empleado.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Se,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[11]||(o[11]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",qe,[o[14]||(o[14]=s("label",{class:"q-mb-sm block"},"Modalidad",-1)),t(V,{modelValue:e.vendedor.modalidad,"onUpdate:modelValue":o[4]||(o[4]=a=>e.vendedor.modalidad=a),options:e.modalidades,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.modalidad.$errors.length,onBlur:e.v$.modalidad.$touch,"error-message":"Debes seleccionar un modalidad","use-input":"","input-debounce":"0",onFilter:e.filtrarModalidades,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.modalidad.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Ne,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[13]||(o[13]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",Qe,[o[16]||(o[16]=s("label",{class:"q-mb-sm block"},"Tipo de Vendedor",-1)),t(V,{modelValue:e.vendedor.tipo_vendedor,"onUpdate:modelValue":o[5]||(o[5]=a=>e.vendedor.tipo_vendedor=a),options:e.tipos_vendedores,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","input-debounce":0,"use-input":"",hint:"Obligatorio",error:!!e.v$.tipo_vendedor.$errors.length,onBlur:e.v$.tipo_vendedor.$touch,"option-value":a=>a.nombre,"option-label":a=>a.descripcion,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.tipo_vendedor.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",_e,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[15]||(o[15]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onBlur","option-value","option-label"])]),e.vendedor.activo?_("",!0):(n(),m("div",Me,[o[17]||(o[17]=s("br",null,null,-1)),t(me,{modelValue:e.vendedor.activo,"onUpdate:modelValue":o[6]||(o[6]=a=>e.vendedor.activo=a),"checked-icon":"check",disable:e.disabled,label:e.vendedor.activo?"Activo":"Inactivo",color:"positive"},null,8,["modelValue","disable","label"])])),e.vendedor.activo?_("",!0):(n(),m("div",Ie,[o[18]||(o[18]=s("label",{class:"q-mb-sm block"},"Causa de desactivaci\xF3n",-1)),t(ue,{modelValue:e.vendedor.causa_desactivacion,"onUpdate:modelValue":o[7]||(o[7]=a=>e.vendedor.causa_desactivacion=a),placeholder:"Obligatorio",autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])]))])]),_:1})]),default:i(()=>[o[19]||(o[19]=f(" > "))]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var So=re(ke,[["render",Le]]);export{So as default};

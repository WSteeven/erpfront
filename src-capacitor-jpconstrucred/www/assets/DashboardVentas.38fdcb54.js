import{c as Z,e as u,g as x,f as oo,s as eo,q as ao,v as so,x as D,y as l,S as P,H as r,D as s,bf as f,bg as R,B as t,F as C,G as b,K as z,k as I,R as v,z as i,I as y,J as k,M as d,O as ro,P as to,L as c,a6 as lo}from"./index.846478c1.js";import{Q as V,a as w}from"./QItemSection.ca64420c.js";import{Q as L,a as O}from"./QSelect.d8222f79.js";import{Q as A,a as N,C as M}from"./QPopupProxy.7844573b.js";import{Q as io}from"./QBtnGroup.b7cc3fd9.js";import{a as no,Q as j}from"./QTabPanels.ca44a1cd.js";import{Q as uo}from"./QPage.b0adedad.js";import{u as mo}from"./index.15c331c5.js";import{r as H}from"./i18n-validators.06501904.js";import{T as co}from"./TabLayout.b05b8b79.js";import{E as po,S as fo,k as bo}from"./EssentialTable.01bbad48.js";import{M as vo}from"./ModalEntidad.5edc5f68.js";import{G as go}from"./GraficoGenerico.55ab3015.js";import{B as ho,P as Co}from"./index.dcacde50.js";import{C as yo}from"./ContenedorSimpleMixin.1a882cca.js";import{P as ko,a as qo,u as $o,c as Po}from"./prefactura.11c8e649.js";import{u as Vo}from"./filtrosListadosGenerales.c330183b.js";import{C as wo}from"./ClientesPrefacturasController.418e9cd2.js";import{v as Qo}from"./utils.19b149f6.js";import{o as So}from"./graficoGenerico.2759c2ea.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./index.209eea81.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./buttonSubmits.31738227.js";import"./EssentialTablePagination.3349ebcb.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBadge.60ffdb76.js";import"./QFile.c3222262.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./chart.2729d76a.js";import"./entidadAuditable.75a46700.js";var Bo=Z({components:{TabLayout:co,EssentialTable:po,SelectorImagen:fo,TableView:bo,Bar:ho,Pie:Co,ModalesEntidad:vo,GraficoGenerico:go},setup(){const o=new yo(ko,new qo),{listadosAuxiliares:e}=o.useReferencias(),{cargarVista:Q,obtenerListados:S}=o.useComportamiento(),B=$o(),F="PROVEEDOR",g=u(),h=u(),a=u(),m=u([]),q=u(),J=u(),U=u(),E=u(!1),K=x(()=>p.fecha_inicio&&p.fecha_fin),p=oo({fecha_inicio:"",fecha_fin:"",proveedor:null,empleado:null,todos:!1,tipo:""}),$={grafico:"grafico",listado:"listado"},G=u($.grafico),{clientes:T,filtrarClientes:W}=Vo(e);Q(async()=>{await S({clientes:new wo}),T.value=e.clientes,p.fecha_fin=Qo(eo)});const _=mo({fecha_inicio:{required:H},fecha_fin:{required:H}},p);async function X(){if(await _.value.$validate())try{const n=await B.consultarDashboard(p);g.value=n.cant_prefacturas_creadas,h.value=n.cant_prefacturas_anuladas,a.value=n.todas,q.value=n.graficos,U.value=n,E.value=!(q.value.length>1)}catch(n){console.log(n)}}function Y(n,ae){J.value=n.label,m.value=U.value[n.label.toLowerCase()],G.value=$.listado}return{v$:_,dashboard:p,configuracionColumnas:Po,accionesTabla:ao,cantPrefacturasCreadas:g,cantPrefacturasAnuladas:h,prefacturas:a,prefacturasFiltradas:m,graficos:q,optionsPie:So,modoUnaColumna:E,tabs:G,opcionesGrafico:$,mostrarTitulosSeccion:K,PROVEEDOR:F,clientes:T,filtrarClientes:W,consultar:X,clickGrafico:Y}}});const Fo={class:"border-1 text-primary text-bold q-mb-lg"},Uo={class:"row q-col-gutter-sm q-mb-md"},Eo={class:"col-12 col-md-3"},Go={class:"col-12 col-md-3"},To={class:"row items-center justify-end"},_o={class:"error-msg"},Do={class:"col-12 col-md-3"},Ro={class:"row items-center justify-end"},zo={class:"error-msg"},Io={key:0,class:"col-12 col-md-3"},Lo={class:"error-msg"},Oo={class:"row q-col-gutter-sm q-mb-lg"},Ao={class:"col-12 col-md-12 q-mb-lg"},No={class:"row q-col-gutter-xs"},Mo={key:0,class:"col-6"},jo={class:"text-h3 q-mb-md"},Ho={key:1,class:"col-6 col-md-3"},Jo={class:"text-h3 text-primary q-mb-md"},Ko={key:2,class:"col-6 col-md-3"},Wo={class:"text-h3 q-mb-md"},Xo={class:"q-mb-xl q-gutter-y-md column items-center"},Yo={class:"text-subtitle2 q-mb-lg"},Zo={class:"row q-col-gutter-sm q-py-md q-mb-lg"},xo={class:"col-12"};function oe(o,e,Q,S,B,F){const g=D("grafico-generico"),h=D("essential-table");return l(),P(uo,{padding:""},{default:r(()=>[s(f,{class:"q-mb-md rounded no-border custom-shadow"},{default:r(()=>[s(R,null,{default:r(()=>[t("div",Fo,[s(C,{name:"bi-graph-up-arrow",class:"q-mr-sm"}),e[14]||(e[14]=b(" An\xE1lisis de datos: Prefacturas "))]),t("div",Uo,[t("div",Eo,[e[16]||(e[16]=t("label",{class:"q-mb-sm block"},"Seleccione el cliente",-1)),s(L,{modelValue:o.dashboard.cliente,"onUpdate:modelValue":[e[0]||(e[0]=a=>o.dashboard.cliente=a),e[1]||(e[1]=a=>o.consultar())],options:o.clientes,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",clearable:"","option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":r(()=>[s(V,null,{default:r(()=>[s(w,{class:"text-grey"},{default:r(()=>e[15]||(e[15]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),t("div",Go,[e[17]||(e[17]=t("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),s(z,{modelValue:o.dashboard.fecha_inicio,"onUpdate:modelValue":e[4]||(e[4]=a=>o.dashboard.fecha_inicio=a),error:!!o.v$.fecha_inicio.$errors.length,onBlur:o.v$.fecha_inicio.$touch,outlined:"",dense:""},{append:r(()=>[s(C,{name:"event",class:"cursor-pointer"},{default:r(()=>[s(A,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[s(N,{modelValue:o.dashboard.fecha_inicio,"onUpdate:modelValue":[e[2]||(e[2]=a=>o.dashboard.fecha_inicio=a),e[3]||(e[3]=a=>o.consultar())],mask:o.maskFecha,"today-btn":""},{default:r(()=>[t("div",To,[I(s(v,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:r(()=>[(l(!0),i(y,null,k(o.v$.fecha_inicio.$errors,a=>(l(),i("div",{key:a.$uid},[t("div",_o,d(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])]),t("div",Do,[e[18]||(e[18]=t("label",{class:"q-mb-sm block"},"Fecha de fin",-1)),s(z,{modelValue:o.dashboard.fecha_fin,"onUpdate:modelValue":e[7]||(e[7]=a=>o.dashboard.fecha_fin=a),error:!!o.v$.fecha_fin.$errors.length,onBlur:o.v$.fecha_fin.$touch,outlined:"",dense:""},{append:r(()=>[s(C,{name:"event",class:"cursor-pointer"},{default:r(()=>[s(A,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[s(N,{modelValue:o.dashboard.fecha_fin,"onUpdate:modelValue":[e[5]||(e[5]=a=>o.dashboard.fecha_fin=a),e[6]||(e[6]=a=>o.consultar())],mask:o.maskFecha,"today-btn":""},{default:r(()=>[t("div",Ro,[I(s(v,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:r(()=>[(l(!0),i(y,null,k(o.v$.fecha_fin.$errors,a=>(l(),i("div",{key:a.$uid},[t("div",zo,d(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])]),o.dashboard.tipo==o.PROVEEDOR?(l(),i("div",Io,[e[20]||(e[20]=t("label",{class:"q-mb-sm block"},"Seleccione un proveedor",-1)),s(L,{modelValue:o.dashboard.proveedor,"onUpdate:modelValue":[e[8]||(e[8]=a=>o.dashboard.proveedor=a),o.consultar],options:o.proveedores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",clearable:"","use-input":"","input-debounce":"0",error:!!o.v$.proveedor.$errors.length,onBlur:o.v$.proveedor.$touch,onFilter:o.filtrarProveedores,onPopupShow:e[9]||(e[9]=a=>o.ordenarLista(o.proveedores,"razon_social")),"option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:r(a=>[s(V,ro(to(a.itemProps)),{default:r(()=>[s(w,null,{default:r(()=>[s(O,null,{default:r(()=>[b(d(a.opt.razon_social),1)]),_:2},1024),s(O,{caption:""},{default:r(()=>[b(d(a.opt.nombre_comercial)+" - Sucursal: "+d(a.opt.sucursal||a.opt.direccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[s(V,null,{default:r(()=>[s(w,{class:"text-grey"},{default:r(()=>e[19]||(e[19]=[b(" No hay resultados ")])),_:1})]),_:1})]),error:r(()=>[(l(!0),i(y,null,k(o.v$.proveedor.$errors,a=>(l(),i("div",{key:a.$uid},[t("div",Lo,d(a.$message),1)]))),128))]),_:1},8,["modelValue","options","error","onBlur","onFilter","onUpdate:modelValue","option-label","option-value"])])):c("",!0)])]),_:1})]),_:1}),s(f,{class:"q-mb-md rounded no-border custom-shadow"},{default:r(()=>[e[24]||(e[24]=t("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Informaci\xF3n de las prefacturas ",-1)),s(R,null,{default:r(()=>{var a;return[t("div",Oo,[t("div",Ao,[t("div",No,[((a=o.prefacturas)==null?void 0:a.length)>=0?(l(),i("div",Mo,[s(f,{class:"rounded-card text-white no-border q-pa-md text-center full-height cursor-pointer bg-primary"},{default:r(()=>{var m;return[t("div",jo,d((m=o.prefacturas)==null?void 0:m.length),1),e[21]||(e[21]=t("div",{class:"text-bold"},"Cantidad de prefacturas totales",-1))]}),_:1})])):c("",!0),o.cantPrefacturasCreadas>=0?(l(),i("div",Ho,[s(f,{class:"rounded-card q-pa-md text-center full-height"},{default:r(()=>[t("div",Jo,d(o.cantPrefacturasCreadas),1),e[22]||(e[22]=t("div",null,"Cantidad de prefacturas creadas",-1))]),_:1})])):c("",!0),o.cantPrefacturasAnuladas>=0?(l(),i("div",Ko,[s(f,{class:"rounded-card q-pa-md text-center full-height bg-negative text-white"},{default:r(()=>[t("div",Wo,d(o.cantPrefacturasAnuladas),1),e[23]||(e[23]=t("div",null,"Cantidad de prefacturas anuladas",-1))]),_:1})])):c("",!0)])])])]}),_:1})]),_:1}),s(f,{class:"q-mb-md rounded no-border custom-shadow"},{default:r(()=>[e[26]||(e[26]=t("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Gr\xE1ficos estad\xEDsticos de Prefacturas ",-1)),s(no,{modelValue:o.tabs,"onUpdate:modelValue":e[13]||(e[13]=a=>o.tabs=a),animated:"","transition-prev":"scale","transition-next":"scale","keep-alive":""},{default:r(()=>[s(j,{name:o.opcionesGrafico.grafico},{default:r(()=>[t("div",Xo,[s(io,{push:""},{default:r(()=>[s(v,{push:"",label:"Una columna",icon:"bi-list","no-caps":"",onClick:e[10]||(e[10]=()=>o.modoUnaColumna=!0)}),s(v,{push:"",label:"Dos columnas",icon:"bi-grid","no-caps":"",onClick:e[11]||(e[11]=()=>o.modoUnaColumna=!1)})]),_:1})]),o.mostrarTitulosSeccion?(l(),i("div",{key:0,class:lo(["q-col-gutter-y-xl q-col-gutter-x-xs q-mb-xl",{row:!o.modoUnaColumna,column:o.modoUnaColumna}])},[(l(!0),i(y,null,k(o.graficos,a=>(l(),i("div",{class:"col-12 col-md-6 text-center",key:a.id},[t("div",Yo,d(a.encabezado),1),t("div",null,[a?(l(),P(g,{key:0,data:a,options:o.optionsPie,onClick:m=>o.clickGrafico(m,a.identificador)},null,8,["data","options","onClick"])):c("",!0)])]))),128))],2)):c("",!0)]),_:1},8,["name"]),s(j,{name:o.opcionesGrafico.listado},{default:r(()=>[s(v,{color:"primary",onClick:e[12]||(e[12]=a=>o.tabs=o.opcionesGrafico.grafico),glossy:"","no-caps":"",rounded:"",unelevated:"",class:"q-mx-auto block"},{default:r(()=>[s(C,{name:"bi-arrow-left"}),e[25]||(e[25]=b(" Regresar al gr\xE1fico"))]),_:1}),t("div",Zo,[t("div",xo,[o.prefacturasFiltradas.length?(l(),P(h,{key:0,titulo:"Ordenes de Compra",configuracionColumnas:[...o.configuracionColumnas,o.accionesTabla],datos:o.prefacturasFiltradas,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"alto-fijo":!1,ajustarCeldas:!0},null,8,["configuracionColumnas","datos"])):c("",!0)])])]),_:1},8,["name"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}var Ke=so(Bo,[["render",oe]]);export{Ke as default};

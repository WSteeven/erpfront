var ae=Object.defineProperty;var ne=(e,o,t)=>o in e?ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var u=(e,o,t)=>(ne(e,typeof o!="symbol"?o+"":o,t),t);import{Q,a as k}from"./QSelect.d8222f79.js";import{Q as w,a as B}from"./QItemSection.ca64420c.js";import{bz as se,t as M,A as re,c as te,U as de,p as ue,u as ce,e as T,a3 as me,bA as pe,s as ve,v as fe,x as be,y as s,S as ge,H as i,D as a,B as n,z as r,O as U,P as R,G as f,M as c,I as b,J as g,R as $e,F as D,L as j,K as V,aa as Ve,a7 as Ce}from"./index.846478c1.js";import{Q as he}from"./QForm.0a21c4a5.js";import{u as ye}from"./index.15c331c5.js";import{T as Se}from"./TabLayoutFilterTabs2.94e4b3e1.js";import{C as ke}from"./ContenedorSimpleMixin.1a882cca.js";import{u as we,S as Be,y as Ee}from"./utils.19b149f6.js";import{V as J}from"./VendedorController.a532027a.js";import{E as Ae}from"./entidadAuditable.75a46700.js";import{r as C,m as I,b as N,a as De}from"./i18n-validators.06501904.js";import{t as Ie}from"./ventas.utils.b757673b.js";import{u as Ne}from"./filtrosListadosGenerales.c330183b.js";class Fe extends se{constructor(){super(M.clientes_claro)}}const Le=[{name:"identificacion",field:"identificacion",label:"Identificaci\xF3n",align:"left",sortable:!0},{name:"nombres",field:"nombres",label:"Nombres",align:"left",sortable:!0},{name:"apellidos",field:"apellidos",label:"Apellidos",align:"left",sortable:!0},{name:"direccion",field:"direccion",label:"Direcci\xF3n",align:"left"},{name:"telefono1",field:"telefono1",label:"Tel\xE9fono",align:"left"},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class Oe extends Ae{constructor(){super();u(this,"id");u(this,"supervisor");u(this,"canton");u(this,"identificacion");u(this,"nombres");u(this,"apellidos");u(this,"telefono1");u(this,"telefono2");u(this,"direccion");u(this,"activo");this.id=null,this.supervisor=null,this.canton=null,this.identificacion=null,this.nombres=null,this.apellidos=null,this.telefono1=null,this.telefono2=null,this.direccion=null,this.activo=!0}}class z{constructor(){u(this,"axios");this.axios=re.getInstance()}async anular(o){return this.solicitud("/desactivar/",o)}async solicitud(o,t,v){const S=this.axios.getEndpoint(M.clientes_claro)+o+t,h=await this.axios.post(S,v);return{response:h,result:h.data.modelo}}}var Pe=te({components:{TabLayoutFilterTabs2:Se},setup(e,{emit:o}){const t=new ke(Oe,new Fe),{entidad:v,accion:S,disabled:h,listadosAuxiliares:p,listado:l}=t.useReferencias(),{setValidador:H,listar:G,obtenerListados:K,cargarVista:W}=t.useComportamiento(),{onGuardado:X,onReestablecer:Y}=t.useHooks(),{confirmar:F,notificarCorrecto:L,prompt:oo,notificarError:O}=de();we().setQuasar(ue());const $=new Be,m=ce(),Z=T(!1),P=T("1"),{vendedores_claro:E,filtrarVendedoresClaro:_,cantones:A,filtrarCantones:x}=Ne(p);W(async()=>{await K({vendedores:{controller:new J,params:m.esJefeVentasClaro?{"tipo_vendedor[]":"SUPERVISOR_VENTAS","&tipo_vendedor[]":"JEFE_VENTAS",activo:1}:{tipo_vendedor:"SUPERVISOR_VENTAS",activo:1}}}),p.cantones=A.value=JSON.parse(me.getItem("cantones").toString()),A.value=p.cantones,E.value=p.vendedores,m.esSupervisorVentasClaro&&(v.supervisor=m.user.id)});const ee={identificacion:{required:C,maxLength:I(13),minLenght:N(10)},supervisor:{requiredIf:De(()=>m.esJefeVentasClaro)},nombres:{required:C},apellidos:{required:C},direccion:{required:C},telefono1:{required:C,maxLength:I(10),minLenght:N(7)},telefono2:{maxLength:I(10),minLenght:N(7)},canton:{required:C}},q=ye(ee,v);H(q.value),X((d,y)=>{o("cerrar-modal",!1),o("guardado",{formulario:"ClienteClaroPage",id:d,modelo:y.modelo})}),Y(()=>{m.esSupervisorVentasClaro&&(v.supervisor=m.user.id)});function oe(d){P.value=d,G({activo:d})}async function le(){$.activar(),p.vendedores=await(await new J().listar({activo:1,tipo_vendedor:"SUPERVISOR_VENTAS"})).result,E.value=p.vendedores,$.desactivar()}return{mixin:t,v$:q,disabled:h,accion:S,acciones:pe,configuracionColumnas:Le,is_month:Z,tabDefecto:P,tabOptionsClienteClaro:Ie,store:m,cliente:v,maskFecha:ve,removeAccents:Ee,vendedores:E,filtrarVendedores:_,recargarVendedores:le,cantones:A,filtrarCantones:x,filtrarClientes:oe,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar Cliente",accion:({entidad:d,posicion:y})=>{F("\xBFEst\xE1 seguro de activar el cliente?",async()=>{try{$.activar(),await new z().anular(d.id),l.value.splice(y,1),L("Activado correctamente")}catch{O("No se pudo desactivar el cliente!")}finally{$.desactivar()}})},visible:({entidad:d})=>!d.activo&&m.can("puede.activar.clientes_claro")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar Cliente",accion:({entidad:d,posicion:y})=>{F("\xBFEst\xE1 seguro de desactivar el cliente?",async()=>{try{$.activar(),await new z().anular(d.id),l.value.splice(y,1),L("Desactivado correctamente")}catch{O("No se pudo desactivar el cliente!")}finally{$.desactivar()}})},visible:({entidad:d})=>d.activo&&m.can("puede.desactivar.clientes_claro")}}}});const qe={class:"row q-col-gutter-sm q-mb-md"},Qe={key:0,class:"col-12 col-md-3"},Te={class:"error-msg"},Ue={class:"col-12 col-md-3"},Re={class:"error-msg"},je={class:"col-12 col-md-3"},Je={class:"error-msg"},ze={class:"col-12 col-md-3"},Me={class:"error-msg"},He={class:"col-12 col-md-3"},Ge={class:"error-msg"},Ke={class:"col-12 col-md-3"},We={class:"error-msg"},Xe={class:"col-12 col-md-3"},Ye={class:"col-12 col-md-3"},Ze={class:"error-msg"},_e={key:1,class:"col-12 col-md-3"};function xe(e,o,t,v,S,h){const p=be("tab-layout-filter-tabs-2");return s(),ge(p,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:!0,accion1:e.btnDesactivar,accion2:e.btnActivar,"tab-options":e.tabOptionsClienteClaro,tabDefecto:e.tabDefecto,filtrar:e.filtrarClientes},{formulario:i(()=>[a(he,{onSubmit:o[9]||(o[9]=Ce(()=>{},["prevent"]))},{default:i(()=>[n("div",qe,[e.store.esJefeVentasClaro||e.store.esAdministrador?(s(),r("div",Qe,[o[11]||(o[11]=n("label",{class:"q-mb-sm block"},"Supervisor",-1)),a(Q,{modelValue:e.cliente.supervisor,"onUpdate:modelValue":o[0]||(o[0]=l=>e.cliente.supervisor=l),options:e.vendedores,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,error:!!e.v$.supervisor.$errors.length,onBlur:e.v$.supervisor.$touch,"error-message":"Debes seleccionar un supervisor de ventas","use-input":"","input-debounce":"0",onFilter:e.filtrarVendedores,"option-value":l=>l.empleado_id,"option-label":l=>l.empleado_info,"emit-value":"","map-options":""},{option:i(l=>[a(w,U(R(l.itemProps)),{default:i(()=>[a(B,null,{default:i(()=>[a(k,null,{default:i(()=>[f(c(l.opt.empleado_info),1)]),_:2},1024),a(k,{caption:""},{default:i(()=>[f(c(l.opt.tipo_vendedor)+" "+c(l.opt.modalidad_info),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:i(()=>[(s(!0),r(b,null,g(e.v$.supervisor.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",Te,c(l.$message),1)]))),128))]),after:i(()=>[a($e,{color:"positive",onClick:e.recargarVendedores},{default:i(()=>[a(D,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),"no-option":i(()=>[a(w,null,{default:i(()=>[a(B,{class:"text-grey"},{default:i(()=>o[10]||(o[10]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onBlur","onFilter","option-value","option-label"])])):j("",!0),n("div",Ue,[o[13]||(o[13]=n("label",{class:"q-mb-sm block"},"Ciudad",-1)),a(Q,{modelValue:e.cliente.canton,"onUpdate:modelValue":o[1]||(o[1]=l=>e.cliente.canton=l),options:e.cantones,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,error:!!e.v$.canton.$errors.length,onBlur:e.v$.canton.$touch,"error-message":"Debes seleccionar una ciudad","use-input":"","input-debounce":"0",onFilter:e.filtrarCantones,"option-value":l=>l.id,"option-label":l=>l.canton,"emit-value":"","map-options":""},{option:i(l=>[a(w,U(R(l.itemProps)),{default:i(()=>[a(B,null,{default:i(()=>[a(k,null,{default:i(()=>[f(c(l.opt.canton),1)]),_:2},1024),a(k,{caption:""},{default:i(()=>[f("Provincia: "+c(l.opt.provincia),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:i(()=>[(s(!0),r(b,null,g(e.v$.canton.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",Re,c(l.$message),1)]))),128))]),"no-option":i(()=>[a(w,null,{default:i(()=>[a(B,{class:"text-grey"},{default:i(()=>o[12]||(o[12]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onBlur","onFilter","option-value","option-label"])]),n("div",je,[o[14]||(o[14]=n("label",{class:"q-mb-sm block"},"Identificacion",-1)),a(V,{modelValue:e.cliente.identificacion,"onUpdate:modelValue":o[2]||(o[2]=l=>e.cliente.identificacion=l),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.identificacion.$errors.length,onBlur:e.v$.identificacion.$touch,outlined:"",dense:""},{error:i(()=>[(s(!0),r(b,null,g(e.v$.identificacion.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",Je,c(l.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),n("div",ze,[o[15]||(o[15]=n("label",{class:"q-mb-sm block"},"Nombres",-1)),a(V,{modelValue:e.cliente.nombres,"onUpdate:modelValue":o[3]||(o[3]=l=>e.cliente.nombres=l),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.nombres.$errors.length,onBlur:e.v$.nombres.$touch,outlined:"",dense:""},{error:i(()=>[(s(!0),r(b,null,g(e.v$.nombres.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",Me,c(l.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),n("div",He,[o[16]||(o[16]=n("label",{class:"q-mb-sm block"},"Apellidos",-1)),a(V,{modelValue:e.cliente.apellidos,"onUpdate:modelValue":o[4]||(o[4]=l=>e.cliente.apellidos=l),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.apellidos.$errors.length,onBlur:e.v$.apellidos.$touch,outlined:"",dense:""},{error:i(()=>[(s(!0),r(b,null,g(e.v$.apellidos.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",Ge,c(l.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),n("div",Ke,[o[17]||(o[17]=n("label",{class:"q-mb-sm block"},"Telefono 1",-1)),a(V,{modelValue:e.cliente.telefono1,"onUpdate:modelValue":o[5]||(o[5]=l=>e.cliente.telefono1=l),autogrow:"",error:!!e.v$.telefono1.$errors.length,onBlur:e.v$.telefono1.$touch,outlined:"",dense:"",placeholder:"Obligatorio"},{prepend:i(()=>[a(D,{name:"bi-telephone-fill"})]),error:i(()=>[(s(!0),r(b,null,g(e.v$.telefono1.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",We,c(l.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])]),n("div",Xe,[o[18]||(o[18]=n("label",{class:"q-mb-sm block"},"Telefono 2",-1)),a(V,{modelValue:e.cliente.telefono2,"onUpdate:modelValue":o[6]||(o[6]=l=>e.cliente.telefono2=l),autogrow:"",outlined:"",dense:"",placeholder:"Opcional"},{prepend:i(()=>[a(D,{name:"bi-telephone-fill"})]),_:1},8,["modelValue"])]),n("div",Ye,[o[19]||(o[19]=n("label",{class:"q-mb-sm block"},"Direcci\xF3n",-1)),a(V,{modelValue:e.cliente.direccion,"onUpdate:modelValue":o[7]||(o[7]=l=>e.cliente.direccion=l),placeholder:"obligatorio",type:"textarea",disable:e.disabled,error:!!e.v$.direccion.$errors.length,autogrow:"",onBlur:e.v$.direccion.$touch,outlined:"",dense:""},{error:i(()=>[(s(!0),r(b,null,g(e.v$.direccion.$errors,l=>(s(),r("div",{key:l.$uid},[n("div",Ze,c(l.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),e.accion!==e.acciones.nuevo?(s(),r("div",_e,[o[20]||(o[20]=n("br",null,null,-1)),a(Ve,{modelValue:e.cliente.activo,"onUpdate:modelValue":o[8]||(o[8]=l=>e.cliente.activo=l),"checked-icon":"check",disable:e.disabled,label:e.cliente.activo?"Activo":"Inactivo",color:"positive"},null,8,["modelValue","disable","label"])])):j("",!0)])]),_:1})]),default:i(()=>[o[21]||(o[21]=f(" > "))]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var eo=fe(Pe,[["render",xe]]),Vo=Object.freeze(Object.defineProperty({__proto__:null,default:eo},Symbol.toStringTag,{value:"Module"}));export{Fe as C,eo as a,Vo as b};

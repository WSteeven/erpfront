var ie=Object.defineProperty;var re=(o,e,p)=>e in o?ie(o,e,{enumerable:!0,configurable:!0,writable:!0,value:p}):o[e]=p;var f=(o,e,p)=>(re(o,typeof e!="symbol"?e+"":e,p),p);import{bz as G,t as k,c as te,be as le,p as L,s as C,e as v,E as ne,a3 as U,A as de,bH as Y,ds as ue,v as pe,y as t,S as me,H as a,D as i,bf as ce,bg as q,B as r,z as l,I as b,J as g,M as h,G as $,L as N,K as P,F as y,k as B,R as F,N as fe,Q as ve,c8 as be}from"./index.846478c1.js";import{Q,a as I}from"./QItemSection.ca64420c.js";import{Q as E}from"./QSelect.d8222f79.js";import{Q as M,a as T,C as O}from"./QPopupProxy.7844573b.js";import{Q as ge}from"./QPage.b0adedad.js";import{T as he}from"./TabLayout.b05b8b79.js";import{u as $e}from"./index.15c331c5.js";import{C as _e}from"./ContenedorSimpleMixin.1a882cca.js";import{T as ye}from"./TipoFonfoController.7d718293.js";import{u as Fe,v as j,A as H,L as S}from"./utils.19b149f6.js";import{E as Ve}from"./entidadAuditable.75a46700.js";import{r as V}from"./i18n-validators.06501904.js";import{u as ke}from"./filtrosListadosGenerales.c330183b.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./buttonSubmits.31738227.js";import"./EssentialTable.01bbad48.js";import"./QFile.c3222262.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./EssentialTablePagination.3349ebcb.js";import"./index.209eea81.js";class we extends Ve{constructor(){super();f(this,"usuario");f(this,"estado");f(this,"fecha_inicio");f(this,"fecha_fin");this.usuario=null,this.estado=null,this.fecha_inicio=null,this.fecha_fin=null}}class Ce extends G{constructor(){super(k.fondo_rotativo_autorizaciones_fecha_pdf)}}class Qe extends G{constructor(){super(k.estados_viaticos)}}var Ie=te({components:{TabLayout:he},setup(){le().setQuasar(L()),Fe().setQuasar(L());const o=new _e(we,new Ce),{entidad:e,disabled:p,listadosAuxiliares:n}=o.useReferencias(),{setValidador:D,obtenerListados:A,cargarVista:s}=o.useComportamiento(),{onReestablecer:J}=o.useHooks();J(()=>e.fecha_fin=j(C));const w=$e({usuario:{required:V},estado:{required:V},fecha_inicio:{required:V},fecha_fin:{required:V}},e);D(w.value);const c=v(),K=v([]),X=v([]),W=v(!1),R=v([]),{empleados:z,filtrarEmpleados:Z}=ke(n);s(async()=>{await A({empleados:{controller:new ne,params:{campos:"id,nombres,apellidos",estado:1,empleados_autorizadores_gasto:1}},tiposFondos:{controller:new ye,params:{campos:"id,descripcion"}},estados:new Qe}),z.value=n.empleados,c.value=U.getItem("usuariosInactivos")==null?[]:JSON.parse(U.getItem("usuariosInactivos").toString()),n.usuariosInactivos=c.value,K.value=n.tiposFondos,X.value=n.tiposFondoRotativoFechas,R.value=n.estados,e.fecha_fin=j(C)});function x(d,u){if(d===""){u(()=>{c.value=n.usuariosInactivos});return}u(()=>{const m=d.toLowerCase();c.value=n.usuariosInactivos.filter(_=>_.nombres.toLowerCase().indexOf(m)>-1||_.apellidos.toLowerCase().indexOf(m)>-1)})}async function ee(d){if(await w.value.$validate()){const u=de.getInstance(),m="reporte_semanal_gastos_del_"+e.fecha_inicio+"_al_"+e.fecha_fin;switch(d){case ue.EXCEL:const _=Y.URL_BASE+"/"+u.getEndpoint(k.fondo_rotativo_autorizaciones_fecha_excel);await H(_,"POST","blob","xlsx",m,e);break;case"pdf":const ae=Y.URL_BASE+"/"+u.getEndpoint(k.fondo_rotativo_autorizaciones_fecha_pdf);await H(ae,"POST","blob","pdf",m,e);break}}}function oe(d){const u=S(new Date,"YYYY/MM/DD");return d<=u}function se(d){const u=S(new Date,"YYYY/MM/DD"),m=S(e.fecha_inicio!==null?e.fecha_inicio:new Date,"YYYY/MM/DD");return d>=m&&d<=u}return{reporte:e,disabled:p,v$:w,maskFecha:C,empleados:z,empleadosInactivos:c,is_inactivo:W,estados_viaticos:R,generar_reporte:ee,filtrarEmpleados:Z,filtrarUsuariosInactivos:x,optionsFechaInicio:oe,optionsFechaFin:se}}});const Ee={class:"row q-col-gutter-sm"},Se={key:0,class:"col-12 col-md-6"},De={class:"error-msg"},Ae={key:1,class:"col-12 col-md-6"},Re={class:"error-msg"},ze={class:"col-12 col-md-6 q-mb-md"},Le={class:"error-msg"},Ue={class:"col-6 col-md-6"},Ye={class:"row items-center justify-end"},qe={class:"error-msg"},Ne={class:"col-6 col-md-6"},Pe={class:"row items-center justify-end"},Be={class:"error-msg"},Me={class:"col-12 col-md-3"};function Te(o,e,p,n,D,A){return t(),me(ge,{class:"flex flex-center"},{default:a(()=>[i(ce,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:a(()=>[i(q,null,{default:a(()=>e[11]||(e[11]=[r("div",{class:"row items-center no-wrap"},[r("div",{class:"col"},[r("div",{class:"text-h6"},"Generar Reporte Autorizaciones Especiales")])],-1)])),_:1}),i(q,null,{default:a(()=>[r("div",Ee,[o.is_inactivo?N("",!0):(t(),l("div",Se,[e[13]||(e[13]=r("label",{class:"q-mb-sm block"},"Empleado",-1)),i(E,{modelValue:o.reporte.usuario,"onUpdate:modelValue":e[0]||(e[0]=s=>o.reporte.usuario=s),options:o.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:o.filtrarEmpleados,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{error:a(()=>[(t(!0),l(b,null,g(o.v$.usuario.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",De,h(s.$message),1)]))),128))]),"no-option":a(()=>[i(Q,null,{default:a(()=>[i(I,{class:"text-grey"},{default:a(()=>e[12]||(e[12]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])),o.is_inactivo?(t(),l("div",Ae,[e[15]||(e[15]=r("label",{class:"q-mb-sm block"},"Empleado",-1)),i(E,{modelValue:o.reporte.usuario,"onUpdate:modelValue":e[1]||(e[1]=s=>o.reporte.usuario=s),options:o.empleadosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un empleado inactivo del listado","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{error:a(()=>[(t(!0),l(b,null,g(o.v$.usuario.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Re,h(s.$message),1)]))),128))]),"no-option":a(()=>[i(Q,null,{default:a(()=>[i(I,{class:"text-grey"},{default:a(()=>e[14]||(e[14]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])):N("",!0),r("div",ze,[e[17]||(e[17]=r("label",{class:"q-mb-sm block"},"Estado",-1)),i(E,{modelValue:o.reporte.estado,"onUpdate:modelValue":e[2]||(e[2]=s=>o.reporte.estado=s),options:o.estados_viaticos,"options-dense":"",dense:"",outlined:"",error:!!o.v$.estado.$errors.length,"option-value":s=>s.id,"option-label":s=>s.descripcion,"emit-value":"","map-options":""},{error:a(()=>[(t(!0),l(b,null,g(o.v$.estado.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Le,h(s.$message),1)]))),128))]),"no-option":a(()=>[i(Q,null,{default:a(()=>[i(I,{class:"text-grey"},{default:a(()=>e[16]||(e[16]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","option-value","option-label"])]),r("div",Ue,[e[18]||(e[18]=r("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(P,{modelValue:o.reporte.fecha_inicio,"onUpdate:modelValue":e[4]||(e[4]=s=>o.reporte.fecha_inicio=s),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:a(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:a(()=>[i(M,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(T,{modelValue:o.reporte.fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=s=>o.reporte.fecha_inicio=s),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:a(()=>[r("div",Ye,[B(i(F,{label:"Cerrar",color:"primary",flat:""},null,512),[[O]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:a(()=>[(t(!0),l(b,null,g(o.v$.fecha_inicio.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",qe,h(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),r("div",Ne,[e[19]||(e[19]=r("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(P,{modelValue:o.reporte.fecha_fin,"onUpdate:modelValue":e[6]||(e[6]=s=>o.reporte.fecha_fin=s),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:a(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:a(()=>[i(M,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(T,{modelValue:o.reporte.fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=s=>o.reporte.fecha_fin=s),mask:o.maskFecha,"today-btn":"",options:o.optionsFechaFin},{default:a(()=>[r("div",Pe,[B(i(F,{label:"Cerrar",color:"primary",flat:""},null,512),[[O]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:a(()=>[(t(!0),l(b,null,g(o.v$.fecha_fin.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Be,h(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),r("div",Me,[i(fe,{modelValue:o.is_inactivo,"onUpdate:modelValue":[e[7]||(e[7]=s=>o.is_inactivo=s),e[8]||(e[8]=()=>o.reporte.usuario=null)],color:"secondary",label:"Inactivo","true-value":!0,"false-value":!1},null,8,["modelValue"])])])]),_:1}),i(ve),i(be,{align:"around"},{default:a(()=>[i(F,{color:"positive",onClick:e[9]||(e[9]=s=>o.generar_reporte("excel"))},{default:a(()=>[i(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[20]||(e[20]=$(" Excel "))]),_:1}),i(F,{color:"negative",onClick:e[10]||(e[10]=s=>o.generar_reporte("pdf"))},{default:a(()=>[i(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[21]||(e[21]=$(" PDF "))]),_:1})]),_:1})]),_:1})]),_:1})}var So=pe(Ie,[["render",Te]]);export{So as default};

import{Q as na,a as j}from"./QSelect.d8222f79.js";import{Q as I,a as O}from"./QItemSection.ca64420c.js";import{c as ma,U as ca,e as _,bA as b,s as da,v as pa,x as fa,y as n,S as ba,H as r,D as l,a7 as va,B as t,O as ga,P as ha,G as F,M as v,K as d,F as L,k as N,R as H,z as m,I as z,J as A,L as M}from"./index.846478c1.js";import{Q as R,a as T,C as K}from"./QPopupProxy.7844573b.js";import{Q as Va}from"./QForm.0a21c4a5.js";import{r as W,a as G}from"./i18n-validators.06501904.js";import{u as Ma}from"./index.15c331c5.js";import{T as ka}from"./TabLayoutFilterTabs2.94e4b3e1.js";import{C as wa}from"./ContenedorSimpleMixin.1a882cca.js";import{M as Pa,a as ya}from"./MatriculaController.b868c99d.js";import{V as Ca}from"./VehiculoController.8465b13a.js";import{u as _a}from"./filtrosListadosGenerales.c330183b.js";import{u as Fa}from"./vehiculos.utils.c31e027d.js";import{X as $a,Y as Da,Z as qa,K as J}from"./utils.19b149f6.js";import{u as Ua}from"./vehiculo.44fdc084.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./index.209eea81.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./QPage.b0adedad.js";import"./EssentialTableTabs.d6bee6af.js";import"./QBadge.60ffdb76.js";import"./EssentialTablePagination.3349ebcb.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBtnGroup.b7cc3fd9.js";import"./EssentialTable.01bbad48.js";import"./QFile.c3222262.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./buttonSubmits.31738227.js";import"./entidadAuditable.75a46700.js";const Ya=[{name:"vehiculo",field:"vehiculo",label:"Veh\xEDculo",align:"left",sortable:!0},{name:"fecha_matricula",field:"fecha_matricula",label:"Fecha matr\xEDcula",align:"left",sortable:!0,editable:!1},{name:"valor_estimado_pagar",field:"valor_estimado_pagar",label:"Valor a Pagar",align:"left",sortable:!0},{name:"proxima_matricula",field:"proxima_matricula",label:"Pr\xF3xima matr\xEDcula",align:"left",sortable:!0},{name:"estado",field:"estado",label:"\xBFMatriculado?",align:"left",sortable:!0}];var Ea=ma({components:{TabLayoutFilterTabs2:ka},setup(){const a=new wa(Pa,new ya),{entidad:o,disabled:$,listadosAuxiliares:k,accion:c}=a.useReferencias(),{setValidador:D,obtenerListados:w,cargarVista:e,listar:p}=a.useComportamiento(),{confirmar:X,prompt:g}=ca(),h=Ua(),q=_(!1),U=_(!1),V={matriculador:null,observacion:null,monto:null},Y=_("1");e(async()=>{await w({vehiculos:{controller:new Ca,params:{campos:"id,placa,modelo_id"}}})});const Z={vehiculo:{required:W},fecha_matricula:{required:W},proxima_matricula:{requiredIf:G(o.fecha_matricula)},matriculador:{requiredIf:G(o.fecha_matricula)}},E=Ma(Z,o);D(E.value);const{primerDia:Q,ultimoDia:B}=$a(da);async function S(i){switch(Y.value=i,i){case"1":await p({"fecha_matricula[start]":Q,"fecha_matricula[end]":B});break;case"2":await p({matriculado:0,"fecha_matricula[operator]":"<","fecha_matricula[value]":Q});break;case"3":await p({matriculado:1});break;case"4":await p({matriculado:0,"fecha_matricula[operator]":">","fecha_matricula[value]":B});break;default:await p()}}function x(i,u){q.value=u!=="month"}function aa(i,u){U.value=u!=="month"}function oa(){const i=Da(qa(o.placa)),u=new Date,s=new Date;s.setFullYear(s.getFullYear()+1),u.setMonth(i),s.setMonth(i),o.fecha_matricula=J.formatDate(u,"MM-YYYY"),o.proxima_matricula=J.formatDate(s,"MM-YYYY")}function ea(){const i=P.value.filter(u=>u.id==o.vehiculo);o.placa=i[0].placa,oa()}const la={titulo:"Valores a Pagar",icono:"bi-search",color:"primary",tooltip:"Valores a pagar de matricula",accion:()=>{window.open("https://srienlinea.sri.gob.ec/sri-en-linea/SriVehiculosWeb/ConsultaValoresPagarVehiculo/Consultas/consultaRubros","_blank")},visible:()=>c.value==b.nuevo||c.value==b.editar},ra={titulo:"Multas",icono:"bi-file-earmark-text-fill",color:"primary",tooltip:"Consultar multas",accion:()=>{window.open("https://consultaweb.ant.gob.ec/PortalWEB/paginas/clientes/clp_criterio_consulta.jsp","_blank")},visible:()=>c.value==b.nuevo||c.value==b.editar},ia={titulo:"Valor a Pagar",color:"primary",tooltip:"Configurar Valor a Pagar",icono:"bi-wrench",accion:({entidad:i})=>{g({titulo:"Valor estimado a Pagar",mensaje:"Ingresa el valor estimado a pagar de matricula",validacion:s=>/^(\d{1,3}(?:,\d{3})*(?:\.\d+)?|\d+)?$/.test(s),requerido:!0,accion:async s=>{h.idMatricula=i.id;const f=await h.setValorEstimadoPagar({valor_estimado_pagar:s});console.log(f),i.valor_estimado_pagar=f.valor_estimado_pagar}})}},ta={titulo:" Pagar",icono:"bi-cash-coin",color:"positive",accion:({entidad:i})=>{X("\xBFEst\xE1 seguro de marcar como pagada la matr\xEDcula?",async()=>{const u={titulo:"Pagar Matricula "+i.vehiculo,mensaje:"Persona que realiz\xF3 la matriculaci\xF3n del veh\xEDculo",requerido:!0,validacion:s=>!!s,accion:async s=>{h.idMatricula=i.id,V.matriculador=s;const f={titulo:"Pagar Matricula "+i.vehiculo,mensaje:"Observaci\xF3n",requerido:!0,validacion:y=>!!y,accion:async y=>{V.observacion=y;const ua={titulo:"Pagar Matricula "+i.vehiculo,mensaje:"Monto del pago",validacion:C=>/^(\d{1,3}(?:,\d{3})*(?:\.\d+)?|\d+)?$/.test(C),accion:async C=>{V.monto=C,await h.pagarMatricula(V)&&await S("3")}};g(ua)}};g(f)}};g(u)})},visible:({entidad:i})=>!i.matriculado},{vehiculos:P,filtrarVehiculos:sa}=_a(k);return P.value=k.vehiculos,{mixin:a,v$:E,matricula:o,disabled:$,accion:c,acciones:b,configuracionColumnas:Ya,maskFecha:"MM-YYYY",is_month_fecha_matricula:q,is_month_proxima_matricula:U,btnColocarValorEstimadoPagar:ia,btnConsultarMatricula:la,btnConsultarMultas:ra,btnPagarMatricula:ta,tabActual:Y,tabOptionsMatriculas:Fa,vehiculos:P,filtrarVehiculos:sa,filtrarMatriculas:S,checkValueFechaMatricula:x,checkValueProximaMatricula:aa,asignarPlaca:ea}}});const Qa={class:"row q-col-gutter-sm q-py-md"},Ba={class:"col-12 col-md-3"},Sa={class:"col-12 col-md-3"},ja={class:"row items-center justify-end"},Ia={class:"error-msg"},Oa={class:"col-12 col-md-3"},La={class:"row items-center justify-end"},Na={class:"error-msg"},Ha={key:0,class:"col-12 col-md-3"},za={key:1,class:"col-12 col-md-3"},Aa={key:2,class:"col-12 col-md-3"},Ra={key:3,class:"col-12 col-md-3"};function Ta(a,o,$,k,c,D){const w=fa("tab-layout-filter-tabs2");return n(),ba(w,{mixin:a.mixin,configuracionColumnas:a.configuracionColumnas,ajustarCeldas:!0,"tab-options":a.tabOptionsMatriculas,tabDefecto:a.tabActual,filtrar:a.filtrarMatriculas,"titulo-pagina":"Matriculas de Veh\xEDculos",accion1Header:a.btnConsultarMatricula,accion2Header:a.btnConsultarMultas,permitirEditar:!1,puedeExportar:"",accion1:a.btnColocarValorEstimadoPagar,accion2:a.btnPagarMatricula},{formulario:r(()=>[l(Va,{onSubmit:o[11]||(o[11]=va(()=>{},["prevent"]))},{default:r(()=>[t("div",Qa,[t("div",Ba,[o[13]||(o[13]=t("label",{class:"q-mb-sm block"},"Placa",-1)),l(na,{modelValue:a.matricula.vehiculo,"onUpdate:modelValue":[o[0]||(o[0]=e=>a.matricula.vehiculo=e),a.asignarPlaca],options:a.vehiculos,"transition-show":"jump-up","transition-hide":"jump-down",disable:a.disabled,"options-dense":"",dense:"",outlined:"",onFilter:a.filtrarVehiculos,"error-message":"Debes seleccionar un numero de placa","use-input":"","input-debounce":"0","option-value":e=>e.id,"option-label":e=>e.placa,"emit-value":"","map-options":""},{option:r(e=>[l(I,ga(ha(e.itemProps)),{default:r(()=>[l(O,null,{default:r(()=>[l(j,null,{default:r(()=>[F(v(e.opt.placa),1)]),_:2},1024),l(j,{caption:""},{default:r(()=>[F(v(e.opt.marca)+": "+v(e.opt.modelo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[l(I,null,{default:r(()=>[l(O,{class:"text-grey"},{default:r(()=>o[12]||(o[12]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter","onUpdate:modelValue","option-value","option-label"])]),t("div",Sa,[o[14]||(o[14]=t("label",{class:"q-mb-sm block"},"Fecha de Matriculaci\xF3n ",-1)),l(d,{modelValue:a.matricula.fecha_matricula,"onUpdate:modelValue":o[3]||(o[3]=e=>a.matricula.fecha_matricula=e),placeholder:"Obligatorio",value:a.matricula.fecha_matricula,mask:"##-####",hint:"Fecha de ultima matriculaci\xF3n",error:!!a.v$.fecha_matricula.$errors.length,disable:a.disabled,onBlur:a.v$.fecha_matricula.$touch,outlined:"",dense:""},{append:r(()=>[l(L,{name:"event",class:"cursor-pointer"},{default:r(()=>[l(R,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:a.is_month_fecha_matricula,"onUpdate:modelValue":o[2]||(o[2]=e=>a.is_month_fecha_matricula=e)},{default:r(()=>[l(T,{modelValue:a.matricula.fecha_matricula,"onUpdate:modelValue":[o[1]||(o[1]=e=>a.matricula.fecha_matricula=e),a.checkValueFechaMatricula],minimal:"",mask:a.maskFecha,"emit-immediately":"","default-view":"Years"},{default:r(()=>[t("div",ja,[N(l(H,{label:"Cerrar",color:"primary",flat:""},null,512),[[K]])])]),_:1},8,["modelValue","mask","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})]),error:r(()=>[(n(!0),m(z,null,A(a.v$.fecha_matricula.$errors,e=>(n(),m("div",{key:e.$uid},[t("div",Ia,v(e.$message),1)]))),128))]),_:1},8,["modelValue","value","error","disable","onBlur"])]),t("div",Oa,[o[15]||(o[15]=t("label",{class:"q-mb-sm block"},"Pr\xF3xima Matr\xEDcula ",-1)),l(d,{modelValue:a.matricula.proxima_matricula,"onUpdate:modelValue":o[6]||(o[6]=e=>a.matricula.proxima_matricula=e),placeholder:"Obligatorio",value:a.matricula.proxima_matricula,mask:"##-####",hint:"Fecha de pr\xF3xima matriculaci\xF3n",error:!!a.v$.proxima_matricula.$errors.length,disable:a.disabled,onBlur:a.v$.proxima_matricula.$touch,outlined:"",dense:""},{append:r(()=>[l(L,{name:"event",class:"cursor-pointer"},{default:r(()=>[l(R,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:a.is_month_proxima_matricula,"onUpdate:modelValue":o[5]||(o[5]=e=>a.is_month_proxima_matricula=e)},{default:r(()=>[l(T,{modelValue:a.matricula.proxima_matricula,"onUpdate:modelValue":[o[4]||(o[4]=e=>a.matricula.proxima_matricula=e),a.checkValueProximaMatricula],minimal:"",mask:a.maskFecha,"emit-immediately":"","default-view":"Years"},{default:r(()=>[t("div",La,[N(l(H,{label:"Cerrar",color:"primary",flat:""},null,512),[[K]])])]),_:1},8,["modelValue","mask","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})]),error:r(()=>[(n(!0),m(z,null,A(a.v$.proxima_matricula.$errors,e=>(n(),m("div",{key:e.$uid},[t("div",Na,v(e.$message),1)]))),128))]),_:1},8,["modelValue","value","error","disable","onBlur"])]),a.matricula.matriculador?(n(),m("div",Ha,[o[16]||(o[16]=t("label",{class:"q-mb-sm block"},"Persona que realiza matriculaci\xF3n",-1)),l(d,{autogrow:"",modelValue:a.matricula.matriculador,"onUpdate:modelValue":o[7]||(o[7]=e=>a.matricula.matriculador=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0),a.matricula.observacion?(n(),m("div",za,[o[17]||(o[17]=t("label",{class:"q-mb-sm block"},"Observaci\xF3n",-1)),l(d,{autogrow:"",modelValue:a.matricula.observacion,"onUpdate:modelValue":o[8]||(o[8]=e=>a.matricula.observacion=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0),a.matricula.monto?(n(),m("div",Aa,[o[18]||(o[18]=t("label",{class:"q-mb-sm block"},"Monto",-1)),l(d,{autogrow:"",modelValue:a.matricula.monto,"onUpdate:modelValue":o[9]||(o[9]=e=>a.matricula.monto=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0),a.matricula.fecha_pago?(n(),m("div",Ra,[o[19]||(o[19]=t("label",{class:"q-mb-sm block"},"Fecha de pago",-1)),l(d,{autogrow:"",modelValue:a.matricula.fecha_pago,"onUpdate:modelValue":o[10]||(o[10]=e=>a.matricula.fecha_pago=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar","accion1Header","accion2Header","accion1","accion2"])}var jo=pa(Ea,[["render",Ta]]);export{jo as default};

var L=Object.defineProperty;var B=(l,n,s)=>n in l?L(l,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[n]=s;var e=(l,n,s)=>(B(l,typeof n!="symbol"?n+"":n,s),s);import{S as I,A as h}from"./utils.2eab62de.js";import{l as U,e as j,c as _,bc as N,m as F,R as T,bz as D,A as c,bH as d,s as u}from"./index.70185135.js";import{E as k}from"./entidadAuditable.75a46700.js";const K=[{name:"id",field:"id",label:"N\xB0",align:"left",sortable:!0,visible:!0},{name:"codigo",field:"codigo",label:"C\xF3digo",align:"center",sortable:!0,visible:!0},{name:"fecha",field:"fecha",label:"Fecha",align:"left",sortable:!0,visible:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0,visible:!0},{name:"solicitante",field:"solicitante",label:"Solicitante",align:"left",sortable:!0,visible:!0},{name:"proveedor",field:"proveedor",label:"Proveedor",align:"left",sortable:!0,visible:!0},{name:"autorizador",field:"autorizador",label:"Autorizador",align:"left",sortable:!0,visible:!0},{name:"autorizacion",field:"autorizacion",label:"Autorizaci\xF3n",align:"left",sortable:!0,visible:!0},{name:"estado",field:"estado",label:"Revisada Compras",align:"left",sortable:!0,visible:!0},{name:"realizada",field:"realizada",label:"Realizada",align:"left",sortable:!0,visible:!0},{name:"pagada",field:"pagada",label:"Pagada",align:"left",sortable:!0,visible:!0},{name:"novedades",field:"novedades",label:"Novedades",align:"left",sortable:!0,visible:!0},{name:"sum_total",field:"sum_total",label:"Total",align:"left",sortable:!0,visible:!0}];class E extends k{constructor(){super();e(this,"codigo");e(this,"solicitante");e(this,"proveedor");e(this,"proveedor_internacional");e(this,"autorizador");e(this,"autorizacion");e(this,"observacion_aut");e(this,"descripcion");e(this,"preorden");e(this,"pedido");e(this,"tarea");e(this,"forma");e(this,"tiempo");e(this,"estado");e(this,"observacion_est");e(this,"causa_anulacion");e(this,"fecha");e(this,"created_at");e(this,"iva");e(this,"categorias");e(this,"listadoProductos");e(this,"realizada");e(this,"observacion_realizada");e(this,"completada");e(this,"pagada");e(this,"novedades");e(this,"sum_total");e(this,"copia_orden");e(this,"tiene_preorden");e(this,"tiene_pedido");e(this,"modificar_iva");e(this,"id_aux");e(this,"es_proveedor_internacional");this.codigo=null,this.solicitante=null,this.proveedor=null,this.proveedor_internacional=null,this.autorizador=null,this.autorizacion=null,this.observacion_aut=null,this.copia_orden=!1,this.descripcion=null,this.preorden=null,this.pedido=null,this.tarea=null,this.forma=null,this.created_at=null,this.tiempo=null,this.estado=null,this.observacion_est=null,this.causa_anulacion=null,this.fecha=null,this.id_aux=null,this.iva=null,this.categorias=[],this.listadoProductos=[],this.tiene_preorden=!1,this.tiene_pedido=!1,this.modificar_iva=!1,this.realizada=!1,this.observacion_realizada=null,this.pagada=!1,this.completada=!1,this.novedades=null,this.sum_total=null,this.es_proveedor_internacional=!1}}const M=U("ordenCompra",()=>{const l=j(new E),n=new E,s=_(),x=_(!0);N().setQuasar(F());const{notificarCorrecto:m,notificarAdvertencia:f,notificarError:p}=T(),y=D.nuevo,r=new I;async function z(){try{r.activar();const t=c.getInstance(),a=d.URL_BASE+"/"+t.getEndpoint(u.ordenes_compras)+"/imprimir/"+s.value,o="orden_compra_"+s.value+"_"+Date.now();h(a,"GET","blob","pdf",o),console.log("Orden de compra impreso con \xE9xito")}catch(t){f("Error al imprimir la orden de compra. "+t)}finally{r.desactivar()}}async function S(){try{r.activar();const t=c.getInstance(),a=d.URL_BASE+"/"+t.getEndpoint(u.ordenes_compras)+"/toProveedor/"+s.value,o=await t.get(a);o.status===200?m(o.data.mensaje):f(o.data.mensaje)}catch(t){p("Error al enviar la orden de compra al proveedor."+t)}finally{r.desactivar()}}async function A(t){try{r.activar();const a=c.getInstance(),o=d.URL_BASE+"/"+a.getEndpoint(u.ordenes_compras)+"/anular/"+s.value,i=await a.post(o,t);return console.log(i),i}catch(a){p(a)}finally{r.desactivar()}}async function R(t){try{r.activar();const a=c.getInstance(),o=d.URL_BASE+"/"+a.getEndpoint(u.ordenes_compras)+"/realizada/"+s.value,i=await a.post(o,t);(i.status=200)?m(i.data.mensaje):f(i.data.mensaje)}catch(a){p("Error al marcar como realizada la orden de compra."+a)}finally{r.desactivar()}}async function w(){try{r.activar();const t=c.getInstance(),a=d.URL_BASE+"/"+t.getEndpoint(u.ordenes_compras)+"/pagada/"+s.value,o=await t.get(a);(o.status=200)?m(o.data.mensaje):f(o.data.mensaje)}catch(t){p("Error al marcar como realizada la orden de compra."+t)}finally{r.desactivar()}}async function O(t){try{r.activar();const a=c.getInstance(),o=d.URL_BASE+"/"+a.getEndpoint(u.dashboard_compras),i=await a.post(o,t);return console.log(i.data.results),i.data.results}catch(a){p("Error al consultar el dashboard"+a)}finally{r.desactivar()}}function P(){l.hydrate(n)}async function C(t,a,o){try{r.activar();const i=c.getInstance(),v=d.URL_BASE+"/"+i.getEndpoint(u.ordenes_compras)+"/reportes",g="reporte_ordenes_compras";switch(t){case"excel":return a.accion="excel",h(v,"POST","blob","xlsx",g,a),o;break;case"pdf":return a.accion="pdf",h(v,"POST","blob","pdf",g,a),o;break;default:a.accion="";const b=await i.post(v,a);return b.data.results?(b.data.results.length<1&&f("No se obtuvieron resultados"),b.data.results):o}}catch(i){console.log(i),p("Error al obtener el reporte")}finally{r.desactivar()}}return{orden:l,accionOrden:y,idOrden:s,permitirSubir:x,anularOrden:A,resetearOrden:P,imprimirPdf:z,enviarPdf:S,marcarRealizada:R,marcarPagada:w,consultarDashboard:O,buscarReporte:C}});export{E as O,K as c,M as u};

import{by as B,s as u,R as w,u as F,A,d as R,m as T,c as D,p as L,q as O,e as P,bH as E,_ as Y,t as j,v as G,P as H,F as c,z as l,y as m,I as h,B as J,j as X,O as K,L as W,a5 as Z}from"./index.70185135.js";import{Q as x,a as ee,C as oe}from"./QPopupProxy.c164d2ac.js";import{Q as ie}from"./QForm.0c8c3b68.js";import{r as y}from"./index.9f64ebda.js";import{u as ae}from"./index.004ff2d8.js";import{T as ne}from"./TabLayoutFilterTabs2.0c89493b.js";import{C as te}from"./ContenedorSimpleMixin.0ef3239b.js";import{A as se}from"./Alimentacion.2916aefc.js";import{t as re,e as le}from"./recursosHumanos.utils.f01cf672.js";import{u as me,A as _}from"./utils.2eab62de.js";import"./format.8ac60962.js";import"./QMenu.7527c31d.js";import"./position-engine.f244a0db.js";import"./QTabs.4ee0c65d.js";import"./QResizeObserver.721a0e6c.js";import"./QSelect.b1759751.js";import"./QChip.a6a2afa6.js";import"./QItemSection.1a41b826.js";import"./QTabPanels.0148950e.js";import"./touch.9135741d.js";import"./QPage.f3b97ac0.js";import"./EssentialTableTabs.a1f1bc4b.js";import"./QBadge.5bb69fff.js";import"./EssentialTablePagination.959d4e60.js";import"./EssentialTable.c4a035e4.js";import"./QFile.f60a5ba1.js";import"./QToolbar.f2167ded.js";import"./use-fullscreen.ec50b882.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.04221389.js";import"./VisorImagen.7aac4fec.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.60ce3364.js";import"./i18n-validators.ea544161.js";import"./buttonSubmits.f728eedc.js";import"./entidadAuditable.75a46700.js";const ce=[{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"mes",field:"mes",label:"Mes",align:"left",sortable:!0}];class de extends B{constructor(){super(u.alimentacion)}}const pe=e=>{const{listar:o}=e.useComportamiento(),{notificarCorrecto:r}=w(),b=F(),d={titulo:"Finalizar Asignacion de Alimentaci\xF3n",icono:"bi-check-circle-fill",color:"warning",visible:({entidad:s})=>!s.finalizado&&b.can("puede.ver.bnt.finalizar_alimentaciones"),accion:async({entidad:s})=>{await p(s.id),await o({finalizado:"0"})}};async function p(s){const i=A.getInstance(),f=i.getEndpoint(u.finalizar_asignacion_alimentacion,{id:s});return await i.get(f),r("Se a Finalizado la asignacion de Alimentacion.")}return{btnFinalizar:d}};var ue=R({components:{TabLayoutFilterTabs2:ne},setup(){const e=new te(se,new de),{btnFinalizar:o}=pe(e),{entidad:r,disabled:b,accion:d,listado:p}=e.useReferencias(),{setValidador:s,listar:i}=e.useComportamiento();me().setQuasar(T());const{promptItems:f}=w(),v=D(!1),q={mes:{required:y},nombre:{required:y}},z=[{id:"pdf",name:"PDF"},{id:"xlsx",name:"EXCEL"}],C=ae(q,r);s(C.value);const V=F();function S(a,t,n){console.log(a,t,n),v.value=t!=="month",I()}function I(){const a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[t,n]=r.mes.split("-");r.nombre=`Asignacion de Alimentaci\xF3n de ${r.es_quincena?"QUINCENA DEL MES DE ":""}  ${a[parseInt(t,10)-1]} de ${n}`}function Q(a){i({finalizado:a},!1)}const $={titulo:"Reporte General",icono:"bi-printer",color:"positive",visible:({entidad:a})=>V.can("puede.acceder.alimentaciones"),accion:({entidad:a})=>{const t=P({mensaje:"Confirme el tipo de reporte",accion:n=>{N(a.id,n)},requerido:!1,defecto:"EXCEL",tipo:"radio",items:z.map(n=>({label:n.name,value:n.id}))});f(t)}},k={titulo:"Cash de Alimentacion",icono:"bi-cash-stack",color:"primary",visible:()=>V.can("puede.ver.campo.cash_alimentacion"),accion:({entidad:a})=>{M(a)}};async function M(a){const t="cash_alimentacion",n=A.getInstance(),g=E.URL_BASE+"/"+n.getEndpoint(u.crear_cash_alimentacion)+a.id;_(g,"GET","blob","xlsx",t,null)}async function N(a,t){const n=A.getInstance(),g="rol_pago",U=E.URL_BASE+"/"+n.getEndpoint(u.imprimir_reporte_general_alimentacion)+a+"?tipo="+t;_(U,"GET","blob",t,g,null)}return{listado:p,configuracionColumnas:ce,tabOptionsEstadosAlimentacion:re,btnCashAlimentacion:k,btnImprimirReporteAlimentacion:$,btnFinalizar:o,estadosAlimentacion:le,filtrarAlimentacion:Q,accionesTabla:L,accion:d,alimentacion:r,maskFecha:O,is_month:v,checkValue:S,mixin:e,v$:C}}});const be={class:"row q-col-gutter-sm q-py-md"},fe={class:"col-12 col-md-3"},ge={class:"row items-center justify-end"},Ae={class:"col-12 col-md-3"},ve={class:"col-12 col-md-3"};function Ce(e,o,r,b,d,p){const s=j("tab-layout-filter-tabs2");return G(),H(s,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,mostrarListado:!0,tabOptions:e.tabOptionsEstadosAlimentacion,accion1:e.btnCashAlimentacion,accion2:e.btnImprimirReporteAlimentacion,accion3:e.btnFinalizar,full:!1,permitirEditar:!1,permitirEliminar:!1,filtrar:e.filtrarAlimentacion,tabDefecto:e.estadosAlimentacion.activa},{formulario:c(()=>[l(ie,{onSubmit:o[5]||(o[5]=Z(()=>{},["prevent"]))},{default:c(()=>[m("div",be,[m("div",fe,[o[6]||(o[6]=m("label",{class:"q-mb-sm block"},"Mes",-1)),l(h,{modelValue:e.alimentacion.mes,"onUpdate:modelValue":o[2]||(o[2]=i=>e.alimentacion.mes=i),placeholder:"Obligatorio",error:!!e.v$.mes.$errors.length,disable:e.accion=="CONSULTAR"||e.accion=="EDITAR",onBlur:e.v$.mes.$touch,outlined:"",dense:"",readonly:""},{append:c(()=>[l(J,{name:"event",class:"cursor-pointer"},{default:c(()=>[l(x,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:e.is_month,"onUpdate:modelValue":o[1]||(o[1]=i=>e.is_month=i)},{default:c(()=>[l(ee,{modelValue:e.alimentacion.mes,"onUpdate:modelValue":[o[0]||(o[0]=i=>e.alimentacion.mes=i),e.checkValue],minimal:"",mask:"MM-YYYY","emit-immediately":"","default-view":"Years"},{default:c(()=>[m("div",ge,[X(l(K,{label:"Cerrar",color:"primary",flat:""},null,512),[[oe]])])]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","error","disable","onBlur"])]),m("div",Ae,[o[7]||(o[7]=m("label",{class:"q-mb-sm block"},"Nombre",-1)),l(h,{modelValue:e.alimentacion.nombre,"onUpdate:modelValue":o[3]||(o[3]=i=>e.alimentacion.nombre=i),placeholder:"Obligatorio",disable:"",type:"textarea",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),m("div",ve,[l(W,{class:"q-mt-lg q-pt-md",modelValue:e.alimentacion.es_quincena,"onUpdate:modelValue":[o[4]||(o[4]=i=>e.alimentacion.es_quincena=i),e.obtenerNombreMes],label:"Es quincena",disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tabOptions","accion1","accion2","accion3","filtrar","tabDefecto"])}var io=Y(ue,[["render",Ce]]);export{io as default};

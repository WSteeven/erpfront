var ie=Object.defineProperty;var ne=(o,e,b)=>e in o?ie(o,e,{enumerable:!0,configurable:!0,writable:!0,value:b}):o[e]=b;var _=(o,e,b)=>(ne(o,typeof e!="symbol"?e+"":e,b),b);import{e as g,c as le,U as mo,be as re,p as po,u as se,E as te,bA as I,dC as F,A as de,a3 as Y,g as ce,de as ue,b_ as me,cy as pe,v as be,x as L,y as d,z as c,D as i,H as l,a7 as ve,B as r,L as u,K as w,F as bo,k as fe,R as x,a5 as oo,N as eo,aa as ge,O as vo,P as fo,G as M,M as U,I as Ve}from"./index.846478c1.js";import{Q as ye,a as Pe,C as we}from"./QPopupProxy.7844573b.js";import{Q as k,a as H}from"./QSelect.d8222f79.js";import{Q as go,a as Vo}from"./QItemSection.ca64420c.js";import{a as Ce}from"./QTable.d5868e69.js";import{Q as $e}from"./QForm.0a21c4a5.js";import{C as Se,u as ke,S as Te,i as qe,n as Ee,a5 as he,a6 as De,s as Ie,a7 as yo}from"./utils.19b149f6.js";import{c as Le,a as Be}from"./VisualizarIngresoPage.ba5a517b.js";import{r as R,a as T}from"./index.209eea81.js";import{u as Fe}from"./index.15c331c5.js";import{c as Me}from"./configuracionColumnasProductos.4f52212a.js";import{u as Ue}from"./selector.b0f0805f.js";import{u as je}from"./transaccion.a5ede60b.js";import{u as Ne}from"./devolucion.f55fb486.js";import{T as Qe}from"./TabLayout.b05b8b79.js";import{E as Oe}from"./EssentialSelectableTable.57ea1b28.js";import{E as Ae}from"./EssentialTable.01bbad48.js";import{M as ze}from"./ModalEntidad.5edc5f68.js";import{C as Ye}from"./ContenedorSimpleMixin.1a882cca.js";import{P as He}from"./ProveedorController.09047060.js";import{M as Re}from"./MotivoController.31024e26.js";import{T as Po}from"./TareaController.4af45b78.js";import{C as Je}from"./ClienteController.b9526fcf.js";import{T as Ke}from"./Transaccion.ef293505.js";import{T as Ge}from"./TransaccionIngresoController.9485e9bb.js";import{u as Xe}from"./transferencia.f50bcf5e.js";import{C as We}from"./ComportamientoModalesGestionarIngreso.372b6fd8.js";import{u as Ze}from"./filtrosListadosGenerales.c330183b.js";import{i as wo}from"./iconos.5bc406be.js";import{N as _e}from"./NoOptionComponent.5e086980.js";import{E as xe}from"./ErrorComponent.eba095ef.js";import"./format.8ac60962.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./QChip.697486c2.js";import"./use-fullscreen.18eeae01.js";import"./SelectorController.6c5262b2.js";import"./entidadAuditable.75a46700.js";import"./QTabs.19bbf6a5.js";import"./QResizeObserver.847ee253.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./QPage.b0adedad.js";import"./buttonSubmits.31738227.js";import"./EssentialTablePagination.3349ebcb.js";import"./QToolbar.2bb5adc4.js";import"./QBtnGroup.b7cc3fd9.js";import"./QBadge.60ffdb76.js";import"./QFile.c3222262.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./Transferencia.f2b64659.js";import"./ComponenteModal.domain.3bd8db1f.js";import"./DetalleProductoPage.c7e1ec6e.js";import"./configuracionColumnasDetallesProductos.d6dcbc18.js";import"./detalle.7cb0a5bb.js";import"./DetalleProducto.7fc57c43.js";import"./PermisoArma.2f16dcc8.js";import"./i18n-validators.06501904.js";import"./TabLayoutFilterTabs2.94e4b3e1.js";import"./EssentialTableTabs.d6bee6af.js";import"./DetalleProductoController.28e02f9a.js";import"./ProductoController.71ce2d89.js";import"./MarcaController.6813984a.js";import"./ModeloController.6883e0f9.js";import"./TipoFibraController.f3884a2e.js";import"./HiloController.8e88d4b1.js";import"./DetalleProductoPage.e7007307.js";import"./LabelAbrirModal.791a07ad.js";import"./PermisoArmaPage.e334e97f.js";import"./FormularioPermisoArma.fcf4a146.js";import"./ProductoPage.d31d0fa6.js";import"./CategoriaController.68fbf3b3.js";import"./UnidadMedidaController.dcd7fdc4.js";import"./MarcaPage.9aba14ba.js";import"./ModeloPage.22b7fc22.js";const oa=[{name:"producto",field:"producto",label:"Producto",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!1},{name:"categoria",field:"categoria",label:"Categoria",align:"left",sortable:!0},{name:"condiciones",field:"condiciones",label:"Condici\xF3n",align:"left",sortable:!1},{name:"observacion",field:"observacion",label:"Observaci\xF3n",align:"left",sortable:!1},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",sortable:!1},{name:"devuelto",field:"devuelto",label:"Devuelto",align:"left",sortable:!1},{name:"pendiente",field:"pendiente",label:"Pendiente",align:"left",sortable:!1}],ea=[{name:"producto",field:"producto",label:"Producto",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 600px; overflow: auto;",align:"left",sortable:!0},{name:"id",field:"id",label:"Id Detalle",align:"left",visible:!1,editable:!1},{name:"modelo",field:"modelo",label:"Modelo",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!0},{name:"fibra",field:"fibra",label:"Fibra",align:"left",sortable:!0},{name:"puntas",field:"puntas",label:"Detalles Fibra",align:"left",sortable:!0},{name:"adicionales",field:"adicionales",label:"Campos adicionales",align:"left",sortable:!0}];function aa(o,e){const b=g(),f=g([]),v=g([]),E=g(),p={refListadoSeleccionable:b,listadoPrecargado:v,listadoSeleccionable:f,endpoint:e,limpiar:()=>{o.id=null,E.value=null},seleccionarMultiple:C=>{o.listadoProductosTransaccion=[...o.listadoProductosTransaccion,...C],o.listadoProductosTransaccion.forEach(a=>{a.id=Se(o.listadoProductosTransaccion)+1})}},V=Ue(p);return{refListadoSeleccionable:b,listado:f,listar:C=>V.listar(E.value,C),limpiar:()=>p.limpiar(),seleccionar:C=>{let a=[];a=o.listadoProductosTransaccion.map(S=>{var A;(A=S.condiciones)!=null||S.id});const O=C.filter(S=>!a.includes(S.id));O.forEach(S=>{S.cantidad=1}),p.seleccionarMultiple(O)},criterioBusqueda:E}}class ia{constructor(e,b){_(this,"transaccion");_(this,"listadoDevolucion",g([]));this.transaccion=e,this.listadoDevolucion=b}async validar(){if(this.transaccion.listadoProductosTransaccion.length===0)throw new Error("Debe agregar al menos un producto al listado");if(this.transaccion.listadoProductosTransaccion.some(b=>b.cantidad<=0))throw new Error("La cantidad de los productos del listado debe ser mayor a 0");if(!this.transaccion.ingreso_masivo&&!this.transaccion.listadoProductosTransaccion.every(f=>f.hasOwnProperty("condiciones")))throw new Error("Debes seleccionar un estado para cada \xEDtem");return!0}}var na=le({name:"transacciones_ingresos",components:{ErrorComponent:xe,NoOptionComponent:_e,TabLayout:Qe,EssentialTable:Ae,ModalesEntidad:ze,EssentialSelectableTable:Oe},setup(){const o=new Ye(Ke,new Ge),{entidad:e,disabled:b,accion:f,listadosAuxiliares:v}=o.useReferencias(),{setValidador:E,obtenerListados:p,cargarVista:V,listar:j,guardar:N,editar:Q,eliminar:C,reestablecer:a}=o.useComportamiento(),{onConsultado:O,onReestablecer:S,onGuardado:A,onBeforeGuardar:Co,onBeforeModificar:$o}=o.useHooks(),{confirmar:ao,prompt:io}=mo(),J=new We;re().setQuasar(po()),ke().setQuasar(po());const y=se(),$=je(),s=Ne(),h=Xe(),no=new Te,So=y.esCoordinador||y.esBodeguero;A(()=>{P.value=[],s.resetearDevolucion()}),O(()=>{e.solicitante=e.solicitante_id,$.transaccion.hydrate(e)}),S(()=>{P.value=[],e.condicion=null,s.resetearDevolucion(),q.value=!1}),Co(()=>{e.proveedor=e.proveedor_id?v.proveedores.find(n=>n.id===e.proveedor_id).razon_social:e.proveedor}),$o(()=>{e.proveedor=e.proveedor_id?v.proveedores.find(n=>n.id===e.proveedor_id).razon_social:e.proveedor});const{refListadoSeleccionable:ko,criterioBusqueda:To,listado:qo,listar:Eo,limpiar:K,seleccionar:ho}=aa(e,"detalles"),Do=g(!1),Io=g(!0),q=g(!1),z=g(!1),P=g(),G=g([]),{clientes:X,filtrarClientes:Lo,empleados:lo,filtrarEmpleados:Bo,sucursales:D,filtrarSucursalesPorBodeguero:Fo,motivos:ro,filtrarMotivos:Mo,tareas:W,proveedores:so,filtrarProveedores:Uo}=Ze(v);V(async()=>{await p({motivos:{controller:new Re,params:{tipo_transaccion_id:1}},clientes:{controller:new Je,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}},empleados:{controller:new te,params:{campos:"id,nombres,apellidos"}},proveedores:new He}),s.devolucion.id?(e.tiene_devolucion=!0,e.tarea=Number.isInteger(s.devolucion.tarea)?s.devolucion.tarea:s.devolucion.tarea_id,await co()):e.solicitante=y.user.id,so.value=v.proveedores});const jo={justificacion:{required:R},sucursal:{required:R},num_comprobante:{required:T(()=>q.value)},fecha_compra:{required:T(()=>q.value)},proveedor_id:{required:T(()=>q.value&&e.modo_seleccion)},proveedor:{required:T(()=>q.value&&!e.modo_seleccion)},motivo:{requiredIfRol:T(y.esBodeguero)},estado:{requiredIfRol:T(f.value===I.editar)},observacion_est:{requiredIfObsEstado:T(function(){return e.tiene_obs_estado})},listadoProductosTransaccion:{required:R},cliente:{required:R},condicion:{requiredIfMasivo:T(e.ingreso_masivo)}},to=Fe(jo,e);E(to.value);const No=new ia(e,P);o.agregarValidaciones(No);const Qo={titulo:"Agregar nuevo detalle",icono:"bi-plus-lg",color:"positive",accion:()=>{J.abrirModalEntidad("DetalleProductoPage")},visible:()=>f.value==I.nuevo||f.value==I.editar};async function Oo(n){B(),K(),yo(P.value),s.resetearDevolucion();try{await s.cargarDevolucion(n),await co()}catch{B(),K(),yo(P.value),s.resetearDevolucion()}}async function co(){e.devolucion=s.devolucion.id,e.justificacion=s.devolucion.justificacion,e.solicitante=Number.isInteger(s.devolucion.solicitante)?s.devolucion.solicitante:s.devolucion.solicitante_id,e.sucursal=Number.isInteger(s.devolucion.sucursal)?s.devolucion.sucursal:s.devolucion.sucursal_id,e.cliente=Number.isInteger(s.devolucion.cliente)?s.devolucion.cliente:s.devolucion.cliente_id,e.es_para_stock=s.devolucion.es_para_stock,s.devolucion.listadoProductos.forEach(n=>{n.detalle_id=n.id,n.pendiente=n.cantidad-n.devuelto}),P.value=[...s.devolucion.listadoProductos.filter(n=>n.cantidad!==n.devuelto)],P.value.sort((n,t)=>n.id-t.id),e.listadoProductosTransaccion=P.value.map(n=>({...n,cantidad:n.pendiente})),s.devolucion.tarea&&(e.es_tarea=!0,e.tarea=Number.isInteger(s.devolucion.tarea)?s.devolucion.tarea:s.devolucion.tarea_id)}async function Ao(n){B(),await h.cargarTransferencia(n),zo()}function zo(){e.sucursal=h.transferencia.sucursal_destino,e.justificacion=h.transferencia.justificacion,e.cliente=h.transferencia.cliente,e.per_autoriza=h.transferencia.per_autoriza,e.listadoProductosTransaccion=h.transferencia.listadoProductos}function B(){e.devolucion=null,e.justificacion="",e.solicitante=null,e.sucursal=null,e.listadoProductosTransaccion=[],P.value=[]}function Yo(n){const t=D.value.filter(m=>m.id===n);e.cliente=t[0].cliente_id}function Ho({entidad:n}){const t=e.listadoProductosTransaccion.findIndex(m=>m.id===n.id);ao("\xBFEsta seguro de continuar?",()=>{e.listadoProductosTransaccion.splice(t,1)})}const Ro={titulo:"Actualizar",icono:"bi-arrow-clockwise",accion:()=>{j()},visible:()=>!1},Jo={titulo:"Editar cantidad",accion:({posicion:n})=>{const t={titulo:"Confirmaci\xF3n",mensaje:"Ingresa la cantidad",defecto:e.listadoProductosTransaccion[n].cantidad,tipo:"number",validacion:m=>m>0,accion:m=>{e.listadoProductosTransaccion[n].cantidad=m}};io(t)},visible:()=>f.value===I.nuevo&&e.ingreso_masivo||f.value===I.editar&&e.ingreso_masivo||!Io.value&&e.ingreso_masivo||e.ingreso_masivo},Ko={titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:n})=>{$.idTransaccion=n.id,await $.imprimirIngreso()}},Go={titulo:"Editar",color:"orange-3",icono:wo.editar,visible:()=>y.esCoordinadorBodega,accion:async({entidad:n})=>{console.log("diste clic en botonEditarIngreso"),$.idTransaccion=n.id,await $.showPreviewEgreso(),J.abrirModalEntidad("ModificarIngresoPage")}},Xo={titulo:"Editar fecha de compra",color:"amber-8",icono:wo.editar,visible:({entidad:n})=>n.motivo===F.compraProveedor,accion:async({entidad:n,posicion:t})=>{var uo;const m={titulo:"Fecha de compra",mensaje:"Ingresa la nueva fecha",defecto:(uo=e.listadoProductosTransaccion[t])==null?void 0:uo.fecha_compra,tipo:"text",accion:async ee=>{try{await de.getInstance().put("api/transacciones-ingresos-editar-fecha-compra/"+n.id,{fecha_compra:ee})}catch(Z){if(qe(Z)){const ae=Z.erroresValidacion;await Ee(ae,mo())}}}};io(m)}},Wo={titulo:"Anular",color:"red",icono:"bi-x",accion:async({entidad:n})=>{ao("\xBFEst\xE1 seguro que desea anular la transacci\xF3n?. Esta acci\xF3n restar\xE1 al inventario los materiales ingresados previamente",async()=>{$.idTransaccion=n.id,await $.anularIngreso(),n.estado=$.transaccion.estado})},visible:({entidad:n})=>y.can("puede.anular.transacciones_ingresos")&&n.estado===me.completa};G.value=JSON.parse(Y.getItem("condiciones").toString()),D.value=JSON.parse(Y.getItem("sucursales").toString()),v.sucursales=D.value,ro.value=v.motivos,W.value=v.tareas,X.value=v.clientes,lo.value=v.empleados;const Zo=ce(()=>[...Le,{name:"condiciones",field:"condiciones",label:"Estado del producto",align:"left",sortable:!1,visible:!0,type:"select",options:G.value.map(n=>({label:n.nombre}))},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",type:"number",sortable:!1},{name:"acciones",field:"acciones",label:"Acciones",align:"center"}]);function _o(n){const t=v.tareas.filter(m=>m.id===n);e.cliente=t[0].cliente_id}async function xo(){const n=(await new pe().listar({campos:"id,lugar",activo:1})).result;Y.set("sucursales",JSON.stringify(n)),D.value=JSON.parse(Y.getItem("sucursales").toString()),v.sucursales=n}async function oe(n=!0,t=null){no.activar();let m;n&&(e.tarea=null),t?m=await new Po().listar({id:t}):m=await new Po().listar({activas_empleado:1,empleado_id:e.solicitante,campos:"id,codigo_tarea,titulo",finalizado:0}),v.tareas=m.result,W.value=m.result,no.desactivar()}return{mixin:o,transaccion:e,disabled:b,accion:f,v$:to,soloLectura:Do,configuracionColumnas:Be,motivos:ro,filtrarMotivos:Mo,estados:ue,tareas:W,clientes:X,empleados:lo,filtrarEmpleados:Bo,sucursales:D,filtrarSucursales:Fo,condiciones:G,listadoDevolucion:P,acciones:I,tareaSeleccionada:_o,motivoSeleccionado(n){z.value=!1;const t=v.motivos.filter(m=>m.id===n);q.value=t[0].nombre===F.compraProveedor,z.value=t[0].nombre===F.mercaderiaClienteTarea||t[0].nombre===F.devolucionTarea,e.es_transferencia=t[0].nombre==F.ingresoTransferenciaBodegas,z.value&&oe(!1,e.tarea)},checkMasivo(n){n||(e.condicion=null)},checkDevolucion(n){n||B()},configuracionColumnasProductosSeleccionadosAccion:Zo,configuracionColumnasDetallesProductosSeleccionables:ea,botonEditarCantidad:Jo,botonActualizar:Ro,botonImprimir:Ko,botonAnular:Wo,botonEditarFechaCompra:Xo,botonEditarIngreso:Go,eliminarItem:Ho,configuracionColumnasListadoProductosDevolucion:oa,pagination:g({rowsPerPage:0}),modales:J,abrirModalDetalle:Qo,refListadoSeleccionableProductos:ko,criterioBusquedaProducto:To,listadoProductos:qo,listarProductos:Eo,limpiarProducto:K,seleccionarProducto:ho,configuracionColumnasProductos:Me,rolSeleccionado:So,llenarTransaccion:Oo,limpiarTransaccion:B,llenarTransferencia:Ao,esVisibleComprobante:q,esVisibleTarea:z,transaccionStore:$,guardar:N,editar:Q,eliminar:C,reestablecer:a,esBodeguero:y.esBodeguero,esCoordinador:y.esCoordinador,seleccionarClientePropietario:Yo,recargarSucursales:xo,filtrarClientes:Lo,ordenarClientes(){he(X,y.esBodegueroTelconet)},ordenarSucursales(){De(D,y.esBodegueroTelconet)},ordenarLista:Ie,proveedores:so,filtrarProveedores:Uo}}});const la={class:"row q-col-gutter-sm q-py-md"},ra={key:0,class:"col col-12"},sa={key:1,class:"col-12 col-md-3"},ta={key:2,class:"col-12 col-md-3"};const da={class:"col-12 col-md-3 q-mb-md"},ca={key:4,class:"col-12 col-md-3 q-mb-md"},ua={key:5,class:"col-12 col-md-3"},ma={key:6,class:"col-12 col-md-3 q-mb-md"},pa={key:7,class:"col-12 col-md-3 q-mb-md"},ba={key:8,class:"col-12 col-md-3 col-sm-3"},va={key:9,class:"col-12 col-md-3"},fa={key:10,class:"col-12 col-md-3 q-mb-md"},ga={key:11,class:"col-12 col-md-3 q-mb-md"},Va={class:"row items-center justify-end"},ya={class:"col-12 col-md-3 q-mb-md"},Pa={class:"col-12 col-md-3"},wa={class:"col-12 col-md-3"},Ca={key:12,class:"col-12 col-md-3"},$a={key:13,class:"col-12 col-md-3 q-mb-md"},Sa={key:14,class:"col-12 col-md-3"},ka={key:15,class:"col-12 col-md-3"},Ta={class:"col-12 col-md-3"},qa={key:16,class:"col-12 col-md-3"},Ea={key:17,class:"col-12 col-md-3"},ha={key:18,class:"col-12 col-md-12"},Da={class:"col-12 col-md-12"},Ia={class:"row q-col-gutter-xs"},La={class:"col-12 col-md-10 q-mb-md"},Ba={class:"col-12 col-md-2"},Fa={class:"col-12"};function Ma(o,e,b,f,v,E){const p=L("error-component"),V=L("no-option-component"),j=L("essential-table"),N=L("essential-selectable-table"),Q=L("tab-layout"),C=L("modales-entidad");return d(),c(Ve,null,[i(Q,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Transacciones - Ingresos",permitirEditar:!1,ajustarCeldas:!0,accion1:o.botonImprimir,accion2:o.botonAnular,accion3:o.botonEditarFechaCompra,accion4:o.botonEditarIngreso,accion1Header:o.botonActualizar,paginate:""},{formulario:l(()=>[i($e,{onSubmit:e[34]||(e[34]=ve(()=>{},["prevent"]))},{default:l(()=>[r("div",la,[o.transaccion.es_para_stock?(d(),c("div",ra,e[35]||(e[35]=[r("span",null,"Se realizar\xE1 un egreso automatico al stock del solicitante",-1)]))):u("",!0),o.transaccion.id?(d(),c("div",sa,[e[36]||(e[36]=r("label",{class:"q-mb-sm block"},"Transacci\xF3n N\xB0",-1)),i(w,{modelValue:o.transaccion.id,"onUpdate:modelValue":e[0]||(e[0]=a=>o.transaccion.id=a),placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly","disable"])])):u("",!0),o.transaccion.created_at?(d(),c("div",ta,[e[37]||(e[37]=r("label",{class:"q-mb-sm block"},"Fecha",-1)),i(w,{modelValue:o.transaccion.created_at,"onUpdate:modelValue":e[1]||(e[1]=a=>o.transaccion.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),u("",!0),r("div",da,[e[39]||(e[39]=r("label",{class:"q-mb-sm block"},"Motivo",-1)),i(k,{modelValue:o.transaccion.motivo,"onUpdate:modelValue":[e[4]||(e[4]=a=>o.transaccion.motivo=a),o.motivoSeleccionado],options:o.motivos,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarMotivos,onPopupShow:e[5]||(e[5]=a=>o.ordenarLista(o.motivos,"nombre")),readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.motivo.$errors.length,"error-message":"Debes seleccionar un motivo","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"motivo",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","readonly","disable","error","option-value","option-label"])]),o.transaccion.es_transferencia?(d(),c("div",ca,[e[40]||(e[40]=r("label",{class:"q-mb-sm block"},"N\xB0 transferencia",-1)),i(w,{type:"number",modelValue:o.transaccion.transferencia,"onUpdate:modelValue":e[6]||(e[6]=a=>o.transaccion.transferencia=a),placeholder:"Opcional",hint:"Ingresa un numero de transferencia y presiona Enter",onKeyup:e[7]||(e[7]=oo(a=>o.llenarTransferencia(o.transaccion.transferencia),["enter"])),readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])])):u("",!0),o.accion==="NUEVO"&&!o.transaccion.es_transferencia&&!o.esVisibleComprobante||o.transaccion.tiene_devolucion&&!o.transaccion.es_transferencia?(d(),c("div",ua,[i(eo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.tiene_devolucion,"onUpdate:modelValue":[e[8]||(e[8]=a=>o.transaccion.tiene_devolucion=a),o.checkDevolucion],label:"\xBFHay devoluci\xF3n?",outlined:"",disable:o.disabled,dense:""},null,8,["modelValue","onUpdate:modelValue","disable"])])):u("",!0),o.transaccion.tiene_devolucion||o.transaccion.devolucion?(d(),c("div",ma,[e[41]||(e[41]=r("label",{class:"q-mb-sm block"},"N\xB0 devoluci\xF3n",-1)),i(w,{type:"number",modelValue:o.transaccion.devolucion,"onUpdate:modelValue":e[9]||(e[9]=a=>o.transaccion.devolucion=a),placeholder:"Opcional",hint:"Ingresa un numero de devoluci\xF3n y presiona Enter",onKeyup:e[10]||(e[10]=oo(a=>o.llenarTransaccion(o.transaccion.devolucion),["enter"])),readonly:o.disabled,disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly","disable"])])):u("",!0),o.esVisibleComprobante||o.transaccion.num_comprobante?(d(),c("div",pa,[e[42]||(e[42]=r("label",{class:"q-mb-sm block"},"N\xB0 Factura/Comprobante",-1)),i(w,{modelValue:o.transaccion.num_comprobante,"onUpdate:modelValue":e[11]||(e[11]=a=>o.transaccion.num_comprobante=a),type:"number",placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,rules:[a=>a>0||"Ingresa un numero de comprobante v\xE1lido"],"lazy-rules":!0,error:!!o.v$.num_comprobante.$errors.length,outlined:"",dense:""},{error:l(()=>[i(p,{clave:"num_comprobante",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","readonly","disable","rules","error"])])):u("",!0),o.esVisibleComprobante?(d(),c("div",ba,[e[43]||(e[43]=r("label",{class:"q-mb-sm block"},"Modo de selecci\xF3n de Proveedor",-1)),i(ge,{label:o.transaccion.modo_seleccion?"LISTADO":"TEXTO",modelValue:o.transaccion.modo_seleccion,"onUpdate:modelValue":[e[12]||(e[12]=a=>o.transaccion.modo_seleccion=a),e[13]||(e[13]=a=>o.transaccion.proveedor=null)],icon:"bi-check2-circle","unchecked-icon":"clear",disable:o.disabled,color:"primary","keep-color":""},null,8,["label","modelValue","disable"])])):u("",!0),o.esVisibleComprobante&&o.transaccion.modo_seleccion||o.transaccion.proveedor_id?(d(),c("div",va,[e[44]||(e[44]=r("label",{class:"q-mb-sm block"},"Proveedor",-1)),i(k,{modelValue:o.transaccion.proveedor_id,"onUpdate:modelValue":e[14]||(e[14]=a=>o.transaccion.proveedor_id=a),options:o.proveedores,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarProveedores,disable:o.disabled||o.soloLectura,"option-label":a=>a.razon_social+" - "+a.sucursal,"option-value":a=>a.id,error:!!o.v$.proveedor_id.$errors.length,"emit-value":"","map-options":""},{option:l(a=>[i(go,vo(fo(a.itemProps)),{default:l(()=>[i(Vo,null,{default:l(()=>[i(H,null,{default:l(()=>[M(U(a.opt.razon_social),1)]),_:2},1024),i(H,{caption:""},{default:l(()=>[M(U(a.opt.nombre_comercial)+" - Sucursal: "+U(a.opt.sucursal||a.opt.direccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[i(V)]),default:l(()=>[r("template",null,[i(p,{clave:"proveedor_id",v$:o.v$},null,8,["v$"])])]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","error"])])):u("",!0),o.esVisibleComprobante&&!o.transaccion.modo_seleccion||o.transaccion.proveedor?(d(),c("div",fa,[e[45]||(e[45]=r("label",{class:"q-mb-sm block"},"Proveedor",-1)),i(w,{modelValue:o.transaccion.proveedor,"onUpdate:modelValue":e[15]||(e[15]=a=>o.transaccion.proveedor=a),placeholder:"Obligatorio",disable:o.disabled||o.soloLectura,error:!!o.v$.proveedor.$errors.length,outlined:"",dense:""},{default:l(()=>[r("template",null,[i(p,{clave:"proveedor",v$:o.v$},null,8,["v$"])])]),_:1},8,["modelValue","disable","error"])])):u("",!0),o.esVisibleComprobante||o.transaccion.fecha_compra?(d(),c("div",ga,[e[46]||(e[46]=r("label",{class:"q-mb-sm block"},"Fecha de compra",-1)),i(w,{modelValue:o.transaccion.fecha_compra,"onUpdate:modelValue":e[17]||(e[17]=a=>o.transaccion.fecha_compra=a),placeholder:"YYYY-MM-DD",hint:"Opcional",disable:o.disabled,error:!!o.v$.fecha_compra.$errors.length,"error-message":"Debes ingresar la fecha de compra",clearable:"",outlined:"",dense:""},{append:l(()=>[i(bo,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(ye,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(Pe,{modelValue:o.transaccion.fecha_compra,"onUpdate:modelValue":e[16]||(e[16]=a=>o.transaccion.fecha_compra=a),mask:"YYYY-MM-DD","today-btn":""},{default:l(()=>[r("div",Va,[fe(i(x,{label:"Cerrar",color:"primary",flat:""},null,512),[[we]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),error:l(()=>[i(p,{clave:"fecha_compra",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error"])])):u("",!0),r("div",ya,[e[47]||(e[47]=r("label",{class:"q-mb-sm block"},"Sucursal",-1)),i(k,{modelValue:o.transaccion.sucursal,"onUpdate:modelValue":[e[18]||(e[18]=a=>o.transaccion.sucursal=a),o.seleccionarClientePropietario],options:o.sucursales,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.sucursal.$errors.length,"error-message":"Debes seleccionar una sucursal","use-input":"","input-debounce":"0",onFilter:o.filtrarSucursales,onPopupShow:o.ordenarSucursales,"option-value":a=>a.id,"option-label":a=>a.lugar,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"sucursal",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),after:l(()=>[i(x,{color:"positive",onClick:o.recargarSucursales},{default:l(()=>[i(bo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","readonly","disable","error","onFilter","onPopupShow","onUpdate:modelValue","option-value","option-label"])]),r("div",Pa,[e[48]||(e[48]=r("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),i(w,{modelValue:o.transaccion.justificacion,"onUpdate:modelValue":e[19]||(e[19]=a=>o.transaccion.justificacion=a),placeholder:"Obligatorio",type:"textarea",autogrow:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.justificacion.$errors.length,outlined:"",dense:""},{error:l(()=>[i(p,{clave:"justificacion",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","readonly","disable","error"])]),r("div",wa,[e[49]||(e[49]=r("label",{class:"q-mb-sm block"},"Solicitante",-1)),i(k,{modelValue:o.transaccion.solicitante,"onUpdate:modelValue":e[20]||(e[20]=a=>o.transaccion.solicitante=a),options:o.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:o.disabled||o.soloLectura,"use-input":"","input-debounce":"0",onFilter:o.filtrarEmpleados,onPopupShow:e[21]||(e[21]=a=>o.ordenarLista(o.empleados,"apellidos")),readonly:o.disabled||o.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","disable","onFilter","readonly","option-label","option-value"])]),o.esVisibleTarea?(d(),c("div",Ca,[e[50]||(e[50]=r("label",{class:"q-mb-sm block"},"Tarea",-1)),i(k,{modelValue:o.transaccion.tarea,"onUpdate:modelValue":[e[22]||(e[22]=a=>o.transaccion.tarea=a),o.tareaSeleccionada],options:o.tareas,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Tarea #",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,"option-label":a=>a.titulo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[i(go,vo(fo(a.itemProps)),{default:l(()=>[i(Vo,null,{default:l(()=>[i(H,null,{default:l(()=>[M(U(a.opt.codigo_tarea),1)]),_:2},1024),i(H,{caption:""},{default:l(()=>[M(U(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","readonly","disable","onUpdate:modelValue","option-label","option-value"])])):u("",!0),o.accion===o.acciones.consultar||o.accion===o.acciones.editar?(d(),c("div",$a,[e[51]||(e[51]=r("label",{class:"q-mb-sm block"},"Estado",-1)),i(k,{modelValue:o.transaccion.estado,"onUpdate:modelValue":e[23]||(e[23]=a=>o.transaccion.estado=a),options:o.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled||o.soloLectura,disable:o.disabled||o.soloLectura,error:!!o.v$.estado.$errors.length,"error-message":"Debes seleccionar un estado para la transacci\xF3n","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"estado",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","readonly","disable","error","option-value","option-label"])])):u("",!0),o.rolSeleccionado?(d(),c("div",Sa,[i(eo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.tiene_obs_estado,"onUpdate:modelValue":e[24]||(e[24]=a=>o.transaccion.tiene_obs_estado=a),label:"Tiene observaci\xF3n",outlined:"",disable:o.disabled||o.soloLectura,dense:""},null,8,["modelValue","disable"])])):u("",!0),o.transaccion.tiene_obs_estado?(d(),c("div",ka,[e[52]||(e[52]=r("label",{class:"q-mb-sm block"},"Observacion",-1)),i(w,{type:"textarea",autogrow:"",modelValue:o.transaccion.observacion_est,"onUpdate:modelValue":e[25]||(e[25]=a=>o.transaccion.observacion_est=a),placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.observacion_est.$errors.length,outlined:"",dense:""},{error:l(()=>[i(p,{clave:"observacion_est",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","readonly","disable","error"])])):u("",!0),r("div",Ta,[e[53]||(e[53]=r("label",{class:"q-mb-sm block"},"Cliente",-1)),i(k,{modelValue:o.transaccion.cliente,"onUpdate:modelValue":e[26]||(e[26]=a=>o.transaccion.cliente=a),options:o.clientes,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.cliente.$errors.length,"error-message":"Debes seleccionar un cliente","use-input":"","input-debounce":"0",onPopupShow:o.ordenarClientes,onFilter:o.filtrarClientes,"option-value":a=>a.id,"option-label":a=>a.razon_social,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"cliente",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","readonly","disable","error","onPopupShow","onFilter","option-value","option-label"])]),o.accion===o.acciones.nuevo?(d(),c("div",qa,[i(eo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.ingreso_masivo,"onUpdate:modelValue":[e[27]||(e[27]=a=>o.transaccion.ingreso_masivo=a),o.checkMasivo],label:"\xBFIngreso masivo?",disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue","disable"])])):u("",!0),o.transaccion.ingreso_masivo?(d(),c("div",Ea,[e[54]||(e[54]=r("label",{class:"q-mb-sm block"},"Estado de los productos",-1)),i(k,{modelValue:o.transaccion.condicion,"onUpdate:modelValue":e[28]||(e[28]=a=>o.transaccion.condicion=a),options:o.condiciones,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,error:!!o.v$.condicion.$errors.length,"error-message":"Debes seleccionar una condici\xF3n","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(p,{clave:"condicion",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(V)]),_:1},8,["modelValue","options","readonly","error","option-value","option-label"])])):u("",!0),o.listadoDevolucion!==void 0&&o.listadoDevolucion.length>0?(d(),c("div",ha,[i(Ce,{"flat.bordered":"",style:{height:"300px"},title:"Listado de la devoluci\xF3n",class:"bg-body-table custom-border",rows:o.listadoDevolucion,columns:o.configuracionColumnasListadoProductosDevolucion,"row-key":"id","hide-bottom":!0,pagination:o.pagination,"onUpdate:pagination":e[29]||(e[29]=a=>o.pagination=a),"rows-per-page-options":[0],"wrap-cells":"","virtual-scroll":"",dense:""},null,8,["rows","columns","pagination"])])):u("",!0),r("div",Da,[e[56]||(e[56]=r("label",{class:"q-mb-sm block"},"Agregar productos",-1)),r("div",Ia,[r("div",La,[i(w,{modelValue:o.criterioBusquedaProducto,"onUpdate:modelValue":e[30]||(e[30]=a=>o.criterioBusquedaProducto=a),placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",disable:o.disabled||o.soloLectura,onKeydown:e[31]||(e[31]=oo(a=>o.listarProductos(),["enter"])),onBlur:e[32]||(e[32]=a=>o.criterioBusquedaProducto===""?o.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","disable"])]),r("div",Ba,[i(x,{onClick:e[33]||(e[33]=a=>o.listarProductos()),icon:"search",unelevated:"",disable:o.disabled||o.soloLectura,color:"positive",class:"full-width",style:{height:"40px"},"no-caps":"",glossy:""},{default:l(()=>e[55]||(e[55]=[M("Buscar")])),_:1},8,["disable"])])])]),r("div",Fa,[i(j,{titulo:"Productos Seleccionados",configuracionColumnas:o.configuracionColumnasProductosSeleccionadosAccion,datos:o.transaccion.listadoProductosTransaccion,permitirConsultar:!1,permitirEditar:!o.transaccion.ingreso_masivo&&o.accion===o.acciones.nuevo,permitirEliminar:o.accion==o.acciones.nuevo||o.accion==o.acciones.editar,mostrarBotones:!1,accion1:o.botonEditarCantidad,accion1Header:o.abrirModalDetalle,altoFijo:!1,ajustarCeldas:!0,onEliminar:o.eliminarItem,permitirEditarModal:!0,modalMaximized:!1},null,8,["configuracionColumnas","datos","permitirEditar","permitirEliminar","accion1","accion1Header","onEliminar"])])])]),_:1}),i(N,{ref:"refListadoSeleccionableProductos","configuracion-columnas":o.configuracionColumnasDetallesProductosSeleccionables,datos:o.listadoProductos,"tipo-seleccion":"multiple",onSelected:o.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","accion3","accion4","accion1Header"]),i(C,{comportamiento:o.modales},null,8,["comportamiento"])],64)}var un=be(na,[["render",Ma]]);export{un as default};

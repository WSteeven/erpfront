import{Q as u,a as h}from"./QSelect.d8222f79.js";import{Q as g,a as f}from"./QItemSection.ca64420c.js";import{c as lo,be as ao,p as I,f as to,U as io,e as w,E as ro,s as M,a3 as no,q as po,dJ as uo,dK as k,A as mo,bH as co,t as fo,v as bo,x as $,y as r,S as D,H as a,D as l,B as t,bf as vo,z as p,O as G,P as H,G as b,M as P,aa as go,L as n,K as S,F as y,k as J,R as C,N as Vo}from"./index.846478c1.js";import{Q as K,a as W,C as X}from"./QPopupProxy.7844573b.js";import{Q as wo}from"./QBtnGroup.b7cc3fd9.js";import{Q as ko}from"./QPage.b0adedad.js";import{Q as yo,a as Co}from"./QLayout.a706f694.js";import{a as Eo}from"./VisualizarEgresoPage.fd3fd7c3.js";import{E as qo}from"./EssentialTable.01bbad48.js";import{C as So,A as Ro,l as Qo,n as Uo}from"./chart.2729d76a.js";import{M as To}from"./ModalEntidad.5edc5f68.js";import{u as Fo,S as ho,v as Po,s as Ao,A as Y}from"./utils.19b149f6.js";import{C as No}from"./ContenedorSimpleMixin.1a882cca.js";import{T as Lo}from"./TransaccionIngresoController.9485e9bb.js";import{T as Oo}from"./Transaccion.ef293505.js";import{M as jo}from"./MotivoController.31024e26.js";import{u as zo}from"./transaccionEgreso.3ba53bb1.js";import{E as Bo}from"./EmpleadoRolesController.89b1a3b6.js";import{T as Io}from"./TareaController.4af45b78.js";import{C as Mo}from"./ClienteController.b9526fcf.js";import{C as $o}from"./ComportamientoModalesGestionarEgresos.1d7aff8d.js";import{C as Do}from"./CategoriaController.68fbf3b3.js";import{u as Z}from"./filtrosListadosGenerales.c330183b.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./QScrollObserver.5aff62ae.js";import"./QResizeObserver.847ee253.js";import"./QForm.0a21c4a5.js";import"./TabLayout.b05b8b79.js";import"./QTabs.19bbf6a5.js";import"./QTabPanels.ca44a1cd.js";import"./use-panel.27349585.js";import"./touch.9135741d.js";import"./buttonSubmits.31738227.js";import"./EssentialTablePagination.3349ebcb.js";import"./QTable.d5868e69.js";import"./use-fullscreen.18eeae01.js";import"./QToolbar.2bb5adc4.js";import"./QBadge.60ffdb76.js";import"./EssentialSelectableTable.57ea1b28.js";import"./pedido.a0fd8edf.js";import"./entidadAuditable.75a46700.js";import"./transferencia.f50bcf5e.js";import"./Transferencia.f2b64659.js";import"./QFile.c3222262.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e43b947c.js";import"./VisorImagen.93b8e0f6.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.eba095ef.js";import"./i18n-validators.06501904.js";import"./index.209eea81.js";import"./configuracion_general.cac1c388.js";import"./ConfiguracionController.1234694f.js";import"./ComponenteModal.domain.3bd8db1f.js";import"./transaccion.a5ede60b.js";So.register(Ro,Qo,Uo);var Go=lo({components:{EssentialTable:qo,ModalEntidad:To},setup(){const s=new No(Oo,new Lo),{listadosAuxiliares:e}=s.useReferencias(),{obtenerListados:A,cargarVista:N}=s.useComportamiento();ao().setQuasar(I()),Fo().setQuasar(I());const m=new ho,R=new $o,i=to({tipo:null,fecha_inicio:"",fecha_fin:"",solicitante:null,per_retira:null,responsable:null,per_autoriza:null,per_atiende:null,sucursal:null,motivo:null,pedido:null,tarea:null,transferencia:null,firmada:!0,categorias:null,accion:""}),{notificarError:Q,notificarAdvertencia:o}=io(),v=zo(),E=w([]),V=w([]),q=w([]),{empleados:L,filtrarEmpleados:_}=Z(e),O=w([]),U=w([]),{categorias:j}=Z(e);N(async()=>{await A({empleados:new ro,motivos:{controller:new jo,params:{tipo_transaccion_id:2}}}),e.categorias=[],i.fecha_fin=Po(M)});function x(){i.solicitante=null,i.sucursal=null,i.responsable=null,i.per_retira=null,i.per_autoriza=null,i.per_atiende=null,i.motivo=null,i.pedido=null,i.tarea=null,i.firmada=!0,i.transferencia=null,i.accion=""}async function oo(c){try{const d=mo.getInstance(),T=co.URL_BASE+"/"+d.getEndpoint(fo.transacciones_egresos)+"/reportes",B="reporte_egresos_bodega";switch(c){case"excel":i.accion="excel",await Y(T,"POST","blob","xlsx",B,i);break;case"pdf":i.accion="pdf",await Y(T,"POST","blob","pdf",B,i);break;default:i.accion="";const F=await d.post(T,i);F.data.results&&(E.value=F.data.results,F.data.results.length<1&&o("No se obtuvieron resultados"))}}catch(d){console.log(d),Q("Error al obtener reporte")}}async function eo(c){if(x(),c==k.tarea&&U.value.length==0){m.activar();const{response:d}=await new Io().listar({campos:"id,codigo_tarea,titulo,cliente_id"});m.desactivar(),U.value=d.data.results}if(c==k.bodeguero&&V.value.length==0){m.activar();const{response:d}=await new Bo().listar({roles:["BODEGA","ACTIVOS FIJOS"]});m.desactivar(),V.value=d.data.results}if(c==k.cliente&&q.value.length==0){m.activar();const{response:d}=await new Mo().listar({estado:1,requiere_bodega:1});m.desactivar(),q.value=d.data.results}if(c==k.categorias){m.activar();const{response:d}=await new Do().listar();m.desactivar(),j.value=d.data.results}}const so={titulo:"",icono:"bi-eye",color:"primary",accion:async({entidad:c})=>{v.idTransaccion=c.id,await v.showPreview(),R.abrirModalEntidad("VisualizarEgresoPage")}},z=JSON.parse(no.getItem("sucursales").toString());return L.value=e.empleados,O.value=e.motivos,z.unshift({id:0,lugar:"TODAS LAS SUCURSALES"}),{configuracionColumnas:[...Eo,po],reporte:i,maskFecha:M,sucursales:z,listado:E,empleados:L,bodegueros:V,motivos:O,tareas:U,clientes:q,categorias:j,opcionesReportesEgresos:uo,tiposReportesEgresos:k,buscarReporte:oo,consultarListado:eo,botonVerTransaccion:so,modales:R,filtrarEmpleados:_,ordenarLista:Ao}}});const Ho={class:"col"},Jo={class:"row q-col-gutter-sm q-pa-sm q-py-md"},Ko={class:"col-12 col-md-3"},Wo={key:0,class:"col-12 col-md-3"},Xo={key:1,class:"col-12 col-md-3"},Yo={key:2,class:"col-12 col-md-3"},Zo={key:3,class:"col-12 col-md-3"},_o={key:4,class:"col-12 col-md-3"},xo={key:5,class:"col-12 col-md-3"},oe={key:6,class:"col-12 col-md-3 q-mb-md"},ee={key:7,class:"col-12 col-md-3 q-mb-md"},se={key:8,class:"col-12 col-md-3 q-mb-md"},le={key:9,class:"col-12 col-md-3 q-mb-md"},ae={key:10,class:"col-12 col-md-3 q-mb-md"},te={key:11,class:"col-12 col-md-3 q-mb-md"},ie={class:"col-12 col-md-3"},re={class:"row items-center justify-end"},ne={class:"col-12 col-md-3"},pe={class:"row items-center justify-end"},de={class:"col-12 col-md-3"},ue={class:"col-12 col-md-12 q-mt-md"},me={class:"text-center"},ce={key:0,class:"row q-col-gutter-sm q-pa-sm q-py-md"},fe={class:"col-12 col-md-12"};function be(s,e,A,N,m,R){const i=$("essential-table"),Q=$("modal-entidad");return r(),D(Co,null,{default:a(()=>[l(yo,null,{default:a(()=>[l(ko,{padding:""},{default:a(()=>[t("div",Ho,[l(vo,{class:"rounded-card custom-shadow"},{default:a(()=>[t("div",Jo,[t("div",Ko,[e[22]||(e[22]=t("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),l(u,{modelValue:s.reporte.tipo,"onUpdate:modelValue":[e[0]||(e[0]=o=>s.reporte.tipo=o),e[1]||(e[1]=o=>s.consultarListado(s.reporte.tipo))],options:s.opcionesReportesEgresos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":o=>o.label,"option-value":o=>o.value,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),s.reporte.tipo===s.tiposReportesEgresos.categorias?(r(),p("div",Wo,[e[23]||(e[23]=t("label",{class:"q-mb-sm block"},"Seleccione una o varias categorias ",-1)),l(u,{modelValue:s.reporte.categorias,"onUpdate:modelValue":e[2]||(e[2]=o=>s.reporte.categorias=o),options:s.categorias,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",hint:"Obligatorio",multiple:"","use-chips":"","option-label":o=>o.nombre,"option-value":o=>o.id,"emit-value":"","map-options":""},{option:a(({itemProps:o,opt:v,selected:E,toggleOption:V})=>[l(g,G(H(o)),{default:a(()=>[l(f,null,{default:a(()=>[b(P(v.nombre)+" ",1),l(h,{"inner-h-t-m-l":v.nombre},null,8,["inner-h-t-m-l"])]),_:2},1024),l(f,{side:""},{default:a(()=>[l(go,{"model-value":E,"onUpdate:modelValue":q=>V(v)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","option-label","option-value"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.solicitante?(r(),p("div",Xo,[e[24]||(e[24]=t("label",{class:"q-mb-sm block"},"Seleccione un empleado",-1)),l(u,{modelValue:s.reporte.solicitante,"onUpdate:modelValue":e[3]||(e[3]=o=>s.reporte.solicitante=o),options:s.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:s.filtrarEmpleados,"option-label":o=>o.nombres+" "+o.apellidos,"option-value":o=>o.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.autorizador?(r(),p("div",Yo,[e[25]||(e[25]=t("label",{class:"q-mb-sm block"},"Seleccione un empleado",-1)),l(u,{modelValue:s.reporte.per_autoriza,"onUpdate:modelValue":e[4]||(e[4]=o=>s.reporte.per_autoriza=o),options:s.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:s.filtrarEmpleados,"option-label":o=>o.nombres+" "+o.apellidos,"option-value":o=>o.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.retira?(r(),p("div",Zo,[e[26]||(e[26]=t("label",{class:"q-mb-sm block"},"Seleccione un empleado",-1)),l(u,{modelValue:s.reporte.per_retira,"onUpdate:modelValue":e[5]||(e[5]=o=>s.reporte.per_retira=o),options:s.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:s.filtrarEmpleados,"option-label":o=>o.nombres+" "+o.apellidos,"option-value":o=>o.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.responsable?(r(),p("div",_o,[e[27]||(e[27]=t("label",{class:"q-mb-sm block"},"Seleccione un empleado",-1)),l(u,{modelValue:s.reporte.responsable,"onUpdate:modelValue":e[6]||(e[6]=o=>s.reporte.responsable=o),options:s.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:s.filtrarEmpleados,"option-label":o=>o.nombres+" "+o.apellidos,"option-value":o=>o.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.bodeguero?(r(),p("div",xo,[e[28]||(e[28]=t("label",{class:"q-mb-sm block"},"Seleccione un bodeguero",-1)),l(u,{modelValue:s.reporte.per_atiende,"onUpdate:modelValue":e[7]||(e[7]=o=>s.reporte.per_atiende=o),options:s.bodegueros,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":o=>o.nombres+" "+o.apellidos,"option-value":o=>o.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.motivo?(r(),p("div",oe,[e[30]||(e[30]=t("label",{class:"q-mb-sm block"},"Motivo",-1)),l(u,{modelValue:s.reporte.motivo,"onUpdate:modelValue":e[8]||(e[8]=o=>s.reporte.motivo=o),options:s.motivos,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","option-value":o=>o.id,"option-label":o=>o.nombre,"emit-value":"","map-options":""},{"no-option":a(()=>[l(g,null,{default:a(()=>[l(f,{class:"text-grey"},{default:a(()=>e[29]||(e[29]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.pedido?(r(),p("div",ee,[e[31]||(e[31]=t("label",{class:"q-mb-sm block"},"N\xB0 de pedido",-1)),l(S,{type:"number",modelValue:s.reporte.pedido,"onUpdate:modelValue":e[9]||(e[9]=o=>s.reporte.pedido=o),placeholder:"Obligatorio",outlined:"",dense:""},null,8,["modelValue"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.cliente?(r(),p("div",se,[e[33]||(e[33]=t("label",{class:"q-mb-sm block"},"Cliente",-1)),l(u,{modelValue:s.reporte.cliente,"onUpdate:modelValue":e[10]||(e[10]=o=>s.reporte.cliente=o),options:s.clientes,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","option-value":o=>o.id,"option-label":o=>o.razon_social,"emit-value":"","map-options":""},{"no-option":a(()=>[l(g,null,{default:a(()=>[l(f,{class:"text-grey"},{default:a(()=>e[32]||(e[32]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.sucursal?(r(),p("div",le,[e[35]||(e[35]=t("label",{class:"q-mb-sm block"},"Bodega",-1)),l(u,{modelValue:s.reporte.sucursal,"onUpdate:modelValue":e[11]||(e[11]=o=>s.reporte.sucursal=o),options:s.sucursales,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","option-value":o=>o.id,"option-label":o=>o.lugar,"emit-value":"","map-options":""},{"no-option":a(()=>[l(g,null,{default:a(()=>[l(f,{class:"text-grey"},{default:a(()=>e[34]||(e[34]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.tarea?(r(),p("div",ae,[e[37]||(e[37]=t("label",{class:"q-mb-sm block"},"Tarea",-1)),l(u,{modelValue:s.reporte.tarea,"onUpdate:modelValue":e[12]||(e[12]=o=>s.reporte.tarea=o),options:s.tareas,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","option-value":o=>o.id,"option-label":o=>o.codigo_tarea,"emit-value":"","map-options":""},{option:a(o=>[l(g,G(H(o.itemProps)),{default:a(()=>[l(f,null,{default:a(()=>[l(h,null,{default:a(()=>[b(P(o.opt.codigo_tarea),1)]),_:2},1024),l(h,{caption:""},{default:a(()=>[b(P(o.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[l(g,null,{default:a(()=>[l(f,{class:"text-grey"},{default:a(()=>e[36]||(e[36]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])])):n("",!0),s.reporte.tipo===s.tiposReportesEgresos.transferencia?(r(),p("div",te,[e[38]||(e[38]=t("label",{class:"q-mb-sm block"},"N\xB0 de transferencia",-1)),l(S,{type:"number",modelValue:s.reporte.transferencia,"onUpdate:modelValue":e[13]||(e[13]=o=>s.reporte.transferencia=o),placeholder:"Obligatorio",outlined:"",dense:""},null,8,["modelValue"])])):n("",!0),t("div",ie,[e[39]||(e[39]=t("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),l(S,{modelValue:s.reporte.fecha_inicio,"onUpdate:modelValue":e[15]||(e[15]=o=>s.reporte.fecha_inicio=o),placeholder:"Opcional",outlined:"",dense:""},{append:a(()=>[l(y,{name:"event",class:"cursor-pointer"},{default:a(()=>[l(K,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[l(W,{modelValue:s.reporte.fecha_inicio,"onUpdate:modelValue":e[14]||(e[14]=o=>s.reporte.fecha_inicio=o),mask:s.maskFecha,"today-btn":""},{default:a(()=>[t("div",re,[J(l(C,{label:"Cerrar",color:"primary",flat:""},null,512),[[X]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",ne,[e[40]||(e[40]=t("label",{class:"q-mb-sm block"},"Fecha fin ",-1)),l(S,{modelValue:s.reporte.fecha_fin,"onUpdate:modelValue":e[17]||(e[17]=o=>s.reporte.fecha_fin=o),placeholder:"Opcional",outlined:"",dense:""},{append:a(()=>[l(y,{name:"event",class:"cursor-pointer"},{default:a(()=>[l(K,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[l(W,{modelValue:s.reporte.fecha_fin,"onUpdate:modelValue":e[16]||(e[16]=o=>s.reporte.fecha_fin=o),mask:s.maskFecha,"today-btn":""},{default:a(()=>[t("div",pe,[J(l(C,{label:"Cerrar",color:"primary",flat:""},null,512),[[X]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",de,[l(Vo,{class:"q-mt-sm",modelValue:s.reporte.firmada,"onUpdate:modelValue":e[18]||(e[18]=o=>s.reporte.firmada=o),label:"Firmada",outlined:"",dense:""},null,8,["modelValue"])]),t("div",ue,[t("div",me,[l(wo,{push:""},{default:a(()=>[l(C,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:e[19]||(e[19]=o=>s.buscarReporte("consulta"))},{default:a(()=>[l(y,{name:"bi-search",size:"xs",class:"q-pr-sm"}),e[41]||(e[41]=t("span",null,"Buscar",-1))]),_:1}),l(C,{color:"positive",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:e[20]||(e[20]=o=>s.buscarReporte("excel"))},{default:a(()=>[l(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[42]||(e[42]=t("span",null,"Excel",-1))]),_:1}),l(C,{color:"negative",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:e[21]||(e[21]=o=>s.buscarReporte("pdf"))},{default:a(()=>[l(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[43]||(e[43]=t("span",null,"PDF",-1))]),_:1})]),_:1})])])]),s.listado.length?(r(),p("div",ce,[t("div",fe,[s.listado.length?(r(),D(i,{key:0,titulo:"Listado de transacciones",configuracionColumnas:s.configuracionColumnas,datos:s.listado,mostrarExportar:!0,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"permitir-buscar":!0,ajustarCeldas:!0,accion1:s.botonVerTransaccion,"alto-fijo":!0},null,8,["configuracionColumnas","datos","accion1"])):n("",!0)])])):n("",!0)]),_:1})]),l(Q,{comportamiento:s.modales,mostrarListado:!1,persistente:!1},null,8,["comportamiento"])]),_:1})]),_:1})]),_:1})}var ys=bo(Go,[["render",be]]);export{ys as default};

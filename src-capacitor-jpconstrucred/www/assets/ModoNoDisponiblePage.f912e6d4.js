import{c as L,U as O,u as z,e as R,V as c,v as j,x as G,y as d,S as H,H as r,D as l,bf as J,bg as w,B as s,F as f,K as g,z as t,I as h,J as b,M as v,G as K,aa as W,k as Q,R as C,L as X,c8 as Z,a7 as x}from"./index.846478c1.js";import{Q as ee,a as oe}from"./QItemSection.ca64420c.js";import{Q as ae}from"./QSelect.d8222f79.js";import{Q as q,a as B,C as E}from"./QPopupProxy.7844573b.js";import{Q as M}from"./QTime.8869ceeb.js";import{Q as le}from"./QForm.0a21c4a5.js";import{s as se,v as re}from"./utils.19b149f6.js";import{r as S,a as de}from"./i18n-validators.06501904.js";import{u as te}from"./index.15c331c5.js";import{C as ne}from"./ContenedorSimpleMixin.1a882cca.js";import{E as ie,a as me}from"./EmpleadoDelegadoController.86156aef.js";import{u as ue}from"./filtrosListadosGenerales.c330183b.js";import{B as pe}from"./buttonSubmits.31738227.js";import{E as ce}from"./EmpleadoRolesController.89b1a3b6.js";import"./QChip.697486c2.js";import"./QMenu.c0bc1e4b.js";import"./position-engine.456d5331.js";import"./format.8ac60962.js";import"./TouchPan.efa9afab.js";import"./touch.9135741d.js";import"./index.209eea81.js";import"./entidadAuditable.75a46700.js";var fe=L({components:{ButtonSubmits:pe},setup(e,{emit:o}){const i=new ne(ie,new me),{entidad:n,accion:k,listadosAuxiliares:m}=i.useReferencias(),{setValidador:u,cargarVista:a,obtenerListados:U,editar:A,guardar:N}=i.useComportamiento(),{onGuardado:I}=i.useHooks(),{notificarInformacion:V}=O(),$=z(),_=R(!0),{empleados:y,filtrarEmpleados:P}=ue(m);a(async()=>{await U({empleados:{controller:new ce,params:{roles:[c.tecnico,c.tecnico_lider,c.empleado],excluir:1}}}),y.value=m.empleados,n.empleado=$.user.id});const Y={delegado:{required:S},fecha_hora_desde:{required:de(!_.value)},fecha_hora_hasta:{required:S}},D=te(Y,n);u(D.value),I(()=>{o("guardado",{formulario:"ModoNoDisponiblePage",valor:!0}),o("cerrar-modal",!1)});const F=()=>{o("cerrar-modal",!1),o("guardado",{formulario:"ModoNoDisponiblePage",valor:!1})};function T(p){p?(n.fecha_hora_desde=null,V("El cambio de delegador comenzar\xE1 a aplicarse inmediatamente.")):V("El cambio de delegador empezaran a aplicarse a partir de la fecha y hora que se empieza a delegar")}return{v$:D,store:$,accion:k,inmediato:_,empleado_delegado:n,empleados:y,mask:"YYYY-MM-DD HH:mm",editar:A,guardar:N,cancelar:F,filtrarEmpleados:P,ordenarLista:se,checkTipoDelegacion:T,dateOptions:p=>p>=re("YYYY/MM/DD")}}});const ge={class:"col-12 col-md-12 rounded-card q-py-sm text-center text-accent bg-yellow-2"},he={class:"row q-col-gutter-xs"},be={class:"col-12 col-md-4 col-sm-6"},ve={class:"col-12 col-md-4 col-sm-6"},ke={class:"error-msg"},Ve={class:"col-12 col-md-4 col-sm-3"},$e={key:0,class:"col-12 col-md-4"},_e={class:"q-gutter-md row items-start"},ye={class:"row items-center justify-end"},De={class:"error-msg"},we={class:"col-12 col-md-4"},Qe={class:"q-gutter-md row items-start"},Ce={class:"row items-center justify-end"},qe={class:"error-msg"};function Be(e,o,i,n,k,m){const u=G("button-submits");return d(),H(le,{onSubmit:o[11]||(o[11]=x(()=>{},["prevent"])),class:""},{default:r(()=>[l(J,{class:"rounded-card custom-shadow"},{default:r(()=>[l(w,null,{default:r(()=>[s("div",ge,[l(f,{name:"bi-exclamation-triangle-fill",class:"q-mr-sm",size:"1em"}),o[12]||(o[12]=s("b",null,"\xA0 Advertencia",-1)),o[13]||(o[13]=s("div",null," Procede con precauci\xF3n, ning\xFAn gasto o ticket donde figures como responsable se te cargar\xE1 a ti sino a la persona que seleccionas como delegado hasta la fecha y hora indicada. ",-1))])]),_:1}),l(w,null,{default:r(()=>[s("div",he,[s("div",be,[o[14]||(o[14]=s("label",{class:"q-mb-sm block"},"Delegador",-1)),l(g,{"model-value":e.store.nombreUsuario,dense:"",outlined:"",disable:""},null,8,["model-value"])]),s("div",ve,[o[16]||(o[16]=s("label",{class:"q-mb-sm block"},"Empleado delegado",-1)),l(ae,{modelValue:e.empleado_delegado.delegado,"onUpdate:modelValue":o[0]||(o[0]=a=>e.empleado_delegado.delegado=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",error:!!e.v$.delegado.$errors.length,onBlur:e.v$.delegado.$touch,"error-message":"Debes seleccionar un empleado para delegar","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:o[1]||(o[1]=a=>e.ordenarLista(e.empleados,"nombres")),"option-value":a=>a.id,"option-disable":a=>a.id===e.store.user.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:r(()=>[(d(!0),t(h,null,b(e.v$.delegado.$errors,a=>(d(),t("div",{key:a.$uid},[s("div",ke,v(a.$message),1)]))),128))]),"no-option":r(()=>[l(ee,null,{default:r(()=>[l(oe,{class:"text-grey"},{default:r(()=>o[15]||(o[15]=[K(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","onBlur","onFilter","option-value","option-disable","option-label"])]),s("div",Ve,[o[17]||(o[17]=s("label",{class:"q-mb-sm block"},"Tipo de delegaci\xF3n",-1)),l(W,{label:e.inmediato?"INMEDIATA":"PROGRAMADA",modelValue:e.inmediato,"onUpdate:modelValue":[o[2]||(o[2]=a=>e.inmediato=a),e.checkTipoDelegacion],color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear"},null,8,["label","modelValue","onUpdate:modelValue"])]),e.inmediato?X("",!0):(d(),t("div",$e,[o[18]||(o[18]=s("label",{class:"q-mb-sm block"},"Delegar desde",-1)),l(g,{modelValue:e.empleado_delegado.fecha_hora_desde,"onUpdate:modelValue":o[5]||(o[5]=a=>e.empleado_delegado.fecha_hora_desde=a),placeholder:"Obligatorio",error:!!e.v$.fecha_hora_desde.$errors.length,onBlur:e.v$.fecha_hora_desde.$touch,readonly:"",outlined:"",dense:""},{append:r(()=>[l(f,{name:"event",class:"cursor-pointer"},{default:r(()=>[l(q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[s("div",_e,[l(B,{modelValue:e.empleado_delegado.fecha_hora_desde,"onUpdate:modelValue":o[3]||(o[3]=a=>e.empleado_delegado.fecha_hora_desde=a),mask:e.mask,options:e.dateOptions,"today-btn":""},{default:r(()=>[s("div",ye,[Q(l(C,{label:"Cerrar",color:"primary",flat:""},null,512),[[E]])])]),_:1},8,["modelValue","mask","options"]),l(M,{modelValue:e.empleado_delegado.fecha_hora_desde,"onUpdate:modelValue":o[4]||(o[4]=a=>e.empleado_delegado.fecha_hora_desde=a),mask:e.mask,color:"primary"},null,8,["modelValue","mask"])])]),_:1})]),_:1})]),error:r(()=>[(d(!0),t(h,null,b(e.v$.fecha_hora_desde.$errors,a=>(d(),t("div",{key:a.$uid},[s("div",De,v(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])])),s("div",we,[o[19]||(o[19]=s("label",{class:"q-mb-sm block"},"Delegar hasta",-1)),l(g,{modelValue:e.empleado_delegado.fecha_hora_hasta,"onUpdate:modelValue":o[8]||(o[8]=a=>e.empleado_delegado.fecha_hora_hasta=a),placeholder:"Obligatorio",error:!!e.v$.fecha_hora_hasta.$errors.length,onBlur:e.v$.fecha_hora_hasta.$touch,readonly:"",outlined:"",dense:""},{append:r(()=>[l(f,{name:"event",class:"cursor-pointer"},{default:r(()=>[l(q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[s("div",Qe,[l(B,{modelValue:e.empleado_delegado.fecha_hora_hasta,"onUpdate:modelValue":o[6]||(o[6]=a=>e.empleado_delegado.fecha_hora_hasta=a),mask:e.mask,options:e.dateOptions,"today-btn":""},{default:r(()=>[s("div",Ce,[Q(l(C,{label:"Cerrar",color:"primary",flat:""},null,512),[[E]])])]),_:1},8,["modelValue","mask","options"]),l(M,{modelValue:e.empleado_delegado.fecha_hora_hasta,"onUpdate:modelValue":o[7]||(o[7]=a=>e.empleado_delegado.fecha_hora_hasta=a),mask:e.mask,color:"primary"},null,8,["modelValue","mask"])])]),_:1})]),_:1})]),error:r(()=>[(d(!0),t(h,null,b(e.v$.fecha_hora_hasta.$errors,a=>(d(),t("div",{key:a.$uid},[s("div",qe,v(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])])])]),_:1}),l(Z,{align:"right"},{default:r(()=>[l(u,{accion:e.accion,onEditar:o[9]||(o[9]=a=>e.editar(e.empleado_delegado)),onGuardar:o[10]||(o[10]=a=>e.guardar(e.empleado_delegado)),onCancelar:e.cancelar},null,8,["accion","onCancelar"])]),_:1})]),_:1})]),_:1})}var Ze=j(fe,[["render",Be]]);export{Ze as default};

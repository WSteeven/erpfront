var ie=Object.defineProperty;var re=(o,e,p)=>e in o?ie(o,e,{enumerable:!0,configurable:!0,writable:!0,value:p}):o[e]=p;var f=(o,e,p)=>(re(o,typeof e!="symbol"?e+"":e,p),p);import{bw as G,s as k,d as te,m as Y,c as v,E as le,a0 as q,q as C,A as ne,bE as z,d5 as de,_ as ue,v as t,P as pe,F as a,z as i,bc as L,y as r,x as l,G as b,H as g,D as h,J as P,I as B,B as y,j as N,O as F,L as me,Q as ce,c8 as fe,bb as ve,K as $}from"./index.6449c167.js";import{Q,a as I}from"./QItemSection.9a955ec6.js";import{Q as E}from"./QSelect.6ce302d7.js";import{Q as O,a as T,C as j}from"./QPopupProxy.72ff1d6d.js";import{Q as be}from"./QPage.5d173a8a.js";import{T as ge}from"./TabLayout.0bce4313.js";import{b as he,u as $e,x as M,B as H,H as D}from"./utils.521b98f3.js";import{u as _e}from"./index.490dde02.js";import{C as ye}from"./ContenedorSimpleMixin.09c9bed5.js";import{T as Fe}from"./TipoFonfoController.f781a23b.js";import{E as Ve}from"./entidadAuditable.75a46700.js";import{r as V}from"./i18n-validators.29e2545c.js";import{u as ke}from"./filtrosListadosGenerales.c3aa2da3.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTable.00c17e97.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./EssentialTablePagination.d5c1010a.js";import"./index.0198dd12.js";class we extends Ve{constructor(){super();f(this,"usuario");f(this,"estado");f(this,"fecha_inicio");f(this,"fecha_fin");this.usuario=null,this.estado=null,this.fecha_inicio=null,this.fecha_fin=null}}class Ce extends G{constructor(){super(k.fondo_rotativo_autorizaciones_fecha_pdf)}}class Qe extends G{constructor(){super(k.estados_viaticos)}}var Ie=te({components:{TabLayout:ge},setup(){he().setQuasar(Y()),$e().setQuasar(Y());const o=new ye(we,new Ce),{entidad:e,disabled:p,listadosAuxiliares:n}=o.useReferencias(),{setValidador:S,obtenerListados:A,cargarVista:s}=o.useComportamiento(),{onReestablecer:J}=o.useHooks();J(()=>e.fecha_fin=M(C));const w=_e({usuario:{required:V},estado:{required:V},fecha_inicio:{required:V},fecha_fin:{required:V}},e);S(w.value);const c=v(),K=v([]),X=v([]),W=v(!1),R=v([]),{empleados:U,filtrarEmpleados:Z}=ke(n);s(async()=>{await A({empleados:{controller:new le,params:{campos:"id,nombres,apellidos",estado:1,empleados_autorizadores_gasto:1}},tiposFondos:{controller:new Fe,params:{campos:"id,descripcion"}},estados:new Qe}),U.value=n.empleados,c.value=q.getItem("usuariosInactivos")==null?[]:JSON.parse(q.getItem("usuariosInactivos").toString()),n.usuariosInactivos=c.value,K.value=n.tiposFondos,X.value=n.tiposFondoRotativoFechas,R.value=n.estados,e.fecha_fin=M(C)});function x(d,u){if(d===""){u(()=>{c.value=n.usuariosInactivos});return}u(()=>{const m=d.toLowerCase();c.value=n.usuariosInactivos.filter(_=>_.nombres.toLowerCase().indexOf(m)>-1||_.apellidos.toLowerCase().indexOf(m)>-1)})}async function ee(d){if(await w.value.$validate()){const u=ne.getInstance(),m="reporte_semanal_gastos_del_"+e.fecha_inicio+"_al_"+e.fecha_fin;switch(d){case de.EXCEL:const _=z.URL_BASE+"/"+u.getEndpoint(k.fondo_rotativo_autorizaciones_fecha_excel);await H(_,"POST","blob","xlsx",m,e);break;case"pdf":const ae=z.URL_BASE+"/"+u.getEndpoint(k.fondo_rotativo_autorizaciones_fecha_pdf);await H(ae,"POST","blob","pdf",m,e);break}}}function oe(d){const u=D(new Date,"YYYY/MM/DD");return d<=u}function se(d){const u=D(new Date,"YYYY/MM/DD"),m=D(e.fecha_inicio!==null?e.fecha_inicio:new Date,"YYYY/MM/DD");return d>=m&&d<=u}return{reporte:e,disabled:p,v$:w,maskFecha:C,empleados:U,empleadosInactivos:c,is_inactivo:W,estados_viaticos:R,generar_reporte:ee,filtrarEmpleados:Z,filtrarUsuariosInactivos:x,optionsFechaInicio:oe,optionsFechaFin:se}}});const Ee={class:"row q-col-gutter-sm"},De={key:0,class:"col-12 col-md-6"},Se={class:"error-msg"},Ae={key:1,class:"col-12 col-md-6"},Re={class:"error-msg"},Ue={class:"col-12 col-md-6 q-mb-md"},Ye={class:"error-msg"},qe={class:"col-6 col-md-6"},ze={class:"row items-center justify-end"},Le={class:"error-msg"},Pe={class:"col-6 col-md-6"},Be={class:"row items-center justify-end"},Ne={class:"error-msg"},Oe={class:"col-12 col-md-3"};function Te(o,e,p,n,S,A){return t(),pe(be,{class:"flex flex-center"},{default:a(()=>[i(ve,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:a(()=>[i(L,null,{default:a(()=>e[11]||(e[11]=[r("div",{class:"row items-center no-wrap"},[r("div",{class:"col"},[r("div",{class:"text-h6"},"Generar Reporte Autorizaciones Especiales")])],-1)])),_:1}),i(L,null,{default:a(()=>[r("div",Ee,[o.is_inactivo?P("",!0):(t(),l("div",De,[e[13]||(e[13]=r("label",{class:"q-mb-sm block"},"Empleado",-1)),i(E,{modelValue:o.reporte.usuario,"onUpdate:modelValue":e[0]||(e[0]=s=>o.reporte.usuario=s),options:o.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:o.filtrarEmpleados,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{error:a(()=>[(t(!0),l(b,null,g(o.v$.usuario.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Se,$(s.$message),1)]))),128))]),"no-option":a(()=>[i(Q,null,{default:a(()=>[i(I,{class:"text-grey"},{default:a(()=>e[12]||(e[12]=[h(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])),o.is_inactivo?(t(),l("div",Ae,[e[15]||(e[15]=r("label",{class:"q-mb-sm block"},"Empleado",-1)),i(E,{modelValue:o.reporte.usuario,"onUpdate:modelValue":e[1]||(e[1]=s=>o.reporte.usuario=s),options:o.empleadosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un empleado inactivo del listado","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{error:a(()=>[(t(!0),l(b,null,g(o.v$.usuario.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Re,$(s.$message),1)]))),128))]),"no-option":a(()=>[i(Q,null,{default:a(()=>[i(I,{class:"text-grey"},{default:a(()=>e[14]||(e[14]=[h(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])):P("",!0),r("div",Ue,[e[17]||(e[17]=r("label",{class:"q-mb-sm block"},"Estado",-1)),i(E,{modelValue:o.reporte.estado,"onUpdate:modelValue":e[2]||(e[2]=s=>o.reporte.estado=s),options:o.estados_viaticos,"options-dense":"",dense:"",outlined:"",error:!!o.v$.estado.$errors.length,"option-value":s=>s.id,"option-label":s=>s.descripcion,"emit-value":"","map-options":""},{error:a(()=>[(t(!0),l(b,null,g(o.v$.estado.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Ye,$(s.$message),1)]))),128))]),"no-option":a(()=>[i(Q,null,{default:a(()=>[i(I,{class:"text-grey"},{default:a(()=>e[16]||(e[16]=[h(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","option-value","option-label"])]),r("div",qe,[e[18]||(e[18]=r("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(B,{modelValue:o.reporte.fecha_inicio,"onUpdate:modelValue":e[4]||(e[4]=s=>o.reporte.fecha_inicio=s),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:a(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:a(()=>[i(O,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(T,{modelValue:o.reporte.fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=s=>o.reporte.fecha_inicio=s),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:a(()=>[r("div",ze,[N(i(F,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:a(()=>[(t(!0),l(b,null,g(o.v$.fecha_inicio.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Le,$(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),r("div",Pe,[e[19]||(e[19]=r("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(B,{modelValue:o.reporte.fecha_fin,"onUpdate:modelValue":e[6]||(e[6]=s=>o.reporte.fecha_fin=s),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:a(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:a(()=>[i(O,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(T,{modelValue:o.reporte.fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=s=>o.reporte.fecha_fin=s),mask:o.maskFecha,"today-btn":"",options:o.optionsFechaFin},{default:a(()=>[r("div",Be,[N(i(F,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:a(()=>[(t(!0),l(b,null,g(o.v$.fecha_fin.$errors,s=>(t(),l("div",{key:s.$uid},[r("div",Ne,$(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),r("div",Oe,[i(me,{modelValue:o.is_inactivo,"onUpdate:modelValue":[e[7]||(e[7]=s=>o.is_inactivo=s),e[8]||(e[8]=()=>o.reporte.usuario=null)],color:"secondary",label:"Inactivo","true-value":!0,"false-value":!1},null,8,["modelValue"])])])]),_:1}),i(ce),i(fe,{align:"around"},{default:a(()=>[i(F,{color:"positive",onClick:e[9]||(e[9]=s=>o.generar_reporte("excel"))},{default:a(()=>[i(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[20]||(e[20]=h(" Excel "))]),_:1}),i(F,{color:"negative",onClick:e[10]||(e[10]=s=>o.generar_reporte("pdf"))},{default:a(()=>[i(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[21]||(e[21]=h(" PDF "))]),_:1})]),_:1})]),_:1})]),_:1})}var Co=ue(Ie,[["render",Te]]);export{Co as default};

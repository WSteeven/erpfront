var R=Object.defineProperty;var H=(o,e,t)=>e in o?R(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var n=(o,e,t)=>(H(o,typeof e!="symbol"?e+"":e,t),t);import{Q as f,a as J}from"./QSelect.6ce302d7.js";import{bw as K,s as W,d as X,m as Y,u as Z,c as w,bx as q,cS as _,c$ as x,_ as oo,t as S,v as $,P as eo,F as l,z as i,y as s,I as k,M as ao,N as io,D as lo,K as no,a7 as L,x as y,J as B,a4 as so}from"./index.6449c167.js";import{Q as ro,a as U}from"./QItemSection.9a955ec6.js";import{Q as to}from"./QForm.ca56f146.js";import{E as uo}from"./entidadAuditable.75a46700.js";import{T as mo}from"./TabLayoutFilterTabs2.5e702525.js";import{N as po}from"./NoOptionComponent.b9594324.js";import{S as bo,q as co}from"./EssentialTable.00c17e97.js";import{b as vo}from"./utils.521b98f3.js";import{u as go}from"./index.490dde02.js";import{r as p,m as fo,a as $o}from"./i18n-validators.29e2545c.js";import{C as Vo}from"./ContenedorSimpleMixin.09c9bed5.js";import{M as Co}from"./MotivoGastoController.bfbd4589.js";import{G as ho}from"./GrupoController.6ad12a37.js";import{u as wo}from"./filtrosListadosGenerales.c3aa2da3.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./QPage.5d173a8a.js";import"./EssentialTableTabs.586dbdfc.js";import"./QBadge.e6f320cd.js";import"./EssentialTablePagination.d5c1010a.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./buttonSubmits.fe817da3.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./index.0198dd12.js";class qo extends uo{constructor(){super();n(this,"fecha_gasto");n(this,"lugar");n(this,"grupo");n(this,"lugar_info");n(this,"motivo");n(this,"motivo_info");n(this,"monto");n(this,"observacion");n(this,"id_usuario");n(this,"empleado_info");n(this,"revisado");n(this,"estado");n(this,"observacion_contabilidad");this.fecha_gasto=null,this.lugar=null,this.grupo=null,this.lugar_info=null,this.motivo=null,this.motivo_info=null,this.monto=null,this.observacion=null,this.id_usuario=null,this.empleado_info=null,this.revisado=!1,this.estado=null,this.observacion_contabilidad=null}}class So extends K{constructor(){super(W.gasto_coordinador)}}const ko=[{name:"fecha_gasto",field:"fecha_gasto",label:"Fecha",align:"left",sortable:!0},{name:"lugar_info",field:"lugar_info",label:"Lugar",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"left",sortable:!0},{name:"motivo_info",field:"motivo_info",label:"Motivo",align:"left",sortable:!0},{name:"observacion",field:"observacion",label:"Observacion",align:"left",sortable:!0},{name:"revisado",field:"revisado",label:"Revisado",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];var yo=X({components:{TabLayoutFilterTabs2:mo,NoOptionComponent:po,SelectorImagen:bo,ErrorComponent:co},setup(){vo().setQuasar(Y());const o=Z(),{esContabilidad:e}=o,t=new Vo(qo,new So),{entidad:b,disabled:G,accion:c,listadosAuxiliares:r}=t.useReferencias(),{setValidador:u,obtenerListados:V,cargarVista:a,consultar:m,listar:C}=t.useComportamiento(),{onModificado:h}=t.useHooks(),v=w("1"),j=[{nombre:"Pendiente",id:1},{nombre:"Completa",id:2},{nombre:"Anulado",id:4}],N={lugar:{required:p},grupo:{required:p},monto:{required:p},motivo:{required:p},observacion:{required:p,minLength:fo(25)},observacion_contabilidad:{required:$o(()=>e&&c.value===q.editar&&b.estado!=1)}},M=go(N,b);u(M.value);const g=w([]),D=w([]),{cantones:Q,filtrarCantones:I,grupos:F,filtrarGrupos:T}=wo(r);a(async()=>{await V({cantones:{controller:new _,params:{campos:"id,canton"}},motivos:{controller:new Co,params:{campos:"id,nombre"}},grupos:{controller:new ho,params:{campos:"id,nombre"}}}),Q.value=r.cantones,g.value=r.motivos,F.value=r.grupos}),h(async()=>await O("1"));async function O(d){v.value=d,await C({estado_id:d})}function P(d,E){if(d===""){E(()=>{g.value=r.motivos});return}E(()=>{const A=d.toLowerCase();g.value=r.motivos.filter(z=>z.nombre.toLowerCase().indexOf(A)>-1)})}return{mixin:t,gasto:b,cantones:Q,grupos:F,motivos:g,disabled:G,accion:c,acciones:q,v$:M,configuracionColumnas:ko,autorizacionesEspeciales:D,estados:j,filtrarGrupos:T,filtrarCantones:I,filtrarMotivos:P,editarGasto:{titulo:" ",icono:"bi-pencil-square",color:"secondary",visible:({entidad:d})=>d.usuario==o.user.id&&v.value==="1",accion:({entidad:d})=>{c.value=q.editar,m(d)}},tabDefecto:v,tabOptions:x,filtrarSolicitudes:O,esContabilidad:e}}});const Bo={class:"row q-col-gutter-sm q-mb-md"},Go={class:"col-12 col-md-3"},Mo={class:"col-12 col-md-3"},Qo={class:"col-12 col-md-3"},Fo={class:"col-12 col-md-3"},Oo={class:"col-12 col-md-12"},Eo={key:0,class:"col-12 col-md-3"},Lo={key:1,class:"col-12 col-md-3 q-mb-md"},Uo={key:2,class:"col-12 col-md-6"};function jo(o,e,t,b,G,c){const r=S("error-component"),u=S("no-option-component"),V=S("tab-layout-filter-tabs2");return $(),eo(V,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Solicitudes de fondos para vi\xE1ticos","tab-options":o.tabOptions,"tab-defecto":o.tabDefecto,"permitir-editar":o.esContabilidad,filtrar:o.filtrarSolicitudes,accion1:o.editarGasto,ajustarCeldas:""},{formulario:l(()=>[i(to,{onSubmit:e[8]||(e[8]=so(()=>{},["prevent"]))},{default:l(()=>[s("div",Bo,[s("div",Go,[e[9]||(e[9]=s("label",{class:"q-mb-sm block"},"Lugar",-1)),i(f,{modelValue:o.gasto.lugar,"onUpdate:modelValue":e[0]||(e[0]=a=>o.gasto.lugar=a),options:o.cantones,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.lugar.$errors.length,"error-message":"Debes seleccionar un canton","use-input":"","input-debounce":"0",onFilter:o.filtrarCantones,onBlur:o.v$.lugar.$touch,"option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},{error:l(()=>[i(r,{clave:"lugar",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(u)]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","onBlur","option-value","option-label"])]),s("div",Mo,[e[10]||(e[10]=s("label",{class:"q-mb-sm block"},"Monto",-1)),i(k,{modelValue:o.gasto.monto,"onUpdate:modelValue":e[1]||(e[1]=a=>o.gasto.monto=a),placeholder:"Obligatorio",type:"number",autogrow:"",disable:o.disabled,error:!!o.v$.monto.$errors.length,onBlur:o.v$.monto.$touch,outlined:"",dense:""},{error:l(()=>[i(r,{clave:"monto",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])]),s("div",Qo,[e[11]||(e[11]=s("label",{class:"q-mb-sm block"},"Grupo",-1)),i(f,{modelValue:o.gasto.grupo,"onUpdate:modelValue":e[2]||(e[2]=a=>o.gasto.grupo=a),options:o.grupos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.grupo.$errors.length,"error-message":"Debes seleccionar un grupo","use-input":"","input-debounce":"0",onFilter:o.filtrarGrupos,onBlur:o.v$.grupo.$touch,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(r,{clave:"grupo",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(u)]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","onBlur","option-value","option-label"])]),s("div",Fo,[e[12]||(e[12]=s("label",{class:"q-mb-sm block"},"Motivo",-1)),i(f,{modelValue:o.gasto.motivo,"onUpdate:modelValue":e[3]||(e[3]=a=>o.gasto.motivo=a),options:o.motivos,"transition-show":"jump-up","transition-hide":"jump-down",disable:o.disabled,"options-dense":"",multiple:"",dense:"","use-chips":"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarMotivos,onBlur:o.v$.motivo.$touch,error:!!o.v$.motivo.$errors.length,"error-message":"Debes seleccionar uno o varios sub_detalle","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{option:l(({itemProps:a,opt:m,selected:C,toggleOption:h})=>[i(ro,ao(io(a)),{default:l(()=>[i(U,null,{default:l(()=>[lo(no(m.nombre)+" ",1),i(J,{"inner-h-t-m-l":m.nombre},null,8,["inner-h-t-m-l"])]),_:2},1024),i(U,{side:""},{default:l(()=>[i(L,{"model-value":C,"onUpdate:modelValue":v=>h(m)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),error:l(()=>[i(r,{clave:"motivo",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(u)]),_:1},8,["modelValue","options","disable","onFilter","onBlur","error","option-value","option-label"])]),s("div",Oo,[e[13]||(e[13]=s("label",{class:"q-mb-sm block"},"Descripcion",-1)),i(k,{modelValue:o.gasto.observacion,"onUpdate:modelValue":e[4]||(e[4]=a=>o.gasto.observacion=a),placeholder:"Obligatorio",autogrow:"",disable:o.disabled,error:!!o.v$.observacion.$errors.length,hint:"Escriba su requerimiento al que desea pedir el gasto",onBlur:o.v$.observacion.$touch,outlined:"",dense:""},{error:l(()=>[i(r,{clave:"observacion",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])]),[o.acciones.consultar,o.acciones.editar].includes(o.accion)?($(),y("div",Eo,[e[14]||(e[14]=s("label",{class:"q-mb-sm block"},"\xBFSolicitud revisada?",-1)),i(L,{label:o.gasto.revisado?"SI":"NO",modelValue:o.gasto.revisado,"onUpdate:modelValue":e[5]||(e[5]=a=>o.gasto.revisado=a),color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear",disable:""},null,8,["label","modelValue"])])):B("",!0),[o.acciones.consultar,o.acciones.editar].includes(o.accion)?($(),y("div",Lo,[e[15]||(e[15]=s("label",{color:"light-green-2",class:"text-positive text-bold q-mb-sm inline-block bg-light-green-2 rounded q-px-md"},"Estado ",-1)),i(f,{modelValue:o.gasto.estado,"onUpdate:modelValue":e[6]||(e[6]=a=>o.gasto.estado=a),options:o.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:!o.esContabilidad,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},null,8,["modelValue","options","disable","option-value","option-label"])])):B("",!0),o.esContabilidad?($(),y("div",Uo,[e[16]||(e[16]=s("label",{class:"q-mb-sm block"},"Observaci\xF3n contabilidad",-1)),i(k,{modelValue:o.gasto.observacion_contabilidad,"onUpdate:modelValue":e[7]||(e[7]=a=>o.gasto.observacion_contabilidad=a),placeholder:"Obligatorio",autogrow:"",disable:o.disabled,error:!!o.v$.observacion_contabilidad.$errors.length,hint:"Escriba su observaci\xF3n al marcar como completada o anulada la solicitud",onBlur:o.v$.observacion_contabilidad.$touch,outlined:"",dense:""},{error:l(()=>[i(r,{clave:"observacion_contabilidad",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])])):B("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tab-defecto","permitir-editar","filtrar","accion1"])}var we=oo(yo,[["render",jo]]);export{we as default};

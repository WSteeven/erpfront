import{Q as F}from"./QSelect.a8f2bfb2.js";import{Q as re,a as ie}from"./QItemSection.c6f2640c.js";import{c as ne,U as ce,e as w,dw as R,f as ue,s as T,A as me,bH as de,t as pe,v as fe,x as A,y as r,S as f,H as s,D as a,B as l,bf as B,z as u,I,J as N,M as $,G,L as n,K as x,F as y,k as z,R as k,a6 as be}from"./index.976e8f3c.js";import{Q as D,a as M,C as H}from"./QPopupProxy.d8ef7a42.js";import{Q as ve}from"./QBtnGroup.7d0835e4.js";import{a as he,Q as j}from"./QTabPanels.1c8c4baa.js";import{Q as ge}from"./QPage.ed5d79ca.js";import{Q as Ce,a as Ve}from"./QLayout.732b3e1b.js";import{r as K}from"./i18n-validators.06eef631.js";import{u as we}from"./index.ed676411.js";import{E as ye}from"./EssentialTable.d8e6954a.js";import{G as ke}from"./GraficoGenerico.18bf69ae.js";import{S as _e,v as Qe,A as J}from"./utils.30e08aa2.js";import{C as W}from"./CombustibleController.2b888a63.js";import{C as qe}from"./ContenedorSimpleMixin.5a0b06ab.js";import{C as Be}from"./Combustible.d039307e.js";import{u as Ie}from"./filtrosListadosGenerales.31e9eb2c.js";import{V as Ne}from"./VehiculoController.fd9db948.js";import{o as $e}from"./graficoGenerico.2759c2ea.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./touch.9135741d.js";import"./QScrollObserver.cb4b92b2.js";import"./QResizeObserver.6ec10d95.js";import"./index.95f5a0db.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./chart.2729d76a.js";import"./entidadAuditable.75a46700.js";var Ee=ne({components:{EssentialTable:ye,GraficoGenerico:ke},setup(){const e=new qe(Be,new W),{listadosAuxiliares:t}=e.useReferencias(),{notificarError:E,notificarAdvertencia:L}=ce(),m=new _e,v="COMBUSTIBLE",b="VEHICULO",h=[v,b],g=w(!0),C=w(R.grafico),o=ue({tipo:null,fecha_inicio:null,fecha_fin:"",vehiculo:null,todos:!1}),d=w(),c=w([]),{combustibles:P,filtrarCombustibles:X,vehiculos:U,filtrarVehiculos:Y}=Ie(t);o.fecha_fin=Qe(T);const Z=[{name:"combustible",field:"combustible",label:"Combustible",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"center",sortable:!0},{name:"recorrido",field:"recorrido",label:"Km Recorridos",align:"left",sortable:!0}],ee=[{name:"vehiculo",field:"vehiculo",label:"Veh\xEDculo",align:"left",sortable:!0},{name:"combustible",field:"combustible",label:"Combustible",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"center",sortable:!0},{name:"recorrido",field:"recorrido",label:"Km Recorridos",align:"left",sortable:!0}],S=we({tipo:{required:K},fecha_inicio:{required:K}},o);async function oe(){m.activar();const i=await new W().listar();t.combustibles=i.result,P.value=i.result,m.desactivar()}async function te(){m.activar();const i=await new Ne().listar();t.vehiculos=i.result,U.value=i.result,m.desactivar()}async function se(i){switch(d.value=null,i){case v:await oe();break;case b:await te();break;default:console.log(i)}}async function ae(i,p,_){if(await S.value.$validate())try{m.activar();const V=me.getInstance(),Q=de.URL_BASE+"/"+V.getEndpoint(pe.reporte_combustibles),O="reporte_conductores";switch(i){case"excel":return p.accion="excel",J(Q,"POST","blob","xlsx",O,p),_;case"pdf":return p.accion="pdf",J(Q,"POST","blob","pdf",O,p),_;default:p.accion="";const q=await V.post(Q,p);return q.data.results?(q.data.results.length<1&&L("No se obtuvieron resultados"),q.data.results):_}}catch(V){console.log(V),E("Error al obtener el reporte")}finally{m.desactivar()}}async function le(i){d.value=await ae(i,o,c.value),c.value=d.value.results}return{reporte:o,v$:S,maskFecha:T,tabs:C,opcionesGrafico:R,optionsPie:$e,results:d,configuracionColumnasVehiculos:ee,configuracionColumnasCombustibles:Z,modoUnaColumna:g,COMBUSTIBLE:v,VEHICULO:b,listado:c,opciones:h,combustibles:P,filtrarCombustibles:X,vehiculos:U,filtrarVehiculos:Y,consultarListado:se,buscarReporte:le}}});const Le={class:"col"},Pe={class:"row q-col-gutter-sm q-pa-sm q-py-md"},Ue={class:"col-12 col-md-3"},Se={class:"error-msg"},Oe={key:0,class:"col-12 col-md-3 col-sm-6 q-mb-md"};const Fe={class:"col-12 col-md-3"},Re={class:"row items-center justify-end"},Te={class:"error-msg"},Ae={class:"col-12 col-md-3"},Ge={class:"row items-center justify-end"},xe={class:"col-12 col-md-12 q-mt-md"},ze={class:"text-center"},De={class:"text-subtitle2 q-mb-lg"},Me={class:"row q-col-gutter-sm q-py-md q-mb-lg"},He={class:"col-12"},je={class:"row q-col-gutter-sm q-py-md q-mb-lg"},Ke={class:"col-12"};function Je(e,t,E,L,m,v){const b=A("grafico-generico"),h=A("essential-table");return r(),f(Ve,null,{default:s(()=>[a(Ce,null,{default:s(()=>[a(ge,{padding:""},{default:s(()=>{var g,C;return[l("div",Le,[a(B,{class:"rounded-card custom-shadow"},{default:s(()=>[l("div",Pe,[l("div",Ue,[t[13]||(t[13]=l("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),a(F,{modelValue:e.reporte.tipo,"onUpdate:modelValue":[t[0]||(t[0]=o=>e.reporte.tipo=o),t[1]||(t[1]=o=>e.consultarListado(e.reporte.tipo))],options:e.opciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",error:!!e.v$.tipo.$errors.length,"emit-value":"","map-options":""},{error:s(()=>[(r(!0),u(I,null,N(e.v$.tipo.$errors,o=>(r(),u("div",{key:o.$uid},[l("div",Se,$(o.$message),1)]))),128))]),_:1},8,["modelValue","options","error"])]),e.reporte.tipo===e.COMBUSTIBLE?(r(),u("div",Oe,[t[15]||(t[15]=l("label",{class:"q-mb-sm block"},"Tipo de combustible",-1)),a(F,{modelValue:e.reporte.combustible,"onUpdate:modelValue":t[2]||(t[2]=o=>e.reporte.combustible=o),options:e.combustibles,"transition-show":"scale","transition-hide":"scale",hint:"OPCIONAL","options-dense":"",clearable:"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarCombustibles,"option-label":o=>o.nombre,"option-value":o=>o.id,"emit-value":"","map-options":""},{"no-option":s(()=>[a(re,null,{default:s(()=>[a(ie,{class:"text-grey"},{default:s(()=>t[14]||(t[14]=[G(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),n("",!0),l("div",Fe,[t[18]||(t[18]=l("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),a(x,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":t[5]||(t[5]=o=>e.reporte.fecha_inicio=o),error:!!e.v$.fecha_inicio.$errors.length,placeholder:"Opcional",outlined:"",dense:""},{append:s(()=>[a(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(M,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":t[4]||(t[4]=o=>e.reporte.fecha_inicio=o),mask:e.maskFecha,"today-btn":""},{default:s(()=>[l("div",Re,[z(a(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:s(()=>[(r(!0),u(I,null,N(e.v$.fecha_inicio.$errors,o=>(r(),u("div",{key:o.$uid},[l("div",Te,$(o.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),l("div",Ae,[t[19]||(t[19]=l("label",{class:"q-mb-sm block"},"Fecha fin ",-1)),a(x,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":t[7]||(t[7]=o=>e.reporte.fecha_fin=o),placeholder:"Opcional",outlined:"",dense:""},{append:s(()=>[a(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(M,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":t[6]||(t[6]=o=>e.reporte.fecha_fin=o),mask:e.maskFecha,"today-btn":""},{default:s(()=>[l("div",Ge,[z(a(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",xe,[l("div",ze,[a(ve,{push:""},{default:s(()=>[a(k,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:t[8]||(t[8]=o=>e.buscarReporte("consulta"))},{default:s(()=>[a(y,{name:"bi-search",size:"xs",class:"q-pr-sm"}),t[20]||(t[20]=l("span",null,"Buscar",-1))]),_:1}),n("",!0),n("",!0)]),_:1})])])])]),_:1}),e.reporte.tipo==e.COMBUSTIBLE&&((g=e.results)==null?void 0:g.results.length)?(r(),f(B,{key:0,class:"q-mb-md q-mt-sm rounded no-border custom-shadow"},{default:s(()=>[t[24]||(t[24]=l("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Gr\xE1ficos Estad\xEDsticos ",-1)),a(he,{modelValue:e.tabs,"onUpdate:modelValue":t[12]||(t[12]=o=>e.tabs=o),animated:"","transition-prev":"scale","transition-next":"scale","keep-alive":""},{default:s(()=>[a(j,{name:e.opcionesGrafico.grafico},{default:s(()=>{var o,d;return[e.results!==null?(r(),u("div",{key:0,class:be(["q-col-gutter-y-xl q-col-gutter-x-xs q-mb-xl",{row:!e.modoUnaColumna,column:e.modoUnaColumna}])},[(r(!0),u(I,null,N((o=e.results)==null?void 0:o.graficos,c=>(r(),u("div",{class:"col-12 col-md-6 text-center",key:c.id},[l("div",De,$(c.encabezado),1),l("div",null,[c?(r(),f(b,{key:0,data:c,options:e.optionsPie},null,8,["data","options"])):n("",!0)])]))),128))],2)):n("",!0),l("div",Me,[l("div",He,[(d=e.results.results)!=null&&d.length?(r(),f(h,{key:0,titulo:"Valores",configuracionColumnas:e.configuracionColumnasCombustibles,datos:e.results.results,altoFijo:!1},null,8,["configuracionColumnas","datos"])):n("",!0)])])]}),_:1},8,["name"]),a(j,{name:e.opcionesGrafico.listado},{default:s(()=>[a(k,{color:"primary",onClick:t[11]||(t[11]=o=>e.tabs=e.opcionesGrafico.grafico),glossy:"","no-caps":"",rounded:"",unelevated:"",class:"q-mx-auto block"},{default:s(()=>[a(y,{name:"bi-arrow-left"}),t[23]||(t[23]=G(" Regresar al gr\xE1fico"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"])]),_:1})):n("",!0),e.reporte.tipo==e.VEHICULO&&((C=e.results)==null?void 0:C.results.length)?(r(),f(B,{key:1,class:"q-mb-md q-mt-sm rounded no-border custom-shadow"},{default:s(()=>{var o;return[l("div",je,[l("div",Ke,[(o=e.results.results)!=null&&o.length?(r(),f(h,{key:0,titulo:"Valores",configuracionColumnas:e.configuracionColumnasVehiculos,datos:e.results.results,mostrarExportar:"",altoFijo:!1},null,8,["configuracionColumnas","datos"])):n("",!0)])])]}),_:1})):n("",!0)])]}),_:1})]),_:1})]),_:1})}var Ao=fe(Ee,[["render",Je]]);export{Ao as default};

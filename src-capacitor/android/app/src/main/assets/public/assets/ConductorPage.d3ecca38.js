import{Q as $,a as L}from"./QSelect.6ce302d7.js";import{Q as N,a as B}from"./QItemSection.9a955ec6.js";import{d as _,e as oo,c as eo,a0 as h,bx as b,p as ao,q as lo,E as to,_ as io,t as O,v as s,P as no,F as t,z as l,a4 as so,y as n,x as d,G as ro,H as mo,K as g,M as uo,N as co,D as k,O as po,B as fo,I as C,J as u}from"./index.6449c167.js";import{Q as bo}from"./QExpansionItem.e36a6702.js";import{Q as go}from"./QForm.ca56f146.js";import{_ as Co,C as vo,c as wo}from"./InformacionLicencia.d5cf7117.js";import{r as M,c as Eo,d as Vo}from"./i18n-validators.29e2545c.js";import{u as yo}from"./index.490dde02.js";import{T as ko}from"./TabLayout.0bce4313.js";import{G as Mo}from"./GestorArchivos.10722df3.js";import{E as So}from"./EssentialTable.00c17e97.js";import{M as Fo}from"./ModalEntidad.168b465e.js";import{S as qo}from"./SolicitarFecha.980c51b6.js";import{E as U}from"./EmpleadoRolesController.16111958.js";import{C as Qo}from"./ContenedorSimpleMixin.09c9bed5.js";import{u as Io,a as Po}from"./MultaConductorPage.f2b21cd7.js";import{a as $o,S as Lo}from"./utils.521b98f3.js";import{g as No,t as Bo}from"./vehiculos.utils.c31e027d.js";import{C as ho}from"./ConductorController.7b773e10.js";import{u as Oo}from"./filtrosListadosGenerales.c3aa2da3.js";import{E as R}from"./Empleado.20234ba0.js";import{C as Uo}from"./Conductor.978d1863.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QPopupProxy.72ff1d6d.js";import"./QToolbar.8dbe891b.js";import"./ComponenteModal.domain.50e59f97.js";import"./entidadAuditable.75a46700.js";import"./index.0198dd12.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTablePagination.d5c1010a.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./QUploader.cca1b7bd.js";import"./QCircularProgress.b24a7ee9.js";import"./QFile.90d9394a.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./VehiculoController.5e90ff0e.js";const Ro=[{name:"empleado",field:"empleado",label:"Empleado",align:"left",sortable:!0},{name:"identificacion",field:"identificacion",label:"Identificaci\xF3n",align:"left",sortable:!0},{name:"licencias",field:"licencias",label:"Cant. Licencias",align:"left",sortable:!0,editable:!1},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0,editable:!1},{name:"multas",field:"multas",label:"Multas",align:"left",sortable:!0}];var To=_({components:{TabLayout:ko,ModalesEntidad:Fo,EssentialTable:So,GestorArchivos:Mo,SolicitarFecha:qo,InformacionLicencia:Co},setup(){const e=new Qo(Uo,new ho),{entidad:o,disabled:S,listadosAuxiliares:r,accion:m}=e.useReferencias(),{setValidador:F,obtenerListados:v,cargarVista:w,consultar:a}=e.useComportamiento(),{onReestablecer:T,onConsultado:A}=e.useHooks(),{confirmar:j,prompt:D}=$o(),c=oo(new R),E=Io(),p=new Lo,q=new vo,f={fecha_pago:null,comentario:null},Q=eo(!1);w(async()=>{await v({empleados:{controller:new U,params:{roles:["CHOFER"]}}}),r.cantones=JSON.parse(h.getItem("cantones").toString()),y.value=JSON.parse(h.getItem("cantones").toString())});const G={empleado:{required:M},tipo_licencia:{required:M},puntos:{required:M,maximo:Eo(30),minimo:Vo(0)}},I=yo(G,o);F(I.value),A(async()=>{c.hydrate(o.info_empleado),await z(),E.conductor=o}),T(()=>{c.hydrate(new R),f.comentario=null,f.fecha_pago=null,E.resetearConductor()});async function H(i){switch(i){case"MultaConductorPage":console.log("Antes de consultar",o.id),await a(o),console.log("Luego de consultar",o.id);break;default:console.log("No se recibio data")}}async function z(){const{result:i}=await new Po().listar({empleado_id:o.empleado});o.multas=i}async function J(i){if(i!=null){p.activar();const{result:P}=await new to().consultar(i);c.hydrate(P),p.desactivar()}}async function K(){p.activar(),r.empleados=(await new U().listar({roles:["CHOFER"]})).result,V.value=r.empleados,p.desactivar()}const{empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,cantones:y}=Oo(r),Y={titulo:"Agregar multa",icono:"bi-file-text",color:"positive",tooltip:"Agregar multa asociado al conductor",accion:()=>{q.abrirModalEntidad("MultaConductorPage")},visible:()=>m.value==b.editar},Z={titulo:"Editar",icono:"bi-pencil-square",color:"secondary",tooltip:"Editar",accion:({entidad:i})=>{j("\xBFEst\xE1 seguro de marcar como pagada la multa?",async()=>{D({titulo:"Fecha de pago",mensaje:"\xBFTienes alguna observaci\xF3n al respecto?",accion:async x=>{E.idMulta=i.id,f.comentario=x,f.fecha_pago==null&&(Q.value=!0)}})})},visible:({entidad:i})=>(m.value==b.nuevo||m.value==b.editar)&&!i.estado};return V.value=r.empleados,y.value=r.cantones,{mixin:e,conductor:o,disabled:S,accion:m,v$:I,acciones:b,configuracionColumnas:Ro,columnasMultasConductor:wo,accionesTabla:ao,empleado:c,maskFecha:lo,modales:q,mostrarSolicitarFecha:Q,abrirModalMultaConductor:Y,btnEditarMulta:Z,tabOptionsConductores:No,empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,obtenerEmpleado:J,cantones:y,tiposLicencias:Bo,guardado:H,recargarChoferes:K}}});const Ao={class:"row q-col-gutter-sm q-pa-sm"},jo={class:"col-12 col-md-3"},Do={class:"error-msg"},Go={key:0,class:"col-12 col-md-3"},Ho={key:1,class:"col-12 col-md-3"},zo={key:2,class:"col-12 col-md-3"},Jo={key:3,class:"col-12 col-md-3"},Ko={key:4,class:"col-12 col-md-3"};function Wo(e,o,S,r,m,F){const v=O("informacion-licencia"),w=O("tab-layout");return s(),no(w,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:"","titulo-pagina":"Conductores"},{formulario:t(()=>[l(go,{onSubmit:o[7]||(o[7]=so(()=>{},["prevent"]))},{default:t(()=>[l(bo,{class:"overflow-hidden q-mb-md expansion",label:"Informaci\xF3n Personal","header-class":"text-bold bg-header-collapse","default-opened":""},{default:t(()=>[n("div",Ao,[n("div",jo,[o[9]||(o[9]=n("label",{class:"q-mb-sm block"},"Chofer",-1)),l($,{modelValue:e.conductor.empleado,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.conductor.empleado=a),e.obtenerEmpleado],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:e.ordenarEmpleados,error:!!e.v$.empleado.$errors.length,"error-message":"Debes seleccionar un empleado para convertirlo en chofer","option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:t(()=>[(s(!0),d(ro,null,mo(e.v$.empleado.$errors,a=>(s(),d("div",{key:a.$uid},[n("div",Do,g(a.$message),1)]))),128))]),option:t(a=>[l(N,uo(co(a.itemProps)),{default:t(()=>[l(B,null,{default:t(()=>[l(L,null,{default:t(()=>[k(g(a.opt.apellidos)+" "+g(a.opt.nombres),1)]),_:2},1024),l(L,{caption:""},{default:t(()=>[k(g(a.opt.identificacion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[l(N,null,{default:t(()=>[l(B,{class:"text-grey"},{default:t(()=>o[8]||(o[8]=[k(" No hay resultados ")])),_:1})]),_:1})]),after:t(()=>[l(po,{color:"positive",onClick:e.recargarChoferes},{default:t(()=>[l(fo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disable","onFilter","onPopupShow","onUpdate:modelValue","error","option-value","option-label"])]),e.empleado.identificacion?(s(),d("div",Go,[o[10]||(o[10]=n("label",{class:"q-mb-sm block"},"Identificacion",-1)),l(C,{mask:"#############",modelValue:e.empleado.identificacion,"onUpdate:modelValue":o[1]||(o[1]=a=>e.empleado.identificacion=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.canton?(s(),d("div",Ho,[o[11]||(o[11]=n("label",{class:"q-mb-sm block"},"Ciudad",-1)),l($,{modelValue:e.empleado.canton,"onUpdate:modelValue":o[2]||(o[2]=a=>e.empleado.canton=a),options:e.cantones,disable:"",dense:"",outlined:"","option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):u("",!0),e.empleado.direccion?(s(),d("div",zo,[o[12]||(o[12]=n("label",{class:"q-mb-sm block"},"Direcci\xF3n",-1)),l(C,{modelValue:e.empleado.direccion,"onUpdate:modelValue":o[3]||(o[3]=a=>e.empleado.direccion=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.celular?(s(),d("div",Jo,[o[13]||(o[13]=n("label",{class:"q-mb-sm block"},"Celular",-1)),l(C,{modelValue:e.empleado.celular,"onUpdate:modelValue":o[4]||(o[4]=a=>e.empleado.celular=a),disable:"",dense:"",outlined:""},null,8,["modelValue"])])):u("",!0),e.empleado.email?(s(),d("div",Ko,[o[14]||(o[14]=n("label",{class:"q-mb-sm block"},"Correo",-1)),l(C,{modelValue:e.empleado.email,"onUpdate:modelValue":o[5]||(o[5]=a=>e.empleado.email=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0)])]),_:1}),l(v,{mixin:e.mixin,conductor:e.conductor,identificacion:e.empleado.identificacion,consultarMultas:!1,onGuardado:o[6]||(o[6]=a=>e.guardado(a))},null,8,["mixin","conductor","identificacion"])]),_:1})]),_:1},8,["mixin","configuracionColumnas"])}var Je=io(To,[["render",Wo]]);export{Je as default};

var ra=Object.defineProperty;var na=(e,a,v)=>a in e?ra(e,a,{enumerable:!0,configurable:!0,writable:!0,value:v}):e[a]=v;var ne=(e,a,v)=>(na(e,typeof a!="symbol"?a+"":a,v),v);import{Q as sa}from"./QResizeObserver.9af84680.js";import{aa as Pe,b6 as Qe,b7 as K,b8 as Oe,c as V,f as p,w,i as Ce,ah as la,k as R,g as xe,an as ia,ab as ua,aq as da,ad as ca,as as va,au as fa,b9 as ma,n as qe,h as Ee,j as ke,b3 as ze,ai as ba,ba as pa,_ as oe,d as de,v as g,P as U,F as s,z as i,B as G,O as ae,J as le,b0 as Ae,U as ga,x as S,y as c,D as z,t as De,K as Q,a3 as Be,G as j,H as W,u as Fe,m as ha,bb as Me,bc as ya,bd as wa,I as Ve,a4 as $a,be as Ca,E as ka,R as Sa,Z as Ta,e as _a,A as qa,s as za,bf as ye}from"./index.6449c167.js";import{T as we}from"./TouchPan.5bc050d4.js";import{b as se}from"./format.8ac60962.js";import{Q as Ba}from"./QCircularProgress.b24a7ee9.js";import{S as Ma,b as Va,c as La,a as Pa}from"./utils.521b98f3.js";import{a as D,Q as Z}from"./QItemSection.9a955ec6.js";import{a as ie,Q as ue}from"./QSelect.6ce302d7.js";import{Q as Qa}from"./QExpansionItem.e36a6702.js";import{C as $e,a as Oa}from"./ComponenteModal.domain.50e59f97.js";import{Q as xa}from"./QForm.ca56f146.js";import{m as Ea}from"./tareas.utils.309e0dff.js";import{r as J}from"./i18n-validators.29e2545c.js";import{u as Ne}from"./index.490dde02.js";import{T as Aa}from"./TabLayout.0bce4313.js";import{E as Ie}from"./EssentialTable.00c17e97.js";import{T as Da}from"./TrabajoAsignadoController.9990fd06.js";import{C as je}from"./ContenedorSimpleMixin.09c9bed5.js";import{M as Fa}from"./MovilizacionSubtareaController.4c60b923.js";import{u as Na}from"./movilizacionSubtarea.b5ca9608.js";import{M as Ia}from"./MovilizacionSubtarea.9a93287f.js";import{c as ja}from"./configuracionColumnasTarea.bcb4cc35.js";import{u as Ha}from"./FiltrosListadosTarea.245f381c.js";import{u as Ra,T as Wa}from"./tarea.733b03a6.js";import Ua from"./ModoNoDisponiblePage.9900a2b2.js";var rt=Pe({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:a,emit:v}){const{proxy:{$q:h}}=xe(),u=Qe(Oe,K);if(u===K)return console.error("QHeader needs to be child of QLayout"),K;const f=V(parseInt(e.heightHint,10)),r=V(!0),n=p(()=>e.reveal===!0||u.view.value.indexOf("H")!==-1||h.platform.is.ios&&u.isContainer.value===!0),T=p(()=>{if(e.modelValue!==!0)return 0;if(n.value===!0)return r.value===!0?f.value:0;const l=f.value-u.scroll.value.position;return l>0?l:0}),O=p(()=>e.modelValue!==!0||n.value===!0&&r.value!==!0),t=p(()=>e.modelValue===!0&&O.value===!0&&e.reveal===!0),x=p(()=>"q-header q-layout__section--marginal "+(n.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(O.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),_=p(()=>{const l=u.rows.value.top,y={};return l[0]==="l"&&u.left.space===!0&&(y[h.lang.rtl===!0?"right":"left"]=`${u.left.size}px`),l[2]==="r"&&u.right.space===!0&&(y[h.lang.rtl===!0?"left":"right"]=`${u.right.size}px`),y});function $(l,y){u.update("header",l,y)}function m(l,y){l.value!==y&&(l.value=y)}function C({height:l}){m(f,l),$("size",l)}function k(l){t.value===!0&&m(r,!0),v("focusin",l)}w(()=>e.modelValue,l=>{$("space",l),m(r,!0),u.animate()}),w(T,l=>{$("offset",l)}),w(()=>e.reveal,l=>{l===!1&&m(r,e.modelValue)}),w(r,l=>{u.animate(),v("reveal",l)}),w(u.scroll,l=>{e.reveal===!0&&m(r,l.direction==="up"||l.position<=e.revealOffset||l.position-l.inflectionPoint<100)});const b={};return u.instances.header=b,e.modelValue===!0&&$("size",f.value),$("space",e.modelValue),$("offset",T.value),Ce(()=>{u.instances.header===b&&(u.instances.header=void 0,$("size",0),$("offset",0),$("space",!1))}),()=>{const l=la(a.default,[]);return e.elevated===!0&&l.push(R("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(R(sa,{debounce:0,onResize:C})),R("header",{class:x.value,style:_.value,onFocusin:k},l)}}});const Le=150;var nt=Pe({name:"QDrawer",inheritAttrs:!1,props:{...ia,...ua,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...da,"onLayout","miniState"],setup(e,{slots:a,emit:v,attrs:h}){const u=xe(),{proxy:{$q:f}}=u,r=ca(e,f),{preventBodyScroll:n}=pa(),{registerTimeout:T,removeTimeout:O}=va(),t=Qe(Oe,K);if(t===K)return console.error("QDrawer needs to be child of QLayout"),K;let x,_=null,$;const m=V(e.behavior==="mobile"||e.behavior!=="desktop"&&t.totalWidth.value<=e.breakpoint),C=p(()=>e.mini===!0&&m.value!==!0),k=p(()=>C.value===!0?e.miniWidth:e.width),b=V(e.showIfAbove===!0&&m.value===!1?!0:e.modelValue===!0),l=p(()=>e.persistent!==!0&&(m.value===!0||He.value===!0));function y(o,d){if(ce(),o!==!1&&t.animate(),M(0),m.value===!0){const q=t.instances[te.value];q!==void 0&&q.belowBreakpoint===!0&&q.hide(!1),N(1),t.isContainer.value!==!0&&n(!0)}else N(0),o!==!1&&pe(!1);T(()=>{o!==!1&&pe(!0),d!==!0&&v("show",o)},Le)}function H(o,d){ve(),o!==!1&&t.animate(),N(0),M(B.value*k.value),ge(),d!==!0?T(()=>{v("hide",o)},Le):O()}const{show:F,hide:E}=fa({showing:b,hideOnRouteChange:l,handleShow:y,handleHide:H}),{addToHistory:ce,removeFromHistory:ve}=ma(b,E,l),X={belowBreakpoint:m,hide:E},L=p(()=>e.side==="right"),B=p(()=>(f.lang.rtl===!0?-1:1)*(L.value===!0?1:-1)),A=V(0),P=V(!1),Y=V(!1),Se=V(k.value*B.value),te=p(()=>L.value===!0?"left":"right"),fe=p(()=>b.value===!0&&m.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:k.value:0),me=p(()=>e.overlay===!0||e.miniToOverlay===!0||t.view.value.indexOf(L.value?"R":"L")!==-1||f.platform.is.ios===!0&&t.isContainer.value===!0),ee=p(()=>e.overlay===!1&&b.value===!0&&m.value===!1),He=p(()=>e.overlay===!0&&b.value===!0&&m.value===!1),Re=p(()=>"fullscreen q-drawer__backdrop"+(b.value===!1&&P.value===!1?" hidden":"")),We=p(()=>({backgroundColor:`rgba(0,0,0,${A.value*.4})`})),Te=p(()=>L.value===!0?t.rows.value.top[2]==="r":t.rows.value.top[0]==="l"),Ue=p(()=>L.value===!0?t.rows.value.bottom[2]==="r":t.rows.value.bottom[0]==="l"),Je=p(()=>{const o={};return t.header.space===!0&&Te.value===!1&&(me.value===!0?o.top=`${t.header.offset}px`:t.header.space===!0&&(o.top=`${t.header.size}px`)),t.footer.space===!0&&Ue.value===!1&&(me.value===!0?o.bottom=`${t.footer.offset}px`:t.footer.space===!0&&(o.bottom=`${t.footer.size}px`)),o}),Ke=p(()=>{const o={width:`${k.value}px`,transform:`translateX(${Se.value}px)`};return m.value===!0?o:Object.assign(o,Je.value)}),Ze=p(()=>"q-drawer__content fit "+(t.isContainer.value!==!0?"scroll":"overflow-auto")),Ge=p(()=>`q-drawer q-drawer--${e.side}`+(Y.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(r.value===!0?" q-drawer--dark q-dark":"")+(P.value===!0?" no-transition":b.value===!0?"":" q-layout--prevent-focus")+(m.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${C.value===!0?"mini":"standard"}`+(me.value===!0||ee.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(Te.value===!0?" q-drawer--top-padding":""))),Xe=p(()=>{const o=f.lang.rtl===!0?e.side:te.value;return[[we,oa,void 0,{[o]:!0,mouse:!0}]]}),Ye=p(()=>{const o=f.lang.rtl===!0?te.value:e.side;return[[we,_e,void 0,{[o]:!0,mouse:!0}]]}),ea=p(()=>{const o=f.lang.rtl===!0?te.value:e.side;return[[we,_e,void 0,{[o]:!0,mouse:!0,mouseAllDir:!0}]]});function be(){ta(m,e.behavior==="mobile"||e.behavior!=="desktop"&&t.totalWidth.value<=e.breakpoint)}w(m,o=>{o===!0?(x=b.value,b.value===!0&&E(!1)):e.overlay===!1&&e.behavior!=="mobile"&&x!==!1&&(b.value===!0?(M(0),N(0),ge()):F(!1))}),w(()=>e.side,(o,d)=>{t.instances[d]===X&&(t.instances[d]=void 0,t[d].space=!1,t[d].offset=0),t.instances[o]=X,t[o].size=k.value,t[o].space=ee.value,t[o].offset=fe.value}),w(t.totalWidth,()=>{(t.isContainer.value===!0||document.qScrollPrevented!==!0)&&be()}),w(()=>e.behavior+e.breakpoint,be),w(t.isContainer,o=>{b.value===!0&&n(o!==!0),o===!0&&be()}),w(t.scrollbarWidth,()=>{M(b.value===!0?0:void 0)}),w(fe,o=>{I("offset",o)}),w(ee,o=>{v("onLayout",o),I("space",o)}),w(L,()=>{M()}),w(k,o=>{M(),he(e.miniToOverlay,o)}),w(()=>e.miniToOverlay,o=>{he(o,k.value)}),w(()=>f.lang.rtl,()=>{M()}),w(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(aa(),t.animate())}),w(C,o=>{v("miniState",o)});function M(o){o===void 0?qe(()=>{o=b.value===!0?0:k.value,M(B.value*o)}):(t.isContainer.value===!0&&L.value===!0&&(m.value===!0||Math.abs(o)===k.value)&&(o+=B.value*t.scrollbarWidth.value),Se.value=o)}function N(o){A.value=o}function pe(o){const d=o===!0?"remove":t.isContainer.value!==!0?"add":"";d!==""&&document.body.classList[d]("q-body--drawer-toggle")}function aa(){_!==null&&clearTimeout(_),u.proxy&&u.proxy.$el&&u.proxy.$el.classList.add("q-drawer--mini-animate"),Y.value=!0,_=setTimeout(()=>{_=null,Y.value=!1,u&&u.proxy&&u.proxy.$el&&u.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function oa(o){if(b.value!==!1)return;const d=k.value,q=se(o.distance.x,0,d);if(o.isFinal===!0){q>=Math.min(75,d)===!0?F():(t.animate(),N(0),M(B.value*d)),P.value=!1;return}M((f.lang.rtl===!0?L.value!==!0:L.value)?Math.max(d-q,0):Math.min(0,q-d)),N(se(q/d,0,1)),o.isFirst===!0&&(P.value=!0)}function _e(o){if(b.value!==!0)return;const d=k.value,q=o.direction===e.side,re=(f.lang.rtl===!0?q!==!0:q)?se(o.distance.x,0,d):0;if(o.isFinal===!0){Math.abs(re)<Math.min(75,d)===!0?(t.animate(),N(1),M(0)):E(),P.value=!1;return}M(B.value*re),N(se(1-re/d,0,1)),o.isFirst===!0&&(P.value=!0)}function ge(){n(!1),pe(!0)}function I(o,d){t.update(e.side,o,d)}function ta(o,d){o.value!==d&&(o.value=d)}function he(o,d){I("size",o===!0?e.miniWidth:d)}return t.instances[e.side]=X,he(e.miniToOverlay,k.value),I("space",ee.value),I("offset",fe.value),e.showIfAbove===!0&&e.modelValue!==!0&&b.value===!0&&e["onUpdate:modelValue"]!==void 0&&v("update:modelValue",!0),Ee(()=>{v("onLayout",ee.value),v("miniState",C.value),x=e.showIfAbove===!0;const o=()=>{(b.value===!0?y:H)(!1,!0)};if(t.totalWidth.value!==0){qe(o);return}$=w(t.totalWidth,()=>{$(),$=void 0,b.value===!1&&e.showIfAbove===!0&&m.value===!1?F(!1):o()})}),Ce(()=>{$!==void 0&&$(),_!==null&&(clearTimeout(_),_=null),b.value===!0&&ge(),t.instances[e.side]===X&&(t.instances[e.side]=void 0,I("size",0),I("offset",0),I("space",!1))}),()=>{const o=[];m.value===!0&&(e.noSwipeOpen===!1&&o.push(ke(R("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),Xe.value)),o.push(ze("div",{ref:"backdrop",class:Re.value,style:We.value,"aria-hidden":"true",onClick:E},void 0,"backdrop",e.noSwipeBackdrop!==!0&&b.value===!0,()=>ea.value)));const d=C.value===!0&&a.mini!==void 0,q=[R("div",{...h,key:""+d,class:[Ze.value,h.class]},d===!0?a.mini():ba(a.default))];return e.elevated===!0&&b.value===!0&&q.push(R("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),o.push(ze("aside",{ref:"content",class:Ge.value,style:Ke.value},q,"contentclose",e.noSwipeClose!==!0&&m.value===!0,()=>Ye.value)),R("div",{class:"q-drawer-container"},o)}}});const Ja=de({setup(){const e=V(!1);function a(){window.scrollTo({top:0,behavior:"smooth"})}const v=()=>{e.value=window.scrollY>100};return Ee(()=>{window.addEventListener("scroll",v)}),Ce(()=>{window.removeEventListener("scroll",v)}),{scrollToTop:a,showButton:e}}});function Ka(e,a,v,h,u,f){return e.showButton?(g(),U(ae,{key:0,onClick:e.scrollToTop,class:"scroll-to-top-button"},{default:s(()=>[i(G,{name:"bi-arrow-up-short"})]),_:1},8,["onClick"])):le("",!0)}var st=oe(Ja,[["render",Ka],["__scopeId","data-v-2e198660"]]);const Za={class:"loading-background"},Ga={__name:"EssentialLoading",setup(e){const a=new Ma;return(v,h)=>ke((g(),S("section",Za,[i(Ba,{indeterminate:"",size:"75px",thickness:.6,color:"primary","center-color":"grey-2",class:"q-ma-md"}),h[0]||(h[0]=c("b",{class:"text-primary"},"Espere, por favor...",-1))],512)),[[Ae,ga(a).estaCargando.value]])}};var lt=Ga;const Xa={},Ya={class:"q-pa-xs text-right"};function eo(e,a){return g(),S("small",Ya,a[0]||(a[0]=[c("strong",null,"Copyright \xA9 2023",-1),z(". Todos los derechos reservados por "),c("strong",null,"JPCONSTRUCRED",-1),z(". ")]))}var it=oe(Xa,[["render",eo]]);const ao=de({name:"EssentialLink",props:{title:{type:String,required:!0},link:{type:String,default:"#"},icon:{type:String,default:""},children:{type:Object,required:!1},can:{type:Boolean,default:!0},hasParent:{type:Boolean,default:!1}}}),oo={key:0};function to(e,a,v,h,u,f){const r=De("EssentialLink",!0);return e.can?(g(),S("div",oo,[e.children?(g(),U(Qa,{key:1,clickable:"",tag:"a","active-class":"link-active",exact:"",class:Be({"bg-desenfoque border-white rounded q-mb-xs":!1,"border-left q-ml-lg":e.hasParent})},{header:s(()=>[e.icon?(g(),U(D,{key:0,avatar:""},{default:s(()=>[i(G,{name:e.icon,size:"xs",class:"text-color-drawer"},null,8,["name"])]),_:1})):le("",!0),i(D,null,{default:s(()=>[i(ie,{class:"text-color-drawer-bold textf-bold"},{default:s(()=>[z(Q(e.title),1)]),_:1})]),_:1})]),default:s(()=>[(g(!0),S(j,null,W(e.children,n=>{var T;return g(),S("div",{key:n.title},[i(r,{title:(T=n.title)!=null?T:"",link:n.link,icon:n.icon,children:n.children,can:n.can,hasParent:""},null,8,["title","link","icon","children","can"])])}),128))]),_:1},8,["class"])):(g(),U(Z,{key:0,clickable:"",tag:"a",to:e.link,"active-class":"link-active",class:Be([{"border-left q-ml-lg":e.hasParent},"text-color-drawer"]),exact:""},{default:s(()=>[e.icon?(g(),U(D,{key:0,avatar:""},{default:s(()=>[i(G,{name:e.icon,size:"xs"},null,8,["name"])]),_:1})):le("",!0),i(D,null,{default:s(()=>[i(ie,null,{default:s(()=>[z(Q(e.title),1)]),_:1})]),_:1})]),_:1},8,["to","class"]))])):le("",!0)}var ut=oe(ao,[["render",to]]),ro=de({components:{TabLayout:Aa,EssentialTable:Ie},emits:["cerrar-modal"],setup(e,{emit:a}){const v=Na(),h=Fe();Va().setQuasar(ha());const u=new je(Ia,new Fa),{entidad:f,disabled:r,accion:n,listadosAuxiliares:T}=u.useReferencias(),{cargarVista:O,obtenerListados:t,setValidador:x,guardar:_}=u.useComportamiento();O(async()=>{await t({subtareas:{controller:new Da,params:{estado:"MOVILIZACION"}}}),C.value=T.subtareas});const m=Ne({subtarea:{required:J},motivo:{required:J},longitud:{required:J},latitud:{required:J}},f);x(m.value);const C=V();function k(y,H){if(y===""){H(()=>{C.value=T.clientes});return}H(()=>{const F=y.toLowerCase();C.value=T.subtareas.filter(E=>E.codigo_subtarea.toLowerCase().indexOf(F)>-1)})}async function b(){await _(f)&&(v.getSubtareaDestino(h.user.id),a("cerrar-modal",!1))}function l(){La(y=>{f.latitud=y.coords.latitude,f.longitud=y.coords.longitude})}return{mixin:u,movilizacion:f,disabled:r,accion:n,v$:m,filtrarSubtareas:k,subtareas:C,comenzar:b,motivosMovilizacion:Ea,obtenerCoordenadas:l}}});const no={class:"row q-col-gutter-xs"},so={class:"col-12 col-md-6"},lo={class:"error-msg"},io={class:"col-12 col-md-6"},uo={class:"error-msg"},co={class:"col-12 col-md-4 q-mx-auto q-mb-xl"},vo={class:"col-12"},fo={class:"error-msg"},mo={class:"col-12"},bo={class:"error-msg"},po={class:"row"};function go(e,a,v,h,u,f){return g(),U(xa,{onSubmit:a[6]||(a[6]=$a(()=>{},["prevent"])),class:""},{default:s(()=>[i(Me,{class:"rounded-card custom-shadow"},{default:s(()=>[i(ya,null,{default:s(()=>[c("div",no,[c("div",so,[a[8]||(a[8]=c("label",{class:"q-mb-sm block"},"Me dirijo al siguiente trabajo",-1)),i(ue,{modelValue:e.movilizacion.subtarea,"onUpdate:modelValue":a[0]||(a[0]=r=>e.movilizacion.subtarea=r),options:e.subtareas,error:!!e.v$.subtarea.$errors.length,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":r=>r.codigo_subtarea+" - "+r.titulo,"option-value":r=>r.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{option:s(r=>[i(Z,wa(r.itemProps,{class:"q-my-sm"}),{default:s(()=>[i(D,null,{default:s(()=>[i(ie,{class:"text-bold text-primary"},{default:s(()=>[z(Q(r.opt.codigo_subtarea),1)]),_:2},1024),i(ie,{caption:""},{default:s(()=>[z(Q(r.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":s(()=>[i(Z,null,{default:s(()=>[i(D,{class:"text-grey"},{default:s(()=>a[7]||(a[7]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:s(()=>[(g(!0),S(j,null,W(e.v$.subtarea.$errors,r=>(g(),S("div",{key:r.$uid},[c("div",lo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","options","error","disable","option-label","option-value"])]),c("div",io,[a[10]||(a[10]=c("label",{class:"q-mb-sm block"},"Motivo",-1)),i(ue,{modelValue:e.movilizacion.motivo,"onUpdate:modelValue":a[1]||(a[1]=r=>e.movilizacion.motivo=r),options:e.motivosMovilizacion,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":r=>r.descripcion,"option-value":r=>r.id,"emit-value":"","map-options":"",error:!!e.v$.motivo.$errors.length,onBlur:e.v$.motivo.$touch},{"no-option":s(()=>[i(Z,null,{default:s(()=>[i(D,{class:"text-grey"},{default:s(()=>a[9]||(a[9]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:s(()=>[(g(!0),S(j,null,W(e.v$.motivo.$errors,r=>(g(),S("div",{key:r.$uid},[c("div",uo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","options","option-label","option-value","error","onBlur"])]),c("div",co,[i(Me,{flat:"",class:"custom-shadows nso-border q-pa-md"},{default:s(()=>[a[14]||(a[14]=c("label",{class:"q-mb-sm text-center block text-bold"},"Coordenadas",-1)),c("div",vo,[a[11]||(a[11]=c("label",{class:"q-mb-sm block"},"Longitud",-1)),i(Ve,{modelValue:e.movilizacion.longitud,"onUpdate:modelValue":a[2]||(a[2]=r=>e.movilizacion.longitud=r),error:!!e.v$.longitud.$errors.length,outlined:"",dense:"",disable:""},{error:s(()=>[(g(!0),S(j,null,W(e.v$.longitud.$errors,r=>(g(),S("div",{key:r.$uid},[c("div",fo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),c("div",mo,[a[12]||(a[12]=c("label",{class:"q-mb-sm block"},"Latitud",-1)),i(Ve,{modelValue:e.movilizacion.latitud,"onUpdate:modelValue":a[3]||(a[3]=r=>e.movilizacion.latitud=r),error:!!e.v$.latitud.$errors.length,outlined:"",dense:"",disable:""},{error:s(()=>[(g(!0),S(j,null,W(e.v$.latitud.$errors,r=>(g(),S("div",{key:r.$uid},[c("div",bo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),i(ae,{color:"positive","no-caps":"","no-wrap":"",class:"full-width",onClick:a[4]||(a[4]=r=>e.obtenerCoordenadas()),disable:e.disabled},{default:s(()=>[i(G,{name:"bi-geo-alt",size:"xs",class:"q-mr-xs"}),a[13]||(a[13]=z(" Actualizar ubicaci\xF3n"))]),_:1},8,["disable"])]),_:1})])]),c("div",po,[i(ae,{class:"col-12",color:"primary",type:"submit","no-caps":"",onClick:a[5]||(a[5]=r=>e.comenzar())},{default:s(()=>[i(G,{name:"bi-car-front-fill",size:"xs",class:"q-pr-sm"}),a[15]||(a[15]=c("span",null,"Comenzar viaje",-1))]),_:1})])]),_:1})]),_:1})]),_:1})}var ho=oe(ro,[["render",go]]),yo=de({components:{EssentialTable:Ie},emits:["cerrar-modal","guardado"],setup(e,{emit:a}){const v=Ra(),h=Fe(),u=new je(Wa,new Ca),{listar:f,cargarVista:r,obtenerListados:n}=u.useComportamiento(),{listado:T,listadosAuxiliares:O}=u.useReferencias();r(async()=>{await n({coordinadores:{controller:new ka,params:{rol:Sa.coordinador,campos:"id,nombres,apellidos"}}}),y.value=O.coordinadores});const t=V(),x=Ta(),{notificarAdvertencia:_,notificarCorrecto:$,confirmar:m}=Pa(),C=_a({actual_coordinador:null,nuevo_coordinador:null}),k=h.esCoordinadorBackup||h.esJefeTecnico;h.esCoordinador&&!h.esCoordinadorBackup&&!h.esJefeTecnico&&(f({finalizado:!1}),C.actual_coordinador=h.user.id);const l=Ne({actual_coordinador:{required:J},nuevo_coordinador:{required:J}},C),{coordinadores:y,filtrarCoordinadores:H}=Ha(O);async function F(B){if(!B.length)return _("Debe seleccionar al menos una tarea para transferir");if(await l.value.$validate())try{m("\xBFEst\xE1 seguro de realizar la transferencia?",async()=>{const A=qa.getInstance(),P=A.getEndpoint(za.transferir_mis_tareas_activas),Y=await A.post(P,{nuevo_coordinador:C.nuevo_coordinador,ids_tareas:B});$(Y.data.mensaje),v.recargaTareasActivas=!0,a("cerrar-modal",!1)})}catch(A){_(A)}}function E(){f({coordinador_id:C.actual_coordinador,finalizado:!1}),t.value.clearSelection()}async function ce(){a("cerrar-modal",!1),await x.replace({name:"tareas"})}function ve(){a("cerrar-modal",!1)}return{v$:l,refTareas:t,transferencia:C,coordinadores:y,filtrarCoordinadores:H,listado:T,irControlTareas:ce,configuracionColumnasTarea:ja,puedeSeleccionarActualCoordinador:k,transferir:F,cancelar:ve,filtrarTareasPorCoordinador:E,seleccionarTareas:()=>{t.value.seleccionar()},tareasSeleccionadas:B=>{console.log(B);const A=B.map(P=>P.id);F(A)}}}});const wo={class:"row q-col-gutter-sm"},$o={class:"col-12 col-md-6"},Co={class:"error-msg"},ko={class:"col-12 col-md-6"},So={class:"error-msg"},To={class:"row justify-end q-gutter-x-xs q-mb-md"},_o={class:"row justify-center q-mb-md"},qo={class:"col-12"};function zo(e,a,v,h,u,f){const r=De("essential-table");return g(),S(j,null,[c("div",wo,[c("div",$o,[a[6]||(a[6]=c("label",{class:"q-mb-sm block"},"Actual coordinador responsable",-1)),i(ue,{modelValue:e.transferencia.actual_coordinador,"onUpdate:modelValue":[a[0]||(a[0]=n=>e.transferencia.actual_coordinador=n),a[1]||(a[1]=n=>e.filtrarTareasPorCoordinador())],options:e.coordinadores,onFilter:e.filtrarCoordinadores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:!e.puedeSeleccionarActualCoordinador,"option-label":n=>n.nombres+" "+n.apellidos,"option-value":n=>n.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",onBlur:e.v$.actual_coordinador.$touch,error:!!e.v$.actual_coordinador.$errors.length},{"no-option":s(()=>[i(Z,null,{default:s(()=>[i(D,{class:"text-grey"},{default:s(()=>a[5]||(a[5]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:s(()=>[(g(!0),S(j,null,W(e.v$.actual_coordinador.$errors,n=>(g(),S("div",{key:n.$uid},[c("div",Co,Q(n.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","onBlur","error"])]),c("div",ko,[a[8]||(a[8]=c("label",{class:"q-mb-sm block"},"Nuevo coordinador responsable",-1)),i(ue,{modelValue:e.transferencia.nuevo_coordinador,"onUpdate:modelValue":a[2]||(a[2]=n=>e.transferencia.nuevo_coordinador=n),options:e.coordinadores,onFilter:e.filtrarCoordinadores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":n=>n.nombres+" "+n.apellidos,"option-value":n=>n.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",onBlur:e.v$.nuevo_coordinador.$touch,error:!!e.v$.nuevo_coordinador.$errors.length},{"no-option":s(()=>[i(Z,null,{default:s(()=>[i(D,{class:"text-grey"},{default:s(()=>a[7]||(a[7]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:s(()=>[(g(!0),S(j,null,W(e.v$.nuevo_coordinador.$errors,n=>(g(),S("div",{key:n.$uid},[c("div",So,Q(n.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","option-label","option-value","onBlur","error"])])]),c("div",To,[i(ae,{color:"primary","no-caps":"",push:"",onClick:a[3]||(a[3]=n=>e.seleccionarTareas()),disable:!e.listado.length},{default:s(()=>[i(G,{name:"bi-arrow-left-right",class:"q-mr-sm",size:"xs"}),a[9]||(a[9]=z(" Transferir al nuevo coordinador"))]),_:1},8,["disable"]),i(ae,{color:"negative","no-caps":"",push:"",icon:"bi-x",onClick:a[4]||(a[4]=n=>e.cancelar())},{default:s(()=>a[10]||(a[10]=[z("Cancelar")])),_:1})]),c("div",_o,[c("div",qo,[ke(i(r,{ref:"refTareas",titulo:"Hay un total de "+e.listado.length+" tareas activas.",configuracionColumnas:e.configuracionColumnasTarea,datos:e.listado,separador:"cell",permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-botones":!1,permitirFiltrar:!1,mostrarFooter:!1,"alto-fijo":!1,"ajustar-celdas":!0,"tipo-seleccion":"multiple",onSelected:e.tareasSeleccionadas},null,8,["titulo","configuracionColumnas","datos","onSelected"]),[[Ae,e.listado.length]])])])],64)}var Bo=oe(yo,[["render",zo]]);class Mo{constructor(){ne(this,"MovilizacionSubtareaPage");ne(this,"TranferirTareaPage");ne(this,"ModoNoDisponiblePage");this.MovilizacionSubtareaPage=ye(new $e("Movilizaci\xF3n entre trabajos",ho)),this.TranferirTareaPage=ye(new $e("Transferir tareas activas",Bo)),this.ModoNoDisponiblePage=ye(new $e("Configurar modo No Disponible",Ua))}}class dt extends Oa{constructor(){super(new Mo)}}export{dt as C,ut as E,it as F,rt as Q,st as S,lt as a,nt as b};

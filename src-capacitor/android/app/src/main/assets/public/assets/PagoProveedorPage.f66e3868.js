var D=Object.defineProperty;var M=(o,e,r)=>e in o?D(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var n=(o,e,r)=>(M(o,typeof e!="symbol"?e+"":e,r),r);import{a as R}from"./QToolbar.cff7174f.js";import{bz as U,t as y,c as $,U as G,be as H,p as P,e as L,g as Y,bA as V,q as j,A as K,bH as J,v as O,x as k,y as s,S as z,H as u,D as l,a7 as W,B as t,z as m,G as b,R as X,F as Z,L as d,K as f,a9 as x,M as oo}from"./index.976e8f3c.js";import{Q as eo}from"./QChip.334d746c.js";import{Q as ao}from"./QForm.ed6f6690.js";import{u as io}from"./index.ed676411.js";import{T as lo}from"./TabLayout.d6dcc414.js";import{G as ro}from"./GestorDocumentos.5aa78d49.js";import{E as so}from"./EssentialPopupEditableTable.9b9b765e.js";import{E as to}from"./entidadAuditable.75a46700.js";import{C as no}from"./ContenedorSimpleMixin.5a0b06ab.js";import{u as mo,L as uo,A as co}from"./utils.30e08aa2.js";import"./position-engine.2f1d750c.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QSelect.a8f2bfb2.js";import"./QItemSection.c6f2640c.js";import"./QMenu.410ae527.js";import"./format.8ac60962.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./QPage.ed5d79ca.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTable.d8e6954a.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./i18n-validators.06eef631.js";import"./index.95f5a0db.js";import"./EssentialTablePagination.f449a738.js";import"./QUploader.43bbdad9.js";import"./QCircularProgress.4d1a2735.js";const c=[{name:"id",field:"id",label:"id",align:"left",visible:!1,sortable:!0},{name:"razon_social",field:"razon_social",label:"Raz\xF3n Social",align:"left",sortable:!0},{name:"num_documento",field:"num_documento",label:"# Doc.",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n.",align:"left",sortable:!0},{name:"fecha_emision",field:"fecha_emision",label:"F. Emisi\xF3n",align:"left",sortable:!0},{name:"fecha_vencimiento",field:"fecha_vencimiento",label:"F. Vencimiento",align:"left",sortable:!0},{name:"plazo",field:"plazo",label:"Plazo",align:"left",sortable:!0},{name:"total",field:"total",label:"Total",align:"left",sortable:!0},{name:"valor_pagar",field:"valor_pagar",label:"V. Pagar",align:"left",sortable:!0}],po=[{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"realizador",field:"realizador",label:"Subido Por",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0},{name:"cant_elementos",field:"cant_elementos",label:"Cant. Facturas",align:"left",sortable:!0}];class bo extends to{constructor(){super();n(this,"archivo");n(this,"nombre");n(this,"realizador");n(this,"estado");n(this,"cant_elementos");n(this,"listado");this.archivo=null,this.nombre=null,this.realizador=null,this.estado=null,this.cant_elementos=null,this.listado=[]}}class fo extends U{constructor(){super(y.pagos_proveedores)}}var go=$({components:{TabLayout:lo,GestorDocumentos:ro,EssentialPopupEditableTable:so},setup(){const o=new no(bo,new fo),{entidad:e,accion:r,disabled:E,listado:S}=o.useReferencias(),{setValidador:F,listar:g}=o.useComportamiento(),{confirmar:v}=G(),{onConsultado:C}=o.useHooks();H().setQuasar(P()),mo().setQuasar(P());const i=L(),h=Y(()=>e.listado.reduce((a,p)=>a+parseFloat(p.valor_pagar),0).toFixed(2)),w=io({},e);F(w.value),C(()=>{r.value==V.editar?(c.find(a=>a.field==="valor_pagar").visible=!0,c.find(a=>a.field==="valor_pagar").editable=!0,c.find(a=>a.field==="valor_pagar").type="number",c.find(a=>a.field==="valor_pagar").hint="Ingresa el valor a pagar"):c.find(a=>a.field==="valor_pagar").editable=!1});const A={titulo:"Eliminar",icono:"bi-x",color:"negative",accion:({entidad:a,posicion:p})=>{T({posicion:p})},visible:()=>r.value==V.editar},q={titulo:"Cash",icono:"bi-file-earmark-excel-fill",color:"positive",accion:async({entidad:a})=>{await Q(a)}};async function Q(a){const p="pago_a_proveedores_"+uo(new Date,"D-MM-YYYY"),_=K.getInstance(),I=J.URL_BASE+"/"+_.getEndpoint(y.pagos_proveedores)+"/cash/"+a.id;await co(I,"GET","blob","xlsx",p,null)}function T({posicion:a}){v("\xBFEst\xE1 seguro de continuar?",()=>e.listado.splice(a,1))}async function B(){await i.value.subir(),console.log(i.value),g()}function N(a){a.valor_pagar=Number(a.valor_pagar).toFixed(2),a.total<a.valor_pagar&&(a.valor_pagar=a.total)}return{pago:e,mixin:o,accion:r,acciones:V,disabled:E,configuracionColumnas:po,columnasItems:c,accionesTabla:j,refArchivo:i,endpoint:y.pagos_proveedores,btnEliminarFila:A,btnCash:q,subirArchivos:B,calcularValores:N,total:h}}});const vo={class:"row q-col-gutter-sm q-py-md"},Co={key:0,class:"col-12 col-md-12"},Vo={class:"q-mb-sm block"},ko={key:1,class:"col-12 col-md-3"},yo={key:2,class:"col-12 col-md-3"},Eo={key:3,class:"col-12 col-md-3"},Fo={key:4,class:"col-12 col-md-3"},Po={key:5,class:"col-12 col-md-3 col-sm-6"},zo={key:6,class:"col-12"};function So(o,e,r,E,S,F){const g=k("gestor-documentos"),v=k("essential-popup-editable-table"),C=k("tab-layout");return s(),z(C,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Pago a Proveedores",mostrarButtonSubmits:o.accion!=o.acciones.nuevo,accion1:o.btnCash},{formulario:u(()=>[l(ao,{onSubmit:e[5]||(e[5]=W(()=>{},["prevent"]))},{default:u(()=>[t("div",vo,[o.accion==o.acciones.nuevo?(s(),m("div",Co,[t("label",Vo,[e[7]||(e[7]=b("Reporte de contifico ")),e[8]||(e[8]=t("i",{class:"bi bi-info-circle"},null,-1)),l(R,{class:"bg-light-blue-7"},{default:u(()=>e[6]||(e[6]=[b("Suba el reporte de cartera por pagar emitida por contifico")])),_:1})]),l(g,{ref:"refArchivo",mixin:o.mixin,endpoint:o.endpoint,disable:o.disabled,"permitir-eliminar":!1,"mostrar-listado":!1,"listar-al-guardar":!1,esMultiple:!1},{"boton-subir":u(()=>[(s(),z(X,{key:0,color:"positive",push:"","no-caps":"",class:"full-width q-mb-lg",onClick:e[0]||(e[0]=i=>o.subirArchivos())},{default:u(()=>[l(Z,{name:"bi-upload",class:"q-mr-sm",size:"xs"}),e[9]||(e[9]=b(" Subir archivos seleccionados"))]),_:1}))]),_:1},8,["mixin","endpoint","disable"])])):d("",!0),o.pago.id?(s(),m("div",ko,[e[10]||(e[10]=t("label",{class:"q-mb-sm block"},"Documento N\xB0",-1)),l(f,{modelValue:o.pago.id,"onUpdate:modelValue":e[1]||(e[1]=i=>o.pago.id=i),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):d("",!0),o.pago.created_at?(s(),m("div",yo,[e[11]||(e[11]=t("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),l(f,{modelValue:o.pago.created_at,"onUpdate:modelValue":e[2]||(e[2]=i=>o.pago.created_at=i),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):d("",!0),o.pago.nombre?(s(),m("div",Eo,[e[12]||(e[12]=t("label",{class:"q-mb-sm block"},"Archivo",-1)),l(f,{modelValue:o.pago.nombre,"onUpdate:modelValue":e[3]||(e[3]=i=>o.pago.nombre=i),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):d("",!0),o.pago.realizador?(s(),m("div",Fo,[e[13]||(e[13]=t("label",{class:"q-mb-sm block"},"Subido por",-1)),l(f,{modelValue:o.pago.realizador,"onUpdate:modelValue":e[4]||(e[4]=i=>o.pago.realizador=i),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):d("",!0),o.total>0?(s(),m("div",Po,[e[14]||(e[14]=t("label",{class:"q-mb-sm block"},"Total a Pagar:",-1)),l(eo,{square:""},{default:u(()=>[l(x,{icon:"bi-currency-dollar",color:"green","text-color":"white"}),b(" "+oo(o.total),1)]),_:1})])):d("",!0),o.accion!==o.acciones.nuevo?(s(),m("div",zo,[l(v,{ref:"refItems",titulo:"Facturas por pagar",configuracionColumnas:o.accion==o.acciones.consultar?o.columnasItems:[...o.columnasItems,o.accionesTabla],datos:o.pago.listado,separador:"cell",permitirEditarCeldas:o.accion==o.acciones.editar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,altoFijo:"",accion1:o.btnEliminarFila,onFilaModificada:o.calcularValores},null,8,["configuracionColumnas","datos","permitirEditarCeldas","accion1","onFilaModificada"])])):d("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","mostrarButtonSubmits","accion1"])}var be=O(go,[["render",So]]);export{be as default};

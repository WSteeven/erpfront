var ra=Object.defineProperty;var na=(e,a,r)=>a in e?ra(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var i=(e,a,r)=>(na(e,typeof a!="symbol"?a+"":a,r),r);import{Q as sa}from"./QPage.ed5d79ca.js";import{A as ia,t as T,bG as y,bz as O,c as U,be as F,p as $,u as G,U as ta,e as M,v as D,x as S,y as c,S as H,H as f,D as n,a7 as la,B as s,z as m,K as g,L as v,I as ua,J as ca,M as N,N as da,R as A,F as k,G as z,bi as ma,dm as fa,q as pa,dn as R}from"./index.976e8f3c.js";import{E as ba}from"./EssentialTableTabs.c7e98bba.js";import{C as j}from"./ContenedorSimpleMixin.5a0b06ab.js";import{G as va}from"./Gasto.edc5bb42.js";import{S as J,u as ga}from"./utils.30e08aa2.js";import{M as Ta}from"./ModalEntidad.84100166.js";import{C as za,a as Ea}from"./ComponenteModal.domain.22ea4557.js";import{Q as Ca}from"./QForm.ed6f6690.js";import{T as Va}from"./TabLayout.d6dcc414.js";import{S as Sa}from"./EssentialTable.d8e6954a.js";import{u as _a}from"./index.ed676411.js";import{r as q,m as I}from"./i18n-validators.06eef631.js";import{u as K,c as wa}from"./transferenciaSaldo.b0a4ca87.js";import{E as ha}from"./entidadAuditable.75a46700.js";import"./QBadge.1ddeabfd.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QSelect.a8f2bfb2.js";import"./QChip.334d746c.js";import"./QItemSection.c6f2640c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./configuracion_general.ef04b031.js";import"./ConfiguracionController.65de3fc5.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./buttonSubmits.2eb37d38.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./index.95f5a0db.js";const ya=[{name:"usuario_envia_info",field:"usuario_envia_info",label:"Enviado por",align:"left",sortable:!0},{name:"usuario_recibe_info",field:"usuario_recibe_info",label:"Recibido por",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"left",sortable:!0},{name:"motivo",field:"motivo",label:"Motivo",align:"left",sortable:!0}];class Aa{constructor(){i(this,"axios");this.axios=ia.getInstance()}async aprobarTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.aprobar_trnasferencia),a)}catch(r){const t=r;throw new y(t)}}async rechazarTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.rechazar_transferencia),a)}catch(r){const t=r;throw new y(t)}}async anularTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.anular_transferencia),a)}catch(r){const t=r;throw new y(t)}}}class ka extends O{constructor(){super(T.transferencia)}}class qa extends ha{constructor(){super();i(this,"usuario_envia_info");i(this,"usuario_recibe_info");i(this,"usuario_envia");i(this,"usuario_recibe");i(this,"monto");i(this,"motivo");i(this,"cuenta");i(this,"tarea");i(this,"tarea_info");i(this,"comprobante");i(this,"estado_info");i(this,"es_devolucion");this.comprobante=null,this.usuario_envia_info=null,this.es_devolucion=!1,this.usuario_envia=null,this.usuario_recibe=null,this.monto=null,this.motivo="DEVOLUCION",this.cuenta=null,this.usuario_recibe_info=null,this.tarea=null,this.tarea_info=null,this.estado_info=null}}var $a=U({components:{TabLayout:Va,SelectorImagen:Sa},emits:["guardado","cerrar-modal"],setup(e,{emit:a}){F().setQuasar($());const t=G().user,p=K(),u=new J,d=new j(qa,new ka),l=new Aa,{entidad:o,disabled:_,accion:w}=d.useReferencias(),{setValidador:b,consultar:E}=d.useComportamiento(),{confirmar:C,prompt:W,notificarCorrecto:X,notificarAdvertencia:B,notificarError:h}=ta(),x=M(!0),Y=M(!1),Z={usuario_recibe:{requiredIf:o.es_devolucion},monto:{required:q,maxLength:I(50)},cuenta:{required:q,maxLength:I(50)},tarea:{requiredIf:o.es_devolucion},comprobante:{required:q}},P=_a(Z,o);b(P.value),p.id_transferencia&&(E({id:p.id_transferencia}),x.value=!1,Y.value=!0);async function aa(V,ea){switch(ea){case"aprobar":try{u.activar(),await l.aprobarTransferencia(V),X("Se aprob\xF3 la Transferencia Exitosamente"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{h("No se pudo aprobar, debes ingresar un motivo para la anulaci\xF3n")}break;case"rechazar":C("\xBFEst\xE1 seguro de rechazar la transferencia?",async()=>{try{u.activar(),await l.rechazarTransferencia(V),B("Se rechazado Transferencia Exitosamente"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{h("No se pudo rechazar, debes ingresar un motivo para la anulaci\xF3n")}});break;case"anular":C("\xBFEst\xE1 seguro de anular la transferencia?",()=>{W({titulo:"Anular Transferencia",mensaje:"Ingrese motivo de anulacion",accion:async oa=>{try{u.activar(),V.detalle_estado=oa,await l.anularTransferencia(V),B("Se anulado Transferencia Exitosamente"),a("cerrar-modal"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{h("No se pudo anular, debes ingresar un motivo para la anulaci\xF3n")}}})});break}}return{mixin:d,transferencia:o,disabled:_,accion:w,v$:P,usuario:t,mostrarListado:x,actualizarTransferencia:aa,configuracionColumnas:wa}}});const Ma={class:"row q-col-gutter-sm q-mb-md"},Na={key:0,class:"col-12 col-md-3 q-mb-md"},Ba={key:1,class:"col-12 col-md-3 q-mb-md"},xa={class:"col-12 col-md-3"},Pa={class:"col-12 col-md-3"},Qa={class:"error-msg"},Ra={key:2,class:"col-12 col-md-3"},Ia={class:"col-12 col-md-3"},La={class:"col-12 col-md-3 q-mb-xl"},Oa={key:0,class:"q-pa-md q-gutter-sm flex flex-center"},Ua={key:1,class:"q-pa-md q-gutter-sm flex flex-center"};function Fa(e,a,r,t,p,u){const d=S("selector-imagen"),l=S("tab-layout");return c(),H(l,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,mostrarListado:!1,mostrarButtonSubmits:!1},{formulario:f(()=>[n(Ca,{onSubmit:a[7]||(a[7]=la(()=>{},["prevent"]))},{default:f(()=>[s("div",Ma,[e.transferencia.usuario_envia_info?(c(),m("div",Na,[a[11]||(a[11]=s("label",{class:"q-mb-sm block"},"Empleado Emisor",-1)),n(g,{modelValue:e.transferencia.usuario_envia_info,"onUpdate:modelValue":a[0]||(a[0]=o=>e.transferencia.usuario_envia_info=o),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):v("",!0),e.transferencia.es_devolucion?v("",!0):(c(),m("div",Ba,[a[12]||(a[12]=s("label",{class:"q-mb-sm block"},"Empleado Receptor",-1)),n(g,{modelValue:e.transferencia.usuario_recibe_info,"onUpdate:modelValue":a[1]||(a[1]=o=>e.transferencia.usuario_recibe_info=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])),s("div",xa,[a[13]||(a[13]=s("label",{class:"q-mb-sm block"},"Monto:",-1)),n(g,{modelValue:e.transferencia.monto,"onUpdate:modelValue":a[2]||(a[2]=o=>e.transferencia.monto=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])]),s("div",Pa,[a[14]||(a[14]=s("label",{class:"q-mb-sm block"},"Cuenta:",-1)),n(g,{modelValue:e.transferencia.cuenta,"onUpdate:modelValue":a[3]||(a[3]=o=>e.transferencia.cuenta=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},{error:f(()=>[(c(!0),m(ua,null,ca(e.v$.cuenta.$errors,o=>(c(),m("div",{key:o.$uid},[s("div",Qa,N(o.$message),1)]))),128))]),_:1},8,["modelValue"])]),e.transferencia.es_devolucion?v("",!0):(c(),m("div",Ra,[a[15]||(a[15]=s("label",{class:"q-mb-sm block"},"Tareas",-1)),n(g,{modelValue:e.transferencia.tarea_info,"onUpdate:modelValue":a[4]||(a[4]=o=>e.transferencia.tarea_info=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])),s("div",Ia,[a[16]||(a[16]=s("label",{class:"q-mb-sm block"},"Comprobante ",-1)),n(d,{imagen:e.transferencia.comprobante,disable:"","onUpdate:modelValue":a[5]||(a[5]=o=>e.transferencia.comprobante=o)},null,8,["imagen"])]),s("div",La,[n(da,{class:"q-mt-lg q-pt-md",modelValue:e.transferencia.es_devolucion,"onUpdate:modelValue":a[6]||(a[6]=o=>e.transferencia.es_devolucion=o),label:"\xBFEs devolucion?",disable:"",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e.usuario.id==e.transferencia.usuario_recibe&&e.transferencia.estado_info=="POR APROBAR"?(c(),m("div",Oa,[n(A,{color:"positive",onClick:a[8]||(a[8]=o=>e.actualizarTransferencia(e.transferencia,"aprobar"))},{default:f(()=>[n(k,{name:"bi-check-circle",size:"xs"}),a[17]||(a[17]=z(" Aceptar "))]),_:1}),n(A,{color:"negative",onClick:a[9]||(a[9]=o=>e.actualizarTransferencia(e.transferencia,"rechazar"))},{default:f(()=>[n(k,{name:"bi-x-circle",size:"xs"}),a[18]||(a[18]=z(" Rechazar "))]),_:1})])):v("",!0),e.usuario.id==e.transferencia.usuario_recibe&&e.transferencia.estado_info=="APROBADO"?(c(),m("div",Ua,[n(A,{color:"negative",onClick:a[10]||(a[10]=o=>e.actualizarTransferencia(e.transferencia,"anular"))},{default:f(()=>[n(k,{name:"bi-x-circle",size:"xs"}),a[19]||(a[19]=z(" Anular "))]),_:1})])):v("",!0)]),_:1},8,["mixin","configuracionColumnas"])}var Ga=D($a,[["render",Fa]]);class Da{constructor(){i(this,"VisualizarTransferenciaPage");this.VisualizarTransferenciaPage=ma(new za("VisualizarTransferencia",Ga))}}class Ha extends Ea{constructor(){super(new Da)}}class L extends O{constructor(){super(T.autorizaciones_transferencia)}}var ja=U({name:"AutorizarGastoPage",components:{EssentialTableTabs:ba,ModalEntidad:Ta},setup(){const e=new L,a=M("3"),r=new j(va,e),{listado:t}=r.useReferencias(),p=G(),u=K();F().setQuasar($()),ga().setQuasar($());const d=new L;async function l(b){const E=new J;E.activar();const{result:C}=await d.listar({estado:b});t.value=C,a.value=b,E.desactivar()}l(R.PENDIENTE);const o=new Ha,_={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:({entidad:b})=>{u.id_transferencia=b.id,o.abrirModalEntidad("VisualizarTransferenciaPage")}};async function w(){await l(R.PENDIENTE)}return{configuracionColumnasAutorizarTransferencia:ya,listado:t,tabAutorizarTransferenciaSaldo:fa,botonVerModalTransferencia:_,accionesTabla:pa,filtrarAutorizacionesTransferencia:l,guardado:w,authenticationStore:p,modales:o}}});const Ja={class:"text-center q-pb-md"},Ka={class:"q-mb-md"},Wa={key:0,class:"q-mb-md"};function Xa(e,a,r,t,p,u){const d=S("essential-table-tabs"),l=S("modal-entidad");return c(),H(sa,{padding:!e.$q.screen.xs},{default:f(()=>{var o;return[s("div",Ja,[s("div",Ka,[a[0]||(a[0]=z(" Bienvenido, ")),s("strong",null,N(e.authenticationStore.nombreUsuario),1)]),(o=e.authenticationStore.user)!=null&&o.grupo?(c(),m("div",Wa,[a[1]||(a[1]=z(" Grupo, ")),s("strong",null,N(e.authenticationStore.user.grupo),1)])):v("",!0)]),n(d,{configuracionColumnas:[...e.configuracionColumnasAutorizarTransferencia,e.accionesTabla],datos:e.listado,accion1:e.botonVerModalTransferencia,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!1,"mostrar-botones":!1,"tab-options":e.tabAutorizarTransferenciaSaldo,onTabSeleccionado:e.filtrarAutorizacionesTransferencia,"tab-defecto":"3"},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"]),n(l,{comportamiento:e.modales,persistente:!1,mostrarListado:!1,onGuardado:e.guardado},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var Ue=D(ja,[["render",Xa]]);export{Ue as default};

import{Q as p}from"./QSelect.6ce302d7.js";import{d as E,E as w,m as k,u as $,c as x,e as g,q,A as F,bE as I,s as S,_ as R,v as U,P as D,F as r,z as s,bb as L,y as t,L as A,B as O,O as T,J as n}from"./index.6449c167.js";import"./QPopupProxy.72ff1d6d.js";import{E as j,c as z}from"./EssentialTable.00c17e97.js";import{Q as M}from"./QPage.5d173a8a.js";import{Q as G,a as H}from"./QLayout.418abf9d.js";import{a as J,b as K,u as W,S as X,w as Y,B as C}from"./utils.521b98f3.js";import{M as Z}from"./ModalEntidad.168b465e.js";import{E as ee}from"./Empleado.20234ba0.js";import{P as oe}from"./PeriodoController.537f75e0.js";import{C as ae}from"./ContenedorSimpleMixin.09c9bed5.js";import{u as te}from"./filtrosListadosGenerales.c3aa2da3.js";import{o as Q}from"./recursosHumanos.utils.f01cf672.js";import"./QChip.95469f73.js";import"./QItemSection.9a955ec6.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./QScrollObserver.b4b0444d.js";import"./QResizeObserver.9af84680.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./entidadAuditable.75a46700.js";var se=E({components:{EssentialTable:j,ModalEntidad:Z},setup(){const a=new ae(ee,new w),{listadosAuxiliares:o}=a.useReferencias(),{obtenerListados:m,cargarVista:u}=a.useComportamiento(),{notificarError:f,notificarAdvertencia:h}=J();K().setQuasar(k()),W().setQuasar(k());const e=new X,B=$(),_=x([]),v=x([]),l=g({empleado:null,tipo:null,fecha_inicio:"",fecha_fin:"",fecha_corte:"",solicitante:null,periodo:null,sucursal:null,motivo:null,devolucion:null,todos:!1,tarea:null,transferencia:null,accion:""}),{empleados:V,filtrarEmpleados:N}=te(o);u(async()=>{await m({periodos:{controller:new oe,params:{activo:1}},empleados:{controller:new w,params:{estado:1}}}),v.value=o.periodos,V.value=o.empleados});async function y(P){try{e.activar();const c=F.getInstance(),d=I.URL_BASE+"/"+c.getEndpoint(S.vacaciones)+"/reporte",b="Reporte "+Q.filter(i=>i.value==l.tipo)[0].label;switch(P){case"excel":l.accion="excel",await C(d,"POST","blob","xlsx",b,l);break;case"pdf":l.accion="pdf",e.activar(),await C(d,"POST","blob","pdf",b,l),e.desactivar();break;default:l.accion="";const i=await c.post(d,l);i.data.results&&(_.value=i.data.results,i.data.results.length<1&&h("No se obtuvieron resultados"))}e.desactivar()}catch(c){console.log(c),f("Error al obtener reporte")}finally{e.desactivar()}}return{mixin:a,reporte:l,store:B,maskFecha:q,listado:_,periodos:v,empleados:V,filtrarEmpleados:N,opcionesReporteVacaciones:Q,buscarReporte:y,ordenarLista:Y}}});const le={class:"row q-col-gutter-sm q-pa-sm q-py-md"},re={class:"col-12 col-md-3"},ie={class:"col-12 col-md-3"},ne={class:"col-12 col-md-3"},ce={class:"col-12 col-md-3 q-mb-xl"};const de={class:"col-12 col-md-12 q-mt-md"},pe={class:"text-center"};function me(a,o,m,u,f,h){return U(),D(H,null,{default:r(()=>[s(G,null,{default:r(()=>[s(M,{padding:""},{default:r(()=>[s(L,{class:"rounded-card custom-shadow"},{default:r(()=>[t("div",le,[t("div",re,[o[15]||(o[15]=t("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),s(p,{modelValue:a.reporte.tipo,"onUpdate:modelValue":o[0]||(o[0]=e=>a.reporte.tipo=e),options:a.opcionesReporteVacaciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.label,"option-value":e=>e.value,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ie,[o[16]||(o[16]=t("label",{class:"q-mb-sm block"},"Per\xEDodo",-1)),s(p,{modelValue:a.reporte.periodo,"onUpdate:modelValue":o[1]||(o[1]=e=>a.reporte.periodo=e),options:a.periodos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ne,[o[17]||(o[17]=t("label",{class:"q-mb-sm block"},"Empleado",-1)),s(p,{modelValue:a.reporte.empleado,"onUpdate:modelValue":o[2]||(o[2]=e=>a.reporte.empleado=e),options:a.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"","use-input":"","input-debounce":"0",outlined:"",clearable:"",onFilter:a.filtrarEmpleados,onPopupShow:o[3]||(o[3]=e=>a.ordenarLista(a.empleados,"apellidos")),"option-label":e=>e.apellidos+" "+e.nombres,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])]),t("div",ce,[s(A,{class:"q-mt-lg q-pt-md",modelValue:a.reporte.todos,"onUpdate:modelValue":[o[4]||(o[4]=e=>a.reporte.todos=e),o[5]||(o[5]=()=>a.reporte.empleado=a.reporte.todos?a.reporte.empleado=null:a.reporte.empleado=a.store.user.id)],label:"Todos los empleados",outlined:"",dense:""},null,8,["modelValue"])]),n("",!0),n("",!0),n("",!0),t("div",de,[t("div",pe,[s(z,{push:""},{default:r(()=>[n("",!0),s(T,{color:"positive",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[13]||(o[13]=e=>a.buscarReporte("excel"))},{default:r(()=>[s(O,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),o[22]||(o[22]=t("span",null,"Excel",-1))]),_:1}),n("",!0)]),_:1})])])])]),_:1})]),_:1})]),_:1})]),_:1})}var Ye=R(se,[["render",me]]);export{Ye as default};

import{a as Y,Q as M}from"./QTabs.3c726b04.js";import{Q as f,a as k}from"./QSelect.a8f2bfb2.js";import{Q as T,a as w}from"./QItemSection.c6f2640c.js";import{c as Z,be as x,p as L,u as h,U as ee,e as oe,i as ae,f as E,w as te,g as se,v as ie,x as re,y as b,S as le,H as s,B as i,G as l,D as t,bf as ne,a6 as de,O as pe,P as ue,M as C,R as n,F as m,z as V,L as q,bh as me,k as ce,b3 as fe,K as be}from"./index.976e8f3c.js";import{a as v}from"./QToolbar.cff7174f.js";import{a as ve,Q as S}from"./QTabPanels.1c8c4baa.js";import{Q as ye}from"./QPage.ed5d79ca.js";import{u as ge,c as Pe}from"./UseMaterialesTarea.58fbff36.js";import{a as ke,F as Te,u as we}from"./FiltroMiBodegaEmpleado.020f4a2d.js";import{d as y}from"./tareas.utils.309e0dff.js";import{E as Ee}from"./EssentialTable.d8e6954a.js";import{F as Ce,u as Ve}from"./FiltroMiBodegaProyecto.782f312c.js";import{u as qe}from"./filtrosListadosGenerales.31e9eb2c.js";import{F as Me}from"./FiltroMiBodega.5c2bf6ef.js";import{u as Se}from"./utils.30e08aa2.js";import"./QResizeObserver.6ec10d95.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./listadoMaterialesDevolucion.5ce4073a.js";import"./TareaController.c7f2748b.js";import"./ClienteMaterialEmpleadoController.fcdf149e.js";import"./entidadAuditable.75a46700.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./i18n-validators.06eef631.js";import"./index.95f5a0db.js";import"./EtapaController.9ea539ef.js";import"./ProyectoController.29ab1934.js";var Qe=Z({components:{EssentialTable:Ee},setup(){const a=ke();x().setQuasar(L()),Se().setQuasar(L());const o=h(),{notificarAdvertencia:Q}=ee(),c=oe();ae(()=>{c.value=y.personal,P.value=e.proyectos});const p=E(new Me),r=E(new Ce),g=E(new Te),e=E({productos:[],productosTarea:[],productosProyectosEtapas:[],productosStock:[],clientesMaterialesTarea:[],clientesMaterialesEmpleado:[],tareas:[],proyectos:[],etapas:[]}),{consultarProductosTarea:U,consultarClientesMaterialesTarea:u,consultarTareasClienteFinalMantenimiento:_}=ge(p,e),{consultarProductosEmpleado:A,consultarClientesMaterialesEmpleado:F}=we(g,e),{consultarProyectos:$,consultarEtapas:z,consultarProductosProyecto:N}=Ve(r,e);function R(d){switch(d){case"proyectos":$().then(()=>P.value=e.proyectos);break;case"clientes":r.etapa_id?u({proyecto_id:r.proyecto_id,etapa_id:r.etapa_id,filtrar_por_etapa:!0}):u({proyecto_id:r.proyecto_id,etapa_id:r.etapa_id,filtrar_por_proyecto:!0});break}}function j(d){switch(d){case"tareas":_(o.user.id);break;case"clientes":u({tarea_id:p.tarea_id,filtrar_por_tarea:1});break}}function D(d){switch(d){case"clientes":F();break}}function I(){e.productos=[],p.cliente_id=void 0,e.tareas.find(d=>d.id===p.tarea_id),u({tarea_id:p.tarea_id,filtrar_por_tarea:1})}async function O(){r.proyecto_id?(await z(r.proyecto_id),B.value=e.etapas,e.proyectos.find(d=>d.id===r.proyecto_id),r.cliente_id=void 0,a.codigoTarea=null):e.etapas=[],e.productosProyectosEtapas=[],e.productos=[],r.etapa_id=null,p.cliente_id=null,e.etapas.length||u({proyecto_id:r.proyecto_id,filtrar_por_proyecto:1})}function G(){u({proyecto_id:r.proyecto_id,etapa_id:r.etapa_id,filtrar_por_etapa:1})}function H(){if(e.etapas.length&&!r.etapa_id)return Q("Debe seleccionar una etapa");N()}u({filtrar_por_tarea:!0}),F(),_(o.user.id),$().then(()=>P.value=e.proyectos),te(c,()=>{switch(c.value){case y.paraClienteFinal:e.productos=e.productosTarea,a.listadoMateriales=e.productosTarea;break;case y.paraProyecto:e.productos=e.productosProyectosEtapas,a.listadoMateriales=e.productosProyectosEtapas;break;case"personal":e.productos=e.productosStock,a.listadoMateriales=e.productosStock;break}});const{tareas:K,filtrarTareas:J,proyectos:P,filtrarProyectos:W,etapas:B,filtrarEtapas:X}=qe(e);return{tab:c,configuracionColumnasMaterialEmpleadoTarea:Pe,listadosAuxiliares:e,filtro:p,filtroProyecto:r,filtroEmpleado:g,destinosTareas:y,transferenciaProductoEmpleadoStore:a,consultarEtapas:z,tareas:K,proyectos:P,etapas:B,filtrarTareas:J,filtrarProyectos:W,filtrarEtapas:X,seleccionarTarea:I,seleccionarProyecto:O,seleccionarEtapa:G,consultarProductosTarea:U,consultarProductosProyectoEtapa:H,consultarProductosEmpleado:A,refrescarListadosProyectos:R,refrescarListadosTareas:j,refrescarListadosEmpleado:D,mostrarBtnTransferirStockPersonal:se(()=>c.value===y.paraClienteFinal)}}});const _e={class:"row q-col-gutter-sm q-pa-sm q-mb-md"},Fe={class:"col-12 col-md-6"},$e={key:0,class:"col-12 col-md-6"},ze={class:"row q-mb-lg"},Be={class:"col-12"},Le={class:"row q-col-gutter-sm q-pa-sm q-mb-md"},Ue={class:"col-12 col-md-4"},Ae={class:"col-12 col-md-4"},Ne={key:0,class:"col-12 col-md-4"},Re={key:1,class:"col-12 col-md-4"},je={class:"row q-mb-lg"},De={class:"col-12"},Ie={class:"row justify-center q-gutter-sm q-mb-md"},Oe={class:"col-12"},Ge={class:"col-12"},He={key:0,class:"row q-pt-md"},Ke={class:"col-12 row justify-center q-gutter-sm q-mb-md"},Je={class:"col-12 q-px-md q-mb-md"};function We(a,o,Q,c,p,r){const g=re("essential-table");return b(),le(ye,{padding:""},{default:s(()=>[o[40]||(o[40]=i("div",{class:"column q-mb-md text-center"},[i("div",{class:"q-mb-md text-primary"},"Mi bodega"),i("small",null,[l("Conoce el material que tienes a tu disposici\xF3n para utilizar en tus trabajos. "),i("br"),l(" El material puede ser asignado para la tarea o a tu stock personal.")])],-1)),t(ne,{class:"rounded-card custom-shadow"},{default:s(()=>[t(Y,{modelValue:a.tab,"onUpdate:modelValue":o[0]||(o[0]=e=>a.tab=e),class:de(["text-primary",{"bg-grey-3":!a.$q.dark.isActive}]),"active-color":"primary",align:"justify","no-caps":"","inline-label":""},{default:s(()=>[t(M,{name:a.destinosTareas.personal,label:"Stock personal",icon:"bi-person"},null,8,["name"]),t(M,{name:a.destinosTareas.paraClienteFinal,label:"Material para cliente final y mantenimiento",icon:"bi-pin-angle"},null,8,["name"]),t(M,{name:a.destinosTareas.paraProyecto,label:"Material para proyectos",icon:"bi-diagram-2"},null,8,["name"])]),_:1},8,["modelValue","class"]),t(ve,{modelValue:a.tab,"onUpdate:modelValue":o[19]||(o[19]=e=>a.tab=e),animated:""},{default:s(()=>[t(S,{name:a.destinosTareas.paraClienteFinal},{default:s(()=>[i("div",_e,[i("div",Fe,[o[21]||(o[21]=i("label",{class:"q-mb-sm block"},"Seleccione una tarea",-1)),t(f,{modelValue:a.filtro.tarea_id,"onUpdate:modelValue":[o[2]||(o[2]=e=>a.filtro.tarea_id=e),o[3]||(o[3]=e=>a.seleccionarTarea())],options:a.tareas,onFilter:a.filtrarTareas,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.codigo_tarea+" - "+e.titulo,"option-value":e=>e.id,"emit-value":"","map-options":""},{option:s(e=>[t(T,pe(ue(e.itemProps)),{default:s(()=>[t(w,null,{default:s(()=>[t(k,null,{default:s(()=>[l(C(e.opt.codigo_tarea),1)]),_:2},1024),t(k,{caption:""},{default:s(()=>[l(C(e.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[1]||(o[1]=e=>a.refrescarListadosTareas("tareas"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[20]||(o[20]=[l("Recargar tareas")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),a.filtro.tarea_id?(b(),V("div",$e,[o[23]||(o[23]=i("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material",-1)),t(f,{modelValue:a.filtro.cliente_id,"onUpdate:modelValue":o[5]||(o[5]=e=>a.filtro.cliente_id=e),options:a.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.razon_social,"option-value":e=>e.cliente_id,"emit-value":"","map-options":""},{after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[4]||(o[4]=e=>a.refrescarListadosTareas("clientes"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[22]||(o[22]=[l("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):q("",!0)]),i("div",ze,[i("div",Be,[t(n,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:o[6]||(o[6]=e=>a.consultarProductosTarea())},{default:s(()=>o[24]||(o[24]=[l("Consultar")])),_:1})])])]),_:1},8,["name"]),t(S,{name:a.destinosTareas.paraProyecto},{default:s(()=>[i("div",Le,[i("div",Ue,[o[27]||(o[27]=i("label",{class:"q-mb-sm block"},"Todos los proyectos asignados",-1)),t(f,{modelValue:a.filtroProyecto.proyecto_id,"onUpdate:modelValue":[o[8]||(o[8]=e=>a.filtroProyecto.proyecto_id=e),o[9]||(o[9]=e=>a.seleccionarProyecto())],options:a.proyectos,onFilter:a.filtrarProyectos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",clearable:""},{option:s(e=>[t(T,me(e.itemProps,{class:"q-my-sm"}),{default:s(()=>[t(w,null,{default:s(()=>[t(k,{class:"text-bold text-primary"},{default:s(()=>[l(C(e.opt.codigo_proyecto),1)]),_:2},1024),t(k,{caption:""},{default:s(()=>[l(C(e.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[7]||(o[7]=e=>a.refrescarListadosProyectos("proyectos"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[25]||(o[25]=[l("Recargar proyectos")])),_:1})]),_:1})]),"no-option":s(()=>[t(T,null,{default:s(()=>[t(w,{class:"text-grey"},{default:s(()=>o[26]||(o[26]=[l(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),ce(i("div",Ae,[o[29]||(o[29]=i("label",{class:"q-mb-sm block"},"Seleccione una etapa",-1)),t(f,{modelValue:a.filtroProyecto.etapa_id,"onUpdate:modelValue":[o[10]||(o[10]=e=>a.filtroProyecto.etapa_id=e),o[11]||(o[11]=e=>a.seleccionarEtapa())],options:a.etapas,onFilter:a.filtrarEtapas,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{"no-option":s(()=>[t(T,null,{default:s(()=>[t(w,{class:"text-grey"},{default:s(()=>o[28]||(o[28]=[l(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])],512),[[fe,a.filtroProyecto.proyecto_id&&a.etapas.length]]),a.filtroProyecto.proyecto_id?(b(),V("div",Ne,[o[31]||(o[31]=i("label",{class:"q-mb-sm block"},"Cliente propietario del material de proyecto/etapa",-1)),t(f,{modelValue:a.filtroProyecto.cliente_id,"onUpdate:modelValue":o[13]||(o[13]=e=>a.filtroProyecto.cliente_id=e),options:a.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.razon_social,"option-value":e=>e.cliente_id,"emit-value":"","map-options":""},{after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[12]||(o[12]=e=>a.refrescarListadosProyectos("clientes"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[30]||(o[30]=[l("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):q("",!0),a.transferenciaProductoEmpleadoStore.codigoTarea?(b(),V("div",Re,[o[32]||(o[32]=i("label",{class:"q-mb-sm block"},"Tarea",-1)),t(be,{modelValue:a.transferenciaProductoEmpleadoStore.codigoTarea,"onUpdate:modelValue":o[14]||(o[14]=e=>a.transferenciaProductoEmpleadoStore.codigoTarea=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):q("",!0)]),i("div",je,[i("div",De,[t(n,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:o[15]||(o[15]=e=>a.consultarProductosProyectoEtapa())},{default:s(()=>o[33]||(o[33]=[l("Consultar")])),_:1})])])]),_:1},8,["name"]),t(S,{name:a.destinosTareas.personal},{default:s(()=>[i("div",Ie,[i("div",Oe,[o[35]||(o[35]=i("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material",-1)),t(f,{modelValue:a.filtroEmpleado.cliente_id,"onUpdate:modelValue":o[17]||(o[17]=e=>a.filtroEmpleado.cliente_id=e),options:a.listadosAuxiliares.clientesMaterialesEmpleado,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.razon_social,"option-value":e=>e.cliente_id,"emit-value":"","map-options":""},{after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[16]||(o[16]=e=>a.refrescarListadosEmpleado("clientes"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[34]||(o[34]=[l("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),i("div",Ge,[t(n,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:o[18]||(o[18]=e=>a.consultarProductosEmpleado())},{default:s(()=>o[36]||(o[36]=[l("Consultar")])),_:1})])])]),_:1},8,["name"])]),_:1},8,["modelValue"]),a.listadosAuxiliares.productos.length?(b(),V("div",He,[o[39]||(o[39]=i("div",{class:"col-12 text-center"},[i("label",{class:"q-mb-sm block text-bold"},"Opciones de devoluci\xF3n de material sobrante de la tarea")],-1)),i("div",Ke,[t(n,{class:"bg-grey-4 text-primary","no-caps":"",unelevated:"",rounded:"",to:{name:"devoluciones"}},{default:s(()=>[t(m,{name:"bi-building",size:"xs",class:"q-pr-sm"}),o[37]||(o[37]=i("span",null,"Devolver a bodega matriz",-1))]),_:1}),t(n,{"no-caps":"",class:"bg-grey-4 text-primary",unelevated:"",rounded:"",to:{name:"transferencia_producto_empleado"}},{default:s(()=>[t(m,{name:"bi-box-arrow-up-right",size:"xs",class:"q-pr-sm"}),o[38]||(o[38]=i("span",null,"Transferir a otro empleado",-1))]),_:1})]),i("div",Je,[t(g,{titulo:"Productos",configuracionColumnas:a.configuracionColumnasMaterialEmpleadoTarea,datos:a.listadosAuxiliares.productos,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"alto-fijo":!1,"ajustar-celdas":!0,"mostrar-exportar":!0},null,8,["configuracionColumnas","datos"])])])):q("",!0)]),_:1})]),_:1})}var Uo=ie(Qe,[["render",We]]);export{Uo as default};

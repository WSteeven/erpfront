var D=Object.defineProperty;var M=(o,a,s)=>a in o?D(o,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[a]=s;var n=(o,a,s)=>(M(o,typeof a!="symbol"?a+"":a,s),s);import{a as $}from"./QToolbar.8dbe891b.js";import{bw as R,s as k,d as U,m as P,c as Y,f as G,bx as V,p as H,A as L,bE as j,_ as J,t as E,v as r,P as z,F as u,z as i,a4 as K,y as t,x as d,D as b,O,B as W,J as m,I as f,a6 as X,K as Z}from"./index.6449c167.js";import{Q as x}from"./QChip.95469f73.js";import{Q as oo}from"./QForm.ca56f146.js";import{u as ao}from"./index.490dde02.js";import{T as eo}from"./TabLayout.0bce4313.js";import{G as lo}from"./GestorDocumentos.59a805e5.js";import{E as io}from"./EssentialPopupEditableTable.e294b26f.js";import{E as so}from"./entidadAuditable.75a46700.js";import{C as ro}from"./ContenedorSimpleMixin.09c9bed5.js";import{a as to,b as no,u as mo,H as uo,B as co}from"./utils.521b98f3.js";import"./position-engine.70d0a89f.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QSelect.6ce302d7.js";import"./QItemSection.9a955ec6.js";import"./format.8ac60962.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTable.00c17e97.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./EssentialTablePagination.d5c1010a.js";import"./QUploader.cca1b7bd.js";import"./QCircularProgress.b24a7ee9.js";const c=[{name:"id",field:"id",label:"id",align:"left",visible:!1,sortable:!0},{name:"razon_social",field:"razon_social",label:"Raz\xF3n Social",align:"left",sortable:!0},{name:"num_documento",field:"num_documento",label:"# Doc.",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n.",align:"left",sortable:!0},{name:"fecha_emision",field:"fecha_emision",label:"F. Emisi\xF3n",align:"left",sortable:!0},{name:"fecha_vencimiento",field:"fecha_vencimiento",label:"F. Vencimiento",align:"left",sortable:!0},{name:"plazo",field:"plazo",label:"Plazo",align:"left",sortable:!0},{name:"total",field:"total",label:"Total",align:"left",sortable:!0},{name:"valor_pagar",field:"valor_pagar",label:"V. Pagar",align:"left",sortable:!0}],po=[{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"realizador",field:"realizador",label:"Subido Por",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0},{name:"cant_elementos",field:"cant_elementos",label:"Cant. Facturas",align:"left",sortable:!0}];class bo extends so{constructor(){super();n(this,"archivo");n(this,"nombre");n(this,"realizador");n(this,"estado");n(this,"cant_elementos");n(this,"listado");this.archivo=null,this.nombre=null,this.realizador=null,this.estado=null,this.cant_elementos=null,this.listado=[]}}class fo extends R{constructor(){super(k.pagos_proveedores)}}var go=U({components:{TabLayout:eo,GestorDocumentos:lo,EssentialPopupEditableTable:io},setup(){const o=new ro(bo,new fo),{entidad:a,accion:s,disabled:y,listado:w}=o.useReferencias(),{setValidador:F,listar:g}=o.useComportamiento(),{confirmar:v}=to(),{onConsultado:C}=o.useHooks();no().setQuasar(P()),mo().setQuasar(P());const l=Y(),S=G(()=>a.listado.reduce((e,p)=>e+parseFloat(p.valor_pagar),0).toFixed(2)),h=ao({},a);F(h.value),C(()=>{s.value==V.editar?(c.find(e=>e.field==="valor_pagar").visible=!0,c.find(e=>e.field==="valor_pagar").editable=!0,c.find(e=>e.field==="valor_pagar").type="number",c.find(e=>e.field==="valor_pagar").hint="Ingresa el valor a pagar"):c.find(e=>e.field==="valor_pagar").editable=!1});const Q={titulo:"Eliminar",icono:"bi-x",color:"negative",accion:({entidad:e,posicion:p})=>{B({posicion:p})},visible:()=>s.value==V.editar},q={titulo:"Cash",icono:"bi-file-earmark-excel-fill",color:"positive",accion:async({entidad:e})=>{await A(e)}};async function A(e){const p="pago_a_proveedores_"+uo(new Date,"D-MM-YYYY"),I=L.getInstance(),N=j.URL_BASE+"/"+I.getEndpoint(k.pagos_proveedores)+"/cash/"+e.id;await co(N,"GET","blob","xlsx",p,null)}function B({posicion:e}){v("\xBFEst\xE1 seguro de continuar?",()=>a.listado.splice(e,1))}async function T(){await l.value.subir(),console.log(l.value),g()}function _(e){e.valor_pagar=Number(e.valor_pagar).toFixed(2),e.total<e.valor_pagar&&(e.valor_pagar=e.total)}return{pago:a,mixin:o,accion:s,acciones:V,disabled:y,configuracionColumnas:po,columnasItems:c,accionesTabla:H,refArchivo:l,endpoint:k.pagos_proveedores,btnEliminarFila:Q,btnCash:q,subirArchivos:T,calcularValores:_,total:S}}});const vo={class:"row q-col-gutter-sm q-py-md"},Co={key:0,class:"col-12 col-md-12"},Vo={class:"q-mb-sm block"},Eo={key:1,class:"col-12 col-md-3"},ko={key:2,class:"col-12 col-md-3"},yo={key:3,class:"col-12 col-md-3"},Fo={key:4,class:"col-12 col-md-3"},Po={key:5,class:"col-12 col-md-3 col-sm-6"},zo={key:6,class:"col-12"};function wo(o,a,s,y,w,F){const g=E("gestor-documentos"),v=E("essential-popup-editable-table"),C=E("tab-layout");return r(),z(C,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Pago a Proveedores",mostrarButtonSubmits:o.accion!=o.acciones.nuevo,accion1:o.btnCash},{formulario:u(()=>[i(oo,{onSubmit:a[5]||(a[5]=K(()=>{},["prevent"]))},{default:u(()=>[t("div",vo,[o.accion==o.acciones.nuevo?(r(),d("div",Co,[t("label",Vo,[a[7]||(a[7]=b("Reporte de contifico ")),a[8]||(a[8]=t("i",{class:"bi bi-info-circle"},null,-1)),i($,{class:"bg-light-blue-7"},{default:u(()=>a[6]||(a[6]=[b("Suba el reporte de cartera por pagar emitida por contifico")])),_:1})]),i(g,{ref:"refArchivo",mixin:o.mixin,endpoint:o.endpoint,disable:o.disabled,"permitir-eliminar":!1,"mostrar-listado":!1,"listar-al-guardar":!1,esMultiple:!1},{"boton-subir":u(()=>[(r(),z(O,{key:0,color:"positive",push:"","no-caps":"",class:"full-width q-mb-lg",onClick:a[0]||(a[0]=l=>o.subirArchivos())},{default:u(()=>[i(W,{name:"bi-upload",class:"q-mr-sm",size:"xs"}),a[9]||(a[9]=b(" Subir archivos seleccionados"))]),_:1}))]),_:1},8,["mixin","endpoint","disable"])])):m("",!0),o.pago.id?(r(),d("div",Eo,[a[10]||(a[10]=t("label",{class:"q-mb-sm block"},"Documento N\xB0",-1)),i(f,{modelValue:o.pago.id,"onUpdate:modelValue":a[1]||(a[1]=l=>o.pago.id=l),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),o.pago.created_at?(r(),d("div",ko,[a[11]||(a[11]=t("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),i(f,{modelValue:o.pago.created_at,"onUpdate:modelValue":a[2]||(a[2]=l=>o.pago.created_at=l),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),o.pago.nombre?(r(),d("div",yo,[a[12]||(a[12]=t("label",{class:"q-mb-sm block"},"Archivo",-1)),i(f,{modelValue:o.pago.nombre,"onUpdate:modelValue":a[3]||(a[3]=l=>o.pago.nombre=l),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):m("",!0),o.pago.realizador?(r(),d("div",Fo,[a[13]||(a[13]=t("label",{class:"q-mb-sm block"},"Subido por",-1)),i(f,{modelValue:o.pago.realizador,"onUpdate:modelValue":a[4]||(a[4]=l=>o.pago.realizador=l),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):m("",!0),o.total>0?(r(),d("div",Po,[a[14]||(a[14]=t("label",{class:"q-mb-sm block"},"Total a Pagar:",-1)),i(x,{square:""},{default:u(()=>[i(X,{icon:"bi-currency-dollar",color:"green","text-color":"white"}),b(" "+Z(o.total),1)]),_:1})])):m("",!0),o.accion!==o.acciones.nuevo?(r(),d("div",zo,[i(v,{ref:"refItems",titulo:"Facturas por pagar",configuracionColumnas:o.accion==o.acciones.consultar?o.columnasItems:[...o.columnasItems,o.accionesTabla],datos:o.pago.listado,separador:"cell",permitirEditarCeldas:o.accion==o.acciones.editar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,altoFijo:"",accion1:o.btnEliminarFila,onFilaModificada:o.calcularValores},null,8,["configuracionColumnas","datos","permitirEditarCeldas","accion1","onFilaModificada"])])):m("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","mostrarButtonSubmits","accion1"])}var ua=J(go,[["render",wo]]);export{ua as default};

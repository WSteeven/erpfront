import{Q as u,a as N}from"./QSelect.a8f2bfb2.js";import{Q as V,a as w}from"./QItemSection.c6f2640c.js";import{c as oo,be as eo,p as F,f as to,U as so,e as I,E as ao,s as io,a3 as lo,q as ro,dG as no,dH as Q,A as po,t as R,bH as O,v as mo,x as D,y as n,S as j,H as a,D as s,B as i,bf as uo,z as d,L as p,G as b,K as y,O as co,P as fo,M as Y,F as v,k as $,R as g}from"./index.976e8f3c.js";import{Q as z,a as G,C as H}from"./QPopupProxy.d8ef7a42.js";import{Q as bo}from"./QBtnGroup.7d0835e4.js";import{Q as vo}from"./QPage.ed5d79ca.js";import{Q as go,a as Vo}from"./QLayout.732b3e1b.js";import{a as wo}from"./VisualizarIngresoPage.6af72adc.js";import{E as yo}from"./EssentialTable.d8e6954a.js";import{C as Co,A as ko,l as So,n as qo}from"./chart.2729d76a.js";import{M as Eo}from"./ModalEntidad.84100166.js";import{u as Io,S as Qo,v as Ro,A as J}from"./utils.30e08aa2.js";import{C as To}from"./ContenedorSimpleMixin.5a0b06ab.js";import{T as Uo}from"./TransaccionIngresoController.853a6f44.js";import{T as Ao}from"./Transaccion.ef293505.js";import{M as Po}from"./MotivoController.e8fd6bfb.js";import{C as ho}from"./ComportamientoModalesGestionarIngreso.9f2d1595.js";import{u as Mo}from"./transaccionEgreso.f9c2a99c.js";import{E as Lo}from"./EmpleadoRolesController.69a9291a.js";import{T as Bo}from"./TareaController.c7f2748b.js";import{u as No}from"./filtrosListadosGenerales.31e9eb2c.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QScrollObserver.cb4b92b2.js";import"./QResizeObserver.6ec10d95.js";import"./QForm.ed6f6690.js";import"./TabLayout.d6dcc414.js";import"./QTabs.3c726b04.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBadge.1ddeabfd.js";import"./EssentialSelectableTable.001f5242.js";import"./transaccion.a1960e3b.js";import"./transferencia.7fc28b7d.js";import"./Transferencia.f2b64659.js";import"./entidadAuditable.75a46700.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./i18n-validators.06eef631.js";import"./index.95f5a0db.js";import"./configuracion_general.ef04b031.js";import"./ConfiguracionController.65de3fc5.js";import"./ComponenteModal.domain.22ea4557.js";import"./DetalleProductoPage.be9ed2e6.js";import"./configuracionColumnasDetallesProductos.d6dcbc18.js";import"./detalle.f9f808a3.js";import"./DetalleProducto.7fc57c43.js";import"./PermisoArma.2f16dcc8.js";import"./index.ed676411.js";import"./TabLayoutFilterTabs2.f1a01a4e.js";import"./EssentialTableTabs.c7e98bba.js";import"./DetalleProductoController.3a7836a2.js";import"./ProductoController.a7c63da7.js";import"./MarcaController.61dfb2d6.js";import"./ModeloController.620336dd.js";import"./TipoFibraController.6f0b3db4.js";import"./HiloController.458738c9.js";import"./NoOptionComponent.ffe820c8.js";import"./DetalleProductoPage.c7daf597.js";import"./LabelAbrirModal.367ecdc1.js";import"./PermisoArmaPage.04f1843c.js";import"./FormularioPermisoArma.227357f5.js";import"./ProductoPage.4c638c07.js";import"./configuracionColumnasProductos.4f52212a.js";import"./CategoriaController.c55d1214.js";import"./UnidadMedidaController.8c5dd68e.js";import"./MarcaPage.a5fa7642.js";import"./ModeloPage.adea4486.js";Co.register(ko,So,qo);var Fo=oo({components:{EssentialTable:yo,ModalEntidad:Eo},setup(){const e=new To(Ao,new Uo),{listadosAuxiliares:o}=e.useReferencias(),{obtenerListados:T,cargarVista:U}=e.useComportamiento();eo().setQuasar(F()),Io().setQuasar(F());const c=new Qo,C=new ho,l=to({tipo:null,fecha_inicio:"",fecha_fin:"",solicitante:null,per_atiende:null,sucursal:null,motivo:null,devolucion:null,tarea:null,transferencia:null,accion:""}),{notificarError:k,notificarAdvertencia:t}=so(),A=Mo(),P=I([]),S=I([]),{empleados:h,filtrarEmpleados:K,motivos:M,filtrarMotivos:W}=No(o),q=I([]);U(async()=>{await T({empleados:new ao,motivos:{controller:new Po,params:{tipo_transaccion_id:1}}}),l.fecha_fin=Ro(io)});function X(){l.solicitante=null,l.sucursal=null,l.per_atiende=null,l.motivo=null,l.devolucion=null,l.tarea=null,l.transferencia=null,l.accion=""}async function Z(m){try{const r=po.getInstance();let f=r.getEndpoint(R.transacciones_ingresos)+"/reportes";const B="reporte_ingresos_bodega";switch(m){case"excel":f=O.URL_BASE+"/"+r.getEndpoint(R.transacciones_ingresos)+"/reportes",l.accion="excel",await J(f,"POST","blob","xlsx",B,l);break;case"pdf":f=O.URL_BASE+"/"+r.getEndpoint(R.transacciones_ingresos)+"/reportes",l.accion="pdf",await J(f,"POST","blob","pdf",B,l);break;default:l.accion="";const E=await r.post(f,l);E.data.results&&(P.value=E.data.results,E.data.results.length<1&&t("No se obtuvieron resultados"))}}catch(r){console.log(r),k("Error al obtener reporte")}}async function _(m){if(X(),m==Q.tarea&&q.value.length==0){c.activar();const{response:r}=await new Bo().listar({campos:"id,codigo_tarea,titulo,cliente_id"});c.desactivar(),q.value=r.data.results}if(m==Q.bodeguero&&S.value.length==0){c.activar();const{response:r}=await new Lo().listar({roles:["BODEGA","ACTIVOS FIJOS"]});c.desactivar(),S.value=r.data.results}}const x={titulo:"",icono:"bi-eye",color:"primary",accion:async({entidad:m})=>{A.idTransaccion=m.id,await A.showPreview(),C.abrirModalEntidad("VisualizarIngresoPage")}},L=JSON.parse(lo.getItem("sucursales").toString());return h.value=o.empleados,M.value=o.motivos,L.unshift({id:0,lugar:"TODAS LAS SUCURSALES"}),{configuracionColumnas:[...wo,ro],reporte:l,sucursales:L,listado:P,empleados:h,bodegueros:S,motivos:M,filtrarMotivos:W,tareas:q,opcionesReportesIngresos:no,tiposReportesIngresos:Q,buscarReporte:Z,consultarListado:_,botonVerTransaccion:x,modales:C,filtrarEmpleados:K}}});const Oo={class:"col"},Do={class:"row q-col-gutter-sm q-pa-sm q-py-md"},jo={class:"col-12 col-md-3"},Yo={key:0,class:"col-12 col-md-3"},$o={key:1,class:"col-12 col-md-3"},zo={key:2,class:"col-12 col-md-3 q-mb-md"},Go={key:3,class:"col-12 col-md-3 q-mb-md"},Ho={key:4,class:"col-12 col-md-3 q-mb-md"},Jo={key:5,class:"col-12 col-md-3 q-mb-md"},Ko={key:6,class:"col-12 col-md-3 q-mb-md"},Wo={class:"col-12 col-md-3"},Xo={class:"row items-center justify-end"},Zo={class:"col-12 col-md-3"},_o={class:"row items-center justify-end"},xo={class:"col-12 col-md-12 q-mt-md"},oe={class:"text-center"},ee={key:0,class:"row q-col-gutter-sm q-pa-sm q-py-md"},te={class:"col-12 col-md-12"};function se(e,o,T,U,c,C){const l=D("essential-table"),k=D("modal-entidad");return n(),j(Vo,null,{default:a(()=>[s(go,null,{default:a(()=>[s(vo,{padding:""},{default:a(()=>[i("div",Oo,[s(uo,{class:"rounded-card custom-shadow"},{default:a(()=>[i("div",Do,[i("div",jo,[o[16]||(o[16]=i("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),s(u,{modelValue:e.reporte.tipo,"onUpdate:modelValue":[o[0]||(o[0]=t=>e.reporte.tipo=t),o[1]||(o[1]=t=>e.consultarListado(e.reporte.tipo))],options:e.opcionesReportesIngresos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":t=>t.label,"option-value":t=>t.value,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),e.reporte.tipo===e.tiposReportesIngresos.solicitante?(n(),d("div",Yo,[o[17]||(o[17]=i("label",{class:"q-mb-sm block"},"Seleccione un empleado",-1)),s(u,{modelValue:e.reporte.solicitante,"onUpdate:modelValue":o[2]||(o[2]=t=>e.reporte.solicitante=t),options:e.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,"option-label":t=>t.nombres+" "+t.apellidos,"option-value":t=>t.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):p("",!0),e.reporte.tipo===e.tiposReportesIngresos.bodeguero?(n(),d("div",$o,[o[18]||(o[18]=i("label",{class:"q-mb-sm block"},"Seleccione un bodeguero",-1)),s(u,{modelValue:e.reporte.per_atiende,"onUpdate:modelValue":o[3]||(o[3]=t=>e.reporte.per_atiende=t),options:e.bodegueros,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":t=>t.nombres+" "+t.apellidos,"option-value":t=>t.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])])):p("",!0),e.reporte.tipo===e.tiposReportesIngresos.motivo?(n(),d("div",zo,[o[20]||(o[20]=i("label",{class:"q-mb-sm block"},"Motivo",-1)),s(u,{modelValue:e.reporte.motivo,"onUpdate:modelValue":o[4]||(o[4]=t=>e.reporte.motivo=t),options:e.motivos,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarMotivos,"option-value":t=>t.id,"option-label":t=>t.nombre,"emit-value":"","map-options":""},{"no-option":a(()=>[s(V,null,{default:a(()=>[s(w,{class:"text-grey"},{default:a(()=>o[19]||(o[19]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-value","option-label"])])):p("",!0),e.reporte.tipo===e.tiposReportesIngresos.devolucion?(n(),d("div",Go,[o[21]||(o[21]=i("label",{class:"q-mb-sm block"},"N\xB0 de devolucion",-1)),s(y,{type:"number",modelValue:e.reporte.devolucion,"onUpdate:modelValue":o[5]||(o[5]=t=>e.reporte.devolucion=t),placeholder:"Obligatorio",outlined:"",dense:""},null,8,["modelValue"])])):p("",!0),e.reporte.tipo===e.tiposReportesIngresos.sucursal?(n(),d("div",Ho,[o[23]||(o[23]=i("label",{class:"q-mb-sm block"},"Bodega",-1)),s(u,{modelValue:e.reporte.sucursal,"onUpdate:modelValue":o[6]||(o[6]=t=>e.reporte.sucursal=t),options:e.sucursales,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","option-value":t=>t.id,"option-label":t=>t.lugar,"emit-value":"","map-options":""},{"no-option":a(()=>[s(V,null,{default:a(()=>[s(w,{class:"text-grey"},{default:a(()=>o[22]||(o[22]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])])):p("",!0),e.reporte.tipo===e.tiposReportesIngresos.tarea?(n(),d("div",Jo,[o[25]||(o[25]=i("label",{class:"q-mb-sm block"},"Tarea",-1)),s(u,{modelValue:e.reporte.tarea,"onUpdate:modelValue":o[7]||(o[7]=t=>e.reporte.tarea=t),options:e.tareas,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","option-value":t=>t.id,"option-label":t=>t.codigo_tarea,"emit-value":"","map-options":""},{option:a(t=>[s(V,co(fo(t.itemProps)),{default:a(()=>[s(w,null,{default:a(()=>[s(N,null,{default:a(()=>[b(Y(t.opt.codigo_tarea),1)]),_:2},1024),s(N,{caption:""},{default:a(()=>[b(Y(t.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[s(V,null,{default:a(()=>[s(w,{class:"text-grey"},{default:a(()=>o[24]||(o[24]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])])):p("",!0),e.reporte.tipo===e.tiposReportesIngresos.transferencia?(n(),d("div",Ko,[o[26]||(o[26]=i("label",{class:"q-mb-sm block"},"N\xB0 de transferencia",-1)),s(y,{type:"number",modelValue:e.reporte.transferencia,"onUpdate:modelValue":o[8]||(o[8]=t=>e.reporte.transferencia=t),placeholder:"Obligatorio",outlined:"",dense:""},null,8,["modelValue"])])):p("",!0),i("div",Wo,[o[27]||(o[27]=i("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),s(y,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":o[10]||(o[10]=t=>e.reporte.fecha_inicio=t),placeholder:"Opcional",outlined:"",dense:""},{append:a(()=>[s(v,{name:"event",class:"cursor-pointer"},{default:a(()=>[s(z,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[s(G,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":o[9]||(o[9]=t=>e.reporte.fecha_inicio=t),mask:"DD-MM-YYYY","today-btn":""},{default:a(()=>[i("div",Xo,[$(s(g,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",Zo,[o[28]||(o[28]=i("label",{class:"q-mb-sm block"},"Fecha fin ",-1)),s(y,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":o[12]||(o[12]=t=>e.reporte.fecha_fin=t),placeholder:"Opcional",outlined:"",dense:""},{append:a(()=>[s(v,{name:"event",class:"cursor-pointer"},{default:a(()=>[s(z,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[s(G,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":o[11]||(o[11]=t=>e.reporte.fecha_fin=t),mask:"DD-MM-YYYY","today-btn":""},{default:a(()=>[i("div",_o,[$(s(g,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",xo,[i("div",oe,[s(bo,{push:""},{default:a(()=>[s(g,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[13]||(o[13]=t=>e.buscarReporte("consulta"))},{default:a(()=>[s(v,{name:"bi-search",size:"xs",class:"q-pr-sm"}),o[29]||(o[29]=i("span",null,"Buscar",-1))]),_:1}),s(g,{color:"positive",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[14]||(o[14]=t=>e.buscarReporte("excel"))},{default:a(()=>[s(v,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),o[30]||(o[30]=i("span",null,"Excel",-1))]),_:1}),s(g,{color:"negative",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[15]||(o[15]=t=>e.buscarReporte("pdf"))},{default:a(()=>[s(v,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),o[31]||(o[31]=i("span",null,"PDF",-1))]),_:1})]),_:1})])])]),e.listado.length?(n(),d("div",ee,[i("div",te,[e.listado.length?(n(),j(l,{key:0,titulo:"Listado de transacciones",configuracionColumnas:e.configuracionColumnas,datos:e.listado,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"permitir-buscar":!0,accion1:e.botonVerTransaccion,ajustarCeldas:!0,"alto-fijo":!0},null,8,["configuracionColumnas","datos","accion1"])):p("",!0)])])):p("",!0)]),_:1})]),s(k,{comportamiento:e.modales,mostrarListado:!1,persistente:!1},null,8,["comportamiento"])]),_:1})]),_:1})]),_:1})}var Ut=mo(Fo,[["render",se]]);export{Ut as default};

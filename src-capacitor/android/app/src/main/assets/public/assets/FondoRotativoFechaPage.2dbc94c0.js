var ro=Object.defineProperty;var no=(o,e,f)=>e in o?ro(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var F=(o,e,f)=>(no(o,typeof e!="symbol"?e+"":e,f),f);import{bw as lo,s as Q,d as uo,m as L,u as fo,c as b,E as po,a0 as S,q as co,a1 as mo,A as vo,d5 as R,bE as U,_ as bo,v as p,P as ho,F as s,z as i,bc as O,y as n,x as c,G as g,H as w,D as C,J as Y,I as B,B as $,j as P,O as y,Q as _o,c8 as Fo,bb as go,K as k}from"./index.6449c167.js";import{Q as q,a as T}from"./QItemSection.9a955ec6.js";import{Q as A}from"./QSelect.6ce302d7.js";import{Q as N,a as j,C as M}from"./QPopupProxy.72ff1d6d.js";import{Q as wo}from"./QPage.5d173a8a.js";import{T as Co}from"./TabLayout.0bce4313.js";import{b as $o,u as yo,B as z,H as I}from"./utils.521b98f3.js";import{u as ko}from"./index.490dde02.js";import{C as Vo}from"./ContenedorSimpleMixin.09c9bed5.js";import{T as Io}from"./TipoFonfoController.f781a23b.js";import{E as Qo}from"./entidadAuditable.75a46700.js";import{a as Do,r as H}from"./i18n-validators.29e2545c.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTable.00c17e97.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./EssentialTablePagination.d5c1010a.js";import"./index.0198dd12.js";class Eo extends lo{constructor(){super(Q.fondo_rotativo_fecha_pdf)}}class Lo extends Qo{constructor(){super();F(this,"usuario");F(this,"fecha_inicio");F(this,"fecha_fin");this.usuario=null,this.fecha_inicio=null,this.fecha_fin=null}}var So=uo({components:{TabLayout:Co},setup(){$o().setQuasar(L()),yo().setQuasar(L());const o=fo(),e=new Vo(Lo,new Eo),{entidad:f,disabled:D,accion:E,listadosAuxiliares:l}=e.useReferencias(),{setValidador:a,obtenerListados:G,cargarVista:J}=e.useComportamiento(),K={usuario:{requiredIfUsuario:Do(()=>o.can("puede.ver.campo.empleado.fondo_rotativo"))},fecha_inicio:{required:H},fecha_fin:{required:H}},V=ko(K,f);a(V.value);const m=b([]),v=b(),h=b([]),X=b("false"),_=b([]);m.value=l.usuarios,J(async()=>{await G({usuarios:{controller:new po,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Io,params:{campos:"id,descripcion"}}}),m.value=l.usuarios,v.value=S.getItem("usuariosInactivos")==null?[]:JSON.parse(S.getItem("usuariosInactivos").toString()),l.usuariosInactivos=v.value,h.value=l.tiposFondos,_.value=l.tiposFondoRotativoFechas});function W(t,r){if(t===""){r(()=>{m.value=l.usuarios});return}r(()=>{const d=t.toLowerCase();m.value=l.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function Z(t,r){if(t===""){r(()=>{v.value=l.usuariosInactivos});return}r(()=>{const d=t.toLowerCase();v.value=l.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function x(t,r){if(t===""){r(()=>{h.value=l.tiposFondos});return}r(()=>{const d=t.toLowerCase();h.value=l.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}function oo(t,r){if(t===""){r(()=>{_.value=l.tiposFondoRotativoFechas});return}r(()=>{const d=t.toLowerCase();_.value=l.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}async function eo(t,r){if(await V.value.$validate()){const d=vo.getInstance(),u="reporte_semanal_gastos_del_"+t.fecha_inicio+"_al_"+t.fecha_fin;switch(r){case R.EXCEL:const io=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_excel);z(io,"POST","blob","xlsx",u,t);break;case R.PDF:const to=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_pdf);z(to,"POST","blob","pdf",u,t);break}}}function ao(t){const r=I(new Date,"YYYY/MM/DD");return t<=r}function so(t){const r=I(new Date,"YYYY/MM/DD"),d=I(f.fecha_inicio!==null?f.fecha_inicio:new Date,"YYYY/MM/DD");return t>=d&&t<=r}return{mixin:e,fondo_rotativo_fecha:f,disabled:D,accion:E,store:o,v$:V,usuarios:m,usuariosInactivos:v,tiposFondos:h,tiposFondoRotativoFechas:_,maskFecha:co,is_inactivo:X,generar_reporte:eo,filtrarUsuarios:W,filtrarUsuariosInactivos:Z,filtrarTiposFondos:x,filtrarTiposFondoRotativoFechas:oo,watchEffect:mo,optionsFechaInicio:ao,optionsFechaFin:so}}});const Ro={key:0,class:"col-12 col-md-3"},Uo={class:"error-msg"},Oo={key:1,class:"col-12 col-md-3"},Yo={class:"error-msg"},Bo={class:"col-6 col-md-3"},Po={class:"row items-center justify-end"},qo={class:"error-msg"},To={class:"col-6 col-md-3"},Ao={class:"row items-center justify-end"},No={class:"error-msg"};function jo(o,e,f,D,E,l){return p(),ho(wo,{class:"flex flex-center"},{default:s(()=>[i(go,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:s(()=>[i(O,null,{default:s(()=>e[8]||(e[8]=[n("div",{class:"row items-center no-wrap"},[n("div",{class:"col"},[n("div",{class:"text-h6"},"Generar Reporte Fondo Rotativo")])],-1)])),_:1}),i(O,null,{default:s(()=>[o.store.can("puede.ver.campo.empleado.fondo_rotativo")&&o.is_inactivo=="false"?(p(),c("div",Ro,[e[10]||(e[10]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(A,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[0]||(e[0]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onBlur:o.v$.usuario.$touch,onFilter:o.filtrarUsuarios,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),c(g,null,w(o.v$.usuario.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",Uo,k(a.$message),1)]))),128))]),"no-option":s(()=>[i(q,null,{default:s(()=>[i(T,{class:"text-grey"},{default:s(()=>e[9]||(e[9]=[C(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onBlur","onFilter","option-value","option-label"])])):Y("",!0),o.is_inactivo=="true"?(p(),c("div",Oo,[e[12]||(e[12]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(A,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[1]||(e[1]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un usuario","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),c(g,null,w(o.v$.usuario.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",Yo,k(a.$message),1)]))),128))]),"no-option":s(()=>[i(q,null,{default:s(()=>[i(T,{class:"text-grey"},{default:s(()=>e[11]||(e[11]=[C(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])):Y("",!0),n("div",Bo,[e[13]||(e[13]=n("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(B,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i($,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(j,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[2]||(e[2]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:s(()=>[n("div",Po,[P(i(y,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),c(g,null,w(o.v$.fecha_inicio.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",qo,k(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),n("div",To,[e[14]||(e[14]=n("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(B,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=a=>o.fondo_rotativo_fecha.fecha_fin=a),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i($,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(j,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[4]||(e[4]=a=>o.fondo_rotativo_fecha.fecha_fin=a),mask:o.maskFecha,"today-btn":"",options:o.optionsFechaFin},{default:s(()=>[n("div",Ao,[P(i(y,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),c(g,null,w(o.v$.fecha_fin.$errors,a=>(p(),c("div",{key:a.$uid},[n("div",No,k(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])])]),_:1}),i(_o),i(Fo,{align:"around"},{default:s(()=>[i(y,{color:"positive",onClick:e[6]||(e[6]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"excel"))},{default:s(()=>[i($,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[15]||(e[15]=C("Excel"))]),_:1}),i(y,{color:"negative",onClick:e[7]||(e[7]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"pdf"))},{default:s(()=>[i($,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[16]||(e[16]=C("PDF"))]),_:1})]),_:1})]),_:1})]),_:1})}var $e=bo(So,[["render",jo]]);export{$e as default};

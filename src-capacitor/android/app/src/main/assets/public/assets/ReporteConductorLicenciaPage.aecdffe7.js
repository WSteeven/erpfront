import{Q as w,a as m}from"./QItemSection.9a955ec6.js";import{Q as E,a as A}from"./QSelect.6ce302d7.js";import{d as F,m as L,u as j,e as U,c as z,A as O,bE as D,s as G,_ as H,t as M,v as r,P as S,F as a,z as s,y as l,bb as J,x as f,D as b,G as K,H as W,K as h,J as c,a7 as I,M as X,N as Y,O as Z,B as ee}from"./index.6449c167.js";import{E as oe,c as te}from"./EssentialTable.00c17e97.js";import{Q as ae}from"./QPage.5d173a8a.js";import{Q as se,a as le}from"./QLayout.418abf9d.js";import{b as ie,u as ne,a as re,S as ce,B as x}from"./utils.521b98f3.js";import{C as ue}from"./ContenedorSimpleMixin.09c9bed5.js";import{C as de}from"./Conductor.978d1863.js";import{C as P}from"./ConductorController.7b773e10.js";import{u as pe}from"./filtrosListadosGenerales.c3aa2da3.js";import{t as me}from"./vehiculos.utils.c31e027d.js";import{a as fe}from"./i18n-validators.29e2545c.js";import{u as be}from"./index.490dde02.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./QPopupProxy.72ff1d6d.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./QScrollObserver.b4b0444d.js";import"./QResizeObserver.9af84680.js";import"./entidadAuditable.75a46700.js";import"./index.0198dd12.js";const ge=[{name:"conductor",field:"conductor",label:"Conductor",align:"left",sortable:!0},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0},{name:"tipo_licencia",field:"tipo_licencia",label:"Tipo Licencia",align:"left",sortable:!0},{name:"inicio_vigencia",field:"inicio_vigencia",label:"Inicio Vigencia",align:"left"},{name:"fin_vigencia",field:"fin_vigencia",label:"Fin Vigencia",align:"left"},{name:"vence",field:"vence",label:"Vencimiento",align:"left"}];var ve=F({components:{EssentialTable:oe},setup(){const t=new ue(de,new P),{listadosAuxiliares:e}=t.useReferencias(),{obtenerListados:V,cargarVista:k}=t.useComportamiento();ie().setQuasar(L()),ne().setQuasar(L());const{notificarError:Q,notificarAdvertencia:B}=re();j();const u=new ce,o=U({conductor:null,tipo_licencia:null,vigencia:null,todos:!1}),i=z([]),{empleados:d,filtrarEmpleados:g}=pe(e);k(async()=>{await V({empleados:new P}),d.value=e.empleados});const $={conductor:{requiredIf:fe(()=>!o.todos)}},q=be($,o);async function R(v,n,C){if(await q.value.$validate())try{u.activar();const p=O.getInstance(),_=D.URL_BASE+"/"+p.getEndpoint(G.reporte_conductor_licencia),N="reporte_conductores";switch(v){case"excel":return n.accion="excel",x(_,"POST","blob","xlsx",N,n),C;case"pdf":return n.accion="pdf",x(_,"POST","blob","pdf",N,n),C;default:n.accion="";const y=await p.post(_,n);return y.data.results?(y.data.results.length<1&&B("No se obtuvieron resultados"),y.data.results):C}}catch(p){console.log(p),Q("Error al obtener el reporte")}finally{u.desactivar()}}async function T(v){i.value=await R(v,o,i.value)}return{reporte:o,v$:q,tiposLicencias:me,configuracionColumnas:ge,listado:i,empleados:d,filtrarEmpleados:g,buscarReporte:T}}});const Ce={class:"col"},_e={class:"row q-col-gutter-sm q-pa-sm q-py-md"},ye={key:0,class:"col-12 col-md-5"},we={class:"error-msg"},he={class:"col-12 col-md-2"},Ve={class:"col-12 col-md-5"},ke={class:"col-12 col-md-12 q-mt-md"},Qe={class:"text-center"},Be={key:0,class:"row q-col-gutter-sm q-pa-sm q-py-md"},$e={class:"col-12 col-md-12"};function qe(t,e,V,k,Q,B){const u=M("essential-table");return r(),S(le,null,{default:a(()=>[s(se,null,{default:a(()=>[s(ae,{padding:""},{default:a(()=>[l("div",Ce,[s(J,{class:"rounded-card custom-shadow"},{default:a(()=>[l("div",_e,[t.reporte.todos?c("",!0):(r(),f("div",ye,[e[7]||(e[7]=l("label",{class:"q-mb-sm block"},"Conductor",-1)),s(E,{modelValue:t.reporte.conductor,"onUpdate:modelValue":e[0]||(e[0]=o=>t.reporte.conductor=o),options:t.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:t.filtrarEmpleados,error:!!t.v$.conductor.$errors.length,"option-value":o=>o.id,"option-label":o=>o.apellidos+" "+o.nombres,"emit-value":"","map-options":""},{"no-option":a(()=>[s(w,null,{default:a(()=>[s(m,{class:"text-grey"},{default:a(()=>e[6]||(e[6]=[b(" No hay resultados ")])),_:1})]),_:1})]),error:a(()=>[(r(!0),f(K,null,W(t.v$.conductor.$errors,o=>(r(),f("div",{key:o.$uid},[l("div",we,h(o.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","error","option-value","option-label"])])),l("div",he,[e[8]||(e[8]=l("label",null,"Todos",-1)),e[9]||(e[9]=b()),e[10]||(e[10]=l("br",null,null,-1)),s(I,{class:"q-mt-sm",label:t.reporte.todos?"SI":"NO",modelValue:t.reporte.todos,"onUpdate:modelValue":e[1]||(e[1]=o=>t.reporte.todos=o),color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear"},null,8,["label","modelValue"])]),l("div",Ve,[e[12]||(e[12]=l("label",{class:"q-mb-sm block"},"Tipo de Licencia",-1)),s(E,{modelValue:t.reporte.tipo_licencia,"onUpdate:modelValue":e[2]||(e[2]=o=>t.reporte.tipo_licencia=o),options:t.tiposLicencias,"transition-show":"jump-up","transition-hide":"jump-down",hint:"Obligatorio","options-dense":"",dense:"",outlined:"","use-chips":"",multiple:"","error-message":"Debes seleccionar un tipo de licencia","option-value":o=>o.value,"option-label":o=>o.label,"emit-value":"","map-options":""},{option:a(({itemProps:o,opt:i,selected:d,toggleOption:g})=>[s(w,X(Y(o)),{default:a(()=>[s(m,null,{default:a(()=>[s(A,null,{default:a(()=>[l("strong",null,h(i.label),1),b(" - "+h(i.caption),1)]),_:2},1024)]),_:2},1024),s(m,{side:""},{default:a(()=>[s(I,{"model-value":d,"onUpdate:modelValue":$=>g(i)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[s(w,null,{default:a(()=>[s(m,{class:"text-grey"},{default:a(()=>e[11]||(e[11]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])]),l("div",ke,[l("div",Qe,[s(te,{push:""},{default:a(()=>[s(Z,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:e[3]||(e[3]=o=>t.buscarReporte("consulta"))},{default:a(()=>[s(ee,{name:"bi-search",size:"xs",class:"q-pr-sm"}),e[13]||(e[13]=l("span",null,"Buscar",-1))]),_:1}),c("",!0),c("",!0)]),_:1})])])]),t.listado!==void 0?(r(),f("div",Be,[l("div",$e,[t.listado.length?(r(),S(u,{key:0,titulo:"Listado de proveedores",configuracionColumnas:t.configuracionColumnas,datos:t.listado,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"permitir-buscar":!0,"alto-fijo":!1,ajustarCeldas:""},null,8,["configuracionColumnas","datos"])):c("",!0)])])):c("",!0)]),_:1})])]),_:1})]),_:1})]),_:1})}var io=H(ve,[["render",qe]]);export{io as default};

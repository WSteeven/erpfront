import{d as E,c as g,f as U,w as N,v as f,x as _,z as s,F as x,B as M,bF as O,j as S,b0 as A,bb as G,y as h,O as V,P as J,K as k,J as q,bc as L,aT as K,G as T,_ as X,t as Y}from"./index.6449c167.js";import{Q as Z}from"./QFile.90d9394a.js";import{Q as W}from"./QImg.fd079679.js";import"./QChip.95469f73.js";import"./format.8ac60962.js";const ee={class:"row q-gutter-sm justify-center closeButton"},te={class:"row q-col-gutter-sm q-mb-md q-ml-md q-mr-md text-grey-4"},oe={class:"col-12 col-md-3 text-h6"},ae={key:0,class:"col-12 col-md-3 text-h6"},ne={key:1,class:"col-12 col-md-3 text-h6"},se={class:"col-12 col-md-3 text-h6"},le={class:"col-12 col-md-3 text-h6"},ie={key:0,class:"block text-center q-py-sm"},re=E({__name:"ImagenComprimidaComponent",props:["modelValue","imagen","disable","file_extensiones","error","alto","hint","texto1","texto2","texto3","texto4","texto5"],emits:["update:modelValue"],setup(o,{emit:c}){const b=o,d=c,m=g(),u=g(),l=U(()=>b.imagen),y=U(()=>{var a;return(a=b.alto)!=null?a:"160px"}),p=g(!1),F=g(0),n=g(1),v=async a=>{if(a!=null){m.value=a.size;const e=new FileReader,t=await I(a);e.readAsDataURL(t),e.onload=()=>d("update:modelValue",e.result),m.value=t.size}else m.value=null};async function I(a){return new Promise(e=>{const t=new FileReader;t.onload=C=>{const r=new Image;r.src=C.target.result,r.onload=()=>{const $=document.createElement("canvas"),P=$.getContext("2d"),j=1600;let D=r.width,Q=r.height;if(r.width>j){const R=j/r.width;D=j,Q=r.height*R}$.width=D,$.height=Q,P.drawImage(r,0,0,D,Q),$.toBlob(R=>{const H=new File([R],a.name,{type:"image/jpeg",lastModified:Date.now()});e(H)},"image/jpeg",.7)}},t.readAsDataURL(a)})}N(l,()=>{l.value||(u.value=null)});function z(){d("update:modelValue",null)}function i(){F.value+=90}function w(){n.value+=.1}function B(){n.value-=.1}return(a,e)=>(f(),_(T,null,[s(Z,{modelValue:u.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>u.value=t),v],dense:"",outlined:"",class:"q-mt-sm",clearable:"",onClear:e[1]||(e[1]=t=>z()),disable:o.disable,accept:".png, .jpg, .jpeg",error:o.error,hint:o.hint},{prepend:x(()=>[s(M,{name:"attach_file"})]),error:x(()=>[O(a.$slots,"error")]),_:3},8,["modelValue","disable","error","hint"]),S(s(W,{src:l.value,width:"100%",height:y.value,fit:"contain"},null,8,["src","height"]),[[A,l.value]]),s(K,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),maximized:""},{default:x(()=>[s(G,{class:"bg-black rounded-card no-border",flat:""},{default:x(()=>[h("div",ee,[s(V,{round:"",push:"",color:"positive",glossy:"",icon:"bi-arrow-clockwise",onClick:e[2]||(e[2]=t=>i())}),s(V,{push:"",dense:"",color:"white",rounded:"",outline:"",icon:"bi-dash",onClick:e[3]||(e[3]=t=>B())}),s(V,{dense:"",push:"",outline:"",rounded:"",color:"white",icon:"bi-plus",onClick:e[4]||(e[4]=t=>w())}),s(V,{round:"",push:"",color:"negative",glossy:"",icon:"bi-x",onClick:e[5]||(e[5]=()=>p.value=!1)})]),o.texto1?(f(),J(L,{key:0},{default:x(()=>[h("div",te,[h("div",oe,k(o.texto1),1),o.texto2?(f(),_("div",ae,k(o.texto2),1)):q("",!0),o.texto3?(f(),_("div",ne,k(o.texto3),1)):q("",!0),h("div",se,k(o.texto4),1),h("div",le,k(o.texto5),1)])]),_:1})):q("",!0),s(L,{class:"rounded-footer text-center q-pa-none scroll-container"},{default:x(()=>[S(s(W,{src:l.value,fit:"contain",width:"100%",height:"100vh","spinner-color":"white","img-style":{transform:"rotate("+F.value+"deg) scale("+n.value+")"}},null,8,["src","img-style"]),[[A,l.value]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l.value?(f(),_("small",ie,[s(V,{outline:"",glossy:"",color:"primary",onClick:e[7]||(e[7]=t=>p.value=!0),label:"Ver en pantalla completa","no-caps":""})])):q("",!0)],64))}});const de=E({components:{ImagenComprimidaComponent:re},emits:["update:modelValue"],setup(o,{emit:c}){const b=g(),d=g(),m=g(),u=U(()=>d),l="160px";N(u,()=>{u.value||(d.value=null)});const y=n=>{if(n!=null){const v=new FileReader;v.readAsDataURL(n),v.onload=()=>c("update:modelValue",v.result),m.value=n.size,p(n)}else m.value=null};async function p(n){return new Promise(v=>{const I=new FileReader;I.onload=z=>{const i=new Image;i.src=z.target.result,i.onload=()=>{const w=document.createElement("canvas"),B=w.getContext("2d"),a=800;let e=i.width,t=i.height;if(i.width>a){const C=a/i.width;e=a,t=i.height*C}w.width=e,w.height=t,B.drawImage(i,0,0,e,t),w.toBlob(C=>{const r=new File([C],n.name,{type:"image/jpeg",lastModified:Date.now()});v(r)},"image/jpeg",.7)}},I.readAsDataURL(n)})}async function F(){if(!d.value)return;const n=await p(d.value);m.value=n.size}return{imagen:b,imagen2:d,fileSize2:m,imagenCodificada:u,alto:l,onFileChange:y,compressAndUpload:F}}}),me={class:"row q-col-gutter-sm q-pa-sm"},ce={class:"col col-md-4"};function ue(o,c,b,d,m,u){const l=Y("imagen-comprimida-component");return f(),_("div",me,[h("div",ce,[c[1]||(c[1]=h("label",{class:"q-mb-sm block"},"Imagen sin comprimir",-1)),s(l,{file_extensiones:".jpg, image/*",imagen:o.imagen,alto:"200px","onUpdate:modelValue":c[0]||(c[0]=y=>o.imagen=y)},null,8,["imagen"])])])}var xe=X(de,[["render",ue]]);export{xe as default};

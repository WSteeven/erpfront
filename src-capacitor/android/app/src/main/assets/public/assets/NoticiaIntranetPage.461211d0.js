var O=Object.defineProperty;var M=(o,e,m)=>e in o?O(o,e,{enumerable:!0,configurable:!0,writable:!0,value:m}):o[e]=m;var l=(o,e,m)=>(M(o,typeof e!="symbol"?e+"":e,m),m);import{d as R,u as j,c as T,f as H,cp as G,q as J,_ as K,t as h,v as r,P as W,F as s,z as i,y as a,I as D,x as n,H as b,G as f,B as X,a7 as A,M as Y,N as Z,D as E,K as c,J as x,a4 as ee}from"./index.6449c167.js";import{Q as oe,a as te}from"./QPopupProxy.72ff1d6d.js";import{Q as S,a as q}from"./QItemSection.9a955ec6.js";import{Q}from"./QSelect.6ce302d7.js";import{Q as ae}from"./QForm.ca56f146.js";import{u as ie}from"./index.490dde02.js";import{r as g}from"./index.0198dd12.js";import{T as se}from"./TabLayoutFilterTabs2.5e702525.js";import{C as le}from"./ContenedorSimpleMixin.09c9bed5.js";import{N as re}from"./NoticiaController.8fa1d74f.js";import{E as ne}from"./entidadAuditable.75a46700.js";import{D as me}from"./DepartamentoController.0e15eb40.js";import{C as de}from"./CategoriaController.d0f3b0e9.js";import{E as ue}from"./EtiquetaController.c7f99601.js";import{S as pe}from"./EssentialTable.00c17e97.js";import{E as ce}from"./EssentialEditor.3e49b578.js";import{u as be}from"./filtrosListadosGenerales.c3aa2da3.js";import"./utils.521b98f3.js";import"./format.8ac60962.js";import"./position-engine.70d0a89f.js";import"./QChip.95469f73.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPage.5d173a8a.js";import"./EssentialTableTabs.586dbdfc.js";import"./QBadge.e6f320cd.js";import"./EssentialTablePagination.d5c1010a.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./buttonSubmits.fe817da3.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./extend.4a22771d.js";const fe=[{name:"titulo",field:"titulo",label:"T\xEDtulo",align:"left",sortable:!0},{name:"fecha_vencimiento",field:"fecha_vencimiento",label:"Fecha Vencimiento",align:"left",sortable:!0},{name:"autor",field:"autor",label:"Autor",align:"left",sortable:!0},{name:"categoria",field:"categoria",label:"Categor\xEDa",align:"left",sortable:!0},{name:"etiquetas",field:"etiquetas",label:"Etiquetas",align:"left",sortable:!0}];class ge extends ne{constructor(){super();l(this,"id");l(this,"titulo");l(this,"descripcion");l(this,"fecha_creacion");l(this,"fecha_vencimiento");l(this,"autor");l(this,"categoria");l(this,"etiquetas");l(this,"imagen_noticia");l(this,"departamentos_destinatarios");l(this,"para_todos");this.id=null,this.titulo=null,this.descripcion="",this.fecha_creacion=null,this.fecha_vencimiento=null,this.autor=null,this.categoria=null,this.etiquetas=[],this.imagen_noticia=null,this.departamentos_destinatarios=[],this.para_todos=!0}}var ve=R({components:{TabLayoutFilterTabs2:se,EssentialEditor:ce,SelectorImagen:pe},setup(){const o=new le(ge,new re),{entidad:e,disabled:m,accion:U,listadosAuxiliares:d}=o.useReferencias(),{setValidador:w,cargarVista:k,obtenerListados:C,listar:y}=o.useComportamiento(),{onReestablecer:t,onConsultado:v}=o.useHooks(),u=j(),{departamentos:V,filtrarDepartamentos:F}=be(d),I=T([]),N=T([]);k(async()=>{await C({categorias:{controller:new de,params:{activo:1}},etiquetas:new ue,departamentos:{controller:new me,params:{campos:"id,nombre",activo:1}}}),I.value=d.categorias,V.value=d.departamentos,e.autor=u.user.nombres+" "+u.user.apellidos}),t(()=>{e.autor=u.user.nombres+" "+u.user.apellidos}),v(()=>{N.value=d.etiquetas});const B=p=>{if(!p)return!0;const $=p.trim().split(/\s+/).length;return $<=150||`La descripci\xF3n no puede tener m\xE1s de 150 palabras. Actualmente tiene ${$} palabras.`},L=H(()=>({titulo:{required:g},autor:{required:g},categoria:{required:g},fecha_vencimiento:{required:g},descripcion:{required:g,maxWords:B}})),P=ie(L,e);w(P.value);function _(p){y({estado:p},!1)}function z(p){e.etiquetas=[],N.value=d.etiquetas.filter($=>$.categoria_id===p)}return{mixin:o,disabled:m,noticia:e,configuracionColumnas:fe,tabOptionsNoticias:G,v$:P,maskFecha:J,accion:U,filtrarNoticias:_,categoriaSeleccionada:z,filtrarDepartamentos:F,categorias:I,etiquetas:N,departamentos:V}}});const Ve={class:"row q-col-gutter-sm q-py-md"},$e={class:"col-12 col-md-6"},qe={class:"error-msg"},ke={class:"col-12 col-md-6"},Ce={class:"error-msg"},ye={class:"col-12 col-md-12"},Ne={class:"col-12 col-md-6"},he={class:"error-msg"},De={class:"col-12 col-md-3 q-mb-md"},Ee={key:0,class:"col-12 col-md-3"},Se={class:"col-12 col-md-6"},Qe={class:"error-msg"},Ue={class:"col-12 col-md-6"},we={class:"col-12 col-md-6"};function Fe(o,e,m,U,d,w){const k=h("essential-editor"),C=h("selector-imagen"),y=h("tab-layout-filter-tabs2");return r(),W(y,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,tabOptions:o.tabOptionsNoticias,permitirEliminar:!1,mostrarButtonSubmits:!0,filtrar:o.filtrarNoticias,tabDefecto:"1",ajustarCeldas:"",forzarListar:!0},{formulario:s(()=>[i(ae,{onSubmit:e[10]||(e[10]=ee(()=>{},["prevent"]))},{default:s(()=>[a("div",Ve,[a("div",$e,[e[11]||(e[11]=a("label",{class:"q-mb-sm block"},"T\xEDtulo",-1)),i(D,{modelValue:o.noticia.titulo,"onUpdate:modelValue":e[0]||(e[0]=t=>o.noticia.titulo=t),error:!!o.v$.titulo.$errors.length,dense:"",outlined:""},{error:s(()=>[(r(!0),n(f,null,b(o.v$.titulo.$errors,t=>(r(),n("div",{key:t.$uid},[a("div",qe,c(t.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),a("div",ke,[e[12]||(e[12]=a("label",{class:"q-mb-sm block"},"Autor",-1)),i(D,{modelValue:o.noticia.autor,"onUpdate:modelValue":e[1]||(e[1]=t=>o.noticia.autor=t),disable:"",error:!!o.v$.autor.$errors.length,dense:"",outlined:""},{error:s(()=>[(r(!0),n(f,null,b(o.v$.autor.$errors,t=>(r(),n("div",{key:t.$uid},[a("div",Ce,c(t.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),a("div",ye,[e[13]||(e[13]=a("label",{class:"q-mb-sm block"},"Descripci\xF3n",-1)),i(k,{modelValue:o.noticia.descripcion,"onUpdate:modelValue":e[2]||(e[2]=t=>o.noticia.descripcion=t),disable:o.disabled},null,8,["modelValue","disable"]),(r(!0),n(f,null,b(o.v$.descripcion.$errors,t=>(r(),n("div",{key:t.$uid,class:"text-negative text-uppercase"},[a("small",null,c(t.$message),1)]))),128))]),a("div",Ne,[e[14]||(e[14]=a("label",{class:"q-mb-sm block"},"Fecha de vencimiento",-1)),i(D,{modelValue:o.noticia.fecha_vencimiento,"onUpdate:modelValue":e[4]||(e[4]=t=>o.noticia.fecha_vencimiento=t),error:!!o.v$.fecha_vencimiento.$errors.length,dense:"",outlined:""},{append:s(()=>[i(X,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(oe,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(te,{modelValue:o.noticia.fecha_vencimiento,"onUpdate:modelValue":e[3]||(e[3]=t=>o.noticia.fecha_vencimiento=t),mask:o.maskFecha,"today-btn":""},null,8,["modelValue","mask"])]),_:1},512)]),_:1})]),error:s(()=>[(r(!0),n(f,null,b(o.v$.fecha_vencimiento.$errors,t=>(r(),n("div",{key:t.$uid},[a("div",he,c(t.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),a("div",De,[e[15]||(e[15]=a("label",{class:"q-mb-sm block"},"\xBFNoticia para todos los empleados?",-1)),i(A,{modelValue:o.noticia.para_todos,"onUpdate:modelValue":e[5]||(e[5]=t=>o.noticia.para_todos=t),label:o.noticia.para_todos?"Si":"Personalizado","true-value":!0,"false-value":!1,dense:""},null,8,["modelValue","label"])]),o.noticia.para_todos?x("",!0):(r(),n("div",Ee,[e[17]||(e[17]=a("label",{class:"q-mb-sm block"},"Departamentos Destinatarios",-1)),i(Q,{modelValue:o.noticia.departamentos_destinatarios,"onUpdate:modelValue":e[6]||(e[6]=t=>o.noticia.departamentos_destinatarios=t),options:o.departamentos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"","use-chips":"",outlined:"",multiple:"","use-input":"","input-debounce":"0",onFilter:o.filtrarDepartamentos,"option-value":t=>t.id,"option-label":t=>t.nombre,"emit-value":"","map-options":"",disable:o.noticia.para_todos},{option:s(({itemProps:t,opt:v,selected:u,toggleOption:V})=>[i(S,Y(Z(t)),{default:s(()=>[i(q,null,{default:s(()=>[E(c(v.nombre),1)]),_:2},1024),i(q,{side:""},{default:s(()=>[i(A,{"model-value":u,"onUpdate:modelValue":F=>V(v)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"no-option":s(()=>[i(S,null,{default:s(()=>[i(q,{class:"text-grey"},{default:s(()=>e[16]||(e[16]=[E(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-value","option-label","disable"])])),a("div",Se,[e[18]||(e[18]=a("label",{class:"q-mb-sm block"},"Categor\xEDa",-1)),i(Q,{outlined:"",modelValue:o.noticia.categoria,"onUpdate:modelValue":[e[7]||(e[7]=t=>o.noticia.categoria=t),o.categoriaSeleccionada],options:o.categorias,disable:o.disabled,"option-value":t=>t.id,"option-label":t=>t.nombre,dense:"","options-dense":"",error:!!o.v$.categoria.$errors.length,"use-chips":"","emit-value":"","map-options":""},{error:s(()=>[(r(!0),n(f,null,b(o.v$.categoria.$errors,t=>(r(),n("div",{key:t.$uid},[a("div",Qe,c(t.$message),1)]))),128))]),_:1},8,["modelValue","options","disable","option-value","option-label","error","onUpdate:modelValue"])]),a("div",Ue,[e[20]||(e[20]=a("label",{class:"q-mb-sm block"},"Etiquetas",-1)),i(Q,{outlined:"",modelValue:o.noticia.etiquetas,"onUpdate:modelValue":e[8]||(e[8]=t=>o.noticia.etiquetas=t),options:o.etiquetas,"options-dense":"",dense:"",disable:o.disabled,multiple:"","use-chips":"","use-input":"","input-debounce":"0","option-value":t=>t.id,"option-label":t=>t.nombre,"emit-value":"","map-options":""},{"no-option":s(()=>[i(S,null,{default:s(()=>[i(q,{class:"text-grey"},{default:s(()=>e[19]||(e[19]=[E(" Selecciona una categor\xEDa que tenga etiquetas ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","option-value","option-label"])]),a("div",we,[e[21]||(e[21]=a("label",{class:"q-mb-sm block"},"Imagen",-1)),i(C,{file_extensiones:".jpg, image/*",imagen:o.noticia.imagen_noticia,comprimir:!0,disable:o.disabled,alto:"200px","onUpdate:modelValue":e[9]||(e[9]=t=>o.noticia.imagen_noticia=t)},null,8,["imagen","disable"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tabOptions","filtrar"])}var ko=K(ve,[["render",Fe]]);export{ko as default};

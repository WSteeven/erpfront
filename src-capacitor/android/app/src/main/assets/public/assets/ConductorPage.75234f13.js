import{Q as L,a as $}from"./QSelect.a8f2bfb2.js";import{Q as N,a as B}from"./QItemSection.c6f2640c.js";import{c as _,U as oo,f as eo,e as ao,a3 as U,bA as b,q as lo,s as to,E as io,v as no,x as h,y as s,S as so,H as t,D as l,a7 as ro,B as n,z as d,I as mo,J as uo,M as g,O as co,P as po,G as k,R as fo,F as bo,K as C,L as u}from"./index.976e8f3c.js";import{Q as go}from"./QExpansionItem.558e637e.js";import{Q as Co}from"./QForm.ed6f6690.js";import{I as vo,C as wo,c as Eo}from"./InformacionLicencia.f0728a71.js";import{r as M,d as Vo,c as yo}from"./i18n-validators.06eef631.js";import{u as ko}from"./index.ed676411.js";import{T as Mo}from"./TabLayout.d6dcc414.js";import{G as So}from"./GestorArchivos.f1319a4d.js";import{E as Fo}from"./EssentialTable.d8e6954a.js";import{M as qo}from"./ModalEntidad.84100166.js";import{S as Io}from"./SolicitarFecha.09b6766b.js";import{E as O}from"./EmpleadoRolesController.69a9291a.js";import{C as Qo}from"./ContenedorSimpleMixin.5a0b06ab.js";import{u as Po,a as Lo}from"./MultaConductorPage.28b63b83.js";import{S as $o}from"./utils.30e08aa2.js";import{g as No,t as Bo}from"./vehiculos.utils.c31e027d.js";import{C as Uo}from"./ConductorController.e8e76909.js";import{u as ho}from"./filtrosListadosGenerales.31e9eb2c.js";import{E as R}from"./Empleado.20234ba0.js";import{C as Oo}from"./Conductor.978d1863.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QPopupProxy.d8ef7a42.js";import"./QToolbar.cff7174f.js";import"./ComponenteModal.domain.22ea4557.js";import"./entidadAuditable.75a46700.js";import"./index.95f5a0db.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPage.ed5d79ca.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./QUploader.43bbdad9.js";import"./QCircularProgress.4d1a2735.js";import"./QFile.e27868da.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./configuracion_general.ef04b031.js";import"./ConfiguracionController.65de3fc5.js";import"./VehiculoController.fd9db948.js";const Ro=[{name:"empleado",field:"empleado",label:"Empleado",align:"left",sortable:!0},{name:"identificacion",field:"identificacion",label:"Identificaci\xF3n",align:"left",sortable:!0},{name:"licencias",field:"licencias",label:"Cant. Licencias",align:"left",sortable:!0,editable:!1},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0,editable:!1},{name:"multas",field:"multas",label:"Multas",align:"left",sortable:!0}];var Ao=_({components:{TabLayout:Mo,ModalesEntidad:qo,EssentialTable:Fo,GestorArchivos:So,SolicitarFecha:Io,InformacionLicencia:vo},setup(){const e=new Qo(Oo,new Uo),{entidad:o,disabled:S,listadosAuxiliares:r,accion:m}=e.useReferencias(),{setValidador:F,obtenerListados:v,cargarVista:w,consultar:a}=e.useComportamiento(),{onReestablecer:A,onConsultado:T}=e.useHooks(),{confirmar:j,prompt:D}=oo(),c=eo(new R),E=Po(),p=new $o,q=new wo,f={fecha_pago:null,comentario:null},I=ao(!1);w(async()=>{await v({empleados:{controller:new O,params:{roles:["CHOFER"]}}}),r.cantones=JSON.parse(U.getItem("cantones").toString()),y.value=JSON.parse(U.getItem("cantones").toString())});const G={empleado:{required:M},tipo_licencia:{required:M},puntos:{required:M,maximo:Vo(30),minimo:yo(0)}},Q=ko(G,o);F(Q.value),T(async()=>{c.hydrate(o.info_empleado),await z(),E.conductor=o}),A(()=>{c.hydrate(new R),f.comentario=null,f.fecha_pago=null,E.resetearConductor()});async function H(i){switch(i){case"MultaConductorPage":console.log("Antes de consultar",o.id),await a(o),console.log("Luego de consultar",o.id);break;default:console.log("No se recibio data")}}async function z(){const{result:i}=await new Lo().listar({empleado_id:o.empleado});o.multas=i}async function J(i){if(i!=null){p.activar();const{result:P}=await new io().consultar(i);c.hydrate(P),p.desactivar()}}async function K(){p.activar(),r.empleados=(await new O().listar({roles:["CHOFER"]})).result,V.value=r.empleados,p.desactivar()}const{empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,cantones:y}=ho(r),Y={titulo:"Agregar multa",icono:"bi-file-text",color:"positive",tooltip:"Agregar multa asociado al conductor",accion:()=>{q.abrirModalEntidad("MultaConductorPage")},visible:()=>m.value==b.editar},Z={titulo:"Editar",icono:"bi-pencil-square",color:"secondary",tooltip:"Editar",accion:({entidad:i})=>{j("\xBFEst\xE1 seguro de marcar como pagada la multa?",async()=>{D({titulo:"Fecha de pago",mensaje:"\xBFTienes alguna observaci\xF3n al respecto?",accion:async x=>{E.idMulta=i.id,f.comentario=x,f.fecha_pago==null&&(I.value=!0)}})})},visible:({entidad:i})=>(m.value==b.nuevo||m.value==b.editar)&&!i.estado};return V.value=r.empleados,y.value=r.cantones,{mixin:e,conductor:o,disabled:S,accion:m,v$:Q,acciones:b,configuracionColumnas:Ro,columnasMultasConductor:Eo,accionesTabla:lo,empleado:c,maskFecha:to,modales:q,mostrarSolicitarFecha:I,abrirModalMultaConductor:Y,btnEditarMulta:Z,tabOptionsConductores:No,empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,obtenerEmpleado:J,cantones:y,tiposLicencias:Bo,guardado:H,recargarChoferes:K}}});const To={class:"row q-col-gutter-sm q-pa-sm"},jo={class:"col-12 col-md-3"},Do={class:"error-msg"},Go={key:0,class:"col-12 col-md-3"},Ho={key:1,class:"col-12 col-md-3"},zo={key:2,class:"col-12 col-md-3"},Jo={key:3,class:"col-12 col-md-3"},Ko={key:4,class:"col-12 col-md-3"};function Wo(e,o,S,r,m,F){const v=h("informacion-licencia"),w=h("tab-layout");return s(),so(w,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:"","titulo-pagina":"Conductores"},{formulario:t(()=>[l(Co,{onSubmit:o[7]||(o[7]=ro(()=>{},["prevent"]))},{default:t(()=>[l(go,{class:"overflow-hidden q-mb-md expansion",label:"Informaci\xF3n Personal","header-class":"text-bold bg-header-collapse","default-opened":""},{default:t(()=>[n("div",To,[n("div",jo,[o[9]||(o[9]=n("label",{class:"q-mb-sm block"},"Chofer",-1)),l(L,{modelValue:e.conductor.empleado,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.conductor.empleado=a),e.obtenerEmpleado],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:e.ordenarEmpleados,error:!!e.v$.empleado.$errors.length,"error-message":"Debes seleccionar un empleado para convertirlo en chofer","option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:t(()=>[(s(!0),d(mo,null,uo(e.v$.empleado.$errors,a=>(s(),d("div",{key:a.$uid},[n("div",Do,g(a.$message),1)]))),128))]),option:t(a=>[l(N,co(po(a.itemProps)),{default:t(()=>[l(B,null,{default:t(()=>[l($,null,{default:t(()=>[k(g(a.opt.apellidos)+" "+g(a.opt.nombres),1)]),_:2},1024),l($,{caption:""},{default:t(()=>[k(g(a.opt.identificacion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[l(N,null,{default:t(()=>[l(B,{class:"text-grey"},{default:t(()=>o[8]||(o[8]=[k(" No hay resultados ")])),_:1})]),_:1})]),after:t(()=>[l(fo,{color:"positive",onClick:e.recargarChoferes},{default:t(()=>[l(bo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disable","onFilter","onPopupShow","onUpdate:modelValue","error","option-value","option-label"])]),e.empleado.identificacion?(s(),d("div",Go,[o[10]||(o[10]=n("label",{class:"q-mb-sm block"},"Identificacion",-1)),l(C,{mask:"#############",modelValue:e.empleado.identificacion,"onUpdate:modelValue":o[1]||(o[1]=a=>e.empleado.identificacion=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.canton?(s(),d("div",Ho,[o[11]||(o[11]=n("label",{class:"q-mb-sm block"},"Ciudad",-1)),l(L,{modelValue:e.empleado.canton,"onUpdate:modelValue":o[2]||(o[2]=a=>e.empleado.canton=a),options:e.cantones,disable:"",dense:"",outlined:"","option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):u("",!0),e.empleado.direccion?(s(),d("div",zo,[o[12]||(o[12]=n("label",{class:"q-mb-sm block"},"Direcci\xF3n",-1)),l(C,{modelValue:e.empleado.direccion,"onUpdate:modelValue":o[3]||(o[3]=a=>e.empleado.direccion=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.celular?(s(),d("div",Jo,[o[13]||(o[13]=n("label",{class:"q-mb-sm block"},"Celular",-1)),l(C,{modelValue:e.empleado.celular,"onUpdate:modelValue":o[4]||(o[4]=a=>e.empleado.celular=a),disable:"",dense:"",outlined:""},null,8,["modelValue"])])):u("",!0),e.empleado.email?(s(),d("div",Ko,[o[14]||(o[14]=n("label",{class:"q-mb-sm block"},"Correo",-1)),l(C,{modelValue:e.empleado.email,"onUpdate:modelValue":o[5]||(o[5]=a=>e.empleado.email=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0)])]),_:1}),l(v,{mixin:e.mixin,conductor:e.conductor,identificacion:e.empleado.identificacion,consultarMultas:!1,onGuardado:o[6]||(o[6]=a=>e.guardado(a))},null,8,["mixin","conductor","identificacion"])]),_:1})]),_:1},8,["mixin","configuracionColumnas"])}var Xe=no(Ao,[["render",Wo]]);export{Xe as default};

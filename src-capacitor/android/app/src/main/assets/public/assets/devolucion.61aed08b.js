var w=Object.defineProperty;var D=(o,t,n)=>t in o?w(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;var a=(o,t,n)=>(D(o,typeof t!="symbol"?t+"":t,n),n);import{a as A,S as z,B as I}from"./utils.521b98f3.js";import{l as L,e as S,c as F,bx as P,b_ as _,A as l,s as r,bE as R}from"./index.6449c167.js";import{E as j}from"./entidadAuditable.75a46700.js";class v extends j{constructor(){super();a(this,"justificacion");a(this,"solicitante");a(this,"solicitante_id");a(this,"tarea");a(this,"tarea_id");a(this,"canton");a(this,"causa_anulacion");a(this,"estado");a(this,"estado_bodega");a(this,"created_at");a(this,"es_para_stock");a(this,"observacion_aut");a(this,"autorizacion");a(this,"per_autoriza");a(this,"per_autoriza_id");a(this,"sucursal");a(this,"sucursal_id");a(this,"cliente");a(this,"cliente_id");a(this,"pedido_automatico");a(this,"listadoProductos");a(this,"es_tarea");a(this,"tiene_observacion_aut");a(this,"condicion");a(this,"misma_condicion");a(this,"devolver_materiales_tecnicos");this.justificacion=null,this.solicitante=null,this.solicitante_id=null,this.observacion_aut=null,this.autorizacion=null,this.per_autoriza=null,this.per_autoriza_id=null,this.tarea=null,this.tarea_id=null,this.canton=null,this.causa_anulacion=null,this.estado=null,this.estado_bodega=null,this.created_at=null,this.es_para_stock=!1,this.listadoProductos=[],this.sucursal=null,this.sucursal_id=null,this.cliente=null,this.cliente_id=null,this.pedido_automatico=!1,this.es_tarea=!1,this.tiene_observacion_aut=!1,this.condicion=null,this.misma_condicion=!1,this.devolver_materiales_tecnicos=!1}}const G=L("devolucion",()=>{const o=S(new v),t=new v,n=F(),{notificarAdvertencia:u,notificarError:p}=A(),h=P.nuevo,d=new z;async function f(i){const e=l.getInstance(),s=e.getEndpoint(r.devoluciones)+"/"+i,c=await e.get(s);if(c.data.modelo.estado==="CREADA")return c.data.modelo;u("No se puede gestionar una devoluci\xF3n anulada")}async function m(i){try{d.activar();const e=await f(i);console.log(e),e.autorizacion==2?e.estado_bodega===_.pendiente||e.estado_bodega===_.parcial?o.hydrate(e):(u("La devoluci\xF3n ya ha sido completada"),o.hydrate(t)):(u("La devoluci\xF3n no est\xE1 aprobada"),o.hydrate(t))}catch{p("Devoluci\xF3n no encontrada"),o.hydrate(t)}finally{d.desactivar()}}async function g(){const i=l.getInstance(),e=i.getEndpoint(r.devoluciones)+"/show-preview/"+n.value,s=await i.get(e);o.hydrate(s.data.modelo)}async function y(){const i=l.getInstance(),e=R.URL_BASE+"/"+i.getEndpoint(r.devoluciones)+"/imprimir/"+n.value,s="devolucion_"+n.value+"_"+Date.now();I(e,"GET","blob","pdf",s)}async function b(i){const e=l.getInstance(),s=e.getEndpoint(r.devoluciones)+"/corregir-devolucion/"+n.value;return await e.put(s,i)}async function x(i,e){const s=l.getInstance(),c=s.getEndpoint(r.devoluciones)+"/eliminar-item";return await s.post(c,{devolucion_id:e,detalle_id:i})}function E(){o.hydrate(t)}return{devolucion:o,accionDevolucion:h,modificarDevolucion:b,eliminarDetalle:x,cargarDevolucion:m,resetearDevolucion:E,idDevolucion:n,showPreview:g,imprimirPdf:y}});export{v as D,G as u};

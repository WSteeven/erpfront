var W=Object.defineProperty;var X=(e,o,d)=>o in e?W(e,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[o]=d;var r=(e,o,d)=>(X(e,typeof o!="symbol"?o+"":o,d),d);import{Q as b,a as g}from"./QItemSection.9a955ec6.js";import{Q as V}from"./QSelect.6ce302d7.js";import{A as Y,s as Z,d as x,m as ee,u as oe,c as ae,E as ie,da as de,_ as te,t as se,v as n,P as re,F as i,z as t,y as s,x as m,H as $,G as y,D as f,a7 as le,J as Q,I as ne,a4 as me,K as j}from"./index.6449c167.js";import{Q as ue}from"./QForm.ca56f146.js";import{E as pe}from"./entidadAuditable.75a46700.js";import{T as ve}from"./TabLayoutFilterTabs2.5e702525.js";import{b as ce,S as fe,a as be,w as ge}from"./utils.521b98f3.js";import{u as Ve}from"./index.490dde02.js";import{C as $e}from"./ContenedorSimpleMixin.09c9bed5.js";import{V as ye}from"./VendedorController.399c4546.js";import{M as je}from"./ModalidadController.c47c2c73.js";import{r as w}from"./i18n-validators.29e2545c.js";import{u as we}from"./filtrosListadosGenerales.c3aa2da3.js";import{t as Ce}from"./ventas.utils.b757673b.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./QPage.5d173a8a.js";import"./EssentialTableTabs.586dbdfc.js";import"./QBadge.e6f320cd.js";import"./EssentialTablePagination.d5c1010a.js";import"./EssentialTable.00c17e97.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./buttonSubmits.fe817da3.js";import"./index.0198dd12.js";class Ee extends pe{constructor(){super();r(this,"id");r(this,"empleado");r(this,"empleado_id");r(this,"empleado_info");r(this,"modalidad");r(this,"modalidad_id");r(this,"modalidad_info");r(this,"tipo_vendedor");r(this,"jefe_inmediato");r(this,"jefe_inmediato_info");r(this,"causa_desactivacion");r(this,"activo");this.id=null,this.empleado=null,this.empleado_id=null,this.empleado_info=null,this.modalidad=null,this.modalidad_id=null,this.modalidad_info=null,this.tipo_vendedor=null,this.jefe_inmediato=null,this.jefe_inmediato_info=null,this.causa_desactivacion=null,this.activo=!0}}const he=[{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"modalidad_info",field:"modalidad_info",label:"Modalidad",align:"left",sortable:!0},{name:"tipo_vendedor",field:"tipo_vendedor",label:"Tipo Vendedor",align:"left",sortable:!0},{name:"jefe_inmediato_info",field:"jefe_inmediato_info",label:"Jefe Inmediato",align:"left",sortable:!0},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class I{constructor(){r(this,"axios");this.axios=Y.getInstance()}async anular(o,d){return this.solicitud("/desactivar/",o,d)}async solicitud(o,d,p){const v=this.axios.getEndpoint(Z.vendedores_claro)+o+d,u=await this.axios.post(v,p);return{response:u,result:u.data.modelo}}}var ke=x({components:{TabLayoutFilterTabs2:ve},setup(e,{emit:o}){ce().setQuasar(ee());const d=new fe,p=oe(),v=new $e(Ee,new ye),{entidad:u,disabled:C,accion:a,listadosAuxiliares:E,listado:k}=v.useReferencias(),{setValidador:M,obtenerListados:L,cargarVista:T,listar:P}=v.useComportamiento(),{onGuardado:U,onModificado:O,onReestablecer:H}=v.useHooks(),{confirmar:D,notificarCorrecto:F,prompt:B,notificarError:q}=be();H(()=>u.jefe_inmediato=p.user.id),U((l,c)=>{o("cerrar-modal",!1),o("guardado",{formulario:"VendedorPage",id:l,modelo:c.modelo})}),O(()=>u.jefe_inmediato=p.user.id);const A=ae("1"),{empleados:N,filtrarEmpleados:J,modalidades:S,filtrarModalidades:R}=we(E);T(async()=>{await L({empleados:{controller:new ie,params:{departamento_id:9,"or[departamento_id]":13,estado:1}},modalidades:{controller:new je,params:{campos:"id,nombre"}}}),u.jefe_inmediato=p.user.id,N.value=E.empleados,S.value=E.modalidades});const _=Ve({empleado:{required:w},modalidad:{required:w},tipo_vendedor:{required:w},jefe_inmediato:{required:w}},u);M(_.value);function G(l){A.value=l,P({activo:l})}return{mixin:v,vendedor:u,disabled:C,accion:a,v$:_,configuracionColumnas:he,tabOptionsVendedores:Ce,tabDefecto:A,empleados:N,modalidades:S,tipos_vendedores:de,ordenarLista:ge,filtrarEmpleados:J,filtrarModalidades:R,filtrarVendedores:G,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar Vendedor",accion:({entidad:l,posicion:c})=>{D("\xBFEst\xE1 seguro de activar el proveedor?",()=>{B({titulo:"Causa de activaci\xF3n",mensaje:"Ingresa el motivo por el que quieres activar este proveedor?",accion:async h=>{try{d.activar(),await new I().anular(l.id,{causa_desactivacion:h}),k.value.splice(c,1),F("Activado correctamente")}catch{q("No se pudo activar el vendedor!")}finally{d.desactivar()}}})})},visible:({entidad:l})=>!l.activo&&p.can("puede.activar.vendedores_claro")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar Vendedor",accion:({entidad:l,posicion:c})=>{D("\xBFEst\xE1 seguro de desactivar el vendedor?",()=>{B({titulo:"Causa de desactivaci\xF3n",mensaje:"Ingresa el motivo por el que quieres desactivar este vendedor?",accion:async h=>{try{d.activar(),await new I().anular(l.id,{causa_desactivacion:h}),k.value.splice(c,1),F("Desactivado correctamente")}catch{q("No se pudo desactivar el vendedor!")}finally{d.desactivar()}}})})},visible:({entidad:l})=>l.activo&&p.can("puede.desactivar.vendedores_claro")}}}});const De={class:"row q-col-gutter-sm q-mb-md"},Fe={class:"col-12 col-md-3 col-sm-6"},Be={class:"error-msg"},qe={class:"col-12 col-md-3 col-sm-6"},Ae={class:"error-msg"},Ne={class:"col-12 col-md-3 col-sm-6"},Se={class:"error-msg"},_e={class:"col-12 col-md-3 col-sm-6"},Qe={class:"error-msg"},Ie={key:0,class:"col-12 col-md-3"},Me={key:1,class:"col-12 col-md-3"};function Le(e,o,d,p,v,u){const C=se("tab-layout-filter-tabs-2");return n(),re(C,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:!0,accion1:e.btnDesactivar,accion2:e.btnActivar,puedeExportar:"","tab-options":e.tabOptionsVendedores,tabDefecto:e.tabDefecto,filtrar:e.filtrarVendedores},{formulario:i(()=>[t(ue,{onSubmit:o[8]||(o[8]=me(()=>{},["prevent"]))},{default:i(()=>[s("div",De,[s("div",Fe,[o[10]||(o[10]=s("label",{class:"q-mb-sm block"},"Jefe inmediato",-1)),t(V,{modelValue:e.vendedor.jefe_inmediato,"onUpdate:modelValue":o[0]||(o[0]=a=>e.vendedor.jefe_inmediato=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.jefe_inmediato.$errors.length,onBlur:e.v$.jefe_inmediato.$touch,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onPopupShow:o[1]||(o[1]=a=>e.ordenarLista(e.empleados,"apellidos")),onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.jefe_inmediato.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Be,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[9]||(o[9]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",qe,[o[12]||(o[12]=s("label",{class:"q-mb-sm block"},"Empleado",-1)),t(V,{modelValue:e.vendedor.empleado,"onUpdate:modelValue":o[2]||(o[2]=a=>e.vendedor.empleado=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.empleado.$errors.length,onBlur:e.v$.empleado.$touch,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onPopupShow:o[3]||(o[3]=a=>e.ordenarLista(e.empleados,"apellidos")),onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.empleado.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Ae,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[11]||(o[11]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",Ne,[o[14]||(o[14]=s("label",{class:"q-mb-sm block"},"Modalidad",-1)),t(V,{modelValue:e.vendedor.modalidad,"onUpdate:modelValue":o[4]||(o[4]=a=>e.vendedor.modalidad=a),options:e.modalidades,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.modalidad.$errors.length,onBlur:e.v$.modalidad.$touch,"error-message":"Debes seleccionar un modalidad","use-input":"","input-debounce":"0",onFilter:e.filtrarModalidades,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.modalidad.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Se,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[13]||(o[13]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",_e,[o[16]||(o[16]=s("label",{class:"q-mb-sm block"},"Tipo de Vendedor",-1)),t(V,{modelValue:e.vendedor.tipo_vendedor,"onUpdate:modelValue":o[5]||(o[5]=a=>e.vendedor.tipo_vendedor=a),options:e.tipos_vendedores,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","input-debounce":0,"use-input":"",hint:"Obligatorio",error:!!e.v$.tipo_vendedor.$errors.length,onBlur:e.v$.tipo_vendedor.$touch,"option-value":a=>a.nombre,"option-label":a=>a.descripcion,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.tipo_vendedor.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Qe,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[15]||(o[15]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onBlur","option-value","option-label"])]),e.vendedor.activo?Q("",!0):(n(),m("div",Ie,[o[17]||(o[17]=s("br",null,null,-1)),t(le,{modelValue:e.vendedor.activo,"onUpdate:modelValue":o[6]||(o[6]=a=>e.vendedor.activo=a),"checked-icon":"check",disable:e.disabled,label:e.vendedor.activo?"Activo":"Inactivo",color:"positive"},null,8,["modelValue","disable","label"])])),e.vendedor.activo?Q("",!0):(n(),m("div",Me,[o[18]||(o[18]=s("label",{class:"q-mb-sm block"},"Causa de desactivaci\xF3n",-1)),t(ne,{modelValue:e.vendedor.causa_desactivacion,"onUpdate:modelValue":o[7]||(o[7]=a=>e.vendedor.causa_desactivacion=a),placeholder:"Obligatorio",autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])]))])]),_:1})]),default:i(()=>[o[19]||(o[19]=f(" > "))]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var Do=te(ke,[["render",Le]]);export{Do as default};

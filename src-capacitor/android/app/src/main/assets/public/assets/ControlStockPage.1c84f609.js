var D=Object.defineProperty;var P=(o,e,a)=>e in o?D(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var r=(o,e,a)=>(P(o,typeof e!="symbol"?e+"":e,a),a);import{Q as p}from"./QSelect.a8f2bfb2.js";import{bz as M,t as O,c as A,e as I,cy as U,v as N,x as f,y as F,S as z,H as n,D as t,a7 as T,B as i,K as $}from"./index.976e8f3c.js";import{Q as h}from"./QForm.ed6f6690.js";import{r as k}from"./index.95f5a0db.js";import{u as L}from"./index.ed676411.js";import{T as R}from"./TabLayout.d6dcc414.js";import{M as B}from"./ModalEntidad.84100166.js";import{C as Q}from"./ContenedorSimpleMixin.5a0b06ab.js";import{D as H}from"./DetalleProductoController.3a7836a2.js";import{E as K}from"./entidadAuditable.75a46700.js";import{C as j}from"./ClienteController.f53ff018.js";import{P as G}from"./ProductoController.a7c63da7.js";import{s as J}from"./utils.30e08aa2.js";import{u as X}from"./filtrosListadosGenerales.31e9eb2c.js";import{E as W}from"./ErrorComponent.b482e77d.js";import{N as Y}from"./NoOptionComponent.ffe820c8.js";import"./QChip.334d746c.js";import"./QItemSection.c6f2640c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./QPage.ed5d79ca.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTable.d8e6954a.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./EssentialTablePagination.f449a738.js";import"./configuracion_general.ef04b031.js";import"./ConfiguracionController.65de3fc5.js";import"./i18n-validators.06eef631.js";const Z=[{name:"sucursal_id",field:"sucursal_id",label:"sucursal",align:"left",sortable:!0},{name:"detalle_id",field:"detalle_id",label:"detalle",align:"left",sortable:!0},{name:"cliente_id",field:"cliente_id",label:"Cliente",align:"left",sortable:!0},{name:"minimo",field:"minimo",label:"minimo",align:"left",sortable:!0},{name:"reorden",field:"reorden",label:"reorden",align:"left",sortable:!0},{name:"actual",field:"actual",label:"En inventario",align:"left",sortable:!0},{name:"estado",field:"estado",label:"estado",align:"left",sortable:!0}];class x extends M{constructor(){super(O.control_stocks)}}class oo extends K{constructor(){super();r(this,"producto");r(this,"sucursal_id");r(this,"detalle_id");r(this,"cliente_id");r(this,"minimo");r(this,"reorden");r(this,"actual");r(this,"estado");this.producto=null,this.sucursal_id=null,this.detalle_id=null,this.cliente_id=null,this.minimo=null,this.reorden=null,this.actual=null,this.estado=null}}var eo=A({components:{NoOptionComponent:Y,ErrorComponent:W,TabLayout:R,ModalesEntidad:B},setup(){const o=new Q(oo,new x),{entidad:e,disabled:a,listadosAuxiliares:d}=o.useReferencias(),{setValidador:g,obtenerListados:C,cargarVista:u,listar:m}=o.useComportamiento(),s=I([]),{clientes:l,productos:V,filtrarProductos:_,sucursales:c,filtrarSucursales:w}=X(d);u(async()=>{await C({sucursales:{controller:new U,params:{campos:"id,lugar,cliente_id",activo:1}},productos:{controller:new G,params:{campos:"id,nombre"}},detalles:{controller:new H,params:{campos:"id,producto_id,descripcion,modelo_id,serial"}},clientes:{controller:new j,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}}})});const S=L({sucursal_id:{required:k},detalle_id:{required:k},cliente_id:{required:k}},e);g(S.value);const E={titulo:"Actualizar",tooltip:"Actualizar listado",icono:"bi-arrow-clockwise",accion:()=>{m()}},y=[{nombre:"SUFICIENTE",valor:"STOCK SUFICIENTE"},{nombre:"REORDEN",valor:"PROXIMO A AGOTARSE"},{nombre:"MINIMO",valor:"DEBAJO DEL MINIMO"}];return c.value=d.sucursales,V.value=d.productos,s.value=d.detalles,l.value=d.clientes,{mixin:o,stock:e,v$:S,disabled:a,configuracionColumnas:Z,opciones_estados:y,productos:V,filtrarProductos:_,sucursales:c,filtrarSucursales:w,opciones_detalles:s,clientes:l,ordenarLista:J,seleccionarDetalle(b){s.value=d.detalles.filter(v=>v.producto_id===b),e.detalle_id=null,s.value.length<1&&(e.detalle_id=null),s.value.length==1&&(e.detalle_id=s.value[0].id)},seleccionarPropietario(b){const v=c.value.filter(q=>q.id===b);e.cliente_id=v[0].cliente_id},btnActualizarStock:E}}});const lo={class:"row q-col-gutter-sm q-py-md"},to={class:"col-12 col-md-6"},io={class:"col-12 col-md-6"},ro={class:"col-12 col-md-6 q-mb-md"},ao={class:"col-12 col-md-6 q-mb-md"},so={class:"col-12 col-md-6"},no={class:"col-12 col-md-6"};function uo(o,e,a,d,g,C){const u=f("no-option-component"),m=f("error-component"),s=f("tab-layout");return F(),z(s,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Control de stock",ajustarCeldas:!0,accion1Header:o.btnActualizarStock},{formulario:n(()=>[t(h,{onSubmit:e[7]||(e[7]=T(()=>{},["prevent"]))},{default:n(()=>[i("div",lo,[i("div",to,[e[8]||(e[8]=i("label",{class:"q-mb-sm block"},"Producto",-1)),t(p,{modelValue:o.stock.producto,"onUpdate:modelValue":[e[0]||(e[0]=l=>o.stock.producto=l),o.seleccionarDetalle],options:o.productos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarProductos,"option-label":l=>l.nombre,"option-value":l=>l.id,"emit-value":"","map-options":""},{"no-option":n(()=>[t(u)]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","option-label","option-value"])]),i("div",io,[e[9]||(e[9]=i("label",{class:"q-mb-sm block"},"Detalle",-1)),t(p,{modelValue:o.stock.detalle_id,"onUpdate:modelValue":e[1]||(e[1]=l=>o.stock.detalle_id=l),options:o.opciones_detalles,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",error:!!o.v$.detalle_id.$errors.length,"error-message":"Debes seleccionar un detalle de producto","option-label":l=>l.id&&l.serial?l.modelo+" \xA0 | \xA0 "+l.descripcion+" \xA0 | \xA0 "+l.serial:l.id?l.modelo+" | "+l.descripcion:null,"option-value":l=>l.id,"emit-value":"","map-options":""},{error:n(()=>[t(m,{clave:"detalle_id",v$:o.v$},null,8,["v$"])]),"no-option":n(()=>[t(u)]),_:1},8,["modelValue","options","error","option-label","option-value"])]),i("div",ro,[e[10]||(e[10]=i("label",{class:"q-mb-sm block"},"Sucursal",-1)),t(p,{modelValue:o.stock.sucursal_id,"onUpdate:modelValue":[e[2]||(e[2]=l=>o.stock.sucursal_id=l),o.seleccionarPropietario],options:o.sucursales,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarSucursales,onPopupShow:e[3]||(e[3]=l=>o.ordenarLista(o.sucursales,"lugar")),error:!!o.v$.sucursal_id.$errors.length,"error-message":"Debes seleccionar una sucursal","option-label":l=>l.lugar,"option-value":l=>l.id,"emit-value":"","map-options":""},{"no-option":n(()=>[t(u)]),error:n(()=>[t(m,{clave:"sucursal_id",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","error","option-label","option-value"])]),i("div",ao,[e[11]||(e[11]=i("label",{class:"q-mb-sm block"},"Propietario",-1)),t(p,{modelValue:o.stock.cliente_id,"onUpdate:modelValue":e[4]||(e[4]=l=>o.stock.cliente_id=l),options:o.clientes,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",disable:"",outlined:"",error:!!o.v$.cliente_id.$errors.length,"error-message":"Debes seleccionar el propietario del producto","option-label":l=>l.razon_social,"option-value":l=>l.id,"emit-value":"","map-options":""},{error:n(()=>[t(m,{clave:"cliente_id",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","options","error","option-label","option-value"])]),i("div",so,[e[12]||(e[12]=i("label",{class:"q-mb-sm block"},"Minimo",-1)),t($,{type:"number",mask:"####","unmasked-value":"",modelValue:o.stock.minimo,"onUpdate:modelValue":e[5]||(e[5]=l=>o.stock.minimo=l),placeholder:"Obligatorio",readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])]),i("div",no,[e[13]||(e[13]=i("label",{class:"q-mb-sm block"},"Reorden",-1)),t($,{type:"number",mask:"####","unmasked-value":"",modelValue:o.stock.reorden,"onUpdate:modelValue":e[6]||(e[6]=l=>o.stock.reorden=l),placeholder:"Obligatorio",readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","accion1Header"])}var le=N(eo,[["render",uo]]);export{le as default};

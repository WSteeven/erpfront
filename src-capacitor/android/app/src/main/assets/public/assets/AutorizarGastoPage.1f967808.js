var O=Object.defineProperty;var R=(a,o,r)=>o in a?O(a,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[o]=r;var E=(a,o,r)=>(R(a,typeof o!="symbol"?o+"":o,r),r);import{Q as $}from"./QPage.5d173a8a.js";import{bw as k,s as Q,bf as L,d as x,c as n,m as w,u as U,cX as i,cY as j,p as J,E as K,bx as G,be as X,_ as H,t as h,v as z,P as W,F as Z,y as u,D as y,K as A,x as aa,J as ea,z as M,a3 as oa}from"./index.6449c167.js";import{M as ta}from"./ModalEntidad.168b465e.js";import{C as ra}from"./ConfirmarDialog.131c5c13.js";import{E as sa}from"./EssentialTableTabs.586dbdfc.js";import{C as ia}from"./ContenedorSimpleMixin.09c9bed5.js";import{G as na}from"./Gasto.2946018b.js";import{S as la,b as ca,u as ua,N as ma}from"./utils.521b98f3.js";import{C as da,a as pa}from"./ComponenteModal.domain.50e59f97.js";import{V as fa}from"./VisualizarGastoPage.32b5aee0.js";import{u as ba}from"./fondo_rotativo.904d83a9.js";import{V as ga}from"./VehiculoController.5e90ff0e.js";import{P as _a}from"./ProyectoController.fd7b11f8.js";import"./QToolbar.8dbe891b.js";import"./position-engine.70d0a89f.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./logo.4781eea2.js";import"./QBadge.e6f320cd.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QSelect.6ce302d7.js";import"./QChip.95469f73.js";import"./QItemSection.9a955ec6.js";import"./format.8ac60962.js";import"./EssentialTablePagination.d5c1010a.js";import"./EssentialTable.00c17e97.js";import"./use-fullscreen.a7661f85.js";import"./QPopupProxy.72ff1d6d.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./entidadAuditable.75a46700.js";import"./QForm.ca56f146.js";import"./TabLayout.0bce4313.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./buttonSubmits.fe817da3.js";import"./index.490dde02.js";import"./configuracionColumnasGasto.bbc5ae20.js";import"./GastoPusherEvent.95f9e40c.js";import"./notificationRealtime.3b61757a.js";import"./AprobarGastoController.8bab6304.js";import"./GastoController.9622aaf5.js";const va=[{name:"id",field:"id",label:"Id",align:"left",sortable:!0},{name:"fecha_viat",field:"fecha_viat",label:"Fecha",align:"left",sortable:!0},{name:"tarea_info",field:"tarea_info",label:"Tarea",align:"left",sortable:!0},{name:"tarea_cliente",field:"tarea_cliente",label:"Tarea cliente",align:"left",sortable:!0},{name:"factura",field:"factura",label:"#Factura",align:"left",sortable:!0},{name:"num_comprobante",field:"num_comprobante",label:"#Comprobante",align:"left",sortable:!0},{name:"ruc",field:"ruc",label:"RUC.",align:"left",sortable:!0},{name:"aut_especial_user",field:"aut_especial_user",label:"Autorizaci\xF3n Especial",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"detalle_info",field:"detalle_info",label:"Detalle",align:"left",sortable:!0},{name:"sub_detalle_info",field:"sub_detalle_info",label:"SubDetalle",align:"left",sortable:!0},{name:"centro_costo",field:"centro_costo",label:"Centro de Costo",align:"left",sortable:!0},{name:"subcentro_costo",field:"subcentro_costo",label:"Sub Centro de Costo",align:"left",sortable:!0},{name:"estado_info",field:"estado_info",label:"Estado	",align:"left",sortable:!0},{name:"detalle_estado",field:"detalle_estado",label:"Descripcion",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha de Creaci\xF3n",align:"left",sortable:!0}];class P extends k{constructor(){super(Q.autorizaciones_gastos)}}class Ca{constructor(){E(this,"VisualizarGastoPage");this.VisualizarGastoPage=L(new da("Gastos",fa))}}class Da extends pa{constructor(){super(new Ca)}}var Ea=x({name:"AutorizarGastoPage",components:{EssentialTableTabs:sa,ConfirmarDialog:ra,ModalEntidad:ta},setup(){const a=new P,o=n(),r=new ia(na,a),{listado:p}=r.useReferencias(),s=new la;ca().setQuasar(w()),ua().setQuasar(w());const l=U(),t=ba(),m=n([]),c=n([]),g=n([]),_=n([]),S=new P;async function f(e){s.activar();const{result:d}=await S.listar({estado:e});p.value=d,o.value=e,s.desactivar()}async function N(){m.value=(await new ga().listar({campos:"id,placa"})).result,c.value=(await new K().listar({estado:1})).result}async function T(e){s.activar(),g.value=(await new _a().listar({campos:"id,nombre,codigo_proyecto",finalizado:0,empleado_id:e})).result,_.value=(await new X().listar({campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id",empleado_id:e,activas_empleado:1,formulario:!0})).result,s.desactivar()}f(i.PENDIENTE),N();const v=new Da,V=n(),F={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:async({entidad:e})=>{s.activar(),t.gasto=e,t.vehiculos=m.value,t.empleados=c.value,t.habilitar_observacion_autorizador=l.user.id===e.aut_especial&&[i.PENDIENTE,i.APROBADO].includes(e.estado)&&q(e.fecha_viat),t.accion_form=l.user.id===e.aut_especial&&e.estado===i.PENDIENTE?G.editar:G.consultar,e.estado===i.PENDIENTE&&await T(e.id_usuario),t.proyectos=g.value,t.tareas=_.value,v.abrirModalEntidad("VisualizarGastoPage"),s.desactivar()}};function q(e){const d=new Date,C=new Date(d.getFullYear(),d.getMonth(),1),b=new Date(C);b.setDate(C.getDate()-1);const B=new Date(b.getFullYear(),b.getMonth(),1),I=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),D=ma(e,"YYYY-MM-DD","America/Guayaquil");return D>=B&&D<=I||l.esAdministrador}async function Y(){f(i.PENDIENTE)}return{configuracionColumnasAutorizarGasto:va,listado:p,estadosGastos:i,tabAutorizarGasto:j,botonVerModalGasto:F,accionesTabla:J,estaSemanAC:V,guardado:Y,filtrarAutorizacionesGasto:f,authenticationStore:l,modales:v}}});const wa={class:"text-center q-pb-md"},Ga={class:"q-my-md"},ha={key:0,class:"q-mb-md"};function za(a,o,r,p,s,l){const t=h("essential-table-tabs"),m=h("modal-entidad");return z(),W($,{padding:!a.$q.screen.xs},{default:Z(()=>{var c;return[u("div",wa,[u("div",Ga,[o[0]||(o[0]=y(" Bienvenido, ")),u("strong",null,A(a.authenticationStore.nombreUsuario),1)]),(c=a.authenticationStore.user)!=null&&c.grupo?(z(),aa("div",ha,[o[1]||(o[1]=y(" Grupo, ")),u("strong",null,A(a.authenticationStore.user.grupo),1)])):ea("",!0)]),u("div",{class:oa([{"bg-desenfoque rounded q-pa-sm":a.$q.screen.xs},"borde custom-shadow rounded"])},[M(t,{configuracionColumnas:[...a.configuracionColumnasAutorizarGasto,a.accionesTabla],datos:a.listado,accion1:a.botonVerModalGasto,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!0,"mostrar-botones":!1,"tab-options":a.tabAutorizarGasto,onTabSeleccionado:a.filtrarAutorizacionesGasto,tabDefecto:"3",ajustarCeldas:""},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"])],2),M(m,{comportamiento:a.modales,onGuardado:a.guardado,mostrarListado:!1},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var Ee=H(Ea,[["render",za]]);export{Ee as default};

var z=Object.defineProperty;var x=(n,e,s)=>e in n?z(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var o=(n,e,s)=>(x(n,typeof e!="symbol"?e+"":e,s),s);import{a as A,S}from"./utils.521b98f3.js";import{l as b,e as L,c as _,bx as I,b_ as R,A as d,bE as p,s as l,bZ as B}from"./index.6449c167.js";import{E as C}from"./entidadAuditable.75a46700.js";class m extends C{constructor(){super();o(this,"solicitante");o(this,"solicitante_id");o(this,"pedido");o(this,"autorizacion");o(this,"autorizacion_id");o(this,"justificacion");o(this,"estado");o(this,"causa_anulacion");o(this,"autorizador");o(this,"autorizador_id");o(this,"created_at");o(this,"listadoProductos");this.solicitante=null,this.solicitante_id=null,this.pedido=null,this.justificacion=null,this.estado=null,this.causa_anulacion=null,this.autorizador=null,this.autorizador_id=null,this.autorizacion=null,this.autorizacion_id=null,this.created_at=null,this.listadoProductos=[]}}const N=b("preorden",()=>{const n=L(new m),e=new m,s=_(),f=_([]),{notificarAdvertencia:h,notificarError:u}=A(),y=I.nuevo,r=new S;async function g(t){const a=d.getInstance(),i=a.getEndpoint(l.preordenes_compras)+"/show-preview/"+t,c=await a.get(i);if(c.data.modelo.autorizacion===B.aprobado)return c.data.modelo}async function v(t){try{r.activar();const a=await g(t);console.log("El modelo es: ",a),a.estado===R.completa?(h("La preorden ya ha sido generada en otra orden de compra"),n.hydrate(e)):n.hydrate(a)}catch{h("Preorden no encontrada"),n.hydrate(e)}finally{r.desactivar()}}async function E(t){try{r.activar();const a=d.getInstance(),i=p.URL_BASE+"/"+a.getEndpoint(l.preordenes_compras)+"/anular/"+s.value;return await a.post(i,t)}catch(a){u(a)}finally{r.desactivar()}}async function P(){try{r.activar();const t=d.getInstance(),a=p.URL_BASE+"/"+t.getEndpoint(l.preordenes_compras_consolidadas),i=await t.get(a);f.value=i.data.results}catch(t){u(t)}finally{r.desactivar()}}async function w(t){try{r.activar();const a=d.getInstance(),i=p.URL_BASE+"/"+a.getEndpoint(l.preordenes_compras),c=await a.post(i,t);console.log(c)}catch(a){u(a)}finally{r.desactivar()}}return{preorden:n,accionPreorden:y,idPreorden:s,cargarPreorden:v,anularPreorden:E,consolidarPreordenes:P,crearPreordenConsolida:w,listadoItems:f}});export{m as P,N as u};

var R=Object.defineProperty;var $=(a,o,r)=>o in a?R(a,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[o]=r;var E=(a,o,r)=>($(a,typeof o!="symbol"?o+"":o,r),r);import{Q as k}from"./QPage.ed5d79ca.js";import{bz as L,t as Q,bi as x,c as U,e as i,be as j,p as G,u as H,dg as n,dh as J,q as K,E as W,bA as h,v as X,x as z,y as A,S as Z,H as aa,B as u,G as y,M,z as ea,L as oa,a6 as ta,D as S}from"./index.976e8f3c.js";import{M as ra}from"./ModalEntidad.84100166.js";import{C as sa}from"./ConfirmarDialog.7e84f025.js";import{E as ia}from"./EssentialTableTabs.c7e98bba.js";import{C as na}from"./ContenedorSimpleMixin.5a0b06ab.js";import{G as la}from"./Gasto.edc5bb42.js";import{S as ca,u as ua,P as ma}from"./utils.30e08aa2.js";import{C as da,a as pa}from"./ComponenteModal.domain.22ea4557.js";import{V as fa}from"./VisualizarGastoPage.333989df.js";import{u as ba}from"./fondo_rotativo.2f402897.js";import{V as ga}from"./VehiculoController.fd9db948.js";import{P as _a}from"./ProyectoController.29ab1934.js";import{T as Ca}from"./TareaController.c7f2748b.js";import{C as va}from"./ClienteController.f53ff018.js";import"./QToolbar.cff7174f.js";import"./position-engine.2f1d750c.js";import"./configuracion_general.ef04b031.js";import"./ConfiguracionController.65de3fc5.js";import"./EssentialTable.d8e6954a.js";import"./QSelect.a8f2bfb2.js";import"./QChip.334d746c.js";import"./QItemSection.c6f2640c.js";import"./QMenu.410ae527.js";import"./format.8ac60962.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./QPopupProxy.d8ef7a42.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./i18n-validators.06eef631.js";import"./index.95f5a0db.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./EssentialTablePagination.f449a738.js";import"./entidadAuditable.75a46700.js";import"./QForm.ed6f6690.js";import"./TabLayout.d6dcc414.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./buttonSubmits.2eb37d38.js";import"./index.ed676411.js";import"./configuracionColumnasGasto.bbc5ae20.js";import"./GastoPusherEvent.08595b2c.js";import"./notificationRealtime.cf45dfec.js";import"./AprobarGastoController.2f9cb818.js";import"./GastoController.e3057fd0.js";import"./NoOptionComponent.ffe820c8.js";const Da=[{name:"id",field:"id",label:"Id",align:"left",sortable:!0},{name:"fecha_viat",field:"fecha_viat",label:"Fecha",align:"left",sortable:!0},{name:"tarea_info",field:"tarea_info",label:"Tarea",align:"left",sortable:!0},{name:"tarea_cliente",field:"tarea_cliente",label:"Tarea cliente",align:"left",sortable:!0},{name:"factura",field:"factura",label:"#Factura",align:"left",sortable:!0},{name:"num_comprobante",field:"num_comprobante",label:"#Comprobante",align:"left",sortable:!0},{name:"ruc",field:"ruc",label:"RUC.",align:"left",sortable:!0},{name:"aut_especial_user",field:"aut_especial_user",label:"Autorizaci\xF3n Especial",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"detalle_info",field:"detalle_info",label:"Detalle",align:"left",sortable:!0},{name:"sub_detalle_info",field:"sub_detalle_info",label:"SubDetalle",align:"left",sortable:!0},{name:"centro_costo",field:"centro_costo",label:"Centro de Costo",align:"left",sortable:!0},{name:"subcentro_costo",field:"subcentro_costo",label:"Sub Centro de Costo",align:"left",sortable:!0},{name:"estado_info",field:"estado_info",label:"Estado	",align:"left",sortable:!0},{name:"detalle_estado",field:"detalle_estado",label:"Descripcion",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha de Creaci\xF3n",align:"left",sortable:!0}];class P extends L{constructor(){super(Q.autorizaciones_gastos)}}class wa{constructor(){E(this,"VisualizarGastoPage");this.VisualizarGastoPage=x(new da("Gastos",fa))}}class Ea extends pa{constructor(){super(new wa)}}var Ga=U({name:"AutorizarGastoPage",components:{EssentialTableTabs:ia,ConfirmarDialog:sa,ModalEntidad:ra},setup(){const a=new P,o=i(),r=new na(la,a),{listado:p}=r.useReferencias(),s=new ca;j().setQuasar(G()),ua().setQuasar(G());const l=H(),t=ba(),m=i([]),c=i([]),g=i([]),_=i([]),C=i([]),T=new P;async function f(e){s.activar();const{result:d}=await T.listar({estado:e});p.value=d,o.value=e,s.desactivar()}async function N(){m.value=(await new ga().listar({campos:"id,placa"})).result,c.value=(await new W().listar({estado:1})).result}async function V(e){s.activar(),g.value=(await new _a().listar({campos:"id,nombre,codigo_proyecto",finalizado:0,empleado_id:e})).result,C.value=(await new Ca().listar({campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id",empleado_id:e,activas_empleado:1,formulario:!0})).result,_.value=(await new va().listar({estado:1,requiere_fr:1})).result,s.desactivar()}f(n.PENDIENTE),N();const v=new Ea,q=i(),F={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:async({entidad:e})=>{console.log("boton ",e),s.activar(),t.gasto=e,t.vehiculos=m.value,t.empleados=c.value,t.habilitar_observacion_autorizador=l.user.id===e.aut_especial&&[n.PENDIENTE,n.APROBADO].includes(e.estado)&&B(e.fecha_viat),t.accion_form=l.user.id===e.aut_especial&&e.estado===n.PENDIENTE?h.editar:h.consultar,e.estado===n.PENDIENTE&&await V(e.id_usuario),t.proyectos=g.value,t.tareas=C.value,t.clientes=_.value,v.abrirModalEntidad("VisualizarGastoPage"),s.desactivar()}};function B(e){const d=new Date,D=new Date(d.getFullYear(),d.getMonth(),1),b=new Date(D);b.setDate(D.getDate()-1);const I=new Date(b.getFullYear(),b.getMonth(),1),O=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),w=ma(e,"YYYY-MM-DD","America/Guayaquil");return w>=I&&w<=O||l.esAdministrador}async function Y(){f(n.PENDIENTE)}return{configuracionColumnasAutorizarGasto:Da,listado:p,estadosGastos:n,tabAutorizarGasto:J,botonVerModalGasto:F,accionesTabla:K,estaSemanAC:q,guardado:Y,filtrarAutorizacionesGasto:f,authenticationStore:l,modales:v}}});const ha={class:"text-center q-pb-md"},za={class:"q-my-md"},Aa={key:0,class:"q-mb-md"};function ya(a,o,r,p,s,l){const t=z("essential-table-tabs"),m=z("modal-entidad");return A(),Z(k,{padding:!a.$q.screen.xs},{default:aa(()=>{var c;return[u("div",ha,[u("div",za,[o[0]||(o[0]=y(" Bienvenido, ")),u("strong",null,M(a.authenticationStore.nombreUsuario),1)]),(c=a.authenticationStore.user)!=null&&c.grupo?(A(),ea("div",Aa,[o[1]||(o[1]=y(" Grupo, ")),u("strong",null,M(a.authenticationStore.user.grupo),1)])):oa("",!0)]),u("div",{class:ta([{"bg-desenfoque rounded q-pa-sm":a.$q.screen.xs},"borde custom-shadow rounded"])},[S(t,{configuracionColumnas:[...a.configuracionColumnasAutorizarGasto,a.accionesTabla],datos:a.listado,accion1:a.botonVerModalGasto,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!0,"mostrar-botones":!1,"tab-options":a.tabAutorizarGasto,onTabSeleccionado:a.filtrarAutorizacionesGasto,tabDefecto:"3",ajustarCeldas:""},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"])],2),S(m,{comportamiento:a.modales,onGuardado:a.guardado,mostrarListado:!1},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var Se=X(Ga,[["render",ya]]);export{Se as default};

import{Q as $,a as L}from"./QSelect.b920278b.js";import{Q as N,a as B}from"./QItemSection.ec4cc512.js";import{d as _,R as oo,e as eo,c as ao,a2 as h,bz as b,p as lo,q as to,E as io,_ as no,t as O,v as s,P as so,F as t,z as l,a6 as ro,y as n,x as d,G as mo,H as uo,K as g,M as co,N as po,D as k,O as fo,B as bo,I as C,J as u}from"./index.b8e09611.js";import{Q as go}from"./QExpansionItem.795361a7.js";import{Q as Co}from"./QForm.eab79b48.js";import{I as vo,C as wo,c as Eo}from"./InformacionLicencia.bcd90aa2.js";import{r as M,d as Vo,c as yo}from"./i18n-validators.06abe774.js";import{u as ko}from"./index.70965bc7.js";import{T as Mo}from"./TabLayout.45a66130.js";import{G as So}from"./GestorArchivos.801d8a9f.js";import{E as Fo}from"./EssentialTable.23af6cc8.js";import{M as qo}from"./ModalEntidad.54c9ab3a.js";import{S as Io}from"./SolicitarFecha.13418260.js";import{E as R}from"./EmpleadoRolesController.fec03cf3.js";import{C as Qo}from"./ContenedorSimpleMixin.4e22246b.js";import{u as Po,a as $o}from"./MultaConductorPage.bbc5d467.js";import{S as Lo}from"./utils.9344cd7e.js";import{g as No,t as Bo}from"./vehiculos.utils.c31e027d.js";import{C as ho}from"./ConductorController.1494aa58.js";import{u as Oo}from"./filtrosListadosGenerales.87fcb144.js";import{E as U}from"./Empleado.20234ba0.js";import{C as Ro}from"./Conductor.978d1863.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QPopupProxy.685eacb5.js";import"./QToolbar.afeb6de9.js";import"./ComponenteModal.domain.92aacded.js";import"./entidadAuditable.75a46700.js";import"./index.ea415f98.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPage.e6f8825d.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTablePagination.ce808cac.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./QUploader.16c4ab83.js";import"./QCircularProgress.c6e924d2.js";import"./QFile.c79664c6.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./VehiculoController.30a3b5a2.js";const Uo=[{name:"empleado",field:"empleado",label:"Empleado",align:"left",sortable:!0},{name:"identificacion",field:"identificacion",label:"Identificaci\xF3n",align:"left",sortable:!0},{name:"licencias",field:"licencias",label:"Cant. Licencias",align:"left",sortable:!0,editable:!1},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0,editable:!1},{name:"multas",field:"multas",label:"Multas",align:"left",sortable:!0}];var To=_({components:{TabLayout:Mo,ModalesEntidad:qo,EssentialTable:Fo,GestorArchivos:So,SolicitarFecha:Io,InformacionLicencia:vo},setup(){const e=new Qo(Ro,new ho),{entidad:o,disabled:S,listadosAuxiliares:r,accion:m}=e.useReferencias(),{setValidador:F,obtenerListados:v,cargarVista:w,consultar:a}=e.useComportamiento(),{onReestablecer:T,onConsultado:A}=e.useHooks(),{confirmar:j,prompt:z}=oo(),c=eo(new U),E=Po(),p=new Lo,q=new wo,f={fecha_pago:null,comentario:null},I=ao(!1);w(async()=>{await v({empleados:{controller:new R,params:{roles:["CHOFER"]}}}),r.cantones=JSON.parse(h.getItem("cantones").toString()),y.value=JSON.parse(h.getItem("cantones").toString())});const D={empleado:{required:M},tipo_licencia:{required:M},puntos:{required:M,maximo:Vo(30),minimo:yo(0)}},Q=ko(D,o);F(Q.value),A(async()=>{c.hydrate(o.info_empleado),await H(),E.conductor=o}),T(()=>{c.hydrate(new U),f.comentario=null,f.fecha_pago=null,E.resetearConductor()});async function G(i){switch(i){case"MultaConductorPage":console.log("Antes de consultar",o.id),await a(o),console.log("Luego de consultar",o.id);break;default:console.log("No se recibio data")}}async function H(){const{result:i}=await new $o().listar({empleado_id:o.empleado});o.multas=i}async function J(i){if(i!=null){p.activar();const{result:P}=await new io().consultar(i);c.hydrate(P),p.desactivar()}}async function K(){p.activar(),r.empleados=(await new R().listar({roles:["CHOFER"]})).result,V.value=r.empleados,p.desactivar()}const{empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,cantones:y}=Oo(r),Y={titulo:"Agregar multa",icono:"bi-file-text",color:"positive",tooltip:"Agregar multa asociado al conductor",accion:()=>{q.abrirModalEntidad("MultaConductorPage")},visible:()=>m.value==b.editar},Z={titulo:"Editar",icono:"bi-pencil-square",color:"secondary",tooltip:"Editar",accion:({entidad:i})=>{j("\xBFEst\xE1 seguro de marcar como pagada la multa?",async()=>{z({titulo:"Fecha de pago",mensaje:"\xBFTienes alguna observaci\xF3n al respecto?",accion:async x=>{E.idMulta=i.id,f.comentario=x,f.fecha_pago==null&&(I.value=!0)}})})},visible:({entidad:i})=>(m.value==b.nuevo||m.value==b.editar)&&!i.estado};return V.value=r.empleados,y.value=r.cantones,{mixin:e,conductor:o,disabled:S,accion:m,v$:Q,acciones:b,configuracionColumnas:Uo,columnasMultasConductor:Eo,accionesTabla:lo,empleado:c,maskFecha:to,modales:q,mostrarSolicitarFecha:I,abrirModalMultaConductor:Y,btnEditarMulta:Z,tabOptionsConductores:No,empleados:V,filtrarEmpleados:W,ordenarEmpleados:X,obtenerEmpleado:J,cantones:y,tiposLicencias:Bo,guardado:G,recargarChoferes:K}}});const Ao={class:"row q-col-gutter-sm q-pa-sm"},jo={class:"col-12 col-md-3"},zo={class:"error-msg"},Do={key:0,class:"col-12 col-md-3"},Go={key:1,class:"col-12 col-md-3"},Ho={key:2,class:"col-12 col-md-3"},Jo={key:3,class:"col-12 col-md-3"},Ko={key:4,class:"col-12 col-md-3"};function Wo(e,o,S,r,m,F){const v=O("informacion-licencia"),w=O("tab-layout");return s(),so(w,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:"","titulo-pagina":"Conductores"},{formulario:t(()=>[l(Co,{onSubmit:o[7]||(o[7]=ro(()=>{},["prevent"]))},{default:t(()=>[l(go,{class:"overflow-hidden q-mb-md expansion",label:"Informaci\xF3n Personal","header-class":"text-bold bg-header-collapse","default-opened":""},{default:t(()=>[n("div",Ao,[n("div",jo,[o[9]||(o[9]=n("label",{class:"q-mb-sm block"},"Chofer",-1)),l($,{modelValue:e.conductor.empleado,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.conductor.empleado=a),e.obtenerEmpleado],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:e.ordenarEmpleados,error:!!e.v$.empleado.$errors.length,"error-message":"Debes seleccionar un empleado para convertirlo en chofer","option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:t(()=>[(s(!0),d(mo,null,uo(e.v$.empleado.$errors,a=>(s(),d("div",{key:a.$uid},[n("div",zo,g(a.$message),1)]))),128))]),option:t(a=>[l(N,co(po(a.itemProps)),{default:t(()=>[l(B,null,{default:t(()=>[l(L,null,{default:t(()=>[k(g(a.opt.apellidos)+" "+g(a.opt.nombres),1)]),_:2},1024),l(L,{caption:""},{default:t(()=>[k(g(a.opt.identificacion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":t(()=>[l(N,null,{default:t(()=>[l(B,{class:"text-grey"},{default:t(()=>o[8]||(o[8]=[k(" No hay resultados ")])),_:1})]),_:1})]),after:t(()=>[l(fo,{color:"positive",onClick:e.recargarChoferes},{default:t(()=>[l(bo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disable","onFilter","onPopupShow","onUpdate:modelValue","error","option-value","option-label"])]),e.empleado.identificacion?(s(),d("div",Do,[o[10]||(o[10]=n("label",{class:"q-mb-sm block"},"Identificacion",-1)),l(C,{mask:"#############",modelValue:e.empleado.identificacion,"onUpdate:modelValue":o[1]||(o[1]=a=>e.empleado.identificacion=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.canton?(s(),d("div",Go,[o[11]||(o[11]=n("label",{class:"q-mb-sm block"},"Ciudad",-1)),l($,{modelValue:e.empleado.canton,"onUpdate:modelValue":o[2]||(o[2]=a=>e.empleado.canton=a),options:e.cantones,disable:"",dense:"",outlined:"","option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):u("",!0),e.empleado.direccion?(s(),d("div",Ho,[o[12]||(o[12]=n("label",{class:"q-mb-sm block"},"Direcci\xF3n",-1)),l(C,{modelValue:e.empleado.direccion,"onUpdate:modelValue":o[3]||(o[3]=a=>e.empleado.direccion=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0),e.empleado.celular?(s(),d("div",Jo,[o[13]||(o[13]=n("label",{class:"q-mb-sm block"},"Celular",-1)),l(C,{modelValue:e.empleado.celular,"onUpdate:modelValue":o[4]||(o[4]=a=>e.empleado.celular=a),disable:"",dense:"",outlined:""},null,8,["modelValue"])])):u("",!0),e.empleado.email?(s(),d("div",Ko,[o[14]||(o[14]=n("label",{class:"q-mb-sm block"},"Correo",-1)),l(C,{modelValue:e.empleado.email,"onUpdate:modelValue":o[5]||(o[5]=a=>e.empleado.email=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):u("",!0)])]),_:1}),l(v,{mixin:e.mixin,conductor:e.conductor,identificacion:e.empleado.identificacion,consultarMultas:!1,onGuardado:o[6]||(o[6]=a=>e.guardado(a))},null,8,["mixin","conductor","identificacion"])]),_:1})]),_:1},8,["mixin","configuracionColumnas"])}var Xe=no(To,[["render",Wo]]);export{Xe as default};

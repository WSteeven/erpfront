var ro=Object.defineProperty;var no=(o,e,f)=>e in o?ro(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var F=(o,e,f)=>(no(o,typeof e!="symbol"?e+"":e,f),f);import{bz as lo,t as Q,c as uo,be as fo,p as D,u as po,e as b,E as mo,a3 as R,s as co,a4 as vo,A as bo,dr as E,bH as U,v as ho,y as p,S as _o,H as s,D as i,bf as Fo,bg as Y,B as n,z as m,I as g,J as w,M as C,G as $,L as O,K as A,F as y,k as B,R as k,Q as go,c8 as wo}from"./index.976e8f3c.js";import{Q as P,a as T}from"./QItemSection.c6f2640c.js";import{Q as q}from"./QSelect.a8f2bfb2.js";import{Q as M,a as N,C as j}from"./QPopupProxy.d8ef7a42.js";import{Q as Co}from"./QPage.ed5d79ca.js";import{T as $o}from"./TabLayout.d6dcc414.js";import{u as yo}from"./index.ed676411.js";import{C as ko}from"./ContenedorSimpleMixin.5a0b06ab.js";import{T as Vo}from"./TipoFonfoController.62f8062c.js";import{E as Io}from"./entidadAuditable.75a46700.js";import{u as Qo,A as z,L as I}from"./utils.30e08aa2.js";import{a as Lo,r as H}from"./i18n-validators.06eef631.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTable.d8e6954a.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./EssentialTablePagination.f449a738.js";import"./index.95f5a0db.js";class So extends lo{constructor(){super(Q.fondo_rotativo_fecha_pdf)}}class Do extends Io{constructor(){super();F(this,"usuario");F(this,"fecha_inicio");F(this,"fecha_fin");this.usuario=null,this.fecha_inicio=null,this.fecha_fin=null}}var Ro=uo({components:{TabLayout:$o},setup(){fo().setQuasar(D()),Qo().setQuasar(D());const o=po(),e=new ko(Do,new So),{entidad:f,disabled:L,accion:S,listadosAuxiliares:l}=e.useReferencias(),{setValidador:a,obtenerListados:G,cargarVista:J}=e.useComportamiento(),K={usuario:{requiredIfUsuario:Lo(()=>o.can("puede.ver.campo.empleado.fondo_rotativo"))},fecha_inicio:{required:H},fecha_fin:{required:H}},V=yo(K,f);a(V.value);const c=b([]),v=b(),h=b([]),X=b("false"),_=b([]);c.value=l.usuarios,J(async()=>{await G({usuarios:{controller:new mo,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Vo,params:{campos:"id,descripcion"}}}),c.value=l.usuarios,v.value=R.getItem("usuariosInactivos")==null?[]:JSON.parse(R.getItem("usuariosInactivos").toString()),l.usuariosInactivos=v.value,h.value=l.tiposFondos,_.value=l.tiposFondoRotativoFechas});function W(t,r){if(t===""){r(()=>{c.value=l.usuarios});return}r(()=>{const d=t.toLowerCase();c.value=l.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function Z(t,r){if(t===""){r(()=>{v.value=l.usuariosInactivos});return}r(()=>{const d=t.toLowerCase();v.value=l.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function x(t,r){if(t===""){r(()=>{h.value=l.tiposFondos});return}r(()=>{const d=t.toLowerCase();h.value=l.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}function oo(t,r){if(t===""){r(()=>{_.value=l.tiposFondoRotativoFechas});return}r(()=>{const d=t.toLowerCase();_.value=l.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}async function eo(t,r){if(await V.value.$validate()){const d=bo.getInstance(),u="reporte_semanal_gastos_del_"+t.fecha_inicio+"_al_"+t.fecha_fin;switch(r){case E.EXCEL:const io=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_excel);z(io,"POST","blob","xlsx",u,t);break;case E.PDF:const to=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_pdf);z(to,"POST","blob","pdf",u,t);break}}}function ao(t){const r=I(new Date,"YYYY/MM/DD");return t<=r}function so(t){const r=I(new Date,"YYYY/MM/DD"),d=I(f.fecha_inicio!==null?f.fecha_inicio:new Date,"YYYY/MM/DD");return t>=d&&t<=r}return{mixin:e,fondo_rotativo_fecha:f,disabled:L,accion:S,store:o,v$:V,usuarios:c,usuariosInactivos:v,tiposFondos:h,tiposFondoRotativoFechas:_,maskFecha:co,is_inactivo:X,generar_reporte:eo,filtrarUsuarios:W,filtrarUsuariosInactivos:Z,filtrarTiposFondos:x,filtrarTiposFondoRotativoFechas:oo,watchEffect:vo,optionsFechaInicio:ao,optionsFechaFin:so}}});const Eo={key:0,class:"col-12 col-md-3"},Uo={class:"error-msg"},Yo={key:1,class:"col-12 col-md-3"},Oo={class:"error-msg"},Ao={class:"col-6 col-md-3"},Bo={class:"row items-center justify-end"},Po={class:"error-msg"},To={class:"col-6 col-md-3"},qo={class:"row items-center justify-end"},Mo={class:"error-msg"};function No(o,e,f,L,S,l){return p(),_o(Co,{class:"flex flex-center"},{default:s(()=>[i(Fo,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:s(()=>[i(Y,null,{default:s(()=>e[8]||(e[8]=[n("div",{class:"row items-center no-wrap"},[n("div",{class:"col"},[n("div",{class:"text-h6"},"Generar Reporte Fondo Rotativo")])],-1)])),_:1}),i(Y,null,{default:s(()=>[o.store.can("puede.ver.campo.empleado.fondo_rotativo")&&o.is_inactivo=="false"?(p(),m("div",Eo,[e[10]||(e[10]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(q,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[0]||(e[0]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onBlur:o.v$.usuario.$touch,onFilter:o.filtrarUsuarios,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),m(g,null,w(o.v$.usuario.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Uo,C(a.$message),1)]))),128))]),"no-option":s(()=>[i(P,null,{default:s(()=>[i(T,{class:"text-grey"},{default:s(()=>e[9]||(e[9]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onBlur","onFilter","option-value","option-label"])])):O("",!0),o.is_inactivo=="true"?(p(),m("div",Yo,[e[12]||(e[12]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(q,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[1]||(e[1]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un usuario","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),m(g,null,w(o.v$.usuario.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Oo,C(a.$message),1)]))),128))]),"no-option":s(()=>[i(P,null,{default:s(()=>[i(T,{class:"text-grey"},{default:s(()=>e[11]||(e[11]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])):O("",!0),n("div",Ao,[e[13]||(e[13]=n("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(A,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(M,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(N,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[2]||(e[2]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:s(()=>[n("div",Bo,[B(i(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),m(g,null,w(o.v$.fecha_inicio.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Po,C(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),n("div",To,[e[14]||(e[14]=n("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(A,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=a=>o.fondo_rotativo_fecha.fecha_fin=a),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(M,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(N,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[4]||(e[4]=a=>o.fondo_rotativo_fecha.fecha_fin=a),mask:o.maskFecha,"today-btn":"",options:o.optionsFechaFin},{default:s(()=>[n("div",qo,[B(i(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),m(g,null,w(o.v$.fecha_fin.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Mo,C(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])])]),_:1}),i(go),i(wo,{align:"around"},{default:s(()=>[i(k,{color:"positive",onClick:e[6]||(e[6]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"excel"))},{default:s(()=>[i(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[15]||(e[15]=$("Excel"))]),_:1}),i(k,{color:"negative",onClick:e[7]||(e[7]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"pdf"))},{default:s(()=>[i(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[16]||(e[16]=$("PDF"))]),_:1})]),_:1})]),_:1})]),_:1})}var Ve=ho(Ro,[["render",No]]);export{Ve as default};

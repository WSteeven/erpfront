import{c as W,e as g,g as U,w as H,y as f,z as I,D as s,H as x,F as P,bI as O,k as S,b3 as L,bf as G,B as h,R as k,S as J,bg as A,M as V,L as q,aE as K,I as T,v as X,x as Y}from"./index.976e8f3c.js";import{Q as Z}from"./QFile.e27868da.js";import{Q as E}from"./QImg.e0fb285c.js";import"./QChip.334d746c.js";import"./format.8ac60962.js";const ee={class:"row q-gutter-sm justify-center closeButton"},te={class:"row q-col-gutter-sm q-mb-md q-ml-md q-mr-md text-grey-4"},oe={class:"col-12 col-md-3 text-h6"},ae={key:0,class:"col-12 col-md-3 text-h6"},ne={key:1,class:"col-12 col-md-3 text-h6"},se={class:"col-12 col-md-3 text-h6"},le={class:"col-12 col-md-3 text-h6"},ie={key:0,class:"block text-center q-py-sm"},re=W({__name:"ImagenComprimidaComponent",props:["modelValue","imagen","disable","file_extensiones","error","alto","hint","texto1","texto2","texto3","texto4","texto5"],emits:["update:modelValue"],setup(o,{emit:c}){const y=o,d=c,m=g(),u=g(),l=U(()=>y.imagen),C=U(()=>{var a;return(a=y.alto)!=null?a:"160px"}),p=g(!1),_=g(0),n=g(1),v=async a=>{if(a!=null){m.value=a.size;const e=new FileReader,t=await F(a);e.readAsDataURL(t),e.onload=()=>d("update:modelValue",e.result),m.value=t.size}else m.value=null};async function F(a){return new Promise(e=>{const t=new FileReader;t.onload=b=>{const r=new Image;r.src=b.target.result,r.onload=()=>{const $=document.createElement("canvas"),M=$.getContext("2d"),D=1600;let Q=r.width,R=r.height;if(r.width>D){const j=D/r.width;Q=D,R=r.height*j}$.width=Q,$.height=R,M.drawImage(r,0,0,Q,R),$.toBlob(j=>{const N=new File([j],a.name,{type:"image/jpeg",lastModified:Date.now()});e(N)},"image/jpeg",.7)}},t.readAsDataURL(a)})}H(l,()=>{l.value||(u.value=null)});function z(){d("update:modelValue",null)}function i(){_.value+=90}function w(){n.value+=.1}function B(){n.value-=.1}return(a,e)=>(f(),I(T,null,[s(Z,{modelValue:u.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>u.value=t),v],dense:"",outlined:"",class:"q-mt-sm",clearable:"",onClear:e[1]||(e[1]=t=>z()),disable:o.disable,accept:".png, .jpg, .jpeg",error:o.error,hint:o.hint},{prepend:x(()=>[s(P,{name:"attach_file"})]),error:x(()=>[O(a.$slots,"error")]),_:3},8,["modelValue","disable","error","hint"]),S(s(E,{src:l.value,width:"100%",height:C.value,fit:"contain"},null,8,["src","height"]),[[L,l.value]]),s(K,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),maximized:""},{default:x(()=>[s(G,{class:"bg-black rounded-card no-border",flat:""},{default:x(()=>[h("div",ee,[s(k,{round:"",push:"",color:"positive",glossy:"",icon:"bi-arrow-clockwise",onClick:e[2]||(e[2]=t=>i())}),s(k,{push:"",dense:"",color:"white",rounded:"",outline:"",icon:"bi-dash",onClick:e[3]||(e[3]=t=>B())}),s(k,{dense:"",push:"",outline:"",rounded:"",color:"white",icon:"bi-plus",onClick:e[4]||(e[4]=t=>w())}),s(k,{round:"",push:"",color:"negative",glossy:"",icon:"bi-x",onClick:e[5]||(e[5]=()=>p.value=!1)})]),o.texto1?(f(),J(A,{key:0},{default:x(()=>[h("div",te,[h("div",oe,V(o.texto1),1),o.texto2?(f(),I("div",ae,V(o.texto2),1)):q("",!0),o.texto3?(f(),I("div",ne,V(o.texto3),1)):q("",!0),h("div",se,V(o.texto4),1),h("div",le,V(o.texto5),1)])]),_:1})):q("",!0),s(A,{class:"rounded-footer text-center q-pa-none scroll-container"},{default:x(()=>[S(s(E,{src:l.value,fit:"contain",width:"100%",height:"100vh","spinner-color":"white","img-style":{transform:"rotate("+_.value+"deg) scale("+n.value+")"}},null,8,["src","img-style"]),[[L,l.value]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l.value?(f(),I("small",ie,[s(k,{outline:"",glossy:"",color:"primary",onClick:e[7]||(e[7]=t=>p.value=!0),label:"Ver en pantalla completa","no-caps":""})])):q("",!0)],64))}});const de=W({components:{ImagenComprimidaComponent:re},emits:["update:modelValue"],setup(o,{emit:c}){const y=g(),d=g(),m=g(),u=U(()=>d),l="160px";H(u,()=>{u.value||(d.value=null)});const C=n=>{if(n!=null){const v=new FileReader;v.readAsDataURL(n),v.onload=()=>c("update:modelValue",v.result),m.value=n.size,p(n)}else m.value=null};async function p(n){return new Promise(v=>{const F=new FileReader;F.onload=z=>{const i=new Image;i.src=z.target.result,i.onload=()=>{const w=document.createElement("canvas"),B=w.getContext("2d"),a=800;let e=i.width,t=i.height;if(i.width>a){const b=a/i.width;e=a,t=i.height*b}w.width=e,w.height=t,B.drawImage(i,0,0,e,t),w.toBlob(b=>{const r=new File([b],n.name,{type:"image/jpeg",lastModified:Date.now()});v(r)},"image/jpeg",.7)}},F.readAsDataURL(n)})}async function _(){if(!d.value)return;const n=await p(d.value);m.value=n.size}return{imagen:y,imagen2:d,fileSize2:m,imagenCodificada:u,alto:l,onFileChange:C,compressAndUpload:_}}}),me={class:"row q-col-gutter-sm q-pa-sm"},ce={class:"col col-md-4"};function ue(o,c,y,d,m,u){const l=Y("imagen-comprimida-component");return f(),I("div",me,[h("div",ce,[c[1]||(c[1]=h("label",{class:"q-mb-sm block"},"Imagen sin comprimir",-1)),s(l,{file_extensiones:".jpg, image/*",imagen:o.imagen,alto:"200px","onUpdate:modelValue":c[0]||(c[0]=C=>o.imagen=C)},null,8,["imagen"])])])}var xe=X(de,[["render",ue]]);export{xe as default};

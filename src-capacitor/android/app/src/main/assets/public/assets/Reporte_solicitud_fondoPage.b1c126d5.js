var Z=Object.defineProperty;var ee=(o,e,n)=>e in o?Z(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n;var _=(o,e,n)=>(ee(o,typeof e!="symbol"?e+"":e,n),n);import{bz as oe,t as y,c as se,be as ie,p as V,u as ae,e as b,E as S,s as re,a4 as te,A as le,dr as $,bH as D,v as ne,y as f,S as de,H as a,D as i,bf as ue,bg as E,B as t,G as C,K as I,F as v,k as R,R as h,z as g,I as Y,J as A,M as L,Q as pe,c8 as me}from"./index.976e8f3c.js";import{Q as ce,a as fe}from"./QItemSection.c6f2640c.js";import{Q as _e}from"./QSelect.a8f2bfb2.js";import{Q as P,a as T,C as U}from"./QPopupProxy.d8ef7a42.js";import{Q as be}from"./QPage.ed5d79ca.js";import{T as ve}from"./TabLayout.d6dcc414.js";import{u as he}from"./index.ed676411.js";import{C as ge}from"./ContenedorSimpleMixin.5a0b06ab.js";import{u as we,A as B,L as k}from"./utils.30e08aa2.js";import{E as Ce}from"./entidadAuditable.75a46700.js";import{u as ke}from"./fondo_rotativo.2f402897.js";import{r as M}from"./i18n-validators.06eef631.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTable.d8e6954a.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./EssentialTablePagination.f449a738.js";import"./Gasto.edc5bb42.js";import"./index.95f5a0db.js";class ye extends oe{constructor(){super(y.reporte_solicitud_fondo_pdf)}}class Fe extends Ce{constructor(){super();_(this,"usuario");_(this,"fecha_inicio");_(this,"fecha_fin");this.usuario=null,this.fecha_inicio=null,this.fecha_fin=null}}var Qe=se({components:{TabLayout:ve},setup(){ie().setQuasar(V()),we().setQuasar(V());const o=ae(),e=ke(),n=new ge(Fe,new ye),F=b(!1),{entidad:p,disabled:Q,accion:s,listadosAuxiliares:m}=n.useReferencias(),{setValidador:q,obtenerListados:O,cargarVista:z}=n.useComportamiento(),w=he({fecha_inicio:{required:M},fecha_fin:{required:M}},p);q(w.value);const d=b([]),N=b("false"),j=b("false");d.value=m.usuarios,z(async()=>{await O({usuarios:{controller:new S,params:{campos:"id,nombres,apellidos",estado:1}}}),d.value=m.usuarios});function H(l,r){if(l===""){r(()=>{d.value=m.usuarios});return}r(()=>{const u=l.toLowerCase();d.value=m.usuarios.filter(c=>c.nombres.toLowerCase().indexOf(u)>-1||c.apellidos.toLowerCase().indexOf(u)>-1)})}async function G(l,r){if(await w.value.$validate()){const u=le.getInstance(),c="reporte_solicitud_fondos"+new Date().getTime();switch(r){case $.EXCEL:const X=D.URL_BASE+"/"+u.getEndpoint(y.reporte_solicitud_fondo_excel);B(X,"POST","blob","xlsx",c,l);break;case $.PDF:const W=D.URL_BASE+"/"+u.getEndpoint(y.reporte_solicitud_fondo_pdf);B(W,"POST","blob","pdf",c,l);break}}}async function x(l){if(l==="true"){const r=(await new S().listar({campos:"id,nombres,apellidos",estado:0})).result;e.empleados=r,setTimeout(()=>setInterval(()=>{r.value=e.empleados,d.value=r.value},100),250)}else{const r=m.usuarios;e.empleados=r,setTimeout(()=>setInterval(()=>{r.value=e.empleados,d.value=r.value},100),250)}}function J(l){const r=k(new Date,"YYYY/MM/DD");return l<=r}function K(l){const r=k(new Date,"YYYY/MM/DD"),u=k(p.fecha_inicio!==null?p.fecha_inicio:new Date,"YYYY/MM/DD");return l>=u&&l<=r}return{mixin:n,store:o,maskFecha:re,reporte_solicitud_fondos:p,disabled:Q,accion:s,v$:w,usuarios:d,mostrarInactivos:x,is_inactivo:j,is_all_users:N,generar_reporte:G,filtrarUsuarios:H,visualizar_saldo_usuario:F,watchEffect:te,optionsFechaInicio:J,optionsFechaFin:K}}});const Ve={class:"col-12 col-md-3"},Se={class:"col-6 col-md-3"},$e={class:"row items-center justify-end"},De={class:"error-msg"},Ee={class:"col-6 col-md-3"},Ie={class:"row items-center justify-end"},Re={class:"error-msg"};function Ye(o,e,n,F,p,Q){return f(),de(be,{class:"flex flex-center"},{default:a(()=>[i(ue,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:a(()=>[i(E,null,{default:a(()=>e[7]||(e[7]=[t("div",{class:"row items-center no-wrap"},[t("div",{class:"col"},[t("div",{class:"text-h6"},"Generar Reporte Solicitudes de Fondos")])],-1)])),_:1}),i(E,null,{default:a(()=>[t("div",Ve,[e[9]||(e[9]=t("label",{class:"q-mb-sm block"},"Empleado",-1)),i(_e,{modelValue:o.reporte_solicitud_fondos.usuario,"onUpdate:modelValue":e[0]||(e[0]=s=>o.reporte_solicitud_fondos.usuario=s),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"error-message":"Debes seleccionar un usuario","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuarios,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":a(()=>[i(ce,null,{default:a(()=>[i(fe,{class:"text-grey"},{default:a(()=>e[8]||(e[8]=[C(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])]),t("div",Se,[e[10]||(e[10]=t("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(I,{modelValue:o.reporte_solicitud_fondos.fecha_inicio,"onUpdate:modelValue":e[2]||(e[2]=s=>o.reporte_solicitud_fondos.fecha_inicio=s),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:a(()=>[i(v,{name:"event",class:"cursor-pointer"},{default:a(()=>[i(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(T,{modelValue:o.reporte_solicitud_fondos.fecha_inicio,"onUpdate:modelValue":e[1]||(e[1]=s=>o.reporte_solicitud_fondos.fecha_inicio=s),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:a(()=>[t("div",$e,[R(i(h,{label:"Cerrar",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:a(()=>[(f(!0),g(Y,null,A(o.v$.fecha_inicio.$errors,s=>(f(),g("div",{key:s.$uid},[t("div",De,L(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),t("div",Ee,[e[11]||(e[11]=t("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(I,{modelValue:o.reporte_solicitud_fondos.fecha_fin,"onUpdate:modelValue":e[4]||(e[4]=s=>o.reporte_solicitud_fondos.fecha_fin=s),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:a(()=>[i(v,{name:"event",class:"cursor-pointer"},{default:a(()=>[i(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(T,{modelValue:o.reporte_solicitud_fondos.fecha_fin,"onUpdate:modelValue":e[3]||(e[3]=s=>o.reporte_solicitud_fondos.fecha_fin=s),mask:o.maskFecha,options:o.optionsFechaFin,"today-btn":""},{default:a(()=>[t("div",Ie,[R(i(h,{label:"Cerrar",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:a(()=>[(f(!0),g(Y,null,A(o.v$.fecha_fin.$errors,s=>(f(),g("div",{key:s.$uid},[t("div",Re,L(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])])]),_:1}),i(pe),i(me,{align:"around"},{default:a(()=>[i(h,{color:"positive",onClick:e[5]||(e[5]=s=>o.generar_reporte(o.reporte_solicitud_fondos,"excel"))},{default:a(()=>[i(v,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[12]||(e[12]=C("Excel"))]),_:1}),i(h,{color:"negative",onClick:e[6]||(e[6]=s=>o.generar_reporte(o.reporte_solicitud_fondos,"pdf"))},{default:a(()=>[i(v,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[13]||(e[13]=C("PDF"))]),_:1})]),_:1})]),_:1})]),_:1})}var go=ne(Qe,[["render",Ye]]);export{go as default};

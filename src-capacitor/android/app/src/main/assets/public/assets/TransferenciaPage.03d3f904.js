var K=Object.defineProperty;var W=(e,r,d)=>r in e?K(e,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[r]=d;var l=(e,r,d)=>(W(e,typeof r!="symbol"?r+"":r,d),d);import{Q as S,a as _}from"./QItemSection.9a955ec6.js";import{Q as E,a as D}from"./QSelect.6ce302d7.js";import{bw as X,s as Y,d as Z,m as x,u as ee,c as y,E as oe,be as re,_ as ae,t as A,v as n,P as se,F as a,z as i,y as s,x as t,G as b,H as f,D as V,J as L,I as T,bd as ie,K as p,L as ne,a4 as te}from"./index.6449c167.js";import{Q as le}from"./QForm.ca56f146.js";import{E as ue}from"./entidadAuditable.75a46700.js";import{T as de}from"./TabLayout.0bce4313.js";import{S as me}from"./EssentialTable.00c17e97.js";import{b as pe,w as ce}from"./utils.521b98f3.js";import{u as be}from"./index.490dde02.js";import{a as B,r as k,c as fe,b as N}from"./i18n-validators.29e2545c.js";import{C as ve}from"./ContenedorSimpleMixin.09c9bed5.js";import{u as ge,c as $e}from"./transferenciaSaldo.a7aaa0aa.js";import{E as ye}from"./EmpleadoPermisosController.f2fe35f7.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTablePagination.d5c1010a.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./index.0198dd12.js";class Ve extends ue{constructor(){super();l(this,"fecha");l(this,"usuario_envia_info");l(this,"usuario_recibe_info");l(this,"usuario_envia");l(this,"usuario_recibe");l(this,"monto");l(this,"motivo");l(this,"observacion");l(this,"cuenta");l(this,"tarea");l(this,"tarea_info");l(this,"comprobante");l(this,"estado_info");l(this,"es_devolucion");this.fecha=null,this.usuario_envia_info=null,this.usuario_recibe_info=null,this.usuario_envia=null,this.usuario_recibe=null,this.monto=null,this.motivo="TRANSFERENCIA ENTRE USUARIOS",this.observacion=null,this.cuenta=null,this.tarea=null,this.tarea_info=null,this.comprobante=null,this.estado_info=null,this.es_devolucion=!1}}class Ce extends X{constructor(){super(Y.transferencia)}}var he=Z({components:{TabLayout:de,SelectorImagen:me},emits:["guardado","cerrar-modal"],setup(){pe().setQuasar(x());const e=ee(),r=e.user,d=ge(),C=new ve(Ve,new Ce),{entidad:u,disabled:U,accion:q,listadosAuxiliares:m}=C.useReferencias(),{setValidador:o,obtenerListados:F,cargarVista:R,consultar:j}=C.useComportamiento(),h=y([]),w=y([]),I=y(!0),P=y(!1),O=y([]),M={usuario_envia:{required:B(()=>e.can("puede.registrar.fondos_terceros"))},usuario_recibe:{requiredIf:B(()=>!u.es_devolucion)},monto:{required:k,maxValue:fe(9999),maxLength:N(50)},cuenta:{required:k,maxLength:N(50)},tarea:{requiredIf:B(()=>!u.es_devolucion)},comprobante:{required:k},observacion:{required:k,maxLength:N(150)}},Q=be(M,u);o(Q.value),d.id_transferencia&&(j({id:d.id_transferencia}),I.value=!1,P.value=!0),R(async()=>{await F({usuarios:{controller:new oe,params:{campos:"id,nombres,apellidos",estado:1}},tareas:{controller:new re,params:{campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id","f_params[orderBy][field]":"id","f_params[orderBy][type]":"DESC","f_params[limit]":100}}}),m.tareas.unshift({id:0,titulo:"Sin Tarea",codigo_tarea:" "}),w.value=m.tareas,h.value=m.usuarios,e.can("puede.registrar.fondos_terceros")&&await z()});async function z(){const c=await new ye().listar({permisos:["puede.delegar.registro_fondos"]});O.value=c.result}function G(c,v){if(c===""){v(()=>{h.value=m.usuarios});return}v(()=>{const g=c.toLowerCase();h.value=m.usuarios.filter($=>$.nombres.toLowerCase().indexOf(g)>-1||$.apellidos.toLowerCase().indexOf(g)>-1)})}function H(c,v){if(c===""){v(()=>{w.value=m.tareas});return}v(()=>{const g=c.toLowerCase();w.value=m.tareas.filter($=>$.codigo_tarea.toLowerCase().indexOf(g)>-1||$.titulo.toLowerCase().indexOf(g)>-1)})}function J(){u.es_devolucion?(u.usuario_recibe=null,u.tarea=0,u.motivo="DEVOLUCION"):(u.motivo="TRANSFERENCIA ENTRE USUARIOS",u.tarea=null)}return{mixin:C,transferencia:u,disabled:U,accion:q,v$:Q,store:e,empleados_delegadores:O,usuarios:h,usuario:r,tareas:w,ordenarLista:ce,filtrarUsuarios:G,filtrarTareas:H,existeDevolucion:J,mostrarListado:I,configuracionColumnas:$e}}});const we={class:"row q-col-gutter-sm q-mb-md"},Se={key:0,class:"col-12 col-md-3 q-mb-md col-sm-3"},_e={class:"error-msg"},ke={key:1,class:"col-12 col-md-3 q-mb-md"},qe={class:"error-msg"},Ee={class:"col-12 col-md-3"},Le={class:"error-msg"},Te={class:"col-12 col-md-3"},Be={class:"error-msg"},Ne={key:2,class:"col-12 col-md-3"},Ue={class:"error-msg"},Ie={class:"col-12 col-md-3"},Oe={class:"error-msg"},Qe={class:"col-12 col-md-3 q-mb-xl"},De={class:"col-12 col-md-3"},Ae={class:"error-msg"};function Fe(e,r,d,C,u,U){const q=A("selector-imagen"),m=A("tab-layout");return n(),se(m,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:""},{formulario:a(()=>[i(le,{onSubmit:r[10]||(r[10]=te(()=>{},["prevent"]))},{default:a(()=>[s("div",we,[e.store.can("puede.registrar.fondos_terceros")?(n(),t("div",Se,[r[12]||(r[12]=s("label",{class:"q-mb-sm block"},"Empleado Solicitante",-1)),i(E,{modelValue:e.transferencia.usuario_envia,"onUpdate:modelValue":r[0]||(r[0]=o=>e.transferencia.usuario_envia=o),options:e.empleados_delegadores,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"",error:!!e.v$.usuario_envia.$errors.length,onBlur:e.v$.usuario_envia.$touch,"error-message":"Debes seleccionar un empleado al que se carga el gasto","use-input":"","input-debounce":"0",onPopupShow:r[1]||(r[1]=o=>e.ordenarLista(e.empleados_delegadores,"nombres")),"option-value":o=>o.id,"option-label":o=>o.nombres+" "+o.apellidos,"emit-value":"","map-options":""},{error:a(()=>[(n(!0),t(b,null,f(e.v$.usuario_envia.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",_e,p(o.$message),1)]))),128))]),"no-option":a(()=>[i(S,null,{default:a(()=>[i(_,{class:"text-grey"},{default:a(()=>r[11]||(r[11]=[V(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onBlur","option-value","option-label"])])):L("",!0),e.transferencia.es_devolucion?L("",!0):(n(),t("div",ke,[r[14]||(r[14]=s("label",{class:"q-mb-sm block"},"Destinatario:",-1)),i(E,{modelValue:e.transferencia.usuario_recibe,"onUpdate:modelValue":r[2]||(r[2]=o=>e.transferencia.usuario_recibe=o),options:e.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.usuario_recibe.$errors.length,"error-message":"Debes seleccionar un usuario","use-input":"",onBlur:e.v$.usuario_recibe.$touch,"input-debounce":"0",onFilter:e.filtrarUsuarios,"option-value":o=>o.id,"option-label":o=>o.nombres+" "+o.apellidos,"emit-value":"","map-options":""},{error:a(()=>[(n(!0),t(b,null,f(e.v$.usuario_recibe.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",qe,p(o.$message),1)]))),128))]),"no-option":a(()=>[i(S,null,{default:a(()=>[i(_,{class:"text-grey"},{default:a(()=>r[13]||(r[13]=[V(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])])),s("div",Ee,[r[15]||(r[15]=s("label",{class:"q-mb-sm block"},"Monto:",-1)),i(T,{modelValue:e.transferencia.monto,"onUpdate:modelValue":r[3]||(r[3]=o=>e.transferencia.monto=o),placeholder:"Obligatorio",disable:e.disabled,type:"number",error:!!e.v$.monto.$errors.length,onBlur:e.v$.monto.$touch,outlined:"",dense:""},{error:a(()=>[(n(!0),t(b,null,f(e.v$.monto.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",Le,p(o.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),s("div",Te,[r[16]||(r[16]=s("label",{class:"q-mb-sm block"},"Cuenta:",-1)),i(T,{modelValue:e.transferencia.cuenta,"onUpdate:modelValue":r[4]||(r[4]=o=>e.transferencia.cuenta=o),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.cuenta.$errors.length,onBlur:e.v$.cuenta.$touch,outlined:"",dense:""},{error:a(()=>[(n(!0),t(b,null,f(e.v$.cuenta.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",Be,p(o.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),e.transferencia.es_devolucion?L("",!0):(n(),t("div",Ne,[r[18]||(r[18]=s("label",{class:"q-mb-sm block"},"Tareas",-1)),i(E,{modelValue:e.transferencia.tarea,"onUpdate:modelValue":r[5]||(r[5]=o=>e.transferencia.tarea=o),options:e.tareas,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.tarea.$errors.length,onFilter:e.filtrarTareas,onBlur:e.v$.tarea.$touch,"error-message":"Debes seleccionar una Tarea","use-input":"","input-debounce":"0","option-value":o=>o.id,"option-label":o=>o.titulo,"emit-value":"","map-options":""},{error:a(()=>[(n(!0),t(b,null,f(e.v$.tarea.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",Ue,p(o.$message),1)]))),128))]),option:a(o=>[i(S,ie(o.itemProps,{class:"q-my-sm"}),{default:a(()=>[i(_,null,{default:a(()=>[i(D,{class:"text-bold text-primary"},{default:a(()=>[V(p(o.opt.codigo_tarea),1)]),_:2},1024),i(D,{caption:""},{default:a(()=>[V(p(o.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[i(S,null,{default:a(()=>[i(_,{class:"text-grey"},{default:a(()=>r[17]||(r[17]=[V(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","onBlur","option-value","option-label"])])),s("div",Ie,[r[19]||(r[19]=s("label",{class:"q-mb-sm block"},"Comprobante ",-1)),i(q,{placeholder:"Obligatorio",imagen:e.transferencia.comprobante,error:!!e.v$.comprobante.$errors.length,"onUpdate:modelValue":r[6]||(r[6]=o=>e.transferencia.comprobante=o)},{error:a(()=>[(n(!0),t(b,null,f(e.v$.comprobante.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",Oe,p(o.$message),1)]))),128))]),_:1},8,["imagen","error"])]),s("div",Qe,[i(ne,{class:"q-mt-lg q-pt-md",modelValue:e.transferencia.es_devolucion,"onUpdate:modelValue":[r[7]||(r[7]=o=>e.transferencia.es_devolucion=o),r[8]||(r[8]=o=>e.existeDevolucion())],label:"\xBFEs devolucion?",disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])]),s("div",De,[r[20]||(r[20]=s("label",{class:"q-mb-sm block"},"Observaci\xF3n",-1)),i(T,{modelValue:e.transferencia.observacion,"onUpdate:modelValue":r[9]||(r[9]=o=>e.transferencia.observacion=o),placeholder:"obligatorio",type:"textarea",disable:e.disabled,error:!!e.v$.observacion.$errors.length,autogrow:"",onBlur:e.v$.observacion.$touch,outlined:"",dense:""},{error:a(()=>[(n(!0),t(b,null,f(e.v$.observacion.$errors,o=>(n(),t("div",{key:o.$uid},[s("div",Ae,p(o.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas"])}var ho=ae(he,[["render",Fe]]);export{ho as default};

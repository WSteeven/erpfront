var O=Object.defineProperty;var R=(a,o,r)=>o in a?O(a,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[o]=r;var E=(a,o,r)=>(R(a,typeof o!="symbol"?o+"":o,r),r);import{Q as $}from"./QPage.e6f8825d.js";import{by as k,s as Q,bh as L,d as x,c as n,bd as U,m as w,u as j,df as i,dg as J,p as K,E as H,bz as G,_ as W,t as h,v as z,P as X,F as Z,y as u,D as y,K as A,x as aa,J as ea,a5 as oa,z as M}from"./index.b8e09611.js";import{M as ta}from"./ModalEntidad.54c9ab3a.js";import{C as ra}from"./ConfirmarDialog.ad75c94e.js";import{E as sa}from"./EssentialTableTabs.03c27e34.js";import{C as ia}from"./ContenedorSimpleMixin.4e22246b.js";import{G as na}from"./Gasto.2c5038cc.js";import{S as la,u as ca,P as ua}from"./utils.9344cd7e.js";import{C as ma,a as da}from"./ComponenteModal.domain.92aacded.js";import{V as pa}from"./VisualizarGastoPage.b378cde5.js";import{u as fa}from"./fondo_rotativo.d6629802.js";import{V as ba}from"./VehiculoController.30a3b5a2.js";import{P as ga}from"./ProyectoController.cb4f7c6c.js";import{T as _a}from"./TareaController.490ce98d.js";import"./QToolbar.afeb6de9.js";import"./position-engine.799c9136.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./EssentialTable.23af6cc8.js";import"./QSelect.b920278b.js";import"./QChip.f8f308fa.js";import"./QItemSection.ec4cc512.js";import"./QMenu.b3fb639b.js";import"./format.8ac60962.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./QPopupProxy.685eacb5.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./i18n-validators.06abe774.js";import"./index.ea415f98.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./EssentialTablePagination.ce808cac.js";import"./entidadAuditable.75a46700.js";import"./QForm.eab79b48.js";import"./TabLayout.45a66130.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./buttonSubmits.f2d72caa.js";import"./index.70965bc7.js";import"./configuracionColumnasGasto.bbc5ae20.js";import"./GastoPusherEvent.56a80be1.js";import"./notificationRealtime.f88c233f.js";import"./AprobarGastoController.b880f375.js";import"./GastoController.a7fe43bc.js";const va=[{name:"id",field:"id",label:"Id",align:"left",sortable:!0},{name:"fecha_viat",field:"fecha_viat",label:"Fecha",align:"left",sortable:!0},{name:"tarea_info",field:"tarea_info",label:"Tarea",align:"left",sortable:!0},{name:"tarea_cliente",field:"tarea_cliente",label:"Tarea cliente",align:"left",sortable:!0},{name:"factura",field:"factura",label:"#Factura",align:"left",sortable:!0},{name:"num_comprobante",field:"num_comprobante",label:"#Comprobante",align:"left",sortable:!0},{name:"ruc",field:"ruc",label:"RUC.",align:"left",sortable:!0},{name:"aut_especial_user",field:"aut_especial_user",label:"Autorizaci\xF3n Especial",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"detalle_info",field:"detalle_info",label:"Detalle",align:"left",sortable:!0},{name:"sub_detalle_info",field:"sub_detalle_info",label:"SubDetalle",align:"left",sortable:!0},{name:"centro_costo",field:"centro_costo",label:"Centro de Costo",align:"left",sortable:!0},{name:"subcentro_costo",field:"subcentro_costo",label:"Sub Centro de Costo",align:"left",sortable:!0},{name:"estado_info",field:"estado_info",label:"Estado	",align:"left",sortable:!0},{name:"detalle_estado",field:"detalle_estado",label:"Descripcion",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha de Creaci\xF3n",align:"left",sortable:!0}];class P extends k{constructor(){super(Q.autorizaciones_gastos)}}class Ca{constructor(){E(this,"VisualizarGastoPage");this.VisualizarGastoPage=L(new ma("Gastos",pa))}}class Da extends da{constructor(){super(new Ca)}}var Ea=x({name:"AutorizarGastoPage",components:{EssentialTableTabs:sa,ConfirmarDialog:ra,ModalEntidad:ta},setup(){const a=new P,o=n(),r=new ia(na,a),{listado:p}=r.useReferencias(),s=new la;U().setQuasar(w()),ca().setQuasar(w());const l=j(),t=fa(),m=n([]),c=n([]),g=n([]),_=n([]),S=new P;async function f(e){s.activar();const{result:d}=await S.listar({estado:e});p.value=d,o.value=e,s.desactivar()}async function T(){m.value=(await new ba().listar({campos:"id,placa"})).result,c.value=(await new H().listar({estado:1})).result}async function N(e){s.activar(),g.value=(await new ga().listar({campos:"id,nombre,codigo_proyecto",finalizado:0,empleado_id:e})).result,_.value=(await new _a().listar({campos:"id,codigo_tarea,titulo,cliente_id,proyecto_id",empleado_id:e,activas_empleado:1,formulario:!0})).result,s.desactivar()}f(i.PENDIENTE),T();const v=new Da,V=n(),F={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:async({entidad:e})=>{s.activar(),t.gasto=e,t.vehiculos=m.value,t.empleados=c.value,t.habilitar_observacion_autorizador=l.user.id===e.aut_especial&&[i.PENDIENTE,i.APROBADO].includes(e.estado)&&q(e.fecha_viat),t.accion_form=l.user.id===e.aut_especial&&e.estado===i.PENDIENTE?G.editar:G.consultar,e.estado===i.PENDIENTE&&await N(e.id_usuario),t.proyectos=g.value,t.tareas=_.value,v.abrirModalEntidad("VisualizarGastoPage"),s.desactivar()}};function q(e){const d=new Date,C=new Date(d.getFullYear(),d.getMonth(),1),b=new Date(C);b.setDate(C.getDate()-1);const Y=new Date(b.getFullYear(),b.getMonth(),1),I=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),D=ua(e,"YYYY-MM-DD","America/Guayaquil");return D>=Y&&D<=I||l.esAdministrador}async function B(){f(i.PENDIENTE)}return{configuracionColumnasAutorizarGasto:va,listado:p,estadosGastos:i,tabAutorizarGasto:J,botonVerModalGasto:F,accionesTabla:K,estaSemanAC:V,guardado:B,filtrarAutorizacionesGasto:f,authenticationStore:l,modales:v}}});const wa={class:"text-center q-pb-md"},Ga={class:"q-my-md"},ha={key:0,class:"q-mb-md"};function za(a,o,r,p,s,l){const t=h("essential-table-tabs"),m=h("modal-entidad");return z(),X($,{padding:!a.$q.screen.xs},{default:Z(()=>{var c;return[u("div",wa,[u("div",Ga,[o[0]||(o[0]=y(" Bienvenido, ")),u("strong",null,A(a.authenticationStore.nombreUsuario),1)]),(c=a.authenticationStore.user)!=null&&c.grupo?(z(),aa("div",ha,[o[1]||(o[1]=y(" Grupo, ")),u("strong",null,A(a.authenticationStore.user.grupo),1)])):ea("",!0)]),u("div",{class:oa([{"bg-desenfoque rounded q-pa-sm":a.$q.screen.xs},"borde custom-shadow rounded"])},[M(t,{configuracionColumnas:[...a.configuracionColumnasAutorizarGasto,a.accionesTabla],datos:a.listado,accion1:a.botonVerModalGasto,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!0,"mostrar-botones":!1,"tab-options":a.tabAutorizarGasto,onTabSeleccionado:a.filtrarAutorizacionesGasto,tabDefecto:"3",ajustarCeldas:""},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"])],2),M(m,{comportamiento:a.modales,onGuardado:a.guardado,mostrarListado:!1},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var ze=W(Ea,[["render",za]]);export{ze as default};

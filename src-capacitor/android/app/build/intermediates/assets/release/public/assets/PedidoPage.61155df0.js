var ro=Object.defineProperty;var to=(e,o,n)=>o in e?ro(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n;var ie=(e,o,n)=>(to(e,typeof o!="symbol"?o+"":o,n),n);import{ac as no,f as Se,k as uo,ak as po,c as g,u as Be,A as mo,s as co,d as bo,R as vo,bd as fo,m as ye,a0 as go,a1 as yo,bz as q,E as Co,a2 as Ce,dc as Vo,d8 as Po,db as wo,bZ as B,cx as ko,bY as Ve,_ as qo,t as L,v as p,x as c,z as i,F as r,a6 as Eo,y as t,I as P,J as b,O as se,B as Pe,j as $o,L as J,bg as we,D as E,K as T,M as So,N as Bo,cL as Lo,a4 as To,P as Ao,G as Do}from"./index.b8e09611.js";import{Q as y,a as U}from"./QSelect.b920278b.js";import{Q as Fo,a as Uo,C as jo}from"./QPopupProxy.685eacb5.js";import{Q as le,a as re}from"./QItemSection.ec4cc512.js";import{Q as ho}from"./QTable.c4bfb038.js";import{Q as zo}from"./QForm.eab79b48.js";import{c as Io,a as Ro}from"./VisualizarPedidoPage.e3ac2fb6.js";import{r as ke,a as j,h as Oo}from"./i18n-validators.06abe774.js";import{u as Qo}from"./index.70965bc7.js";import{u as Mo}from"./selector.e0ee4903.js";import{T as No}from"./TabLayoutFilterTabs2.6bbaa932.js";import{E as Ho}from"./EssentialSelectableTable.ac03bc90.js";import{E as Go,S as Jo}from"./EssentialTable.23af6cc8.js";import{M as Yo}from"./ModalEntidad.54c9ab3a.js";import{C as Ko}from"./ContenedorSimpleMixin.4e22246b.js";import{P as Zo}from"./PedidoController.a6731e75.js";import{P as Wo,u as Xo}from"./pedido.272275e4.js";import{c as _o,a as xo}from"./configuracionColumnasDetallesModal.0b76e70c.js";import{f as ea}from"./index.ea415f98.js";import{C as oa}from"./ClienteController.6128473d.js";import{u as aa,S as ia,s as sa}from"./utils.9344cd7e.js";import{C as la}from"./ComportamientoModalesPedido.44e6fefe.js";import{u as ra}from"./filtrosListadosGenerales.87fcb144.js";import{P as qe}from"./ProyectoController.cb4f7c6c.js";import{T as Ee}from"./TareaController.490ce98d.js";import{E as ta}from"./EtapaController.7c12ac90.js";import{E as na}from"./ErrorComponent.3c1fc91c.js";import{N as da}from"./NoOptionComponent.9c331961.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./use-fullscreen.37810a50.js";import"./TabLayout.45a66130.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPage.e6f8825d.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTablePagination.ce808cac.js";import"./QToolbar.afeb6de9.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./SelectorController.efbca5b9.js";import"./EssentialTableTabs.03c27e34.js";import"./QFile.c79664c6.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.92aacded.js";var ua=no({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:o}){const n=Se(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>uo("tr",{class:n.value},po(o.default))}});function pa(e,o){const n=g(),l=g([]),w=g(),$=Be(),m={refListadoSeleccionable:n,listadoSeleccionable:l,endpoint:o,limpiar:()=>{e.id=null,w.value=null},seleccionar:C=>{e.listadoProductos=[...e.listadoProductos,...C]}},d=Mo(m);return{refListadoSeleccionable:n,listado:l,listar:C=>d.listar(w.value,C),limpiar:()=>m.limpiar(),seleccionar:C=>{let D=[];D=e.listadoProductos.map(a=>a.id);const S=C.filter(a=>!D.includes(a.id));S.forEach(a=>{a.solicitante=$.user.id}),m.seleccionar(S)},criterioBusqueda:w}}function ma(e){if(e===null)return!0;{const o=e.split("-"),n=new Date,l=new Date(+o[2],+o[1]-1,+o[0]);return!ea.req(e)||n<=l}}class ca{constructor(o){ie(this,"pedido");this.pedido=o}async validar(){if(this.pedido.listadoProductos.length===0)throw new Error("Debe agregar al menos un producto al listado");if(this.pedido.listadoProductos.some(o=>o.cantidad==0||o.cantidad==null))throw new Error("Debe ingresar una cantidad mayor a cero en todos los elementos del listado");return!0}}class $e{constructor(){ie(this,"axios");this.axios=mo.getInstance()}async marcarCompletado(o,n){return this.solicitud("/marcar-completado/",o,{motivo:n})}async anular(o,n){return this.solicitud("/anular/",o,{motivo:n})}async solicitud(o,n,l){const w=this.axios.getEndpoint(co.pedidos)+o+n,$=await this.axios.post(w,l);return{response:$,result:$.data.modelo}}}var ba=bo({components:{NoOptionComponent:da,ErrorComponent:na,TabLayoutFilterTabs2:No,EssentialTable:Go,EssentialSelectableTable:Ho,ModalesEntidad:Yo,SelectorImagen:Jo},emits:["guardado"],setup(e,{emit:o}){const n=new Ko(Wo,new Zo),{entidad:l,disabled:w,filtros:$,accion:m,listadosAuxiliares:d,listado:A}=n.useReferencias(),{setValidador:R,obtenerListados:O,cargarVista:C,listar:D,consultar:S,reestablecer:a}=n.useComportamiento(),{onReestablecer:te,onBeforeConsultar:Le,onConsultado:Te,onGuardado:Ae}=n.useHooks(),{confirmar:Y,prompt:K,notificarCorrecto:ne,notificarError:de,notificarAdvertencia:De}=vo(),ue=new la;fo().setQuasar(ye()),aa().setQuasar(ye());const k=new ia,Q=Xo(),u=Be(),Fe=go(),{refListadoSeleccionable:Ue,criterioBusqueda:je,listado:he,listar:ze,limpiar:Ie,seleccionar:Re}=pa(l,"detalles"),f=g("PENDIENTE"),Z=g(!1),pe=g(!1),W=g(!0),M=u.esCoordinador,X=u.esBodeguero,me=u.esTecnico,_=u.esActivosFijos,ce=u.esRecursosHumanos,Oe=u.esGerente,Qe=Se(()=>{var s,v;return["inspecciones","incidentes"].includes((v=(s=yo().name)==null?void 0:s.toString())!=null?v:"")});Ae(s=>o("guardado",s)),te(()=>{Z.value=!1,fe()}),Le(()=>W.value=!1),Te(()=>{W.value=!0,ee.value=d.empleados,m.value===q.editar&&(M||_||u.user.id===l.per_autoriza_id)&&(Z.value=!0),ge(),G(l.proyecto,!1)});const Me=g(!0),Ne=g(!1),He=g(!1),x=g([]),Ge=g("only_sucursal"),Je=[{label:"Solo bodega seleccionada",value:"only_sucursal"},{label:"Solo perteneciente al cliente de la tarea",value:"only_cliente_tarea"},{label:"Todos los elementos",value:"todos"}],{empleados:ee,filtrarEmpleados:Ye,clientes:be,filtrarClientes:Ke,proyectos:oe,filtrarProyectos:Ze,etapas:h,filtrarEtapas:We,tareas:N,filtrarTareas:Xe,sucursales:ae,filtrarSucursales:_e}=ra(d);C(async()=>{fe(),await O({empleados:{controller:new Co,params:{campos:"id,nombres,apellidos,cargo_id",estado:1}},clientes:{controller:new oa,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}},sucursales:JSON.parse(Ce.getItem("sucursales").toString())}),ee.value=d.empleados,N.value=d.tareas,be.value=d.clientes,ae.value=d.sucursales});const xe={justificacion:{required:ke},observacion_aut:{requiredIfCoordinador:j(()=>l.tiene_observacion_aut)},sucursal:{required:ke},per_retira:{requiredIfCheck:j(()=>l.retira_tercero)},responsable:{requiredIfCoordinador:j(()=>(M||!me||ce)&&!l.para_cliente)},etapa:{requiredIf:j(()=>{if(h.value)return h.value.length&&l.proyecto})},tarea:{requiredIfTarea:j(()=>l.es_tarea)},fecha_limite:{required:j(()=>m.value===q.nuevo),fechaMenor:Oo.withMessage("La fecha l\xEDmite debe ser mayor a la fecha actual",ma)&&m.value===q.nuevo}},ve=Qo(xe,l);R(ve.value);const eo=new ca(l);n.agregarValidaciones(eo);async function oo(s){f.value=s,await D({estado:s,paginate:!0}),$.fields={estado:s},pe.value=(M||_||u.esJefeTecnico||Oe||u.esCompras||u.esRecursosHumanos||u.can("puede.autorizar.pedidos"))&&f.value===B.pendiente}function fe(){l.solicitante=u.user.id,l.responsable=u.user.id}async function ge(){k.activar();const s=await new qe().listar({empleado_id:l.responsable,campos:"id,nombre,codigo_proyecto",finalizado:0});d.proyectos=s.result,oe.value=s.result,m.value==q.nuevo?await z(null):await z(l.etapa,!1),k.desactivar()}function H(s=!1,v=!1){m.value==q.nuevo&&(s&&(l.etapa=null),v&&(l.tarea=null))}async function G(s,v){if(k.activar(),l.proyecto){H(s,v);const V=await new ta().listar({etapas_empleado:1,empleado_id:l.responsable,proyecto_id:l.proyecto});if(x.value=V.result,V.result.length<1)await z(null,!1);else{const F=await new Ee().listar({activas_empleado:1,empleado_id:l.responsable,proyecto_id:l.proyecto});d.tareas=F.result,N.value=F.result}d.etapas=x.value,h.value=x.value}else h.value=[],H(!0,!0),await z(null,!1);k.desactivar()}async function z(s,v=!0){k.activar(),H(!1,v);const V=await new Ee().listar({activas_empleado:1,proyecto_id:l.proyecto,etapa_id:s,empleado_id:l.responsable,campos:"id,codigo_tarea,titulo",finalizado:0});d.tareas=V.result,N.value=V.result,k.desactivar()}async function ao(){const s=d.tareas.filter(v=>v.id==l.tarea)[0];s&&(l.cliente_id=s.cliente_id,l.proyecto==null&&(l.proyecto=s.proyecto_id,await G(!0,!0)),l.etapa=s.etapa_id,l.tarea=s.id)}async function io(s=!0){if(s&&(l.proyecto=null),H(!0,!0),k.activar(),l.responsable){const v=await new qe().listar({empleado_id:l.responsable,finalizado:0});d.proyectos=v.result,oe.value=v.result,await G(!1,!1)}else l.es_tarea=!1;k.desactivar()}async function so(){const s=(await new ko().listar({campos:"id,lugar",activo:1})).result;Ce.set("sucursales",JSON.stringify(s)),d.sucursales=s,ae.value=d.sucursales}function lo({posicion:s}){Y("\xBFEst\xE1 seguro de continuar?",()=>l.listadoProductos.splice(s,1))}return{mixin:n,pedido:l,disabled:w,accion:m,v$:ve,acciones:q,configuracionColumnas:Io,tablaRefrescada:W,clientes:be,filtrarClientes:Ke,proyectos:oe,filtrarProyectos:Ze,etapas:h,filtrarEtapas:We,tareas:N,filtrarTareas:Xe,sucursales:ae,filtrarSucursales:_e,empleados:ee,filtrarEmpleados:Ye,estados:Vo,autorizaciones:Po,refListado:Ue,criterioBusquedaProducto:je,listadoProductos:he,listarProductos:ze,limpiarProducto:Ie,seleccionarProducto:Re,configuracionColumnasDetallesModal:_o,configuracionColumnasProductosSeleccionados:xo,configuracionColumnasProductosSeleccionadosDespachado:Ro,botonEditarCantidad:{titulo:"Cantidad",icono:"bi-pencil",accion:({posicion:s})=>{const v={titulo:"Modifica",mensaje:"Ingresa la cantidad",tipo:"number",defecto:l.listadoProductos[s].cantidad,accion:V=>l.listadoProductos[s].cantidad=V};K(v)},visible:()=>m.value!=q.consultar},botonCorregir:{titulo:"Corregir pedido",color:"amber-3",icono:"bi-gear",accion:({entidad:s})=>{Q.pedido=s,ue.abrirModalEntidad("CorregirPedidoPage")},visible:({entidad:s})=>(f.value=="APROBADO"||f.value=="PARCIAL")&&(X||s.per_autoriza_id==u.user.id)&&s.estado!=B.completa},botonEliminar:{titulo:"Quitar",color:"negative",icono:"bi-x",accion:({posicion:s})=>lo({posicion:s}),visible:()=>m.value!=q.consultar},botonImprimir:{titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:s})=>{Q.idPedido=s.id,await Q.imprimirPdf()},visible:()=>f.value=="APROBADO"||f.value=="PARCIAL"||f.value=="COMPLETA"},botonDespachar:{titulo:"Despachar",color:"primary",icono:"bi-pencil-square",accion:({entidad:s})=>{Q.pedido=s,Fe.push("transacciones-egresos")},visible:({entidad:s})=>(f.value=="APROBADO"||f.value=="PARCIAL")&&(X||u.esBodegueroTelconet)&&s.estado!=B.completa},botonAnularAutorizacion:{titulo:"Anular",color:"negative",icono:"bi-x",accion:({entidad:s,posicion:v})=>{Y("\xBFEst\xE1 seguro de anular el pedido?",()=>{K({titulo:"Causa de anulaci\xF3n",mensaje:"Ingresa el motivo de la anulaci\xF3n",accion:async F=>{try{const{result:I}=await new $e().anular(s.id,F);I.autorizacion===Ve.cancelado&&(ne("Pedido anulado con \xE9xito"),A.value.splice(v,1))}catch{de("No se pudo anular, debes ingresar un motivo para la anulaci\xF3n")}}})})},visible:({entidad:s})=>(f.value===Ve.aprobado||f.value===B.parcial)&&((s.per_autoriza_id===u.user.id||s.solicitante_id===u.user.id)&&s.estado===B.pendiente||u.esActivosFijos)||u.esAdministrador},botonMarcarComoCompletado:{titulo:"Marcar Completado",color:"green-6",icono:"bi-check-circle-fill",tooltip:"Marcar pedido como completado",accion:({entidad:s,posicion:v})=>{Y("\xBFEst\xE1 seguro de marcar el pedido como completado?",()=>{K({titulo:"Observaci\xF3n",mensaje:"Ingresa el motivo de marcar como completo el pedido",accion:async F=>{try{const{result:I}=await new $e().marcarCompletado(s.id,F);I.estado===B.completa&&(ne("Pedido marcado completado con \xE9xito"),A.value.splice(v,1))}catch{de("No se pudo completar el pedido, debes ingresar un motivo para la anulaci\xF3n")}}})})},visible:()=>f.value===B.parcial&&u.esBodeguero&&u.esCoordinadorBodega},store:u,modales:ue,soloLectura:Z,all:Me,only_sucursal:Ne,only_cliente_tarea:He,group:Ge,options_groups:Je,tabOptionsPedidos:wo,tabSeleccionado:f,puedeEditar:pe,esCoordinador:M,esCoordinadorBackup:u.esCoordinadorBackup,esBodeguero:X,esTecnico:me,esActivosFijos:_,esRRHH:ce,obtenerProyectosTareasTecnico:io,obtenerEtapasProyecto:G,obtenerTareasEtapa:z,checkEvidencia(s){s||(l.evidencia1="",l.evidencia2="")},checkCliente(s){s?(l.per_retira=null,l.responsable=null):l.cliente=null},checkRetiraTercero(s){s||(l.per_retira=null)},checkEsTarea(s){s?l.responsable?ge():(De("Debes seleccionar primero un empleado (t\xE9cnico) responsable"),l.es_tarea=!1):l.tarea=null},ordenarLista:sa,onRowClick:s=>alert(`${s.name} clicked`),obtenerDatosTareaSeleccionada:ao,filtrarPedidos:oo,recargarSucursales:so,enRutaInspeccionIncidente:Qe,consultar:S,reestablecer:a}}});const va={class:"row q-col-gutter-sm q-py-md"},fa={key:0,class:"col-12 col-md-3"},ga={key:1,class:"col-12 col-md-3"},ya={key:2,class:"col-12 col-md-3"},Ca={class:"col-12 col-md-3"},Va={class:"col-12 col-md-6"},Pa={class:"col-12 col-md-3"},wa={class:"row items-center justify-end"},ka={class:"col-12 col-md-3 q-mb-xl"},qa={key:3,class:"col-12 col-md-3"},Ea={key:4,class:"col-12 col-md-3"},$a={class:"col-12 col-md-3 q-mb-xl"},Sa={key:5,class:"col-12 col-md-3"},Ba={key:6,class:"col-12 col-md-3 q-mb-xl"},La={key:7,class:"col-12 col-md-3"},Ta={key:8,class:"col-12 col-md-3"},Aa={key:9,class:"col-12 col-md-3"},Da={key:10,class:"col-12 col-md-3"},Fa={key:11,class:"col-12 col-md-3 q-mb-md"},Ua={key:12,class:"col-12 col-md-3"},ja={key:13,class:"col-12 col-md-3 q-mb-md"},ha={class:"col-12 col-md-3 q-mb-xl"},za={key:14,class:"col-12 col-md-3"},Ia={key:15,class:"col-12 col-md-3"},Ra={key:16,class:"col-12 col-md-3"},Oa={key:17,class:"col-12 col-md-3"},Qa={key:18,class:"col-12 col-md-3"},Ma={key:19,class:"col-12 col-md-12"},Na={class:"col-12 col-md-12"},Ha={class:"row q-col-gutter-x-xs"},Ga={class:"col-12 col-md-10 q-mb-md"},Ja={class:"col-12 col-md-2"},Ya={class:"col-12"};function Ka(e,o,n,l,w,$){const m=L("no-option-component"),d=L("error-component"),A=L("selector-imagen"),R=L("essential-table"),O=L("essential-selectable-table"),C=L("tab-layout-filter-tabs2"),D=L("modales-entidad");return p(),c(Do,null,[i(C,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Pedido","tab-options":e.tabOptionsPedidos,tabDefecto:e.tabSeleccionado,filtrar:e.filtrarPedidos,permitirEditar:e.puedeEditar,"permitir-cancelar":!e.enRutaInspeccionIncidente,ajustarCeldas:"",paginate:"","mostrar-listado":!e.enRutaInspeccionIncidente,accion1:e.botonDespachar,accion2:e.botonAnularAutorizacion,accion3:e.botonCorregir,accion4:e.botonMarcarComoCompletado,accion5:e.botonImprimir},{formulario:r(()=>[i(zo,{onSubmit:o[37]||(o[37]=Eo(()=>{},["prevent"]))},{default:r(()=>{var S;return[t("div",va,[e.pedido.id?(p(),c("div",fa,[o[38]||(o[38]=t("label",{class:"q-mb-sm block"},"Pedido N\xB0",-1)),i(P,{modelValue:e.pedido.id,"onUpdate:modelValue":o[0]||(o[0]=a=>e.pedido.id=a),placeholder:"Obligatorio",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable"])])):b("",!0),e.pedido.created_at?(p(),c("div",ga,[o[39]||(o[39]=t("label",{class:"q-mb-sm block"},"Fecha",-1)),i(P,{modelValue:e.pedido.created_at,"onUpdate:modelValue":o[1]||(o[1]=a=>e.pedido.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):b("",!0),e.pedido.solicitante?(p(),c("div",ya,[o[40]||(o[40]=t("label",{class:"q-mb-sm block"},"Solicitante",-1)),i(y,{modelValue:e.pedido.solicitante,"onUpdate:modelValue":o[2]||(o[2]=a=>e.pedido.solicitante=a),options:e.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":r(()=>[i(m)]),_:1},8,["modelValue","options","option-label","option-value"])])):b("",!0),t("div",Ca,[o[41]||(o[41]=t("label",{class:"q-mb-sm block"},"Sucursal",-1)),i(y,{modelValue:e.pedido.sucursal,"onUpdate:modelValue":o[3]||(o[3]=a=>e.pedido.sucursal=a),options:e.sucursales,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.soloLectura,error:!!e.v$.sucursal.$errors.length,"error-message":"Debes seleccionar una sucursal","use-input":"","input-debounce":"0",onFilter:e.filtrarSucursales,onPopupShow:o[4]||(o[4]=a=>e.ordenarLista(e.sucursales,"lugar")),"option-label":a=>a.lugar,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":r(()=>[i(m)]),error:r(()=>[i(d,{clave:"sucursal",v$:e.v$},null,8,["v$"])]),after:r(()=>[i(se,{color:"positive",onClick:e.recargarSucursales},{default:r(()=>[i(Pe,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disable","error","onFilter","option-label","option-value"])]),t("div",Va,[o[42]||(o[42]=t("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),i(P,{type:"textarea",autogrow:"",modelValue:e.pedido.justificacion,"onUpdate:modelValue":o[5]||(o[5]=a=>e.pedido.justificacion=a),placeholder:"Obligatorio",disable:e.disabled&&!e.store.esAdministrador||e.soloLectura&&!e.store.esAdministrador,error:!!e.v$.justificacion.$errors.length,outlined:"",dense:"",onBlur:e.v$.justificacion.$touch},{error:r(()=>[i(d,{clave:"justificacion",v$:e.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])]),t("div",Pa,[o[43]||(o[43]=t("label",{class:"q-mb-sm block"},"Fecha limite",-1)),i(P,{modelValue:e.pedido.fecha_limite,"onUpdate:modelValue":o[7]||(o[7]=a=>e.pedido.fecha_limite=a),placeholder:"Obligatorio",error:!!e.v$.fecha_limite.$errors.length,onBlur:e.v$.fecha_limite.$touch,disable:e.disabled||e.soloLectura,outlined:"",dense:""},{append:r(()=>[i(Pe,{name:"event",class:"cursor-pointer"},{default:r(()=>[i(Fo,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[i(Uo,{modelValue:e.pedido.fecha_limite,"onUpdate:modelValue":o[6]||(o[6]=a=>e.pedido.fecha_limite=a),mask:"DD-MM-YYYY","today-btn":""},{default:r(()=>[t("div",wa,[$o(i(se,{label:"Cerrar",color:"primary",flat:""},null,512),[[jo]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),error:r(()=>[i(d,{clave:"fecha_limite",v$:e.v$},null,8,["v$"])]),_:1},8,["modelValue","error","onBlur","disable"])]),t("div",ka,[i(J,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.para_cliente,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.pedido.para_cliente=a),e.checkCliente],label:"\xBFEs material para el cliente?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])]),e.pedido.para_cliente?(p(),c("div",qa,[o[44]||(o[44]=t("label",{class:"q-mb-sm block"},"Cliente",-1)),i(y,{modelValue:e.pedido.cliente,"onUpdate:modelValue":o[9]||(o[9]=a=>e.pedido.cliente=a),options:e.clientes,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarClientes,onPopupShow:o[10]||(o[10]=a=>e.ordenarLista(e.clientes,"razon_social")),"option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):b("",!0),(e.esCoordinador||e.esCoordinadorBackup)&&!e.pedido.para_cliente||e.esRRHH&&!e.pedido.para_cliente||!e.esTecnico&&!e.pedido.para_cliente?(p(),c("div",Ea,[o[45]||(o[45]=t("label",{class:"q-mb-sm block"},"Responsable",-1)),i(y,{modelValue:e.pedido.responsable,"onUpdate:modelValue":[o[11]||(o[11]=a=>e.pedido.responsable=a),e.obtenerProyectosTareasTecnico],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:o[12]||(o[12]=a=>e.ordenarLista(e.empleados,"apellidos")),"error-message":"Debes seleccionar el responsable de los materiales",error:!!e.v$.responsable.$errors.length,disable:e.disabled||e.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":r(()=>[i(m)]),error:r(()=>[i(d,{clave:"responsable",v$:e.v$},null,8,["v$"])]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","error","disable","option-label","option-value"])])):b("",!0),t("div",$a,[i(J,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.retira_tercero,"onUpdate:modelValue":[o[13]||(o[13]=a=>e.pedido.retira_tercero=a),e.checkRetiraTercero],label:"\xBFRetira otra persona?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])]),e.pedido.retira_tercero?(p(),c("div",Sa,[o[46]||(o[46]=t("label",{class:"q-mb-sm block"},"Persona que retira",-1)),i(y,{modelValue:e.pedido.per_retira,"onUpdate:modelValue":o[14]||(o[14]=a=>e.pedido.per_retira=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:o[15]||(o[15]=a=>e.ordenarLista(e.empleados,"apellidos")),"error-message":"Debes seleccionar la persona que retira los materiales",error:!!e.v$.per_retira.$errors.length,disable:e.disabled||e.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":r(()=>[i(m)]),error:r(()=>[i(d,{clave:"per_retira",v$:e.v$},null,8,["v$"])]),_:1},8,["modelValue","options","onFilter","error","disable","option-label","option-value"])])):b("",!0),e.pedido.es_tarea||e.accion==="NUEVO"?(p(),c("div",Ba,[i(J,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.es_tarea,"onUpdate:modelValue":[o[16]||(o[16]=a=>e.pedido.es_tarea=a),e.checkEsTarea],label:"\xBFEs material de proyecto/tarea?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])])):b("",!0),e.pedido.es_tarea||e.pedido.proyecto?(p(),c("div",La,[o[47]||(o[47]=t("label",{class:"q-mb-sm block"},"Proyecto",-1)),i(y,{modelValue:e.pedido.proyecto,"onUpdate:modelValue":[o[17]||(o[17]=a=>e.pedido.proyecto=a),o[18]||(o[18]=a=>e.obtenerEtapasProyecto(!0,!0))],options:e.proyectos,onFilter:e.filtrarProyectos,"transition-show":"scale","transition-hide":"scale",hint:"Opcional","options-dense":"",dense:"",outlined:"",clearable:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",disable:e.disabled||e.soloLectura},{option:r(a=>[i(le,we(a.itemProps,{class:"q-my-sm"}),{default:r(()=>[i(re,null,{default:r(()=>[i(U,{class:"text-bold text-primary"},{default:r(()=>[E(T(a.opt.codigo_proyecto),1)]),_:2},1024),i(U,{caption:""},{default:r(()=>[E(T(a.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[i(m)]),_:1},8,["modelValue","options","onFilter","option-label","option-value","disable"])])):b("",!0),((S=e.etapas)==null?void 0:S.length)||e.pedido.etapa?(p(),c("div",Ta,[o[48]||(o[48]=t("label",{class:"q-mb-sm block"},"Etapa",-1)),i(y,{modelValue:e.pedido.etapa,"onUpdate:modelValue":[o[19]||(o[19]=a=>e.pedido.etapa=a),o[20]||(o[20]=a=>e.obtenerTareasEtapa(e.pedido.etapa))],options:e.etapas,onFilter:e.filtrarEtapas,"transition-show":"scale","transition-hide":"scale",hint:"Obligatorio","options-dense":"",dense:"",clearable:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",disable:e.disabled||e.soloLectura,onBlur:e.v$.etapa.$touch,error:!!e.v$.etapa.$errors.length},{option:r(a=>[i(le,we(a.itemProps,{class:"q-my-sm"}),{default:r(()=>[i(re,null,{default:r(()=>[i(U,{class:"text-bold text-primary"},{default:r(()=>[E(T(a.opt.nombre),1)]),_:2},1024),i(U,{caption:""},{default:r(()=>[E("Supervisor: "+T(a.opt.supervisor_responsable),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[i(m)]),error:r(()=>[i(d,{clave:"etapa",v$:e.v$},null,8,["v$"])]),_:1},8,["modelValue","options","onFilter","option-label","option-value","disable","onBlur","error"])])):b("",!0),e.pedido.es_tarea?(p(),c("div",Aa,[o[49]||(o[49]=t("label",{class:"q-mb-sm block"},"Tarea",-1)),i(y,{modelValue:e.pedido.tarea,"onUpdate:modelValue":[o[21]||(o[21]=a=>e.pedido.tarea=a),e.obtenerDatosTareaSeleccionada],options:e.tareas,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Obligatorio",dense:"",outlined:"",disable:e.disabled||e.soloLectura,error:!!e.v$.tarea.$errors.length,"use-input":"","input-debounce":"0",onFilter:e.filtrarTareas,"error-message":"Debe seleccionar una tarea","option-label":a=>a.codigo_tarea+" - "+a.titulo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:r(a=>[i(le,So(Bo(a.itemProps)),{default:r(()=>[i(re,null,{default:r(()=>[i(U,null,{default:r(()=>[E(T(a.opt.codigo_tarea),1)]),_:2},1024),i(U,{caption:""},{default:r(()=>[E(T(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:r(()=>[i(d,{clave:"tarea",v$:e.v$},null,8,["v$"])]),"no-option":r(()=>[i(m)]),_:1},8,["modelValue","options","disable","error","onFilter","onUpdate:modelValue","option-label","option-value"])])):b("",!0),e.pedido.per_autoriza?(p(),c("div",Da,[o[50]||(o[50]=t("label",{class:"q-mb-sm block"},"Persona que autoriza",-1)),i(y,{modelValue:e.pedido.per_autoriza,"onUpdate:modelValue":o[22]||(o[22]=a=>e.pedido.per_autoriza=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])])):b("",!0),e.pedido.autorizacion?(p(),c("div",Fa,[o[51]||(o[51]=t("label",{class:"q-mb-sm block"},"Autorizacion",-1)),i(y,{modelValue:e.pedido.autorizacion,"onUpdate:modelValue":o[23]||(o[23]=a=>e.pedido.autorizacion=a),options:e.autorizaciones,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.store.user.id!=e.pedido.per_autoriza_id&&!e.store.esCoordinadorBodega,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{"no-option":r(()=>[i(m)]),_:1},8,["modelValue","options","disable","option-value","option-label"])])):b("",!0),e.store.user.id===e.pedido.per_autoriza_id?(p(),c("div",Ua,[o[52]||(o[52]=t("label",{class:"q-mb-sm block"},"Observacion",-1)),i(P,{autogrow:"",modelValue:e.pedido.observacion_aut,"onUpdate:modelValue":o[24]||(o[24]=a=>e.pedido.observacion_aut=a),placeholder:"Opcional",disable:e.disabled||e.soloLectura&&!(e.esCoordinador||e.esActivosFijos||e.store.user.id==e.pedido.per_autoriza_id),error:!!e.v$.observacion_aut.$errors.length,outlined:"",dense:""},{error:r(()=>[i(d,{clave:"observacion_aut",v$:e.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error"])])):b("",!0),e.pedido.estado||e.accion===e.acciones.consultar?(p(),c("div",ja,[o[53]||(o[53]=t("label",{class:"q-mb-sm block"},"Estado del despacho",-1)),i(y,{modelValue:e.pedido.estado,"onUpdate:modelValue":o[25]||(o[25]=a=>e.pedido.estado=a),options:e.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:"","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):b("",!0),t("div",ha,[i(J,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.tiene_evidencia,"onUpdate:modelValue":[o[26]||(o[26]=a=>e.pedido.tiene_evidencia=a),e.checkEvidencia],label:"\xBFTiene evidencia fotogr\xE1fica?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])]),e.pedido.tiene_evidencia||e.pedido.evidencia1?(p(),c("div",za,[o[54]||(o[54]=t("label",{class:"q-mb-sm block"},"Evidencia 1 ",-1)),i(A,{file_extensiones:".jpg, image/*",imagen:e.pedido.evidencia1,alto:"200px","onUpdate:modelValue":o[27]||(o[27]=a=>e.pedido.evidencia1=a)},null,8,["imagen"])])):b("",!0),e.pedido.tiene_evidencia||e.pedido.evidencia2?(p(),c("div",Ia,[o[55]||(o[55]=t("label",{class:"q-mb-sm block"},"Evidencia 2",-1)),i(A,{file_extensiones:".jpg, image/*",imagen:e.pedido.evidencia2,alto:"200px","onUpdate:modelValue":o[28]||(o[28]=a=>e.pedido.evidencia2=a)},null,8,["imagen"])])):b("",!0),e.pedido.observacion_est||e.accion===e.acciones.nuevo?(p(),c("div",Ra,[o[56]||(o[56]=t("label",{class:"q-mb-sm block"},"Observacion",-1)),i(P,{autogrow:"",modelValue:e.pedido.observacion_est,"onUpdate:modelValue":o[29]||(o[29]=a=>e.pedido.observacion_est=a),placeholder:"Opcional",disable:e.disabled||e.soloLectura&&!e.esCoordinador,outlined:"",dense:""},null,8,["modelValue","disable"])])):b("",!0),e.pedido.observacion_bodega?(p(),c("div",Oa,[o[57]||(o[57]=t("label",{class:"q-mb-sm block"},"Observacion del bodeguero",-1)),i(P,{autogrow:"",modelValue:e.pedido.observacion_bodega,"onUpdate:modelValue":o[30]||(o[30]=a=>e.pedido.observacion_bodega=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):b("",!0),e.pedido.estado_orden_compra?(p(),c("div",Qa,[o[58]||(o[58]=t("label",{class:"q-mb-sm block"},"Estado Orden de Compra",-1)),i(P,{autogrow:"",modelValue:e.pedido.estado_orden_compra,"onUpdate:modelValue":o[31]||(o[31]=a=>e.pedido.estado_orden_compra=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):b("",!0),e.accion==e.acciones.nuevo?(p(),c("div",Ma,[i(Lo,{modelValue:e.group,"onUpdate:modelValue":o[32]||(o[32]=a=>e.group=a),options:e.options_groups,color:"primary"},null,8,["modelValue","options"])])):b("",!0),t("div",Na,[o[60]||(o[60]=t("label",{class:"q-mb-sm block"},"Agregar productos",-1)),t("div",Ha,[t("div",Ga,[i(P,{modelValue:e.criterioBusquedaProducto,"onUpdate:modelValue":o[33]||(o[33]=a=>e.criterioBusquedaProducto=a),disable:e.disabled,placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",onKeydown:o[34]||(o[34]=To(a=>e.listarProductos({tipo_busqueda:e.group,search:e.criterioBusquedaProducto,sucursal_id:e.pedido.sucursal,cliente_id:e.pedido.cliente||e.pedido.cliente_id,stock:!0}),["enter"])),onBlur:o[35]||(o[35]=a=>e.criterioBusquedaProducto===""?e.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","disable"])]),t("div",Ja,[i(se,{onClick:o[36]||(o[36]=a=>e.listarProductos({tipo_busqueda:e.group,search:e.criterioBusquedaProducto,sucursal_id:e.pedido.sucursal,cliente_id:e.pedido.cliente||e.pedido.cliente_id,stock:!0})),icon:"search",unelevated:"",color:"positive",class:"full-width",style:{height:"40px"},disable:e.disabled,"no-caps":"",glossy:""},{default:r(()=>o[59]||(o[59]=[E("Buscar")])),_:1},8,["disable"])])])]),t("div",Ya,[e.tablaRefrescada?(p(),Ao(R,{key:0,titulo:"Productos Seleccionados",configuracionColumnas:e.accion===e.acciones.nuevo||e.accion===e.acciones.editar?e.configuracionColumnasProductosSeleccionados:e.configuracionColumnasProductosSeleccionadosDespachado,datos:e.pedido.listadoProductos,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarBotones:!1,accion1:e.botonEditarCantidad,accion2:e.botonEliminar,ajustarCeldas:!0,altoFijo:!1},{body:r(a=>[i(ua,{props:a,onClick:te=>e.onRowClick(a.row)},{default:r(()=>[i(ho,{key:"name",props:a},{default:r(()=>[E(T(a.row.name),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["configuracionColumnas","datos","accion1","accion2"])):b("",!0)])])]}),_:1}),i(O,{ref:"refListado","configuracion-columnas":e.configuracionColumnasDetallesModal,datos:e.listadoProductos,"tipo-seleccion":"multiple",onSelected:e.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar","permitirEditar","permitir-cancelar","mostrar-listado","accion1","accion2","accion3","accion4","accion5"]),i(D,{comportamiento:e.modales},null,8,["comportamiento"])],64)}var ss=qo(ba,[["render",Ka]]);export{ss as default};

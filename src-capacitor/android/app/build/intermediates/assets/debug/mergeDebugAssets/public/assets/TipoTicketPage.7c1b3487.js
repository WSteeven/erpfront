var Z=Object.defineProperty;var x=(e,o,n)=>o in e?Z(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n;var p=(e,o,n)=>(x(e,typeof o!="symbol"?o+"":o,n),n);import{Q,a as q}from"./QItemSection.c6f2640c.js";import{Q as L}from"./QSelect.a8f2bfb2.js";import{c as ee,u as oe,U as te,g as A,be as ie,p as ae,v as re,x as N,y as l,S as se,H as a,D as r,a7 as ne,B as d,G as T,z as m,I as $,J as C,M as y,L as f,K as F,a5 as le,F as de,R as me,aa as pe}from"./index.976e8f3c.js";import{a as ce}from"./QToolbar.cff7174f.js";import{Q as ue}from"./QForm.ed6f6690.js";import{r as D}from"./i18n-validators.06eef631.js";import{u as be}from"./index.ed676411.js";import{i as fe}from"./iconos.5bc406be.js";import{E as ge}from"./EssentialSelectableTable.001f5242.js";import{T as ke}from"./TabLayout.d6dcc414.js";import{E as ve}from"./EssentialTable.d8e6954a.js";import{C as Te}from"./CategoriaTipoTicketController.76f1a755.js";import{D as $e}from"./DepartamentoController.6b5e308b.js";import{C as Ce}from"./ContenedorSimpleMixin.5a0b06ab.js";import{S as ye,i as De,n as Ve}from"./utils.30e08aa2.js";import{T as Se}from"./TipoTicketController.d5ce7c3f.js";import{E as Ee}from"./entidadAuditable.75a46700.js";import{u as Be}from"./useOrquestadorSelectorEmpleados.8099bd32.js";import{c as we}from"./configuracionColumnasEmpleadosLite.5961fbe8.js";import{u as Qe}from"./filtrosListadosGenerales.31e9eb2c.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./index.95f5a0db.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./QPage.ed5d79ca.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./selector.b9804ebb.js";import"./SelectorController.62baf71e.js";const qe=[{name:"nombre",field:"nombre",label:"Nombre del tipo de ticket",align:"left"},{name:"departamento",field:"departamento",label:"Departamento",align:"left"},{name:"categoria_tipo_ticket",field:"categoria_tipo_ticket",label:"Categor\xEDa",align:"left"},{name:"destinatario",field:"destinatario",label:"Destinatario",align:"left"},{name:"activo",field:"activo",label:"Activo",align:"left"}];class Le extends Ee{constructor(){super();p(this,"nombre");p(this,"activo");p(this,"categoria_tipo_ticket");p(this,"categoria_tipo_ticket_id");p(this,"departamento");p(this,"destinatario",null);p(this,"destinatario_id",null);this.nombre=null,this.activo=!0,this.categoria_tipo_ticket=null,this.categoria_tipo_ticket_id=null,this.departamento=null}}var Ae=ee({components:{TabLayout:ke,EssentialTable:ve,EssentialSelectableTable:ge},setup(){const e=oe(),o=new Se,n=new Ce(Le,o),{entidad:s,disabled:V,accion:S,listadosAuxiliares:g,listado:k}=n.useReferencias(),{setValidador:t,cargarVista:h,obtenerListados:U}=n.useComportamiento(),{onReestablecer:I,onConsultado:M}=n.useHooks();h(async()=>{await U({departamentos:new $e,categoriasTiposTickets:new Te}),s.departamento=e.user.departamento});const b=te(),_=A(()=>K.value.filter(i=>i.departamento_id===s.departamento)),E=new ye,R={titulo:({entidad:i})=>i.activo?"Deshabilitar":"Activar",icono:({entidad:i})=>i.activo?"bi-toggle2-off":"bi-toggle2-on",color:({entidad:i})=>i.activo?"negative":"secondary",accion:({entidad:i,posicion:Y})=>{b.confirmar("\xBFEst\xE1 seguro de continuar?",async()=>{try{E.activar();const{response:u,result:v}=await o.editarParcial(i.id,{nombre:i.nombre,activo:!i.activo});k.value.splice(Y,1,v),b.notificarCorrecto(u.data.mensaje)}catch(u){if(De(u)){const v=u.erroresValidacion;Ve(v,b)}else b.notificarError(u.message)}finally{E.desactivar()}})}},{filtrarDepartamentos:j,departamentos:B,categoriasTiposTickets:K,filtrarCategoriasTiposTickets:O}=Qe(g),P=A(()=>B.value.filter(i=>e.esAdministrador?!0:i.responsable_id===e.user.id)),z=()=>{var i;c.value=(i=c.value)!=null?i:null,s.destinatario=c.value?s.destinatario:null},H={nombre:{required:D},departamento:{required:D},categoria_tipo_ticket:{required:D}};ie().setQuasar(ae());const w=be(H,s);t(w.value),I(()=>s.departamento=e.user.departamento),M(()=>{c.value=s.destinatario,s.destinatario=s.destinatario_id});const{refListadoSeleccionable:G,criterioBusqueda:c,listado:J,listar:W,seleccionar:X}=Be(s,"empleados","destinatario");return{v$:w,mixin:n,tipoTicket:s,disabled:V,accion:S,configuracionColumnasTipoTicket:qe,configuracionColumnasEmpleadosLite:we,filtrarDepartamentos:j,departamentos:B,categoriasTiposTicketsComputed:_,filtrarCategoriasTiposTickets:O,btnToggleActivar:R,iconos:fe,resetearDestinatario:z,departamentosComputed:P,refListadoSeleccionableDestinatario:G,criterioBusquedaDestinatario:c,listadoDestinatario:J,listarDestinatario:W,seleccionarDestinatario:X}}});const Ne={class:"row q-col-gutter-sm q-py-md"},Fe={class:"col-12 col-md-3"},he={class:"error-msg"},Ue={key:0,class:"col-12 col-md-3"},Ie={class:"error-msg"},Me={key:1,class:"col-12 col-md-3"},_e={class:"error-msg"},Re={key:2,class:"col-12 col-md-3"},je={key:3,class:"col-12 col-md-3"};function Ke(e,o,n,s,V,S){const g=N("essential-selectable-table"),k=N("tab-layout");return l(),se(k,{mixin:e.mixin,"configuracion-columnas":e.configuracionColumnasTipoTicket,"permitir-eliminar":!1,"permitir-editar":!0,"permitir-consultar":!1,accion1:e.btnToggleActivar,"subtitulo-pagina":"M\xF3dulo de Tickets"},{formulario:a(()=>[r(ue,{onSubmit:o[8]||(o[8]=ne(()=>{},["prevent"]))},{default:a(()=>[d("div",Ne,[d("div",Fe,[o[10]||(o[10]=d("label",{class:"q-mb-sm block"},"Seleccione un departamento",-1)),r(L,{modelValue:e.tipoTicket.departamento,"onUpdate:modelValue":[o[0]||(o[0]=t=>e.tipoTicket.departamento=t),o[1]||(o[1]=t=>e.tipoTicket.categoria_tipo_ticket=null)],options:e.departamentosComputed,onFilter:e.filtrarDepartamentos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":t=>t.nombre,"option-value":t=>t.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",error:!!e.v$.departamento.$errors.length,onBlur:e.v$.departamento.$touch},{"no-option":a(()=>[r(Q,null,{default:a(()=>[r(q,{class:"text-grey"},{default:a(()=>o[9]||(o[9]=[T(" No hay resultados ")])),_:1})]),_:1})]),error:a(()=>[(l(!0),m($,null,C(e.v$.departamento.$errors,t=>(l(),m("div",{key:t.$uid},[d("div",he,y(t.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","error","onBlur"])]),e.tipoTicket.departamento?(l(),m("div",Ue,[o[12]||(o[12]=d("label",{class:"q-mb-sm block"},"Seleccione una categor\xEDa",-1)),r(L,{modelValue:e.tipoTicket.categoria_tipo_ticket,"onUpdate:modelValue":o[2]||(o[2]=t=>e.tipoTicket.categoria_tipo_ticket=t),options:e.categoriasTiposTicketsComputed,onFilter:e.filtrarCategoriasTiposTickets,"transition-show":"scale","transition-hide":"scale",hint:"Obligatorio","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":t=>t.nombre,"option-value":t=>t.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",error:!!e.v$.categoria_tipo_ticket.$errors.length,onBlur:e.v$.categoria_tipo_ticket.$touch},{"no-option":a(()=>[r(Q,null,{default:a(()=>[r(q,{class:"text-grey"},{default:a(()=>o[11]||(o[11]=[T(" No hay resultados ")])),_:1})]),_:1})]),error:a(()=>[(l(!0),m($,null,C(e.v$.categoria_tipo_ticket.$errors,t=>(l(),m("div",{key:t.$uid},[d("div",Ie,y(t.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","error","onBlur"])])):f("",!0),e.tipoTicket.categoria_tipo_ticket?(l(),m("div",Me,[o[13]||(o[13]=d("label",{class:"q-mb-sm block"},"Nombre del tipo de ticket",-1)),r(F,{modelValue:e.tipoTicket.nombre,"onUpdate:modelValue":o[3]||(o[3]=t=>e.tipoTicket.nombre=t),placeholder:"Obligatorio",disable:e.disabled,autofocus:"",outlined:"",dense:"",error:!!e.v$.nombre.$errors.length},{error:a(()=>[(l(!0),m($,null,C(e.v$.nombre.$errors,t=>(l(),m("div",{key:t.$uid},[d("div",_e,y(t.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])])):f("",!0),e.tipoTicket.categoria_tipo_ticket?(l(),m("div",Re,[o[15]||(o[15]=d("label",{class:"q-mb-sm block"},"Destinatario",-1)),r(F,{modelValue:e.criterioBusquedaDestinatario,"onUpdate:modelValue":o[4]||(o[4]=t=>e.criterioBusquedaDestinatario=t),placeholder:"Escriba y presione enter para buscar",hint:"Puede buscar por nombre, apellido o identificaci\xF3n",disable:e.disabled,onKeydown:o[5]||(o[5]=le(t=>e.listarDestinatario({departamento_id:e.tipoTicket.departamento,estado:1}),["enter"])),onBlur:o[6]||(o[6]=t=>e.resetearDestinatario()),outlined:"",dense:""},{append:a(()=>[r(de,{name:e.tipoTicket.destinatario?"bi-check-circle-fill":"bi-check-circle",color:e.tipoTicket.destinatario?"positive":"grey-6",size:"xs"},null,8,["name","color"])]),after:a(()=>[r(me,{color:"positive",icon:e.iconos.buscar,onClick:e.listarDestinatario,unelevated:"",dense:""},{default:a(()=>[r(ce,null,{default:a(()=>o[14]||(o[14]=[T("Recargar empleados")])),_:1})]),_:1},8,["icon","onClick"])]),_:1},8,["modelValue","disable"])])):f("",!0),e.tipoTicket.categoria_tipo_ticket?(l(),m("div",je,[o[16]||(o[16]=d("br",null,null,-1)),r(pe,{modelValue:e.tipoTicket.activo,"onUpdate:modelValue":o[7]||(o[7]=t=>e.tipoTicket.activo=t),"checked-icon":"check",disable:e.disabled,label:"Activo",color:"positive"},null,8,["modelValue","disable"])])):f("",!0)])]),_:1})]),modales:a(()=>[r(g,{ref:"refListadoSeleccionableDestinatario","configuracion-columnas":e.configuracionColumnasEmpleadosLite,datos:e.listadoDestinatario,onSelected:e.seleccionarDestinatario,"tipo-seleccion":"single"},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracion-columnas","accion1"])}var Uo=re(Ae,[["render",Ke]]);export{Uo as default};

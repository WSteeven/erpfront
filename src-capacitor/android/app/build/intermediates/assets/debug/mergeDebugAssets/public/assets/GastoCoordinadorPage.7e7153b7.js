var R=Object.defineProperty;var H=(o,e,t)=>e in o?R(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var n=(o,e,t)=>(H(o,typeof e!="symbol"?e+"":e,t),t);import{Q as f,a as K}from"./QSelect.a8f2bfb2.js";import{bz as J,t as W,c as X,be as Y,p as Z,u as _,e as w,bA as k,cv as x,dk as oo,v as eo,x as S,y as $,S as ao,H as l,D as i,a7 as io,B as s,K as q,O as lo,P as no,G as so,M as ro,aa as F,z as y,L as B}from"./index.976e8f3c.js";import{Q as to,a as U}from"./QItemSection.c6f2640c.js";import{Q as uo}from"./QForm.ed6f6690.js";import{E as mo}from"./entidadAuditable.75a46700.js";import{T as po}from"./TabLayoutFilterTabs2.f1a01a4e.js";import{N as bo}from"./NoOptionComponent.ffe820c8.js";import{S as co}from"./EssentialTable.d8e6954a.js";import{E as vo}from"./ErrorComponent.b482e77d.js";import{u as go}from"./index.ed676411.js";import{r as p,b as fo,a as $o}from"./i18n-validators.06eef631.js";import{C as Co}from"./ContenedorSimpleMixin.5a0b06ab.js";import{M as Vo}from"./MotivoGastoController.10b2bdb1.js";import{G as ho}from"./GrupoController.9c11e3c7.js";import{u as wo}from"./filtrosListadosGenerales.31e9eb2c.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./utils.30e08aa2.js";import"./QPage.ed5d79ca.js";import"./EssentialTableTabs.c7e98bba.js";import"./QBadge.1ddeabfd.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./buttonSubmits.2eb37d38.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./index.95f5a0db.js";class ko extends mo{constructor(){super();n(this,"fecha_gasto");n(this,"lugar");n(this,"grupo");n(this,"lugar_info");n(this,"motivo");n(this,"motivo_info");n(this,"monto");n(this,"observacion");n(this,"id_usuario");n(this,"empleado_info");n(this,"revisado");n(this,"estado");n(this,"observacion_contabilidad");this.fecha_gasto=null,this.lugar=null,this.grupo=null,this.lugar_info=null,this.motivo=null,this.motivo_info=null,this.monto=null,this.observacion=null,this.id_usuario=null,this.empleado_info=null,this.revisado=!1,this.estado=null,this.observacion_contabilidad=null}}class So extends J{constructor(){super(W.gasto_coordinador)}}const qo=[{name:"fecha_gasto",field:"fecha_gasto",label:"Fecha",align:"left",sortable:!0},{name:"lugar_info",field:"lugar_info",label:"Lugar",align:"left",sortable:!0},{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"left",sortable:!0},{name:"motivo_info",field:"motivo_info",label:"Motivo",align:"left",sortable:!0},{name:"observacion",field:"observacion",label:"Observacion",align:"left",sortable:!0},{name:"revisado",field:"revisado",label:"Revisado",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];var yo=X({components:{TabLayoutFilterTabs2:po,NoOptionComponent:bo,SelectorImagen:co,ErrorComponent:vo},setup(){Y().setQuasar(Z());const o=_(),{esContabilidad:e}=o,t=new Co(ko,new So),{entidad:b,disabled:G,accion:c,listadosAuxiliares:r}=t.useReferencias(),{setValidador:u,obtenerListados:C,cargarVista:a,consultar:m,listar:V}=t.useComportamiento(),{onModificado:h}=t.useHooks(),v=w("1"),j=[{nombre:"Pendiente",id:1},{nombre:"Completa",id:2},{nombre:"Anulado",id:4}],D={lugar:{required:p},grupo:{required:p},monto:{required:p},motivo:{required:p},observacion:{required:p,minLength:fo(25)},observacion_contabilidad:{required:$o(()=>e&&c.value===k.editar&&b.estado!=1)}},M=go(D,b);u(M.value);const g=w([]),N=w([]),{cantones:O,filtrarCantones:I,grupos:Q,filtrarGrupos:T}=wo(r);a(async()=>{await C({cantones:{controller:new x,params:{campos:"id,canton"}},motivos:{controller:new Vo,params:{campos:"id,nombre"}},grupos:{controller:new ho,params:{campos:"id,nombre"}}}),O.value=r.cantones,g.value=r.motivos,Q.value=r.grupos}),h(async()=>await E("1"));async function E(d){v.value=d,await V({estado_id:d})}function A(d,L){if(d===""){L(()=>{g.value=r.motivos});return}L(()=>{const P=d.toLowerCase();g.value=r.motivos.filter(z=>z.nombre.toLowerCase().indexOf(P)>-1)})}return{mixin:t,gasto:b,cantones:O,grupos:Q,motivos:g,disabled:G,accion:c,acciones:k,v$:M,configuracionColumnas:qo,autorizacionesEspeciales:N,estados:j,filtrarGrupos:T,filtrarCantones:I,filtrarMotivos:A,editarGasto:{titulo:" ",icono:"bi-pencil-square",color:"secondary",visible:({entidad:d})=>d.usuario==o.user.id&&v.value==="1",accion:({entidad:d})=>{c.value=k.editar,m(d)}},tabDefecto:v,tabOptions:oo,filtrarSolicitudes:E,esContabilidad:e}}});const Bo={class:"row q-col-gutter-sm q-mb-md"},Go={class:"col-12 col-md-3"},Mo={class:"col-12 col-md-3"},Oo={class:"col-12 col-md-3"},Qo={class:"col-12 col-md-3"},Eo={class:"col-12 col-md-12"},Lo={key:0,class:"col-12 col-md-3"},Fo={key:1,class:"col-12 col-md-3 q-mb-md"},Uo={key:2,class:"col-12 col-md-6"};function jo(o,e,t,b,G,c){const r=S("error-component"),u=S("no-option-component"),C=S("tab-layout-filter-tabs2");return $(),ao(C,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Solicitudes de fondos para vi\xE1ticos","tab-options":o.tabOptions,"tab-defecto":o.tabDefecto,"permitir-editar":o.esContabilidad,filtrar:o.filtrarSolicitudes,accion1:o.editarGasto,ajustarCeldas:""},{formulario:l(()=>[i(uo,{onSubmit:e[8]||(e[8]=io(()=>{},["prevent"]))},{default:l(()=>[s("div",Bo,[s("div",Go,[e[9]||(e[9]=s("label",{class:"q-mb-sm block"},"Lugar",-1)),i(f,{modelValue:o.gasto.lugar,"onUpdate:modelValue":e[0]||(e[0]=a=>o.gasto.lugar=a),options:o.cantones,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.lugar.$errors.length,"error-message":"Debes seleccionar un canton","use-input":"","input-debounce":"0",onFilter:o.filtrarCantones,onBlur:o.v$.lugar.$touch,"option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},{error:l(()=>[i(r,{clave:"lugar",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(u)]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","onBlur","option-value","option-label"])]),s("div",Mo,[e[10]||(e[10]=s("label",{class:"q-mb-sm block"},"Monto",-1)),i(q,{modelValue:o.gasto.monto,"onUpdate:modelValue":e[1]||(e[1]=a=>o.gasto.monto=a),placeholder:"Obligatorio",type:"number",autogrow:"",disable:o.disabled,error:!!o.v$.monto.$errors.length,onBlur:o.v$.monto.$touch,outlined:"",dense:""},{error:l(()=>[i(r,{clave:"monto",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])]),s("div",Oo,[e[11]||(e[11]=s("label",{class:"q-mb-sm block"},"Grupo",-1)),i(f,{modelValue:o.gasto.grupo,"onUpdate:modelValue":e[2]||(e[2]=a=>o.gasto.grupo=a),options:o.grupos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.grupo.$errors.length,"error-message":"Debes seleccionar un grupo","use-input":"","input-debounce":"0",onFilter:o.filtrarGrupos,onBlur:o.v$.grupo.$touch,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[i(r,{clave:"grupo",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(u)]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","onBlur","option-value","option-label"])]),s("div",Qo,[e[12]||(e[12]=s("label",{class:"q-mb-sm block"},"Motivo",-1)),i(f,{modelValue:o.gasto.motivo,"onUpdate:modelValue":e[3]||(e[3]=a=>o.gasto.motivo=a),options:o.motivos,"transition-show":"jump-up","transition-hide":"jump-down",disable:o.disabled,"options-dense":"",multiple:"",dense:"","use-chips":"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarMotivos,onBlur:o.v$.motivo.$touch,error:!!o.v$.motivo.$errors.length,"error-message":"Debes seleccionar uno o varios sub_detalle","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{option:l(({itemProps:a,opt:m,selected:V,toggleOption:h})=>[i(to,lo(no(a)),{default:l(()=>[i(U,null,{default:l(()=>[so(ro(m.nombre)+" ",1),i(K,{"inner-h-t-m-l":m.nombre},null,8,["inner-h-t-m-l"])]),_:2},1024),i(U,{side:""},{default:l(()=>[i(F,{"model-value":V,"onUpdate:modelValue":v=>h(m)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),error:l(()=>[i(r,{clave:"motivo",v$:o.v$},null,8,["v$"])]),"no-option":l(()=>[i(u)]),_:1},8,["modelValue","options","disable","onFilter","onBlur","error","option-value","option-label"])]),s("div",Eo,[e[13]||(e[13]=s("label",{class:"q-mb-sm block"},"Descripcion",-1)),i(q,{modelValue:o.gasto.observacion,"onUpdate:modelValue":e[4]||(e[4]=a=>o.gasto.observacion=a),placeholder:"Obligatorio",autogrow:"",disable:o.disabled,error:!!o.v$.observacion.$errors.length,hint:"Escriba su requerimiento al que desea pedir el gasto",onBlur:o.v$.observacion.$touch,outlined:"",dense:""},{error:l(()=>[i(r,{clave:"observacion",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])]),[o.acciones.consultar,o.acciones.editar].includes(o.accion)?($(),y("div",Lo,[e[14]||(e[14]=s("label",{class:"q-mb-sm block"},"\xBFSolicitud revisada?",-1)),i(F,{label:o.gasto.revisado?"SI":"NO",modelValue:o.gasto.revisado,"onUpdate:modelValue":e[5]||(e[5]=a=>o.gasto.revisado=a),color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear",disable:""},null,8,["label","modelValue"])])):B("",!0),[o.acciones.consultar,o.acciones.editar].includes(o.accion)?($(),y("div",Fo,[e[15]||(e[15]=s("label",{color:"light-green-2",class:"text-positive text-bold q-mb-sm inline-block bg-light-green-2 rounded q-px-md"},"Estado ",-1)),i(f,{modelValue:o.gasto.estado,"onUpdate:modelValue":e[6]||(e[6]=a=>o.gasto.estado=a),options:o.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:!o.esContabilidad,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},null,8,["modelValue","options","disable","option-value","option-label"])])):B("",!0),o.esContabilidad||o.gasto.observacion_contabilidad!=null?($(),y("div",Uo,[e[16]||(e[16]=s("label",{class:"q-mb-sm block"},"Observaci\xF3n contabilidad",-1)),i(q,{modelValue:o.gasto.observacion_contabilidad,"onUpdate:modelValue":e[7]||(e[7]=a=>o.gasto.observacion_contabilidad=a),placeholder:"Obligatorio",autogrow:"",disable:o.disabled||!o.esContabilidad,error:!!o.v$.observacion_contabilidad.$errors.length,hint:"Escriba su observaci\xF3n al marcar como completada o anulada la solicitud",onBlur:o.v$.observacion_contabilidad.$touch,outlined:"",dense:""},{error:l(()=>[i(r,{clave:"observacion_contabilidad",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","disable","error","onBlur"])])):B("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tab-defecto","permitir-editar","filtrar","accion1"])}var qe=eo(yo,[["render",jo]]);export{qe as default};

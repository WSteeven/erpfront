var jo=Object.defineProperty;var ho=(o,e,f)=>e in o?jo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var c=(o,e,f)=>(ho(o,typeof e!="symbol"?e+"":e,f),f);import{bz as To,t as Qo,c as Bo,U as Mo,be as Oo,p as eo,u as Ho,a1 as Ro,g as S,e as V,E as Go,a4 as Ko,bA as C,w as Jo,a3 as ao,q as Wo,v as Xo,x as ro,y as n,S as io,H as t,D as i,a7 as Yo,B as s,z as d,K as w,L as g,G as u,N as h,a5 as Zo,I as k,J as L,M as b,Q as q}from"./index.976e8f3c.js";import{Q as v,a as m}from"./QItemSection.c6f2640c.js";import{Q as E}from"./QSelect.a8f2bfb2.js";import{Q as _o}from"./use-fullscreen.0ccd26e6.js";import{Q as xo}from"./QForm.ed6f6690.js";import{r as D}from"./i18n-validators.06eef631.js";import{u as oe}from"./index.ed676411.js";import{T as ee}from"./TabLayoutFilterTabs2.f1a01a4e.js";import{E as ae,a2 as re,a3 as ie,a8 as le}from"./EssentialTable.d8e6954a.js";import{E as te}from"./EssentialSelectableTable.001f5242.js";import{M as se}from"./ModalEntidad.84100166.js";import{E as ne}from"./EssentialPopupEditableTable.9b9b765e.js";import{C as de}from"./ContenedorSimpleMixin.5a0b06ab.js";import{P as lo,u as ue}from"./proforma.e59e88e0.js";import{u as me,$ as pe,a0 as ce,a1 as T,a3 as fe,C as be}from"./utils.30e08aa2.js";import{u as ve}from"./filtrosListadosGenerales.31e9eb2c.js";import{u as ge}from"./preorden.984b7be7.js";import{C as Ve}from"./ClienteController.f53ff018.js";import{E as ye}from"./entidadAuditable.75a46700.js";import{E as Pe}from"./EmpleadoPermisosController.f86af0cf.js";import{a as ze}from"./index.95f5a0db.js";import{U as we}from"./UnidadMedidaController.8c5dd68e.js";import{u as Ce}from"./configuracion_general.ef04b031.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./QPage.ed5d79ca.js";import"./EssentialTableTabs.c7e98bba.js";import"./QBadge.1ddeabfd.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./buttonSubmits.2eb37d38.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./ConfiguracionController.65de3fc5.js";const Ee=[{name:"id",field:"id",label:"N\xB0",align:"left",sortable:!0},{name:"codigo",field:"codigo",label:"C\xF3digo",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0},{name:"solicitante",field:"solicitante",label:"Solicitante",align:"left",sortable:!0},{name:"cliente",field:"cliente",label:"Cliente",align:"left",sortable:!0},{name:"autorizador",field:"autorizador",label:"Autorizador",align:"left",sortable:!0},{name:"autorizacion",field:"autorizacion",label:"Autorizaci\xF3n",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado Prefacturado",align:"left",sortable:!0}],to=[{name:"cantidad",field:"cantidad",label:"Cantidad",type:"number",align:"left",editable:!0,sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 200px; overflow: auto;",align:"left",editable:!0,sortable:!0},{name:"unidad_medida",field:"unidad_medida",label:"Medida",align:"left",type:"select",editable:!0,sortable:!0},{name:"precio_unitario",field:"precio_unitario",label:"Precio U",hint:"Precio unitario",type:"number",align:"left",editable:!0,sortable:!0},{name:"facturable",field:"facturable",label:"\xBFFacturable?",type:"toggle",align:"center",default:!0,editable:!0,sortable:!0},{name:"grava_iva",field:"grava_iva",label:"\xBFIVA?",align:"center",type:"toggle",default:!0,editable:!0,sortable:!0},{name:"iva",field:"iva",label:"IVA",align:"right",type:"number",editable:!1,sortable:!0},{name:"porcentaje_descuento",field:"porcentaje_descuento",hint:"Porcentaje de descuento",label:"% desc.",align:"left",type:"number",editable:!0,sortable:!0},{name:"descuento",field:"descuento",hint:"Desc.",label:"Desc.",align:"right",type:"number",editable:!1,sortable:!0},{name:"subtotal",field:"subtotal",label:"Subtotal",align:"right",type:"number",editable:!1,sortable:!0},{name:"total",field:"total",label:"Total",align:"right",type:"number",editable:!1,sortable:!0}];class so extends To{constructor(){super(Qo.proformas)}}class Fe{constructor(e){c(this,"proforma");this.proforma=e}async validar(){if(this.proforma.listadoProductos.length==0)throw new Error("Debe agregar al menos un item al listado");if(this.proforma.listadoProductos.some(e=>e.descripcion==null||e.descripcion==null))throw new Error("El campo descripci\xF3n no puede ser vac\xEDo");return!0}}class Se extends ye{constructor(){super();c(this,"cantidad");c(this,"descripcion");c(this,"facturable");c(this,"grava_iva");c(this,"iva");c(this,"porcentaje_descuento");c(this,"descuento");c(this,"precio_unitario");c(this,"subtotal");c(this,"total");c(this,"unidad_medida");this.cantidad=null,this.descripcion=null,this.facturable=!0,this.grava_iva=!0,this.iva=null,this.porcentaje_descuento=null,this.descuento=null,this.precio_unitario=null,this.subtotal=null,this.total=null,this.unidad_medida=null}}var qe=Bo({components:{TabLayoutFilterTabs2:ee,EssentialSelectableTable:te,EssentialTable:ae,ModalesEntidad:se,EssentialPopupEditableTable:ne},emits:["actualizar","fila-modificada"],setup(o,{emit:e}){const f=new de(lo,new so),{entidad:l,disabled:Q,accion:P,listadosAuxiliares:z,listado:A}=f.useReferencias(),{setValidador:a,obtenerListados:no,cargarVista:uo,listar:mo}=f.useComportamiento(),{onReestablecer:po,onConsultado:co,onModificado:fo}=f.useHooks(),{confirmar:B,prompt:bo,notificarCorrecto:vo,notificarError:go}=Mo();Oo().setQuasar(eo()),me().setQuasar(eo());const p=Ho(),Vo=ge(),N=ue(),yo=Ro(),M=Ce(),O=S(()=>l.listadoProductos.reduce((r,y)=>r+pe(y),0).toFixed(2)),I=S(()=>l.listadoProductos.reduce((r,y)=>r+ce(y),0).toFixed(2)),H=S(()=>l.listadoProductos.reduce((r,y)=>r+parseFloat(y.subtotal),0).toFixed(2)),R=S(()=>l.descuento_general==0?l.listadoProductos.reduce((r,y)=>r+parseFloat(y.descuento),0).toFixed(2):l.descuento_general),U=S(()=>(I.value*l.iva/100).toFixed(2)),Po=S(()=>l.descuento_general>0?(Number(H.value)+Number(U.value)-Number(R.value)).toFixed(2):(Number(I.value)+Number(O.value)+Number(U.value)).toFixed(2)),G=V("1"),F=V(),$=V(!1),K=V(!1),zo=V(),{clientes:J,filtrarClientes:wo}=ve(z),W=V([]),X=V([]),Y=V([]),Z=V([]),_=V([]);uo(async()=>{await no({unidades_medidas:new we,empleados:{controller:new Go,params:{campos:"id,nombres,apellidos,cargo_id",estado:1}},autorizadores:{controller:new Pe,params:{permisos:["puede.autorizar.proformas"]}},clientes:{controller:new Ve,params:{estado:1}}}),l.autorizacion=1,to.find(r=>r.field==="unidad_medida").options=z.unidades_medidas.map(r=>({value:r.id,label:r.nombre}))}),Ko(()=>{var r;return l.iva=(r=M.configuracion)==null?void 0:r.iva}),po(()=>{var r;l.created_at=T(new Date().getDate().toLocaleString()),l.iva=(r=M.configuracion)==null?void 0:r.iva,l.solicitante=p.user.id,$.value=!1,l.autorizacion=1}),co(()=>{P.value===C.editar&&(p.user.id===l.autorizador||p.user.id===l.solicitante)?($.value=!1,l.autorizacion=null):$.value=!0}),fo(()=>{oo("1")});const Co={cliente:{required:D},autorizacion:{requiredIfEdita:ze(()=>P.value===C.editar&&l.autorizador===p.user.id)},autorizador:{required:D},descripcion:{required:D},forma:{required:D},tiempo:{required:D}},x=oe(Co,l);a(x.value);const Eo=new Fe(l);f.agregarValidaciones(Eo),l.created_at=T(new Date().getDate().toLocaleString()),l.solicitante=p.user.id;function oo(r){G.value=r,F.value=r,K.value=r=="1"||r=="2",mo({autorizacion_id:r,solicitante_id:p.user.id})}function Fo({posicion:r}){B("\xBFEst\xE1 seguro de continuar?",()=>l.listadoProductos.splice(r,1))}function j(r){r.subtotal=r.facturable?(Number(r.cantidad)*Number(r.precio_unitario)).toFixed(4):0,r.descuento=r.facturable&&l.descuento_general==0?fe(r.subtotal,r.porcentaje_descuento,4):0,r.iva=r.grava_iva&&r.facturable?((Number(r.cantidad)*Number(r.precio_unitario)-Number(r.descuento))*l.iva/100).toFixed(4):0,r.total=r.facturable?(Number(r.cantidad)*Number(r.precio_unitario)+Number(r.iva)-Number(r.descuento)).toFixed(4):0}function So(){l.listadoProductos.forEach(r=>{j(r)})}function qo(){l.descuento_general>0&&l.listadoProductos.forEach(r=>{r.porcentaje_descuento=0,j(r)})}async function No(){if(l.id_aux){const{result:r}=await new so().consultar(l.id_aux);await l.hydrate(r),l.id=null,l.solicitante=p.user.id,l.created_at=T(new Date().getDate().toLocaleString()),l.autorizacion=1,l.estado=1,l.observacion_aut=null}else l.hydrate(new lo)}const Do={titulo:"Agregar \xEDtem",icono:"bi-arrow-bar-down",color:"positive",tooltip:"Agregar elemento",accion:()=>{const r=new Se;r.id=l.listadoProductos.length?be(l.listadoProductos)+1:1,r.unidad_medida=1,l.listadoProductos.push(r),e("actualizar",l.listadoProductos)},visible:()=>P.value===C.nuevo||P.value===C.editar&&l.solicitante===p.user.id},$o={titulo:"Eliminar",icono:"bi-x",color:"negative",accion:({posicion:r})=>{Fo({posicion:r})},visible:()=>P.value==C.nuevo||P.value==C.editar},ko={titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:r})=>{N.idProforma=r.id,await N.imprimirPdf()},visible:()=>F.value>1},Lo={titulo:"Generar Prefactura",color:"primary",icono:"bi-cart-check",accion:({entidad:r})=>{N.proforma=r,yo.push("prefacturas")},visible:()=>F.value==2},Ao={titulo:"Anular",color:"negative",icono:"bi-x",accion:async({entidad:r,posicion:y})=>{B("\xBFEst\xE1 seguro de anular la proforma?",()=>{bo({titulo:"Causa de anulaci\xF3n",mensaje:"Ingresa el motivo de anulaci\xF3n",accion:async Io=>{try{N.idProforma=r.id,(await N.anularProforma({motivo:Io})).status==200&&(vo("Se ha anulado correctamente la proforma"),A.value.splice(y,1))}catch{go("No se pudo anular, debes ingresar un motivo para la anulaci\xF3n")}}})})},visible:({entidad:r})=>F.value==1?r.autorizacion_id==1&&(r.solicitante_id==p.user.id||r.autorizador_id==p.user.id):F.value==2&&p.esCompras||F.value==2&&(r.solicitante_id==p.user.id||r.autorizador_id==p.user.id)};return Jo(zo,()=>{}),W.value=z.empleados,X.value=z.categorias,J.value=z.clientes,Y.value=JSON.parse(ao.getItem("autorizaciones").toString()),_.value=z.autorizadores,Z.value=JSON.parse(ao.getItem("estados_transacciones").toString()),{mixin:f,proforma:l,disabled:Q,accion:P,v$:x,acciones:C,configuracionColumnas:Ee,accionesTabla:Wo,configuracionColumnasDetallesProforma:to,empleados:W,categorias:X,clientes:J,autorizaciones:Y,estados:Z,empleadosAutorizadores:_,opcionesForma:re,opcionesTiempo:ie,store:p,preorden:Vo.preorden,soloLectura:$,btnEliminarFila:$o,btnImprimir:ko,btnAnularProforma:Ao,btnAddRow:Do,btnHacerPrefactura:Lo,tabOptionsProformas:le,tabDefecto:G,puedeEditar:K,filtrarProformas:oo,calcularValores:j,filtrarClientes:wo,actualizarListado:So,actualizarDescuento:qo,cargarProformaBD:No,subtotal_sin_impuestos:O,subtotal_con_impuestos:I,subtotal:H,total:Po,descuento:R,iva:U}}});const Ne={class:"row q-col-gutter-sm q-py-md"},De={key:0,class:"col-12 col-md-3"},$e={key:1,class:"col-12 col-md-3"},ke={class:"col-12 col-md-3"},Le={key:2,class:"col-12 col-md-3 q-mb-xl"},Ae={key:3,class:"col-12 col-md-3"},Ie={class:"col-12 col-md-3"},Ue={key:4,class:"col-12 col-md-3 q-mb-md"},je={class:"error-msg"},he={key:5,class:"col-12 col-md-3"},Te={class:"col-12 col-md-3"},Qe={class:"col-12 col-md-6"},Be={class:"error-msg"},Me={class:"col-12 col-md-3"},Oe={class:"error-msg"},He={class:"col-12 col-md-3"},Re={class:"error-msg"},Ge={key:6,class:"col-12 col-md-3 q-mb-md"},Ke={key:7,class:"col-12 col-md-3 q-mb-md"},Je={key:8,class:"col-12 col-md-3 q-mb-xl"},We={class:"col-12 col-md-3 q-mb-md"},Xe={key:9,class:"col-12 col-md-3 q-mb-xl"},Ye={class:"col-12 col-md-3 q-mb-md"},Ze={class:"col-12"},_e={class:"col-12"},xe={class:"row q-col-xs-4 q-col-xs-offset-8 flex-end justify-end"};function oa(o,e,f,l,Q,P){const z=ro("essential-popup-editable-table"),A=ro("tab-layout-filter-tabs2");return n(),io(A,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Proforma","tab-options":o.tabOptionsProformas,tabDefecto:o.tabDefecto,filtrar:o.filtrarProformas,ajustarCeldas:!0,permitirEditar:o.puedeEditar,permitirEliminar:!1,accion1:o.btnHacerPrefactura,accion2:o.btnImprimir,accion3:o.btnAnularProforma},{formulario:t(()=>[i(xo,{onSubmit:e[18]||(e[18]=Yo(()=>{},["prevent"]))},{default:t(()=>[s("div",Ne,[o.proforma.id?(n(),d("div",De,[e[19]||(e[19]=s("label",{class:"q-mb-sm block"},"Proforma N\xB0",-1)),i(w,{modelValue:o.proforma.id,"onUpdate:modelValue":e[0]||(e[0]=a=>o.proforma.id=a),placeholder:"Obligatorio",disable:"",readonly:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly"])])):g("",!0),o.proforma.solicitante?(n(),d("div",$e,[e[21]||(e[21]=s("label",{class:"q-mb-sm block"},"Solicitante",-1)),i(E,{modelValue:o.proforma.solicitante,"onUpdate:modelValue":e[1]||(e[1]=a=>o.proforma.solicitante=a),options:o.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:!0,readonly:o.disabled||o.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":t(()=>[i(v,null,{default:t(()=>[i(m,{class:"text-grey"},{default:t(()=>e[20]||(e[20]=[u(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","readonly","option-label","option-value"])])):g("",!0),s("div",ke,[e[22]||(e[22]=s("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),i(w,{modelValue:o.proforma.created_at,"onUpdate:modelValue":e[2]||(e[2]=a=>o.proforma.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])]),o.accion===o.acciones.nuevo?(n(),d("div",Le,[i(h,{class:"q-mt-lg q-pt-md",modelValue:o.proforma.copia_proforma,"onUpdate:modelValue":e[3]||(e[3]=a=>o.proforma.copia_proforma=a),label:"\xBFCopiar proforma?",disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable"])])):g("",!0),o.proforma.copia_proforma?(n(),d("div",Ae,[e[23]||(e[23]=s("label",{class:"q-mb-sm block"},"Id Proforma",-1)),i(w,{type:"number",modelValue:o.proforma.id_aux,"onUpdate:modelValue":e[4]||(e[4]=a=>o.proforma.id_aux=a),placeholder:"Obligatorio",hint:"Ingresa un numero de proforma y presiona Enter",onKeyup:Zo(o.cargarProformaBD,["enter"]),disable:o.disabled||o.soloLectura||o.proforma.autorizador===o.store.user.id,outlined:"",dense:""},null,8,["modelValue","onKeyup","disable"])])):g("",!0),s("div",Ie,[e[25]||(e[25]=s("label",{class:"q-mb-sm block"},"Persona que autoriza",-1)),i(E,{modelValue:o.proforma.autorizador,"onUpdate:modelValue":e[5]||(e[5]=a=>o.proforma.autorizador=a),options:o.empleadosAutorizadores,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",error:!!o.v$.autorizador.$errors.length,"error-message":"Debes seleccionar al menos una opcion",disable:o.disabled||o.soloLectura||o.proforma.autorizador===o.store.user.id,"option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":t(()=>[i(v,null,{default:t(()=>[i(m,{class:"text-grey"},{default:t(()=>e[24]||(e[24]=[u(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","disable","option-label","option-value"])]),o.proforma.autorizador?(n(),d("div",Ue,[e[27]||(e[27]=s("label",{class:"q-mb-sm block"},"Autorizacion",-1)),i(E,{modelValue:o.proforma.autorizacion,"onUpdate:modelValue":e[6]||(e[6]=a=>o.proforma.autorizacion=a),options:o.autorizaciones,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",error:!!o.v$.autorizacion.$errors.length,"error-message":"Debes seleccionar una autorizacion",onBlur:o.v$.autorizacion.$touch,disable:o.disabled||o.proforma.autorizador!==o.store.user.id,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:t(()=>[(n(!0),d(k,null,L(o.v$.autorizacion.$errors,a=>(n(),d("div",{key:a.$uid},[s("div",je,b(a.$message),1)]))),128))]),"no-option":t(()=>[i(v,null,{default:t(()=>[i(m,{class:"text-grey"},{default:t(()=>e[26]||(e[26]=[u(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","onBlur","disable","option-value","option-label"])])):g("",!0),o.store.user.id===o.proforma.autorizador_id||o.proforma.observacion_aut?(n(),d("div",he,[e[28]||(e[28]=s("label",{class:"q-mb-sm block"},"Observacion",-1)),i(w,{autogrow:"",modelValue:o.proforma.observacion_aut,"onUpdate:modelValue":e[7]||(e[7]=a=>o.proforma.observacion_aut=a),placeholder:"Opcional",disable:o.disabled||o.soloLectura&&!(o.esCoordinador||o.esActivosFijos||o.store.user.id==o.proforma.autorizador_id),outlined:"",dense:""},null,8,["modelValue","disable"])])):g("",!0),s("div",Te,[e[30]||(e[30]=s("label",{class:"q-mb-sm block"},"Cliente",-1)),i(E,{modelValue:o.proforma.cliente,"onUpdate:modelValue":e[8]||(e[8]=a=>o.proforma.cliente=a),options:o.clientes,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarClientes,error:!!o.v$.cliente.$errors.length,"error-message":"Debes seleccionar al menos una opcion",disable:o.disabled||o.soloLectura||o.proforma.autorizador===o.store.user.id,"option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":t(()=>[i(v,null,{default:t(()=>[i(m,{class:"text-grey"},{default:t(()=>e[29]||(e[29]=[u(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","error","disable","option-label","option-value"])]),s("div",Qe,[e[31]||(e[31]=s("label",{class:"q-mb-sm block"},"Descripci\xF3n",-1)),i(w,{type:"textarea",autogrow:"",modelValue:o.proforma.descripcion,"onUpdate:modelValue":e[9]||(e[9]=a=>o.proforma.descripcion=a),placeholder:"Obligatorio",disable:o.disabled||o.soloLectura||o.proforma.autorizador===o.store.user.id,error:!!o.v$.descripcion.$errors.length,outlined:"",dense:""},{error:t(()=>[(n(!0),d(k,null,L(o.v$.descripcion.$errors,a=>(n(),d("div",{key:a.$uid},[s("div",Be,b(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])]),s("div",Me,[e[33]||(e[33]=s("label",{class:"q-mb-sm block"},"Forma",-1)),i(E,{modelValue:o.proforma.forma,"onUpdate:modelValue":e[10]||(e[10]=a=>o.proforma.forma=a),options:o.opcionesForma,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",error:!!o.v$.forma.$errors.length,disable:o.disabled||o.soloLectura||o.proforma.autorizador===o.store.user.id,"option-label":a=>a.label,"option-value":a=>a.value,"emit-value":"","map-options":""},{"no-option":t(()=>[i(v,null,{default:t(()=>[i(m,{class:"text-grey"},{default:t(()=>e[32]||(e[32]=[u(" No hay resultados ")])),_:1})]),_:1})]),error:t(()=>[(n(!0),d(k,null,L(o.v$.forma.$errors,a=>(n(),d("div",{key:a.$uid},[s("div",Oe,b(a.$message),1)]))),128))]),_:1},8,["modelValue","options","error","disable","option-label","option-value"])]),s("div",He,[e[35]||(e[35]=s("label",{class:"q-mb-sm block"},"Tiempo",-1)),i(E,{modelValue:o.proforma.tiempo,"onUpdate:modelValue":e[11]||(e[11]=a=>o.proforma.tiempo=a),options:o.opcionesTiempo,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",error:!!o.v$.tiempo.$errors.length,disable:o.disabled||o.soloLectura||o.proforma.autorizador===o.store.user.id,readonly:o.disabled||o.soloLectura,"option-label":a=>a.label,"option-value":a=>a.value,"emit-value":"","map-options":""},{"no-option":t(()=>[i(v,null,{default:t(()=>[i(m,{class:"text-grey"},{default:t(()=>e[34]||(e[34]=[u(" No hay resultados ")])),_:1})]),_:1})]),error:t(()=>[(n(!0),d(k,null,L(o.v$.tiempo.$errors,a=>(n(),d("div",{key:a.$uid},[s("div",Re,b(a.$message),1)]))),128))]),_:1},8,["modelValue","options","error","disable","readonly","option-label","option-value"])]),o.proforma.estado||o.accion===o.acciones.consultar?(n(),d("div",Ge,[e[36]||(e[36]=s("label",{class:"q-mb-sm block"},"Estado de la Proforma",-1)),i(E,{modelValue:o.proforma.estado,"onUpdate:modelValue":e[12]||(e[12]=a=>o.proforma.estado=a),options:o.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:"","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):g("",!0),o.proforma.causa_anulacion?(n(),d("div",Ke,[e[37]||(e[37]=s("label",{class:"q-mb-sm block"},"Causa de anulaci\xF3n",-1)),i(w,{modelValue:o.proforma.causa_anulacion,"onUpdate:modelValue":e[13]||(e[13]=a=>o.proforma.causa_anulacion=a),autogrow:"",outlined:"",dense:"",disable:""},null,8,["modelValue"])])):g("",!0),o.accion===o.acciones.nuevo?(n(),d("div",Je,[i(h,{class:"q-mt-lg q-pt-md",modelValue:o.proforma.modificar_iva,"onUpdate:modelValue":e[14]||(e[14]=a=>o.proforma.modificar_iva=a),label:"Modificar IVA establecido",disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable"])])):g("",!0),s("div",We,[e[38]||(e[38]=s("label",{class:"q-mb-sm block"},"IVA general",-1)),i(w,{modelValue:o.proforma.iva,"onUpdate:modelValue":[e[15]||(e[15]=a=>o.proforma.iva=a),o.actualizarListado],outlined:"",dense:"",type:"number",step:".01",suffix:"%",disable:!o.proforma.modificar_iva},null,8,["modelValue","disable","onUpdate:modelValue"])]),o.accion===o.acciones.nuevo||o.accion===o.acciones.editar?(n(),d("div",Xe,[i(h,{class:"q-mt-lg q-pt-md",modelValue:o.proforma.modificar_descuento,"onUpdate:modelValue":e[16]||(e[16]=a=>o.proforma.modificar_descuento=a),label:"\xBFAplicar descuento a toda la proforma?",disable:o.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])])):g("",!0),s("div",Ye,[e[39]||(e[39]=s("label",{class:"q-mb-sm block"},"Descuento general",-1)),i(w,{modelValue:o.proforma.descuento_general,"onUpdate:modelValue":[e[17]||(e[17]=a=>o.proforma.descuento_general=a),o.actualizarDescuento],outlined:"",dense:"",placeholder:"OPCIONAL",hint:"INGRESA LA CANTIDAD DE DESCUENTO EN $",type:"number",step:".01",disable:!o.proforma.modificar_descuento},null,8,["modelValue","disable","onUpdate:modelValue"])]),s("div",Ze,[i(z,{ref:"refItems",titulo:"Productos Seleccionados",configuracionColumnas:o.accion==o.acciones.nuevo||o.accion==o.acciones.editar&&o.proforma.solicitante==o.store.user.id?[...o.configuracionColumnasDetallesProforma,o.accionesTabla]:o.configuracionColumnasDetallesProforma,datos:o.proforma.listadoProductos,separador:"cell",permitirEditarCeldas:o.accion==o.acciones.nuevo||o.accion==o.acciones.editar&&o.proforma.solicitante==o.store.user.id,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,altoFijo:!1,accion1Header:o.btnAddRow,accion1:o.btnEliminarFila,onFilaModificada:o.calcularValores},null,8,["configuracionColumnas","datos","permitirEditarCeldas","accion1Header","accion1","onFilaModificada"])]),s("div",_e,[s("div",xe,[o.proforma.listadoProductos.length>0?(n(),io(_o,{key:0,bordered:"",separator:"",dense:""},{default:t(()=>[i(v,null,{default:t(()=>[i(m,null,{default:t(()=>e[40]||(e[40]=[u("Subtotal: ")])),_:1}),i(q,{vertical:""}),i(m,{avatar:""},{default:t(()=>[u(b(o.subtotal),1)]),_:1})]),_:1}),i(v,null,{default:t(()=>[i(m,null,{default:t(()=>e[41]||(e[41]=[u("Subtotal 0%: ")])),_:1}),i(q,{vertical:""}),i(m,{avatar:""},{default:t(()=>[u(b(o.subtotal_sin_impuestos),1)]),_:1})]),_:1}),i(v,null,{default:t(()=>[i(m,null,{default:t(()=>[u("Subtotal ("+b(o.proforma.iva)+" %): ",1)]),_:1}),i(q,{vertical:""}),i(m,{avatar:""},{default:t(()=>[u(b(o.subtotal_con_impuestos),1)]),_:1})]),_:1}),i(v,null,{default:t(()=>[i(m,{class:"q-mr-md"},{default:t(()=>e[42]||(e[42]=[u("Descuento: ")])),_:1}),i(q,{vertical:""}),i(m,{avatar:""},{default:t(()=>[u(b(o.descuento),1)]),_:1})]),_:1}),i(v,null,{default:t(()=>[i(m,null,{default:t(()=>[u("IVA ("+b(o.proforma.iva)+" %): ",1)]),_:1}),i(q,{vertical:""}),i(m,{avatar:""},{default:t(()=>[u(b(o.iva),1)]),_:1})]),_:1}),i(v,null,{default:t(()=>[i(m,null,{default:t(()=>e[43]||(e[43]=[u("Total: ")])),_:1}),i(q,{vertical:""}),i(m,{avatar:""},{default:t(()=>[u(b(o.total),1)]),_:1})]),_:1})]),_:1})):g("",!0)])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar","permitirEditar","accion1","accion2","accion3"])}var Ya=Xo(qe,[["render",oa]]);export{Ya as default};

import{m as x,e as a,c as R,U as V,A as w,bH as U,q as _,v as D,x as I,y as b,z as E,B as A,S as Q,aa as G,L as j,D as C,bI as N,I as H}from"./index.976e8f3c.js";import{Q as L}from"./QUploader.43bbdad9.js";import{c as O}from"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import{h as z,m as M}from"./utils.30e08aa2.js";import{E as J}from"./EssentialTable.d8e6954a.js";const K=x("subtarea",()=>{const e=a(),t=a(),s=a(),u=a(),d=a(),m=a(),n=a(),l=a(),f=a(),v=a(),c=a(),h=a(),S=a(),i=a(),p=a(),g=a();return{idTarea:e,codigoTarea:t,idSubtareaSeleccionada:s,codigoTareaSeleccionada:d,codigoSubtareaSeleccionada:m,tareaTieneSubtareas:l,idCliente:n,fechaHoraSuspendido:f,motivoSuspendido:v,posicionSubtareaSeleccionada:u,accion:c,observacionTarea:h,subtareaEsVentana:S,fechaInicioTrabajo:i,horaInicioTrabajo:p,horaFinTrabajo:g}});var P=R({components:{EssentialTable:J},props:{mixin:{type:Object,required:!0},endpoint:{type:Object,required:!0},entidad:Object,disable:{type:Boolean,default:!1},permitirEliminar:{type:Boolean,default:!0},listarAlGuardar:{type:Boolean,default:!0},permitirSubir:{type:Boolean,default:!0},label:{type:String,default:"Quiero compartir archivos"},multiple:{type:Boolean,default:!0}},setup(e){const t=K(),{listado:s}=e.mixin.useReferencias(),{eliminar:u,listar:d}=e.mixin.useComportamiento(),{notificarCorrecto:m,notificarError:n,notificarAdvertencia:l,confirmar:f}=V();function v(o){d(o)}let c;const h={titulo:"Eliminar",icono:"bi-trash3",color:"negative",visible:()=>e.permitirEliminar,accion:async({entidad:o})=>{f("Esta operaci\xF3n es irreversible. El archivo se eliminar\xE1 de forma instant\xE1nea.",()=>u(o))}},S={titulo:"Descargar",icono:"bi-download",color:"positive",accion:({entidad:o})=>M(o.ruta)},i=a(),p=w.getInstance(),g=`${U.URL_BASE}/${p.getEndpoint(e.endpoint)}`,B=a(!1);async function T(o){var q;const y=new FormData;y.append("file",o[0]);for(let r in c)y.append(r,c[r]);try{const r=await p.post(g,y);o.value=[],e.listarAlGuardar&&s.value.push(r.data.modelo),m(r.data.mensaje),B.value=!1}catch(r){n((q=r.response)==null?void 0:q.data.mensaje)}}async function F(o){c=o,i.value&&(await i.value.upload(),i.value.reset(),i.value.removeUploadedFiles(),i.value.removeQueuedFiles())}function k(o){l("El tama\xF1o total de los archivos no deben exceder los 10mb.")}function $(){s.value=[]}return{listado:s,refGestor:i,extraerExtension:o=>o.split(".").at(-1),formatBytes:z,quiero_subir_archivos:B,columnas:[...O,_],codigoSubtareaSeleccionada:t.codigoSubtareaSeleccionada,onRejected:k,btnEliminar:h,btnDescargar:S,factoryFn:T,subir:F,listarArchivos:v,limpiarListado:$}}});const W={class:"col-12 col-md-3 q-mb-lg"},X={key:0,class:"col-12 q-mb-sm"},Y={key:1,class:"col-12 q-mb-sm"};function Z(e,t,s,u,d,m){const n=I("essential-table");return b(),E(H,null,[A("div",W,[t[1]||(t[1]=A("br",null,null,-1)),e.permitirSubir?(b(),Q(G,{key:0,modelValue:e.quiero_subir_archivos,"onUpdate:modelValue":t[0]||(t[0]=l=>e.quiero_subir_archivos=l),label:e.label,disable:e.disable,"checked-icon":"bi-eye",color:"positive",outlined:"",dense:""},null,8,["modelValue","label","disable"])):j("",!0)]),e.quiero_subir_archivos?(b(),E("div",X,[C(L,{ref:"refGestor",label:"Selecciona o arrastra tus archivos aqu\xED (M\xE1ximo 10mb)",multiple:e.multiple,style:{width:"100%"},flat:"",factory:e.factoryFn,class:"bg-header-collapse expansion",color:"white","text-color":"black","max-total-size":"10485760",onRejected:e.onRejected,"hide-upload-btn":""},null,8,["multiple","factory","onRejected"])])):j("",!0),N(e.$slots,"boton-subir"),e.listado.length?(b(),E("div",Y,[C(n,{titulo:`Existen ${e.listado.length} archivos compartidos hasta el momento`,configuracionColumnas:e.columnas,datos:e.listado,"alto-fijo":!1,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-footer":!1,"mostrar-botones":!1,"permitir-buscar":!1,accion1:e.btnDescargar,accion2:e.btnEliminar},null,8,["titulo","configuracionColumnas","datos","accion1","accion2"])])):j("",!0)],64)}var se=D(P,[["render",Z]]);export{se as A,K as u};

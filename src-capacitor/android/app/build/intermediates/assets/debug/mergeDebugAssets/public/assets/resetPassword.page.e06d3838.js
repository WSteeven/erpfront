var _=Object.defineProperty;var F=(e,s,t)=>s in e?_(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var c=(e,s,t)=>(F(e,typeof s!="symbol"?s+"":s,t),t);import{u as E,a1 as z,bG as S,c as B,f as Q,e as v,U,be as x,p as V,g,v as j,y as i,S as h,H as p,B as r,z as u,D as n,a9 as A,L as P,a7 as G,F as b,K as y,J as M,I as w,R as $,a6 as O,G as C}from"./index.976e8f3c.js";import{Q as D}from"./QPage.ed5d79ca.js";import{V as I}from"./style.b3ed7dbf.js";import{S as J,u as T,i as Z,n as H}from"./utils.30e08aa2.js";import{u as K}from"./configuracion_general.ef04b031.js";import"./_commonjsHelpers.8402d862.js";import"./format.8ac60962.js";import"./ConfiguracionController.65de3fc5.js";class W{constructor(){c(this,"nombreUsuario");c(this,"password_old");c(this,"password");c(this,"password_confirmation");this.nombreUsuario=null,this.password_old=null,this.password=null,this.password_confirmation=null}}class X{constructor(){c(this,"store",E());c(this,"Router",z())}async actualizarContrasena(s){try{await this.store.actualizarContrasena(s),this.Router.replace("/login")}catch(t){const f=t;throw new S(f)}}}var Y=B({name:"ResetPassword",components:{LottiePlayer:I},setup(){const e=Q(new W),s=z(),t=v(!1),f=E(),q=new X,m=U(),o=new J;e.nombreUsuario=f.getNombreusuario(),e.nombreUsuario===void 0&&s.replace("/login"),x().setQuasar(V()),T().setQuasar(V());const l=K(),L=g(()=>{var d;const a=(d=e.password)!=null?d:"";return{longitud:a.length>=8,contieneNumero:/\d/.test(a),contieneLetra:/[a-zA-Z]/.test(a),contieneEspecial:/[@.\-/*]/.test(a)}});function k(){e.password="",e.password_confirmation=""}async function R(){t.value=!0;try{o.activar();const a=e.password,d=e.password_old;if(!d||!a){m.notificarError("Debe llenar todos los campos de contrase\xF1a.");return}if(!/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[@.\-/*]).{8,}$/.test(a)){m.notificarError("La nueva contrase\xF1a debe tener al menos 8 caracteres, 1 n\xFAmero, 1 letra (may\xFAscula o min\xFAscula) y 1 car\xE1cter especial (@.-/*)."),k();return}if(a===d){m.notificarError("La nueva contrase\xF1a no puede ser igual a la anterior."),k();return}await q.actualizarContrasena(e),m.notificarCorrecto("Contrase\xF1a actualizada correctamente")}catch(a){if(Z(a)){const d=a.erroresValidacion;await H(d,m)}}finally{o.desactivar(),t.value=!1}}const N=g(()=>e.password_old!==""&&e.password!==""&&e.password===e.password_confirmation);return{resetPassword:e,isPwd:v(!0),isPwdold:v(!0),isPwdConfirm:v(!0),enviando:t,enableLoginButton:N,reglasContrasena:L,resetearPassword:R,logoClaro:g(()=>{var a;return(a=l.configuracion)==null?void 0:a.logo_claro}),logoOscuro:g(()=>{var a;return(a=l.configuracion)==null?void 0:a.logo_oscuro})}}});const ee={class:"row items-center"},se={key:0,class:"col-12 col-md-8 text-center q-pa-lg"},oe={class:"imagen d-flex align-items-center justify-content-center"},ae=["src"],re={class:"col-12 col-md-4 column items-center bg-body-table justify-center window-height"},te=["src"],ne={class:"col-12 q-mb-sm"},ie={class:"col-12 q-mb-sm"},le={class:"col-12 q-mb-sm"},de={class:"q-mt-sm q-mb-sm"},ce={class:"col-12"};function ue(e,s,t,f,q,m){return i(),h(D,{class:""},{default:p(()=>[r("div",ee,[!e.$q.screen.xs&&!e.$q.screen.sm?(i(),u("div",se,[r("div",oe,[n(A,{square:"",size:"400px"},{default:p(()=>[r("img",{src:e.$q.dark.isActive?e.logoOscuro:e.logoClaro,alt:"logo"},null,8,ae)]),_:1})])])):P("",!0),r("div",re,[e.$q.screen.xs?(i(),h(A,{key:0,square:"",size:"120px",class:"q-mx-auto block q-mb-md"},{default:p(()=>[r("img",{src:e.$q.dark.isActive?e.logoOscuro:e.logoClaro,alt:"logo"},null,8,te)]),_:1})):P("",!0),r("form",{onSubmit:s[7]||(s[7]=G((...o)=>e.resetearPassword&&e.resetearPassword(...o),["prevent"])),class:"full-width q-px-lg"},[s[9]||(s[9]=r("div",{class:"q-mb-sm"},[r("h2",null,"Bienvenidos a JPCONSTRUCRED"),r("span",null,"Cambia tu contrase\xF1a")],-1)),r("div",ne,[n(y,{modelValue:e.resetPassword.password_old,"onUpdate:modelValue":s[1]||(s[1]=o=>e.resetPassword.password_old=o),label:"Contrase\xF1a antigua",outlined:"",dense:"",type:e.isPwdold?"password":"text",hint:"Porfavor ingrese la contrase\xF1a antigua"},{append:p(()=>[n(b,{name:e.isPwdold?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[0]||(s[0]=o=>e.isPwdold=!e.isPwdold)},null,8,["name"])]),_:1},8,["modelValue","type"])]),r("div",ie,[n(y,{modelValue:e.resetPassword.password,"onUpdate:modelValue":s[3]||(s[3]=o=>e.resetPassword.password=o),label:"Contrase\xF1a Nueva",outlined:"",dense:"",type:e.isPwd?"password":"text",hint:"Requisitos: M\xEDnimo 8 caracteres, 1 n\xFAmero, 1 letra, Caracter especiales ( @.-/* ), contrase\xF1a diferente a la anterior."},{append:p(()=>[n(b,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[2]||(s[2]=o=>e.isPwd=!e.isPwd)},null,8,["name"])]),_:1},8,["modelValue","type"])]),r("div",le,[n(y,{modelValue:e.resetPassword.password_confirmation,"onUpdate:modelValue":s[5]||(s[5]=o=>e.resetPassword.password_confirmation=o),label:"Confirmar Contrase\xF1a",outlined:"",dense:"",type:e.isPwdConfirm?"password":"text",hint:"Porfavor confirme su contrase\xF1a"},{append:p(()=>[n(b,{name:e.isPwdConfirm?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[4]||(s[4]=o=>e.isPwdConfirm=!e.isPwdConfirm)},null,8,["name"])]),_:1},8,["modelValue","type"])]),r("div",de,[s[8]||(s[8]=r("div",{class:"text-subtitle2 q-mb-xs"}," Requisitos de la contrase\xF1a: ",-1)),(i(!0),u(w,null,M(e.reglasContrasena,(o,l)=>(i(),u("div",{key:l,class:"row items-center q-gutter-xs q-mb-xs"},[n(b,{name:o?"check_circle":"cancel",color:o?"green":"red",size:"16px"},null,8,["name","color"]),r("span",{class:O([o?"text-green-7":"text-red-7","text-caption"])},[l==="longitud"?(i(),u(w,{key:0},[C("M\xEDnimo 8 caracteres")],64)):l==="contieneNumero"?(i(),u(w,{key:1},[C("Al menos un n\xFAmero")],64)):l==="contieneLetra"?(i(),u(w,{key:2},[C("Al menos una letra")],64)):l==="contieneEspecial"?(i(),u(w,{key:3},[C("Caracter especial (@ . - / *)")],64)):P("",!0)],2)]))),128))]),r("div",ce,[n($,{color:"primary",label:"Actualizar contrase\xF1a",class:"full-width q-mb-sm",disabled:!e.enableLoginButton,"no-caps":"",unelevated:"",onClick:s[6]||(s[6]=o=>e.resetearPassword())},null,8,["disabled"]),n($,{color:"primary",label:"Volver al inicio de sesi\xF3n",class:"full-width q-mb-sm","no-caps":"",flat:"",to:{name:"Login"}})])],32)])])]),_:1})}var qe=j(Y,[["render",ue]]);export{qe as default};

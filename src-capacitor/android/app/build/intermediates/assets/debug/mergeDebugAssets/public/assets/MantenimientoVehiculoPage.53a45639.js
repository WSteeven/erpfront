var j=Object.defineProperty;var G=(e,o,d)=>o in e?j(e,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[o]=d;var r=(e,o,d)=>(G(e,typeof o!="symbol"?o+"":o,d),d);import{bz as Z,t as K,c as H,U as J,be as W,p as R,u as X,e as Y,E as _,bA as x,q as ee,s as oe,v as ae,x as F,y as t,S as ie,H as l,D as i,a7 as le,B as s,z as n,K as m,L as p,G as b,O as se,P as te,M as u,F as ne,k as re,R as de,I as f,J as g}from"./index.976e8f3c.js";import{Q as V,a as h}from"./QItemSection.c6f2640c.js";import{Q as k,a as Q}from"./QSelect.a8f2bfb2.js";import{Q as me,a as ue,C as pe}from"./QPopupProxy.d8ef7a42.js";import{Q as be}from"./QForm.ed6f6690.js";import{a as $}from"./i18n-validators.06eef631.js";import{u as ve,S as ce}from"./utils.30e08aa2.js";import{u as fe}from"./index.ed676411.js";import{T as ge}from"./TabLayoutFilterTabs2.f1a01a4e.js";import{S as Ve}from"./EssentialTable.d8e6954a.js";import{C as he}from"./ContenedorSimpleMixin.5a0b06ab.js";import{E as ke}from"./entidadAuditable.75a46700.js";import{u as $e}from"./filtrosListadosGenerales.31e9eb2c.js";import{V as ye}from"./VehiculoController.fd9db948.js";import{S as Ee}from"./ServicioController.b2e406e5.js";import{v as Se,w as Oe}from"./vehiculos.utils.c31e027d.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./index.95f5a0db.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPage.ed5d79ca.js";import"./EssentialTableTabs.c7e98bba.js";import"./QBadge.1ddeabfd.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./buttonSubmits.2eb37d38.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";const ze=[{name:"vehiculo",field:"vehiculo",label:"Placa",align:"left",sortable:!0},{name:"empleado",field:"empleado",label:"Chofer",align:"left",sortable:!0},{name:"servicio",field:"servicio",label:"Servicio",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];class qe extends ke{constructor(){super();r(this,"vehiculo");r(this,"servicio");r(this,"empleado");r(this,"supervisor");r(this,"fecha_realizado");r(this,"km_realizado");r(this,"imagen_evidencia");r(this,"estado");r(this,"km_retraso");r(this,"dias_postergado");r(this,"motivo_postergacion");r(this,"observacion");this.vehiculo=null,this.servicio=null,this.empleado=null,this.supervisor=null,this.fecha_realizado=null,this.km_realizado=null,this.imagen_evidencia=null,this.estado=null,this.km_retraso=null,this.dias_postergado=null,this.motivo_postergacion=null,this.observacion=null}}class Ce extends Z{constructor(){super(K.mantenimientos_vehiculos)}}var Ie=H({components:{TabLayoutFilterTabs2:ge,SelectorImagen:Ve},setup(){const e=new he(qe,new Ce),{entidad:o,disabled:d,listadosAuxiliares:v,accion:z}=e.useReferencias(),{setValidador:q,cargarVista:E,obtenerListados:S,reestablecer:a,listar:B,editar:Ye}=e.useComportamiento();e.useHooks(),J(),W().setQuasar(R()),ve().setQuasar(R()),X(),new ce;const C=Y("PENDIENTE"),y="REALIZADO",O="POSTERGADO",{vehiculos:I,filtrarVehiculos:P,empleados:w,filtrarEmpleados:U,servicios:A,filtrarServicios:M}=$e(v);E(async()=>{await S({empleados:{controller:new _,params:{estado:1}},vehiculos:{controller:new ye,params:{estado:1}},servicios:{controller:new Ee,params:{tipo:"PREVENTIVO",estado:1}}}),w.value=v.empleados,I.value=v.vehiculos,A.value=v.servicios});const N={fecha_realizado:{requiredIf:$(()=>o.estado===y)},km_realizado:{requiredIf:$(()=>o.estado===y)},dias_postergado:{requiredIf:$(()=>o.estado===O)},motivo_postergacion:{requiredIf:$(()=>o.estado===O)},observacion:{requiredIf:$(()=>o.estado==="NO REALIZADO")}},D=fe(N,o);q(D.value);function T(c){C.value=c,B({estado:c})}function L(c){console.log(c),c!==y&&(o.fecha_realizado=null,o.km_realizado=null)}return{mixin:e,v$:D,mantenimiento:o,disabled:d,accion:z,acciones:x,configuracionColumnas:ze,accionesTabla:ee,tabDefecto:C,maskFecha:oe,REALIZADO:y,POSTERGADO:O,vehiculos:I,filtrarVehiculos:P,empleados:w,filtrarEmpleados:U,servicios:A,filtrarServicios:M,estadosMantenimientosVehiculos:Se,tabOptions:Oe,filtrarMantenimientos:T,estadoSeleccionado:L}}});const we={class:"row q-col-gutter-sm q-py-md"},Ae={key:0,class:"col-12 col-md-3"},De={class:"col-12 col-md-3"},Re={class:"col-12 col-md-3 q-mb-md"},Fe={class:"col-12 col-md-3 q-mb-md"},Qe={class:"col-12 col-md-3"},Be={class:"col-12 col-md-3"},Pe={key:1,class:"col-6 col-md-3"},Ue={key:2,class:"col-12 col-md-3"},Me={class:"row items-center justify-end"},Ne={class:"error-msg"},Te={key:3,class:"col-6 col-md-3"},Le={class:"error-msg"},je={key:4,class:"col-6 col-md-3"},Ge={class:"error-msg"},Ze={key:5,class:"col-12 col-md-3 col-sm-6"},Ke={class:"error-msg"},He={class:"col-12 col-md-3 col-sm-3"},Je={class:"col-12 col-md-3 col-sm-6"},We={class:"error-msg"};function Xe(e,o,d,v,z,q){const E=F("selector-imagen"),S=F("tab-layout-filter-tabs2");return t(),ie(S,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Mantenimientos de Veh\xEDculos","tab-options":e.tabOptions,ajustarCeldas:"",tabDefecto:e.tabDefecto,filtrar:e.filtrarMantenimientos,permitirEliminar:!1},{formulario:l(()=>[i(be,{onSubmit:o[14]||(o[14]=le(()=>{},["prevent"]))},{default:l(()=>[s("div",we,[e.mantenimiento.created_at?(t(),n("div",Ae,[o[15]||(o[15]=s("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),i(m,{modelValue:e.mantenimiento.created_at,"onUpdate:modelValue":o[0]||(o[0]=a=>e.mantenimiento.created_at=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):p("",!0),s("div",De,[o[17]||(o[17]=s("label",{class:"q-mb-sm block"},"Empleado",-1)),i(k,{modelValue:e.mantenimiento.empleado,"onUpdate:modelValue":o[1]||(o[1]=a=>e.mantenimiento.empleado=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"",onFilter:e.filtrarEmpleados,disable:"","option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[16]||(o[16]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Re,[o[19]||(o[19]=s("label",{class:"q-mb-sm block"},"Veh\xEDculo",-1)),i(k,{modelValue:e.mantenimiento.vehiculo,"onUpdate:modelValue":o[2]||(o[2]=a=>e.mantenimiento.vehiculo=a),options:e.vehiculos,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",dense:"",outlined:"",disable:"","use-input":"","input-debounce":"0",onFilter:e.filtrarVehiculos,"option-label":a=>a.placa,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[i(V,se(te(a.itemProps)),{default:l(()=>[i(h,null,{default:l(()=>[i(Q,null,{default:l(()=>[b(u(a.opt.placa),1)]),_:2},1024),i(Q,{caption:""},{default:l(()=>[b(u(a.opt.marca+" "+a.opt.modelo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[18]||(o[18]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Fe,[o[21]||(o[21]=s("label",{class:"q-mb-sm block"},"Servicio",-1)),i(k,{modelValue:e.mantenimiento.servicio,"onUpdate:modelValue":o[3]||(o[3]=a=>e.mantenimiento.servicio=a),options:e.servicios,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",dense:"",outlined:"",disable:"","use-input":"","input-debounce":"0",onFilter:e.filtrarServicios,"option-label":a=>a.nombre,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[20]||(o[20]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Qe,[o[23]||(o[23]=s("label",{class:"q-mb-sm block"},"Supervisor",-1)),i(k,{modelValue:e.mantenimiento.supervisor,"onUpdate:modelValue":o[4]||(o[4]=a=>e.mantenimiento.supervisor=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"",onFilter:e.filtrarEmpleados,disable:"","option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[i(V,null,{default:l(()=>[i(h,{class:"text-grey"},{default:l(()=>o[22]||(o[22]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),s("div",Be,[o[24]||(o[24]=s("label",{class:"q-mb-sm block"},"Estado",-1)),i(k,{modelValue:e.mantenimiento.estado,"onUpdate:modelValue":[o[5]||(o[5]=a=>e.mantenimiento.estado=a),e.estadoSeleccionado],options:e.estadosMantenimientosVehiculos,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":a=>a.label,"option-value":a=>a.label,"emit-value":"","map-options":""},null,8,["modelValue","options","disable","onUpdate:modelValue","option-label","option-value"])]),e.mantenimiento.estado==="RETRASADO"?(t(),n("div",Pe,[o[25]||(o[25]=s("label",{class:"q-mb-sm block"},"Kms Retrasado",-1)),i(m,{type:"number",modelValue:e.mantenimiento.km_retraso,"onUpdate:modelValue":o[6]||(o[6]=a=>e.mantenimiento.km_retraso=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):p("",!0),e.mantenimiento.estado===e.REALIZADO?(t(),n("div",Ue,[o[26]||(o[26]=s("label",{class:"q-mb-sm block"},"Fecha Realizado",-1)),i(m,{modelValue:e.mantenimiento.fecha_realizado,"onUpdate:modelValue":o[8]||(o[8]=a=>e.mantenimiento.fecha_realizado=a),placeholder:"Obligatorio",error:!!e.v$.fecha_realizado.$errors.length,onBlur:e.v$.fecha_realizado.$touch,disable:e.disabled,outlined:"",dense:""},{append:l(()=>[i(ne,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(me,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(ue,{modelValue:e.mantenimiento.fecha_realizado,"onUpdate:modelValue":o[7]||(o[7]=a=>e.mantenimiento.fecha_realizado=a),mask:e.maskFecha,"today-btn":""},{default:l(()=>[s("div",Me,[re(i(de,{label:"Cerrar",color:"primary",flat:""},null,512),[[pe]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(t(!0),n(f,null,g(e.v$.fecha_realizado.$errors,a=>(t(),n("div",{style:{clear:"inherit"},key:a.$uid},[s("div",Ne,u(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur","disable"])])):p("",!0),e.mantenimiento.estado===e.REALIZADO?(t(),n("div",Te,[o[27]||(o[27]=s("label",{class:"q-mb-sm block"},"Km Realizado",-1)),i(m,{type:"number",modelValue:e.mantenimiento.km_realizado,"onUpdate:modelValue":o[9]||(o[9]=a=>e.mantenimiento.km_realizado=a),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.km_realizado.$errors.length,onBlur:e.v$.km_realizado.$touch,outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.km_realizado.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",Le,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])):p("",!0),e.mantenimiento.estado===e.POSTERGADO?(t(),n("div",je,[o[28]||(o[28]=s("label",{class:"q-mb-sm block"},"D\xEDas de postergaci\xF3n",-1)),i(m,{type:"number",modelValue:e.mantenimiento.dias_postergado,"onUpdate:modelValue":o[10]||(o[10]=a=>e.mantenimiento.dias_postergado=a),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.dias_postergado.$errors.length,onBlur:e.v$.dias_postergado.$touch,outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.dias_postergado.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",Ge,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])):p("",!0),e.mantenimiento.estado===e.POSTERGADO?(t(),n("div",Ze,[o[29]||(o[29]=s("label",{class:"q-mb-sm block"},"Motivo Postergaci\xF3n",-1)),i(m,{autogrow:"",modelValue:e.mantenimiento.motivo_postergacion,"onUpdate:modelValue":o[11]||(o[11]=a=>e.mantenimiento.motivo_postergacion=a),placeholder:"Obligatorio",disable:e.disabled,hint:"Ingresa alguna observaci\xF3n o novedad presentada con este mantenimiento preventivo",error:!!e.v$.motivo_postergacion.$errors.length,onBlur:e.v$.motivo_postergacion.$touch,outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.motivo_postergacion.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",Ke,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])):p("",!0),s("div",He,[o[30]||(o[30]=s("label",{for:"q-mb-xl block"},"Imagen Evidencia",-1)),i(E,{file_extensiones:".jpg, image/*",imagen:e.mantenimiento.imagen_evidencia,alto:"80px","onUpdate:modelValue":o[12]||(o[12]=a=>e.mantenimiento.imagen_evidencia=a)},null,8,["imagen"])]),s("div",Je,[o[31]||(o[31]=s("label",{class:"q-mb-sm block"},"Observaci\xF3n",-1)),i(m,{autogrow:"",modelValue:e.mantenimiento.observacion,"onUpdate:modelValue":o[13]||(o[13]=a=>e.mantenimiento.observacion=a),placeholder:"Opcional",disable:e.disabled,error:!!e.v$.observacion.$errors.length,onBlur:e.v$.observacion.$touch,hint:"Ingresa alguna observaci\xF3n o novedad presentada con este mantenimiento preventivo",outlined:"",dense:""},{error:l(()=>[(t(!0),n(f,null,g(e.v$.observacion.$errors,a=>(t(),n("div",{key:a.$uid},[s("div",We,u(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar"])}var No=ae(Ie,[["render",Xe]]);export{No as default};

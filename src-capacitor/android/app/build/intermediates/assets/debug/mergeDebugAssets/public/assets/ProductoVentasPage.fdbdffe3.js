var O=Object.defineProperty;var I=(o,e,s)=>e in o?O(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var n=(o,e,s)=>(I(o,typeof e!="symbol"?e+"":e,s),s);import{Q as T,a as U}from"./QItemSection.c6f2640c.js";import{Q as _}from"./QSelect.a8f2bfb2.js";import{A as j,t as M,c as H,be as R,p as z,u as G,U as J,e as E,bA as K,v as W,x as X,y as i,S as Y,H as l,D as u,B as a,z as d,J as V,I as h,G as Z,K as w,L as x,a7 as oo,M as y}from"./index.976e8f3c.js";import{Q as eo}from"./QForm.ed6f6690.js";import{E as ro}from"./entidadAuditable.75a46700.js";import{T as to}from"./TabLayoutFilterTabs2.f1a01a4e.js";import{u as ao}from"./index.ed676411.js";import{C as so}from"./ContenedorSimpleMixin.5a0b06ab.js";import{P as io}from"./ProductoVentasController.7be80861.js";import{P as lo}from"./PlanesController.93b0c92b.js";import{S as no}from"./utils.30e08aa2.js";import{t as uo}from"./ventas.utils.b757673b.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./QPopupProxy.d8ef7a42.js";import"./QPage.ed5d79ca.js";import"./EssentialTableTabs.c7e98bba.js";import"./QBadge.1ddeabfd.js";import"./EssentialTablePagination.f449a738.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./EssentialTable.d8e6954a.js";import"./QFile.e27868da.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./i18n-validators.06eef631.js";import"./index.95f5a0db.js";import"./buttonSubmits.2eb37d38.js";class co extends ro{constructor(){super();n(this,"plan");n(this,"plan_info");n(this,"nombre");n(this,"bundle");n(this,"precio");n(this,"activo");this.plan=null,this.plan_info=null,this.nombre=null,this.bundle=null,this.precio=null,this.activo=!0}}const po=[{name:"plan_info",field:"plan_info",label:"Plan",align:"left",sortable:!0},{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"bundle",field:"bundle",label:"Bundle",align:"left",sortable:!0},{name:"precio",field:"precio",label:"Precio",align:"left",sortable:!0},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class N{constructor(){n(this,"axios");this.axios=j.getInstance()}async anular(e){return this.solicitud("/desactivar/",e)}async solicitud(e,s,m){const f=this.axios.getEndpoint(M.productos_ventas)+e+s,b=await this.axios.post(f,m);return{response:b,result:b.data.modelo}}}var mo=H({components:{TabLayoutFilterTabs2:to},setup(){R().setQuasar(z());const o=new no,e=G(),s=new so(co,new io),{entidad:m,disabled:f,accion:b,listadosAuxiliares:v,listado:r}=s.useReferencias(),{setValidador:A,obtenerListados:Q,cargarVista:q,listar:S}=s.useComportamiento(),{confirmar:B,notificarCorrecto:C,notificarError:P}=J(),g=E([]),k=E("1");q(async()=>{await Q({planes:{controller:new lo,params:{campos:"id,nombre"}}}),g.value=v.planes});const D=ao({plan:{required:!0},nombre:{required:!0},bundle:{required:!0},precio:{required:!0}},m);A(D.value);function L(t){k.value=t,S({activo:t})}function F(t,c){if(t===""){c(()=>{g.value=v.planes});return}c(()=>{const p=t.toLowerCase();g.value=v.planes.filter($=>$.nombres.toLowerCase().indexOf(p)>-1||$.apellidos.toLowerCase().indexOf(p)>-1)})}return{mixin:s,producto:m,filtrarPlanes:F,planes:g,tabDefecto:k,disabled:f,accion:b,v$:D,acciones:K,configuracionColumnas:po,tabOptionsProductos:uo,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar",accion:({entidad:t,posicion:c})=>{B("\xBFEst\xE1 seguro de desactivar este producto?",async()=>{try{o.activar();const{result:p,response:$}=await new N().anular(t.id);r.value.splice(c,1),C("Desactivado correctamente")}catch{P("No se pudo desactivar el producto!")}finally{o.desactivar()}})},visible:({entidad:t})=>!t.activo&&e.can("puede.activar.productos_ventas")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar",accion:({entidad:t,posicion:c})=>{B("\xBFEst\xE1 seguro de desactivar este producto?",async()=>{try{o.activar();const{result:p,response:$}=await new N().anular(t.id);r.value.splice(c,1),C("Desactivado correctamente")}catch{P("No se pudo desactivar el producto!")}finally{o.desactivar()}})},visible:({entidad:t})=>t.activo&&e.can("puede.desactivar.productos_ventas")},filtrarProductos:L}}});const bo={class:"row q-col-gutter-sm q-mb-md"},vo={class:"col-12 col-md-3"},fo={class:"error-msg"},go={class:"col-12 col-md-3"},$o={class:"error-msg"},Vo={class:"col-12 col-md-3"},ho={class:"error-msg"},yo={class:"col-12 col-md-3"},wo={class:"error-msg"};function Bo(o,e,s,m,f,b){const v=X("tab-layout-filter-tabs-2");return i(),Y(v,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,ajustarCeldas:!0,accion1:o.btnDesactivar,accion2:o.btnActivar,"tab-options":o.tabOptionsProductos,tabDefecto:o.tabDefecto,filtrar:o.filtrarProductos},{formulario:l(()=>[u(eo,{onSubmit:e[5]||(e[5]=oo(()=>{},["prevent"]))},{default:l(()=>[a("div",bo,[a("div",vo,[e[7]||(e[7]=a("label",{class:"q-mb-sm block"},"Plan",-1)),u(_,{modelValue:o.producto.plan,"onUpdate:modelValue":e[0]||(e[0]=r=>o.producto.plan=r),options:o.planes,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.plan.$errors.length,onBlur:o.v$.plan.$touch,"error-message":"Debes seleccionar un plan","use-input":"","input-debounce":"0",onFilter:o.filtrarPlanes,"option-value":r=>r.id,"option-label":r=>r.nombre,"emit-value":"","map-options":""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.plan.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",fo,y(r.$message),1)]))),128))]),"no-option":l(()=>[u(T,null,{default:l(()=>[u(U,{class:"text-grey"},{default:l(()=>e[6]||(e[6]=[Z(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),a("div",go,[e[8]||(e[8]=a("label",{class:"q-mb-sm block"},"Nombre",-1)),u(w,{modelValue:o.producto.nombre,"onUpdate:modelValue":e[1]||(e[1]=r=>o.producto.nombre=r),placeholder:"Obligatorio",disable:o.disabled,error:!!o.v$.nombre.$errors.length,autogrow:"",onBlur:o.v$.nombre.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.nombre.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",$o,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",Vo,[e[9]||(e[9]=a("label",{class:"q-mb-sm block"},"Bundle",-1)),u(w,{modelValue:o.producto.bundle,"onUpdate:modelValue":e[2]||(e[2]=r=>o.producto.bundle=r),placeholder:"Obligatorio",type:"textarea",disable:o.disabled,error:!!o.v$.bundle.$errors.length,autogrow:"",onBlur:o.v$.bundle.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.bundle.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",ho,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",yo,[e[10]||(e[10]=a("label",{class:"q-mb-sm block"},"Precio",-1)),u(w,{modelValue:o.producto.precio,"onUpdate:modelValue":e[3]||(e[3]=r=>o.producto.precio=r),placeholder:"Obligatorio",type:"number",disable:o.disabled,error:!!o.v$.precio.$errors.length,onBlur:o.v$.precio.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.precio.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",wo,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),x("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var be=W(mo,[["render",Bo]]);export{be as default};

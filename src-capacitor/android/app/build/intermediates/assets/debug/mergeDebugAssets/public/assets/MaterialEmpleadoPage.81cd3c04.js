var ro=Object.defineProperty;var no=(o,e,p)=>e in o?ro(o,e,{enumerable:!0,configurable:!0,writable:!0,value:p}):o[e]=p;var d=(o,e,p)=>(no(o,typeof e!="symbol"?e+"":e,p),p);import{Q as B,a as z}from"./QItemSection.c6f2640c.js";import{Q as T,a as K}from"./QSelect.a8f2bfb2.js";import{c as qe,f as L,e as E,U as Se,i as Te,bA as uo,A as ae,bH as te,t as W,v as he,x as le,y as c,S as ie,H as l,D as t,bg as Ae,B as i,F as C,G as f,z as b,I as N,J as D,M as S,K as G,bf as se,bi as po,bz as co,u as mo,be as fo,p as ge,s as ye,w as bo,q as vo,g as go,E as Z,N as yo,Q as ko,L as P,aa as _o,k as x,R as y,a6 as Co,O as Mo,P as wo,bh as Po,b3 as Eo}from"./index.976e8f3c.js";import{Q as ke,a as _e,C as Ce}from"./QPopupProxy.d8ef7a42.js";import{Q as $o}from"./QBtnGroup.7d0835e4.js";import{a as Vo,Q as ee}from"./QTabs.3c726b04.js";import{a as j}from"./QToolbar.cff7174f.js";import{a as qo,Q as oe}from"./QTabPanels.1c8c4baa.js";import{Q as So}from"./QPage.ed5d79ca.js";import{u as To,c as ho}from"./UseMaterialesTarea.58fbff36.js";import{a as Re,F as Me,u as Ao}from"./FiltroMiBodegaEmpleado.020f4a2d.js";import{u as Ro}from"./filtrosListadosGenerales.31e9eb2c.js";import{d as q}from"./tareas.utils.309e0dff.js";import{S as Qe,u as Qo,v as Fo,s as Io,A as Uo}from"./utils.30e08aa2.js";import{E as Bo}from"./EssentialTable.d8e6954a.js";import{M as zo}from"./ModalEntidad.84100166.js";import{C as Lo,a as jo}from"./ComponenteModal.domain.22ea4557.js";import{Q as No}from"./QExpansionItem.558e637e.js";import{u as Fe}from"./index.ed676411.js";import{B as Do}from"./buttonSubmits.2eb37d38.js";import{E as Ie}from"./entidadAuditable.75a46700.js";import{r as we,c as Go,d as Oo,a as Pe}from"./i18n-validators.06eef631.js";import{C as Ho}from"./ClienteController.f53ff018.js";import{F as Ee,u as Jo}from"./FiltroMiBodegaProyecto.782f312c.js";import{F as $e}from"./FiltroMiBodega.5c2bf6ef.js";import{C as Ko}from"./ContenedorSimpleMixin.5a0b06ab.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QResizeObserver.6ec10d95.js";import"./touch.9135741d.js";import"./listadoMaterialesDevolucion.5ce4073a.js";import"./TareaController.c7f2748b.js";import"./ClienteMaterialEmpleadoController.fcdf149e.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./configuracion_general.ef04b031.js";import"./ConfiguracionController.65de3fc5.js";import"./index.95f5a0db.js";import"./EtapaController.9ea539ef.js";import"./ProyectoController.29ab1934.js";class Ve extends Ie{constructor(){super();d(this,"detalle_producto_id");d(this,"item");d(this,"producto");d(this,"categoria");d(this,"detalle_producto");d(this,"stock_actual");d(this,"tarea");d(this,"medida");d(this,"serial");d(this,"cliente");d(this,"cliente_id");d(this,"etapa");d(this,"transacciones");this.detalle_producto_id=null,this.item=null,this.producto=null,this.categoria=null,this.detalle_producto=null,this.stock_actual=null,this.tarea=null,this.medida=null,this.serial=null,this.cliente=null,this.cliente_id=null,this.etapa=null,this.transacciones=null}}var Wo=qe({components:{ButtonSubmits:Do},setup(o,{emit:e}){const p=L(new Ve),h=E(),A=E(),R=E(),$=E(),n=Re(),a=new Qe,{notificarCorrecto:V,notificarAdvertencia:g,notificarError:u}=Se(),O={stock_actual:{required:we,minValue:Go(1),maxValue:Oo(n.filaAModificar.stock_actual)},cliente:{required:we}},Q=Fe(O,p);async function w(){R.value=(await new Ho().listar({campos:"id,razon_social",requiere_bodega:1,estado:1})).result,$.value=R.value}a.cargarConsulta(w),Te(()=>{p.id=n.filaAModificar.id,p.producto=n.filaAModificar.producto,p.detalle_producto=n.filaAModificar.detalle_producto,p.detalle_producto_id=n.filaAModificar.detalle_producto_id,p.categoria=n.filaAModificar.categoria,p.stock_actual=n.filaAModificar.stock_actual,p.medida=n.filaAModificar.medida,p.serial=n.filaAModificar.serial,p.cliente=n.filaAModificar.cliente_id,p.cliente_id=n.filaAModificar.cliente_id,h.value=n.filaAModificar.tipo,A.value=n.filaAModificar.empleado});async function m(){try{const r=ae.getInstance(),H=te.URL_BASE+"/"+r.getEndpoint(W.actualizar_materiales_empleados),k=await r.post(H,{registro:p,registroOld:n.filaAModificar,tipo:h.value,empleado:A.value});if(console.log(k),k.status=200)return V(k.data.mensaje),!0;g(k.data.mensaje)}catch(r){u("Error al marcar como pagada la matr\xEDcula. "+r)}}function F(){p.hydrate(new Ve)}async function M(){await Q.value.$validate()&&(console.log("Paso la validacion, toca guardar",p),a.cargarConsulta(m),e("cerrar-modal",!1),e("guardado",{formulario:"CambiarClientePropietarioMaterialPage",tipo:h.value})),console.log("Diste clic en guardar")}return{registro:p,v$:Q,reestablecer:F,guardar:M,clientes:$,cargando:a,acciones:uo,valor:E()}}});const Xo={class:"border-1 text-primary text-bold q-mb-lg"},Yo={class:"row q-col-gutter-sm q-pa-sm"},Zo={class:"q-mb-sm block"},xo={class:"row q-col-gutter-sm q-mb-md"},ea={class:"col-12 col-md-3"},oa={class:"error-msg"},aa={class:"col-12 col-md-3"},ta={class:"error-msg"},la={class:"row justify-end q-col-gutter-x-xs"};function ia(o,e,p,h,A,R){const $=le("ButtonSubmits");return c(),ie(se,{class:"q-mb-md rounded no-border custom-shadow"},{default:l(()=>[t(Ae,null,{default:l(()=>[i("div",Xo,[t(C,{name:"bi-graph-up-arrow",class:"q-mr-sm"}),e[5]||(e[5]=f(" Modificar el registro "))]),t(No,{class:"overflow-hidden q-mb-md expansion",label:"Informaci\xF3n del Registro","header-class":"text-bold bg-header-collapse","default-opened":""},{default:l(()=>[i("div",Yo,[(c(!0),b(N,null,D(o.registro,(n,a)=>(c(),b("div",{class:"col-12 col-sm-3",key:a},[i("label",Zo,S(a.toUpperCase()),1),t(G,{modelValue:o.valor,"onUpdate:modelValue":e[0]||(e[0]=V=>o.valor=V),placeholder:n,dense:"",disable:"",outlined:""},null,8,["modelValue","placeholder"])]))),128))])]),_:1}),i("div",xo,[i("div",ea,[e[6]||(e[6]=i("label",{class:"q-mb-sm block"},"Modifique la cantidad",-1)),t(G,{type:"number",modelValue:o.registro.stock_actual,"onUpdate:modelValue":e[1]||(e[1]=n=>o.registro.stock_actual=n),placeholder:"OBLIGATORIO",error:!!o.v$.stock_actual.$errors.length,outlined:"",dense:""},{error:l(()=>[(c(!0),b(N,null,D(o.v$.stock_actual.$errors,n=>(c(),b("div",{key:n.$uid},[i("div",oa,S(n.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),i("div",aa,[e[8]||(e[8]=i("label",{class:"q-mb-sm block"},"Modifica el cliente",-1)),t(T,{modelValue:o.registro.cliente,"onUpdate:modelValue":e[2]||(e[2]=n=>o.registro.cliente=n),options:o.clientes,"options-dense":"",clearable:"",dense:"",outlined:"","use-input":"","use-chips":"",error:!!o.v$.cliente.$errors.length,"input-debounce":"0","option-label":n=>n.razon_social,"option-value":n=>n.id,"emit-value":"","map-options":""},{"no-option":l(()=>[t(B,null,{default:l(()=>[t(z,{class:"text-grey"},{default:l(()=>e[7]||(e[7]=[f(" No hay resultados ")])),_:1})]),_:1})]),error:l(()=>[(c(!0),b(N,null,D(o.v$.cliente.$errors,n=>(c(),b("div",{key:n.$uid},[i("div",ta,S(n.$message),1)]))),128))]),_:1},8,["modelValue","options","error","option-label","option-value"])])]),i("div",la,[t($,{permitirGuardar:"",accion:o.acciones.editar,disabled:o.cargando.cargando,onCancelar:e[3]||(e[3]=n=>o.reestablecer()),onEditar:e[4]||(e[4]=n=>o.guardar())},null,8,["accion","disabled"])])]),_:1})]),_:1})}var sa=he(Wo,[["render",ia]]);class ra{constructor(){d(this,"CambiarClientePropietarioMaterialPage");this.CambiarClientePropietarioMaterialPage=po(new Lo("Cambiar Propietario",sa))}}class na extends jo{constructor(){super(new ra)}}class da extends Ie{constructor(){super();d(this,"detalle_producto_id");d(this,"item");d(this,"producto");d(this,"categoria");d(this,"detalle_producto");d(this,"stock_actual");d(this,"tarea");d(this,"medida");d(this,"serial");d(this,"cliente");d(this,"cliente_id");d(this,"etapa");d(this,"transacciones");this.detalle_producto_id=null,this.item=null,this.producto=null,this.categoria=null,this.detalle_producto=null,this.stock_actual=null,this.tarea=null,this.medida=null,this.serial=null,this.cliente=null,this.cliente_id=null,this.etapa=null,this.transacciones=null}}class ua extends co{constructor(){super(W.productos_empleados)}}var pa=qe({components:{EssentialTable:Bo,ModalEntidad:zo},setup(){const o=Re(),e=mo();fo().setQuasar(ge()),Qo().setQuasar(ge());const p=new Ko(da,new ua),{listar:h}=p.useComportamiento(),A=new na,{notificarCorrecto:R,notificarAdvertencia:$,notificarError:n,prompt:a}=Se(),V=new Qe,g=E(),u=E(),O=E(!1),Q=E(!1);Te(()=>{g.value=q.paraClienteFinal,J.value=r.proyectos});const w=L(new $e),m=L(new Ee),F=L(new Me),M=L({fecha_inicio:"2023-04-01",fecha_fin:Fo(ye)}),r=L({productos:[],productosTarea:[],productosProyectosEtapas:[],productosStock:[],clientesMaterialesTarea:[],clientesMaterialesEmpleado:[],tareas:[],proyectos:[],etapas:[],empleados:[]}),{consultarProductosTarea:H,consultarClientesMaterialesTarea:k,consultarTareasClienteFinalMantenimiento:re}=To(w,r),{consultarProductosEmpleado:ne,consultarClientesMaterialesEmpleado:de}=Ao(F,r,O),{consultarProyectos:ue,consultarEtapas:pe,consultarProductosProyecto:Ue}=Jo(m,r);function ce(){F.empleado_id=u.value,ne()}function Be(s){switch(s){case"proyectos":m.empleado_id=u.value,ue().then(()=>J.value=r.proyectos);break;case"clientes":m.etapa_id?k({empleado_id:u.value,proyecto_id:m.proyecto_id,etapa_id:m.etapa_id,filtrar_por_etapa:!0}):k({empleado_id:u.value,proyecto_id:m.proyecto_id,etapa_id:m.etapa_id,filtrar_por_proyecto:!0});break}}function me(s){switch(s){case"tareas":re(u.value);break;case"clientes":k({empleado_id:u.value,tarea_id:w.tarea_id,filtrar_por_tarea:1});break}}function fe(s){switch(s){case"clientes":de({empleado_id:u.value});break}}function ze(){w.hydrate(new $e),m.hydrate(new Ee),F.hydrate(new Me),r.productos=[],r.productosTarea=[],r.productosProyectosEtapas=[],r.productosStock=[],Le()}function Le(){u.value&&(re(u.value),m.empleado_id=u.value,ue().then(()=>J.value=r.proyectos),de({empleado_id:u.value}),k({empleado_id:u.value,filtrar_por_tarea:!0}))}function je(){r.productos=[],w.cliente_id=void 0,r.tareas.find(s=>s.id===w.tarea_id),k({empleado_id:u.value,tarea_id:w.tarea_id,filtrar_por_tarea:1})}async function Ne(){m.proyecto_id?(await pe(m.proyecto_id),ve.value=r.etapas,r.proyectos.find(s=>s.id===m.proyecto_id),m.cliente_id=void 0,o.codigoTarea=null):r.etapas=[],r.productosProyectosEtapas=[],r.productos=[],m.etapa_id=null,w.cliente_id=null,r.etapas.length||k({empleado_id:u.value,proyecto_id:m.proyecto_id,filtrar_por_proyecto:1})}function De(){k({empleado_id:u.value,proyecto_id:m.proyecto_id,etapa_id:m.etapa_id,filtrar_por_etapa:1})}function be(){if(r.etapas.length&&!m.etapa_id)return $("Debe seleccionar una etapa");Ue()}async function Ge(){try{V.activar();const s=await new Z().listar({campos:"id,nombres,apellidos",estado:1});r.empleados=s.result}catch(s){console.log(s)}finally{V.desactivar()}}async function Oe(s){switch(console.log(s),s.tipo){case q.personal:fe("clientes"),ce();break;case q.paraClienteFinal:me("clientes"),H({empleado_id:u.value});break;default:be();break}}async function He(s){u.value=null;const v=E();s?v.value=await V.cargarConsulta(async()=>(await new Z().listar({estado:0})).result):v.value=await V.cargarConsulta(async()=>(await new Z().listar({estado:1})).result),r.empleados=v.value}async function Je(s,v,_,I){try{const U=ae.getInstance(),io=te.URL_BASE+"/"+U.getEndpoint(W.actualizar_cantidad_material_empleado),so=g.value==q.paraClienteFinal?{tarea_id:I,tipo:g.value,cantidad:s,empleado:u.value,detalle_producto_id:v,cliente_id:_}:{tipo:g.value,cantidad:s,empleado:u.value,detalle_producto_id:v,cliente_id:_},Y=await U.post(io,so);if(Y.status==200)return R(Y.data.mensaje),!0;$(Y.data.mensaje)}catch(U){n("Error al actualizar el \xEDtem. "+U)}}const Ke=async()=>{if(await X.value.$validate()){const s=r.empleados.find(U=>U.id===u.value),v="reporte_materiales_"+(s==null?void 0:s.nombres)+" "+(s==null?void 0:s.apellidos)+"_"+M.fecha_inicio+"-"+M.fecha_fin,_=W.reporte_materiales,I=te.URL_BASE+"/"+ae.getInstance().getEndpoint(_,{empleado_id:u.value,...M});Uo(I,"GET","blob","xlsx",v)}},We=async()=>{if(await X.value.$validate()){const s=r.empleados.find(_=>_.id===u.value),v="reporte_materiales_"+(s==null?void 0:s.nombres)+" "+(s==null?void 0:s.apellidos)+"_"+M.fecha_inicio+"-"+M.fecha_fin;h({export:"xlsx",titulo:v,tipo:3,fecha_inicio:M.fecha_inicio,fecha_fin:M.fecha_fin,responsable:u.value,firmada:1})}},Xe={fecha_inicio:{requiredIf:Pe(()=>Q.value)},fecha_fin:{requiredIf:Pe(()=>Q.value)}},X=Fe(Xe,M);Ge(),bo(g,()=>{switch(g.value){case q.paraClienteFinal:r.productos=r.productosTarea,o.listadoMateriales=r.productosTarea;break;case q.paraProyecto:r.productos=r.productosProyectosEtapas,o.listadoMateriales=r.productosProyectosEtapas;break;case q.personal:r.productos=r.productosStock,o.listadoMateriales=r.productosStock;break}});const{tareas:Ye,filtrarTareas:Ze,proyectos:J,filtrarProyectos:xe,etapas:ve,filtrarEtapas:eo,empleados:oo,filtrarEmpleados:ao}=Ro(r),to={titulo:"Propietario",tooltip:"Cambiar Cliente Propietario",icono:"bi-arrow-left-right",color:"positive",accion:({entidad:s,posicion:v})=>{console.log("btnCambiarClientePropietario",g.value,s,v);const _=s;_.tipo=g.value,_.empleado=u.value,o.filaAModificar=_,A.abrirModalEntidad("CambiarClientePropietarioMaterialPage")},visible:()=>e.can("puede.ver.btn.modificar_stock.materiales_empleados")},lo={titulo:"Stock",tooltip:"Modificar Stock",icono:"bi-pencil-square",color:"primary",accion:({entidad:s,posicion:v})=>{console.log("btnModificarStock",g.value,s,v);const _={titulo:"Modifica",mensaje:"Ingresa la nueva cantidad",tipo:"number",defecto:s.stock_actual,accion:I=>{V.cargarConsulta(()=>Je(I,s.detalle_producto_id,s.cliente_id,s.tarea_id)),s.stock_actual=I}};a(_)},visible:()=>e.can("puede.ver.btn.modificar_stock.materiales_empleados")};return{v$:X,tab:g,configuracionColumnasMaterialEmpleadoTarea:ho,listadosAuxiliares:r,filtro:w,filtroProyecto:m,filtroEmpleado:F,destinosTareas:q,transferenciaProductoEmpleadoStore:o,store:e,accionesTabla:vo,modales:A,consultarEtapas:pe,tareas:Ye,proyectos:J,etapas:ve,checkMostrarInactivos:He,filtrarTareas:Ze,filtrarProyectos:xe,filtrarEtapas:eo,seleccionarTarea:je,seleccionarProyecto:Ne,seleccionarEtapa:De,consultarProductosTarea:H,consultarProductosProyectoEtapa:be,consultarProductosEmpleado:ne,refrescarListadosProyectos:Be,refrescarListadosTareas:me,refrescarListadosEmpleado:fe,mostrarBtnTransferirStockPersonal:go(()=>g.value===q.paraClienteFinal),empleados:oo,filtrarEmpleados:ao,empleadoSeleccionado:u,resetearFiltros:ze,consultarProductosStock:ce,guardado:Oe,ordenarLista:Io,mostrarInactivos:O,btnCambiarClientePropietario:to,btnModificarStock:lo,descargarReporteMaterialesStockUsadosTareas:Ke,filtroReporteMateriales:M,mostrarImprimirReporteMateriales:Q,maskFecha:ye,descargarReporteMateriales:We}}});const ca={class:"col-10 q-mb-md"},ma={class:"col-2 q-mt-md q-pt-sm"},fa={key:0,class:"col-12 q-mt-md q-mb-lg"},ba={class:"col-12 bg-green-1 text-positive text-bold q-px-md q-py-sm"},va={key:1,class:"col-12 col-md-3"},ga={key:2,class:"col-12 col-md-3"},ya={class:"row items-center justify-end"},ka={class:"error-msg"},_a={key:3,class:"col-12 col-md-3"},Ca={class:"row items-center justify-end"},Ma={class:"error-msg"},wa={key:4,class:"col-12 col-md-3"},Pa={class:"row q-col-gutter-sm q-pa-sm q-mb-md"},Ea={class:"col-12 col-md-6"},$a={key:0,class:"col-12 col-md-6"},Va={class:"row q-mb-lg"},qa={class:"col-12"},Sa={class:"row q-col-gutter-sm q-pa-sm q-mb-md"},Ta={class:"col-12 col-md-4"},ha={class:"col-12 col-md-4"},Aa={key:0,class:"col-12 col-md-4"},Ra={key:1,class:"col-12 col-md-4"},Qa={class:"row q-mb-lg"},Fa={class:"col-12"},Ia={class:"row justify-center q-gutter-sm q-mb-md"},Ua={class:"col-12"},Ba={class:"col-12"},za={key:0,class:"row q-pt-md"},La={class:"col-12 row justify-center q-gutter-sm q-mb-md"},ja={class:"col-12 q-px-md"};function Na(o,e,p,h,A,R){const $=le("essential-table"),n=le("modal-entidad");return c(),ie(So,{padding:""},{default:l(()=>[e[59]||(e[59]=i("div",{class:"text-h5 text-bold q-mb-md"}," Productos que tienen asignados los empleados ",-1)),t(se,{class:"rounded q-mb-md bg-body no-border",flat:""},{default:l(()=>[t(Ae,{class:"row q-col-gutter-x-sm"},{default:l(()=>[i("div",ca,[e[32]||(e[32]=i("label",{class:"q-mb-sm block"},[i("b",null,"Paso 1: "),f("Seleccione un empleado")],-1)),t(T,{modelValue:o.empleadoSeleccionado,"onUpdate:modelValue":[e[0]||(e[0]=a=>o.empleadoSeleccionado=a),e[2]||(e[2]=a=>o.resetearFiltros())],options:o.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarEmpleados,onPopupShow:e[1]||(e[1]=a=>o.ordenarLista(o.empleados,"apellidos")),"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[t(B,null,{default:l(()=>[t(z,{class:"text-grey"},{default:l(()=>e[31]||(e[31]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),i("div",ma,[t(yo,{class:"q-mt-sm q-pt-sm",modelValue:o.mostrarInactivos,"onUpdate:modelValue":[e[3]||(e[3]=a=>o.mostrarInactivos=a),o.checkMostrarInactivos],label:"Inactivos",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),o.mostrarImprimirReporteMateriales?(c(),b("div",fa,[t(ko,{color:"positive"}),i("div",ba,[t(C,{name:"bi-bar-chart-line",class:"q-mr-sm"}),e[33]||(e[33]=f(" Reporte de materiales "))])])):P("",!0),o.empleadoSeleccionado?(c(),b("div",va,[e[34]||(e[34]=i("br",null,null,-1)),t(_o,{modelValue:o.mostrarImprimirReporteMateriales,"onUpdate:modelValue":e[4]||(e[4]=a=>o.mostrarImprimirReporteMateriales=a),label:"Mostrar secci\xF3n para imprimir reportes",color:"positive",dense:""},null,8,["modelValue"])])):P("",!0),o.mostrarImprimirReporteMateriales?(c(),b("div",ga,[e[35]||(e[35]=i("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),t(G,{modelValue:o.filtroReporteMateriales.fecha_inicio,"onUpdate:modelValue":e[6]||(e[6]=a=>o.filtroReporteMateriales.fecha_inicio=a),error:!!o.v$.fecha_inicio.$errors.length,onBlur:o.v$.fecha_inicio.$touch,outlined:"",dense:""},{append:l(()=>[t(C,{name:"event",class:"cursor-pointer"},{default:l(()=>[t(ke,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[t(_e,{modelValue:o.filtroReporteMateriales.fecha_inicio,"onUpdate:modelValue":e[5]||(e[5]=a=>o.filtroReporteMateriales.fecha_inicio=a),mask:o.maskFecha,"today-btn":""},{default:l(()=>[i("div",ya,[x(t(y,{label:"Cerrar",color:"primary",flat:""},null,512),[[Ce]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(c(!0),b(N,null,D(o.v$.fecha_inicio.$errors,a=>(c(),b("div",{key:a.$uid},[i("div",ka,S(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])])):P("",!0),o.mostrarImprimirReporteMateriales?(c(),b("div",_a,[e[36]||(e[36]=i("label",{class:"q-mb-sm block"},"Fecha de fin",-1)),t(G,{modelValue:o.filtroReporteMateriales.fecha_fin,"onUpdate:modelValue":e[8]||(e[8]=a=>o.filtroReporteMateriales.fecha_fin=a),error:!!o.v$.fecha_fin.$errors.length,onBlur:o.v$.fecha_fin.$touch,outlined:"",dense:""},{append:l(()=>[t(C,{name:"event",class:"cursor-pointer"},{default:l(()=>[t(ke,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[t(_e,{modelValue:o.filtroReporteMateriales.fecha_fin,"onUpdate:modelValue":e[7]||(e[7]=a=>o.filtroReporteMateriales.fecha_fin=a),mask:o.maskFecha,"today-btn":""},{default:l(()=>[i("div",Ca,[x(t(y,{label:"Cerrar",color:"primary",flat:""},null,512),[[Ce]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(c(!0),b(N,null,D(o.v$.fecha_fin.$errors,a=>(c(),b("div",{key:a.$uid},[i("div",Ma,S(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])])):P("",!0),o.mostrarImprimirReporteMateriales?(c(),b("div",wa,[e[38]||(e[38]=i("label",{class:"block q-mb-sm"},"Bot\xF3n de acciones",-1)),t($o,{dense:"",unelevated:"",rounded:""},{default:l(()=>[t(y,{color:"positive","no-caps":"","no-wrap":"",onClick:e[9]||(e[9]=a=>o.descargarReporteMateriales())},{default:l(()=>[t(C,{name:"bi-file-earmark-spreadsheet",size:"xs",class:"q-mr-sm"}),e[37]||(e[37]=f(" Generar reporte "))]),_:1})]),_:1})])):P("",!0)]),_:1})]),_:1}),o.empleadoSeleccionado?(c(),ie(se,{key:0,class:"rounded-card custom-shadow"},{default:l(()=>[t(Vo,{modelValue:o.tab,"onUpdate:modelValue":e[10]||(e[10]=a=>o.tab=a),class:Co(["text-primary",{"bg-grey-3":!o.$q.dark.isActive}]),"active-color":"primary",align:"justify","no-caps":"","inline-label":""},{default:l(()=>[t(ee,{name:o.destinosTareas.paraClienteFinal,label:"Material para cliente final y mantenimiento",icon:"bi-pin-angle"},null,8,["name"]),t(ee,{name:o.destinosTareas.paraProyecto,label:"Material para proyectos",icon:"bi-diagram-2"},null,8,["name"]),t(ee,{name:o.destinosTareas.personal,label:"Stock personal",icon:"bi-person"},null,8,["name"])]),_:1},8,["modelValue","class"]),t(qo,{modelValue:o.tab,"onUpdate:modelValue":e[29]||(e[29]=a=>o.tab=a),animated:""},{default:l(()=>[t(oe,{name:o.destinosTareas.paraClienteFinal},{default:l(()=>[i("div",Pa,[i("div",Ea,[e[40]||(e[40]=i("label",{class:"q-mb-sm block"},"Seleccione una tarea",-1)),t(T,{modelValue:o.filtro.tarea_id,"onUpdate:modelValue":[e[12]||(e[12]=a=>o.filtro.tarea_id=a),e[13]||(e[13]=a=>o.seleccionarTarea())],options:o.tareas,onFilter:o.filtrarTareas,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":a=>a.codigo_tarea+" - "+a.titulo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[t(B,Mo(wo(a.itemProps)),{default:l(()=>[t(z,null,{default:l(()=>[t(K,null,{default:l(()=>[f(S(a.opt.codigo_tarea),1)]),_:2},1024),t(K,{caption:""},{default:l(()=>[f(S(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),after:l(()=>[t(y,{color:"positive",unelevated:"",onClick:e[11]||(e[11]=a=>o.refrescarListadosTareas("tareas"))},{default:l(()=>[t(C,{size:"xs",name:"bi-arrow-clockwise"}),t(j,null,{default:l(()=>e[39]||(e[39]=[f("Recargar tareas")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),o.filtro.tarea_id?(c(),b("div",$a,[e[42]||(e[42]=i("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material",-1)),t(T,{modelValue:o.filtro.cliente_id,"onUpdate:modelValue":e[15]||(e[15]=a=>o.filtro.cliente_id=a),options:o.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":a=>a.razon_social,"option-value":a=>a.cliente_id,"emit-value":"","map-options":""},{after:l(()=>[t(y,{color:"positive",unelevated:"",onClick:e[14]||(e[14]=a=>o.refrescarListadosTareas("clientes"))},{default:l(()=>[t(C,{size:"xs",name:"bi-arrow-clockwise"}),t(j,null,{default:l(()=>e[41]||(e[41]=[f("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):P("",!0)]),i("div",Va,[i("div",qa,[t(y,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:e[16]||(e[16]=a=>o.consultarProductosTarea({empleado_id:o.empleadoSeleccionado}))},{default:l(()=>e[43]||(e[43]=[f("Consultar")])),_:1})])])]),_:1},8,["name"]),t(oe,{name:o.destinosTareas.paraProyecto},{default:l(()=>[i("div",Sa,[i("div",Ta,[e[46]||(e[46]=i("label",{class:"q-mb-sm block"},"Todos los proyectos asignados",-1)),t(T,{modelValue:o.filtroProyecto.proyecto_id,"onUpdate:modelValue":[e[18]||(e[18]=a=>o.filtroProyecto.proyecto_id=a),e[19]||(e[19]=a=>o.seleccionarProyecto())],options:o.proyectos,onFilter:o.filtrarProyectos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",clearable:""},{option:l(a=>[t(B,Po(a.itemProps,{class:"q-my-sm"}),{default:l(()=>[t(z,null,{default:l(()=>[t(K,{class:"text-bold text-primary"},{default:l(()=>[f(S(a.opt.codigo_proyecto),1)]),_:2},1024),t(K,{caption:""},{default:l(()=>[f(S(a.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),after:l(()=>[t(y,{color:"positive",unelevated:"",onClick:e[17]||(e[17]=a=>o.refrescarListadosProyectos("proyectos"))},{default:l(()=>[t(C,{size:"xs",name:"bi-arrow-clockwise"}),t(j,null,{default:l(()=>e[44]||(e[44]=[f("Recargar proyectos")])),_:1})]),_:1})]),"no-option":l(()=>[t(B,null,{default:l(()=>[t(z,{class:"text-grey"},{default:l(()=>e[45]||(e[45]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),x(i("div",ha,[e[48]||(e[48]=i("label",{class:"q-mb-sm block"},"Seleccione una etapa",-1)),t(T,{modelValue:o.filtroProyecto.etapa_id,"onUpdate:modelValue":[e[20]||(e[20]=a=>o.filtroProyecto.etapa_id=a),e[21]||(e[21]=a=>o.seleccionarEtapa())],options:o.etapas,onFilter:o.filtrarEtapas,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{"no-option":l(()=>[t(B,null,{default:l(()=>[t(z,{class:"text-grey"},{default:l(()=>e[47]||(e[47]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])],512),[[Eo,o.filtroProyecto.proyecto_id&&o.etapas.length]]),o.filtroProyecto.proyecto_id?(c(),b("div",Aa,[e[50]||(e[50]=i("label",{class:"q-mb-sm block"},"Cliente propietario del material de proyecto/etapa",-1)),t(T,{modelValue:o.filtroProyecto.cliente_id,"onUpdate:modelValue":e[23]||(e[23]=a=>o.filtroProyecto.cliente_id=a),options:o.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":a=>a.razon_social,"option-value":a=>a.cliente_id,"emit-value":"","map-options":""},{after:l(()=>[t(y,{color:"positive",unelevated:"",onClick:e[22]||(e[22]=a=>o.refrescarListadosProyectos("clientes"))},{default:l(()=>[t(C,{size:"xs",name:"bi-arrow-clockwise"}),t(j,null,{default:l(()=>e[49]||(e[49]=[f("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):P("",!0),o.transferenciaProductoEmpleadoStore.codigoTarea?(c(),b("div",Ra,[e[51]||(e[51]=i("label",{class:"q-mb-sm block"},"Tarea",-1)),t(G,{modelValue:o.transferenciaProductoEmpleadoStore.codigoTarea,"onUpdate:modelValue":e[24]||(e[24]=a=>o.transferenciaProductoEmpleadoStore.codigoTarea=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):P("",!0)]),i("div",Qa,[i("div",Fa,[t(y,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:e[25]||(e[25]=a=>o.consultarProductosProyectoEtapa())},{default:l(()=>e[52]||(e[52]=[f("Consultar")])),_:1})])])]),_:1},8,["name"]),t(oe,{name:o.destinosTareas.personal},{default:l(()=>[i("div",Ia,[i("div",Ua,[e[54]||(e[54]=i("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material",-1)),t(T,{modelValue:o.filtroEmpleado.cliente_id,"onUpdate:modelValue":e[27]||(e[27]=a=>o.filtroEmpleado.cliente_id=a),options:[...o.listadosAuxiliares.clientesMaterialesEmpleado,{cliente_id:null,razon_social:"Sin cliente"}],"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":a=>a.razon_social,"option-value":a=>a.cliente_id,"emit-value":"","map-options":""},{after:l(()=>[t(y,{color:"positive",unelevated:"",onClick:e[26]||(e[26]=a=>o.refrescarListadosEmpleado("clientes"))},{default:l(()=>[t(C,{size:"xs",name:"bi-arrow-clockwise"}),t(j,null,{default:l(()=>e[53]||(e[53]=[f("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),i("div",Ba,[t(y,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:e[28]||(e[28]=a=>o.consultarProductosStock())},{default:l(()=>e[55]||(e[55]=[f("Consultar")])),_:1})])])]),_:1},8,["name"])]),_:1},8,["modelValue"]),o.listadosAuxiliares.productos.length?(c(),b("div",za,[e[58]||(e[58]=i("div",{class:"col-12 text-center"},[i("label",{class:"q-mb-sm block text-bold"},"Opciones de devoluci\xF3n de material sobrante de la tarea")],-1)),i("div",La,[t(y,{class:"bg-grey-4 text-primary","no-caps":"",unelevated:"",rounded:"",to:{name:"devoluciones"}},{default:l(()=>[t(C,{name:"bi-building",size:"xs",class:"q-pr-sm"}),e[56]||(e[56]=i("span",null,"Devolver a bodega matriz",-1))]),_:1}),t(y,{"no-caps":"",class:"bg-grey-4 text-primary",unelevated:"",rounded:"",to:{name:"transferencia_producto_empleado"}},{default:l(()=>[t(C,{name:"bi-box-arrow-up-right",size:"xs",class:"q-pr-sm"}),e[57]||(e[57]=i("span",null,"Transferir a otro t\xE9cnico",-1))]),_:1})]),i("div",ja,[t($,{titulo:"Listado de materiales para tarea",configuracionColumnas:o.store.can("puede.modificar_stock.materiales_empleados")?[...o.configuracionColumnasMaterialEmpleadoTarea,o.accionesTabla]:o.configuracionColumnasMaterialEmpleadoTarea,datos:o.listadosAuxiliares.productos,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"alto-fijo":!1,"ajustar-celdas":!0,"mostrar-exportar":!0,accion1:o.btnCambiarClientePropietario,accion2:o.btnModificarStock},null,8,["configuracionColumnas","datos","accion1","accion2"])])])):P("",!0)]),_:1})):P("",!0),t(n,{comportamiento:o.modales,onGuardado:e[30]||(e[30]=a=>o.guardado(a)),persistente:!1},null,8,["comportamiento"])]),_:1})}var zt=he(pa,[["render",Na]]);export{zt as default};

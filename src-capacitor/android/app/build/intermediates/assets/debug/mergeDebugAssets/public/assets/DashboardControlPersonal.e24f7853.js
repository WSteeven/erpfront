import{v as D,c as j,e as s,g as m,a3 as N,w as U,j as B,x as R,y as z,S as L,a8 as Q,f as q,U as Z,s as F,A as P,bH as V,t as G,H as M,D as T,bf as H,bg as W,B as x,F as Y,G as J}from"./index.976e8f3c.js";import{Q as K}from"./QPage.ed5d79ca.js";import{E as X}from"./EssentialTable.d8e6954a.js";import{G as ee}from"./GraficoGenerico.18bf69ae.js";import{S as te,z as oe}from"./utils.30e08aa2.js";import{r as E}from"./i18n-validators.06eef631.js";import{u as ae}from"./index.ed676411.js";import{E as re}from"./ErrorComponent.b482e77d.js";import"./QSelect.a8f2bfb2.js";import"./QChip.334d746c.js";import"./QItemSection.c6f2640c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./QPopupProxy.d8ef7a42.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./chart.2729d76a.js";import"./index.95f5a0db.js";const ne=j({__name:"EChartComponente",props:{option:{},labels:{},series:{},height:{},width:{},autoresize:{type:Boolean},theme:{},renderer:{},replaceOnUpdate:{type:Boolean},updateOptions:{}},emits:["finished","click","datazoom","legendselectchanged"],setup(i,{expose:u,emit:l}){const t=i,d=l,c=s(null),g=m(()=>{var e;return(e=t.autoresize)!=null?e:!0}),v=s(!!N.getItem("dark")),_=m(()=>{var e;return(e=t.theme)!=null?e:v.value?"jpDark":"jpLight"}),b=m(()=>{var e;return(e=t.renderer)!=null?e:"canvas"}),w=m(()=>{var r,n;const e=typeof t.height=="number"?`${t.height}px`:(r=t.height)!=null?r:"420px",o=typeof t.width=="string"&&/px|%|vh|vw|rem|em$/.test(t.width),p=typeof t.width=="number"?`${t.width}px`:o?t.width:(n=t.width)!=null?n:"100%";return{height:e,width:p}}),y=m(()=>{var e,o;return{animation:!0,tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{top:10},grid:{left:40,right:20,top:40,bottom:40,containLabel:!0},xAxis:{type:"category",data:(e=t.labels)!=null?e:[],boundaryGap:!1},yAxis:{type:"value",scale:!0,splitLine:{lineStyle:{type:"dashed"}}},series:(o=t.series)!=null&&o.length?t.series:[{name:"Serie 1",type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:3},areaStyle:{opacity:.15},data:[]}]}});function C(e,o){if(Array.isArray(o))return o.slice();const p={...Array.isArray(e)?{}:e};for(const r of Object.keys(o!=null?o:{})){const n=o[r],$=(e!=null?e:{})[r];p[r]=n&&typeof n=="object"&&!Array.isArray(n)?C($,n):n}return p}const h=m(()=>{var e;return Object.keys((e=t.option)!=null?e:{}).length?t.option:y.value}),f=m(()=>t.updateOptions?t.updateOptions:t.replaceOnUpdate?{notMerge:!0,lazyUpdate:!0}:{notMerge:!1,lazyUpdate:!0});U(()=>[t.option,t.labels,t.series],()=>{var e;(e=c.value)!=null&&e.setOption&&c.value.setOption(h.value,f.value)},{deep:!0});function A(e,o){var r,n;const p=C(y.value,e!=null?e:{});(n=(r=c.value)==null?void 0:r.setOption)==null||n.call(r,p,o!=null?o:f.value)}function S(){var e;return(e=c.value)==null?void 0:e.chart}function O(){d("finished")}function k(e){d("click",e)}function I(e){d("datazoom",e)}function a(e){d("legendselectchanged",e)}return B(()=>{var e,o;try{(o=(e=c.value)==null?void 0:e.dispose)==null||o.call(e)}catch{}}),u({setOption:A,getInstance:S}),(e,o)=>{const p=R("VChart");return z(),L(p,{ref_key:"chartRef",ref:c,option:h.value,theme:_.value,renderer:b.value,autoresize:g.value,"update-options":f.value,class:"full-width",style:Q(w.value),onFinished:O,onClick:k,onDatazoom:I,onLegendselectchanged:a},null,8,["option","theme","renderer","autoresize","update-options","style"])}}});var se=D(ne,[["__scopeId","data-v-823c8d02"]]),ie=j({name:"DashboardControlPersonal",components:{ErrorComponent:re,EChartComponente:se,GraficoGenerico:ee,EssentialTable:X},setup(){const i=q({tipo:"",fecha_inicio:"",fecha_fin:""}),{notificarError:u}=Z(),l=new te,t=s([{label:"Asistencias",value:"ASISTENCIAS"},{label:"Atrasos",value:"ATRASOS"}]),d=s(),c=s(),g=s(0),v=s(0),_=s([]),b=s([]),w=s("graficos"),y=s(!0),h=ae({fecha_inicio:{required:E},fecha_fin:{required:E},tipo:{required:E}},i);async function f(){if(await h.value.$validate())try{l.activar(),console.log("Consultando datos",i),g.value=Math.floor(Math.random()*100),v.value=Math.floor(Math.random()*50);const a=await A();console.log("resultados",a),l.desactivar()}catch(a){console.error(a),u(a),l.desactivar()}}async function A(){try{l.activar();const a=P.getInstance(),e=V.URL_BASE+"/"+a.getEndpoint(G.dashboard_control_personal),o=await a.post(e,i);return console.log(o),d.value=o.data.graficos,o.data.results}catch(a){u("Error al consultar el dashboard "+a),await oe(a)}finally{l.desactivar()}}async function S(a){console.log("Click en el evento graficoClickeado",a)}async function O(a){console.log("Click en el evento graficoDataZoom",a)}async function k(){console.log("Click en el evento graficoTerminado")}async function I(a){console.log("Click en el evento graficoCambioLeyenda",a)}return{chartRef:c,dashboard:i,option:d,opcionesTipos:t,totalAsistencias:g,totalAtrasos:v,registros:_,graficos:b,tabs:w,modoUnaColumna:y,v$:h,maskFecha:F,consultar:f,tiposFiltros:["ASISTENCIAS","ATRASOS"],graficoClickeado:S,graficoDataZoom:O,graficoTerminado:k,graficoCambioLeyenda:I}}});const ce={class:"border-1 text-primary text-bold q-mb-lg"},le={class:"row q-col-gutter-sm"},de=["width","height"];function pe(i,u,l,t,d,c){return z(),L(K,{padding:""},{default:M(()=>[T(H,{class:"q-mb-md rounded no-border custom-shadow"},{default:M(()=>[T(W,null,{default:M(()=>[x("div",ce,[T(Y,{name:"bi-graph-up-arrow",class:"q-mr-sm"}),u[0]||(u[0]=J(" An\xE1lisis de datos: M\xF3dulo de Control de Personal "))]),x("div",le,[x("iframe",{title:"Dashboard de Tareas de T\xE9cnicos",width:i.$q.screen.width,height:i.$q.screen.height,src:"https://app.powerbi.com/view?r=eyJrIjoiMTMwNWQxOTUtMDM3Zi00ZTIwLWIxOTktMDI3M2E5MDBmYmY3IiwidCI6IjhiODI2NjQwLTRkZTQtNDEyOS04MWNlLTU3NjE0MTIwZjAwMCIsImMiOjR9",frameborder:"0",allowFullScreen:"true"},null,8,de)])]),_:1})]),_:1})]),_:1})}var Be=D(ie,[["render",pe]]);export{Be as default};

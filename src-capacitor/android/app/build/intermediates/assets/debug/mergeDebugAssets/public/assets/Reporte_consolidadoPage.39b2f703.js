var wo=Object.defineProperty;var go=(o,e,f)=>e in o?wo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var g=(o,e,f)=>(go(o,typeof e!="symbol"?e+"":e,f),f);import{bz as Fo,t as Q,c as So,be as ho,p as P,e as v,ds as B,E as j,a3 as O,s as C,dt as yo,a4 as Ao,A as _o,dr as G,bH as z,v as Io,y as p,S as Vo,H as l,D as i,bf as Oo,bg as M,B as d,z as m,I as $,J as k,M as E,G as F,L as T,R as S,F as h,K as H,k as J,N as K,Q as $o,c8 as ko}from"./index.976e8f3c.js";import{Q as L,a as D}from"./QItemSection.c6f2640c.js";import{Q as R}from"./QSelect.a8f2bfb2.js";import{Q as W,a as X,C as Y}from"./QPopupProxy.d8ef7a42.js";import{Q as Eo}from"./QPage.ed5d79ca.js";import{T as To}from"./TabLayout.d6dcc414.js";import{u as Lo}from"./index.ed676411.js";import{C as Do}from"./ContenedorSimpleMixin.5a0b06ab.js";import{T as Ro}from"./TipoFonfoController.62f8062c.js";import{u as No,W as Z,M as Qo,L as y,s as Uo,A as x}from"./utils.30e08aa2.js";import{E as qo}from"./entidadAuditable.75a46700.js";import{r as N}from"./i18n-validators.06eef631.js";import"./QChip.334d746c.js";import"./QMenu.410ae527.js";import"./position-engine.2f1d750c.js";import"./format.8ac60962.js";import"./QTabs.3c726b04.js";import"./QResizeObserver.6ec10d95.js";import"./QTabPanels.1c8c4baa.js";import"./touch.9135741d.js";import"./buttonSubmits.2eb37d38.js";import"./EssentialTable.d8e6954a.js";import"./QFile.e27868da.js";import"./QTable.048b8be8.js";import"./use-fullscreen.0ccd26e6.js";import"./QToolbar.cff7174f.js";import"./QBtnGroup.7d0835e4.js";import"./QBadge.1ddeabfd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.e0fb285c.js";import"./VisorImagen.e7965569.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.b482e77d.js";import"./EssentialTablePagination.f449a738.js";import"./index.95f5a0db.js";class Po extends qo{constructor(){super();g(this,"empleado");g(this,"tipo_saldo");g(this,"fecha_inicio");g(this,"fecha_fin");this.empleado=null,this.tipo_saldo=null,this.fecha_inicio=null,this.fecha_fin=null}}class Bo extends Fo{constructor(){super(Q.fondo_rotativo_autorizaciones_fecha_pdf)}}var jo=So({components:{TabLayout:To},setup(){ho().setQuasar(P()),No().setQuasar(P());const o=new Do(Po,new Bo),{entidad:e,disabled:f,accion:U,listadosAuxiliares:t}=o.useReferencias(),{setValidador:q,obtenerListados:s,cargarVista:oo}=o.useComportamiento(),eo={tipo_saldo:{required:N},fecha_inicio:{required:N},fecha_fin:{required:N}},I=v(!1),so=v(!1),w=v();w.value=B,t.tipos_saldos=w;const V=Lo(eo,e);q(V.value);const b=v([]),c=v(),A=v([]),_=v([]);b.value=t.usuarios,oo(async()=>{await s({usuarios:{controller:new j,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Ro,params:{campos:"id,descripcion"}}}),b.value=t.usuarios,c.value=O.getItem("usuariosInactivos")==null?[]:JSON.parse(O.getItem("usuariosInactivos").toString()),t.usuariosInactivos=c.value,A.value=t.tiposFondos,_.value=t.tiposFondoRotativoFechas;const a=Z(new Date),n=Qo(a,-1),r=Z(n);e.fecha_inicio=y(r,C),e.fecha_fin=y(n,C)});function ao(a,n){if(a===""){n(()=>{b.value=t.usuarios});return}n(()=>{const r=a.toLowerCase();b.value=t.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(r)>-1||u.apellidos.toLowerCase().indexOf(r)>-1)})}function io(a,n){if(a===""){n(()=>{c.value=t.usuariosInactivos});return}n(()=>{const r=a.toLowerCase();c.value=t.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(r)>-1||u.apellidos.toLowerCase().indexOf(r)>-1)})}function lo(a,n){if(a===""){n(()=>{A.value=t.tiposFondos});return}n(()=>{const r=a.toLowerCase();A.value=t.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(r)>-1)})}function no(a,n){if(a===""){n(()=>{_.value=t.tiposFondoRotativoFechas});return}n(()=>{const r=a.toLowerCase();_.value=t.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(r)>-1)})}function to(a,n){if(a===""){n(()=>{t.tipos_saldos=B,w.value=t.tipos_saldos});return}n(()=>{const r=a.toLowerCase();w.value=t.tipos_saldos.filter(u=>u.label.toLowerCase().indexOf(r)>-1)})}function ro(){const a=b.value.filter(n=>n.id===e.empleado)[0];return(a==null?void 0:a.nombres)+" "+(a==null?void 0:a.apellidos)}async function uo(a,n){if(await V.value.$validate()){const r=_o.getInstance(),u="Reporte consolidado de "+ro()+" del "+a.fecha_inicio+" al "+a.fecha_fin;switch(n){case G.EXCEL:const bo=z.URL_BASE+"/"+r.getEndpoint(Q.consolidado_excel);x(bo,"POST","blob","xlsx",u,a);break;case G.PDF:const Co=z.URL_BASE+"/"+r.getEndpoint(Q.consolidado_pdf);x(Co,"POST","blob","pdf",u,a);break}}}function po(){e.empleado=null,console.log(I.value)}async function mo(){c.value=(await new j().listar({campos:"id,nombres,apellidos",estado:0})).result,t.usuariosInactivos=c.value,O.set("usuariosInactivos",JSON.stringify(c.value))}function fo(a){const n=y(new Date,C);return a<=n}function co(a){const n=y(new Date,C),r=y(e.fecha_inicio!==null?e.fecha_inicio:new Date,C);return a>=r&&a<=n}function vo(){I.value=!1}return{mixin:o,consolidado:e,disabled:f,accion:U,v$:V,maskFecha:C,usuarios:b,usuariosInactivos:c,tiposFondos:A,tiposFondoRotativoFechas:_,tipos_saldos_consolidado:w,tipo_saldo:yo,is_all_empleados:I,is_inactivo:so,ordenarLista:Uo,generar_reporte:uo,filtrarUsuarios:ao,filtrarUsuariosInactivos:io,filtrarTiposFondos:lo,filtrarTiposFondoRotativoFechas:no,filtarTiposSaldos:to,mostrarEmpleados:po,watchEffect:Ao,optionsFechaInicio:fo,optionsFechaFin:co,recargarEmpleadosInactivos:mo,limpiar:vo}}});const Go={class:"col-12 col-md-3"},zo={class:"error-msg"},Mo={key:0,class:"col-12 col-md-3"},Ho={key:1,class:"col-12 col-md-3"},Jo={class:"col-6 col-md-3"},Ko={class:"row items-center justify-end"},Wo={class:"error-msg"},Xo={class:"col-6 col-md-3"},Yo={class:"row items-center justify-end"},Zo={class:"error-msg"},xo={key:2,class:"col-12 col-md-3"},oe={class:"col-12 col-md-3"},ee={class:"col-md-6"},se={class:"col-md-6"};function ae(o,e,f,U,t,q){return p(),Vo(Eo,{padding:"",class:"flex flex-center"},{default:l(()=>[i(Oo,{flat:"",bordered:"",class:"my-card bg-desenfoque"},{default:l(()=>[i(M,null,{default:l(()=>e[15]||(e[15]=[d("div",{class:"row items-center no-wrap"},[d("div",{class:"col"},[d("div",{class:"text-h6"},"Generar Reporte Consolidado de Saldo")])],-1)])),_:1}),i(M,null,{default:l(()=>[d("div",Go,[e[17]||(e[17]=d("label",{class:"q-mb-sm block"},"Tipo de Reporte",-1)),i(R,{modelValue:o.consolidado.tipo_saldo,"onUpdate:modelValue":[e[0]||(e[0]=s=>o.consolidado.tipo_saldo=s),e[2]||(e[2]=s=>o.limpiar())],options:o.tipos_saldos_consolidado,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.tipo_saldo.$errors.length,"error-message":"Debes seleccionar un tipo de saldo","use-input":"","input-debounce":"0",onPopupShow:e[1]||(e[1]=s=>o.ordenarLista(o.tipos_saldos_consolidado,"label")),onBlur:o.v$.tipo_saldo.$touch,onFilter:o.filtarTiposSaldos,"option-value":s=>s.value,"option-label":s=>s.label,"emit-value":"","map-options":""},{error:l(()=>[(p(!0),m($,null,k(o.v$.tipo_saldo.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",zo,E(s.$message),1)]))),128))]),"no-option":l(()=>[i(L,null,{default:l(()=>[i(D,{class:"text-grey"},{default:l(()=>e[16]||(e[16]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),(o.consolidado.tipo_saldo==o.tipo_saldo.ACREDITACIONES||o.consolidado.tipo_saldo==o.tipo_saldo.GASTO||o.consolidado.tipo_saldo==o.tipo_saldo.GASTOS_FOTOGRAFIA||o.consolidado.tipo_saldo==o.tipo_saldo.CONSOLIDADO||o.consolidado.tipo_saldo==o.tipo_saldo.ESTADO_CUENTA||o.consolidado.tipo_saldo==o.tipo_saldo.TRANSFERENCIA_SALDOS)&&!o.is_inactivo?(p(),m("div",Mo,[e[19]||(e[19]=d("label",{class:"q-mb-sm block"},"Empleado",-1)),i(R,{modelValue:o.consolidado.empleado,"onUpdate:modelValue":e[3]||(e[3]=s=>o.consolidado.empleado=s),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onFilter:o.filtrarUsuarios,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":l(()=>[i(L,null,{default:l(()=>[i(D,{class:"text-grey"},{default:l(()=>e[18]||(e[18]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])])):T("",!0),(o.consolidado.tipo_saldo==o.tipo_saldo.ACREDITACIONES||o.consolidado.tipo_saldo==o.tipo_saldo.GASTO||o.consolidado.tipo_saldo==o.tipo_saldo.GASTOS_FOTOGRAFIA||o.consolidado.tipo_saldo==o.tipo_saldo.CONSOLIDADO||o.consolidado.tipo_saldo==o.tipo_saldo.ESTADO_CUENTA||o.consolidado.tipo_saldo==o.tipo_saldo.TRANSFERENCIA_SALDOS)&&o.is_inactivo?(p(),m("div",Ho,[e[21]||(e[21]=d("label",{class:"q-mb-sm block"},"Empleado",-1)),i(R,{modelValue:o.consolidado.empleado,"onUpdate:modelValue":e[5]||(e[5]=s=>o.consolidado.empleado=s),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":l(()=>[i(L,null,{default:l(()=>[i(D,{class:"text-grey"},{default:l(()=>e[20]||(e[20]=[F(" No hay resultados ")])),_:1})]),_:1})]),after:l(()=>[i(S,{color:"positive",onClick:e[4]||(e[4]=s=>o.recargarEmpleadosInactivos())},{default:l(()=>[i(h,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])])):T("",!0),d("div",Jo,[e[22]||(e[22]=d("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(H,{modelValue:o.consolidado.fecha_inicio,"onUpdate:modelValue":e[7]||(e[7]=s=>o.consolidado.fecha_inicio=s),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:l(()=>[i(h,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(X,{modelValue:o.consolidado.fecha_inicio,"onUpdate:modelValue":e[6]||(e[6]=s=>o.consolidado.fecha_inicio=s),mask:o.maskFecha,"today-btn":""},{default:l(()=>[d("div",Ko,[J(i(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[Y]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(p(!0),m($,null,k(o.v$.fecha_inicio.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",Wo,E(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),d("div",Xo,[e[23]||(e[23]=d("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(H,{modelValue:o.consolidado.fecha_fin,"onUpdate:modelValue":e[9]||(e[9]=s=>o.consolidado.fecha_fin=s),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:l(()=>[i(h,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(X,{modelValue:o.consolidado.fecha_fin,"onUpdate:modelValue":e[8]||(e[8]=s=>o.consolidado.fecha_fin=s),mask:o.maskFecha,"today-btn":""},{default:l(()=>[d("div",Yo,[J(i(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[Y]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(p(!0),m($,null,k(o.v$.fecha_fin.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",Zo,E(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),o.consolidado.tipo_saldo==1||o.consolidado.tipo_saldo==2||o.consolidado.tipo_saldo==6?(p(),m("div",xo,[i(K,{modelValue:o.is_all_empleados,"onUpdate:modelValue":[e[10]||(e[10]=s=>o.is_all_empleados=s),e[11]||(e[11]=s=>o.mostrarEmpleados())],color:"secondary",label:"Todos los empleados","true-value":!0,"false-value":!1},null,8,["modelValue"])])):T("",!0),d("div",oe,[i(K,{modelValue:o.is_inactivo,"onUpdate:modelValue":e[12]||(e[12]=s=>o.is_inactivo=s),color:"secondary",label:"Inactivo"},null,8,["modelValue"])])]),_:1}),i($o),i(ko,{align:"around",class:"row q-col-gutter-xs"},{default:l(()=>[d("div",ee,[i(S,{color:"positive",onClick:e[13]||(e[13]=s=>o.generar_reporte(o.consolidado,"excel")),class:"full-width",unelevated:"",square:""},{default:l(()=>[i(h,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[24]||(e[24]=F("Excel"))]),_:1})]),d("div",se,[i(S,{color:"negative",onClick:e[14]||(e[14]=s=>o.generar_reporte(o.consolidado,"pdf")),class:"full-width",unelevated:"",square:""},{default:l(()=>[i(h,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[25]||(e[25]=F("PDF"))]),_:1})])]),_:1})]),_:1})]),_:1})}var Pe=Io(jo,[["render",ae]]);export{Pe as default};

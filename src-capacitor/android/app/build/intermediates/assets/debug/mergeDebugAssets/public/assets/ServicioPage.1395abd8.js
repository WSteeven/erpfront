var L=Object.defineProperty;var D=(o,e,s)=>e in o?L(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var n=(o,e,s)=>(D(o,typeof e!="symbol"?e+"":e,s),s);import{Q as P}from"./QSelect.a8f2bfb2.js";import{A as M,t as Q,c as U,U as j,u as z,v as F,x as H,y as d,S as K,H as c,D as m,a7 as G,B as a,K as V,z as p,I as $,J as S,M as y,aa as J}from"./index.976e8f3c.js";import{Q as W}from"./QForm.ed6f6690.js";import{r as C,a as X,i as Y}from"./i18n-validators.06eef631.js";import{T as Z}from"./TabLayoutFilterTabs2.f1a01a4e.js";import{C as x}from"./ContenedorSimpleMixin.5a0b06ab.js";import{E as _}from"./entidadAuditable.75a46700.js";import{S as oo}from"./ServicioController.b2e406e5.js";import{u as eo}from"./index.ed676411.js";import{b as io,c as ao}from"./vehiculos.utils.c31e027d.js";const so=[{name:"tipo",field:"tipo",label:"Tipo",align:"left",sortable:!0,editable:!1},{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"intervalo",field:"intervalo",label:"Aplicar cada (Km)",align:"left",sortable:!0},{name:"notificar_antes",field:"notificar_antes",label:"Notificar faltando (Km)",align:"center",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];class ro extends _{constructor(){super();n(this,"nombre");n(this,"tipo");n(this,"intervalo");n(this,"notificar_antes");n(this,"estado");this.nombre=null,this.tipo=null,this.intervalo=null,this.notificar_antes=null,this.estado=!0}}class A{constructor(){n(this,"axios");this.axios=M.getInstance()}async anular(e){return this.solicitud("/anular/",e)}async solicitud(e,s,u){const v=this.axios.getEndpoint(Q.servicios)+e+s,b=await this.axios.post(v,u);return{response:b,result:b.data.modelo}}}var to=U({components:{TabLayoutFilterTabs2:Z},props:{mostrarListado:{type:Boolean,default:!0}},setup(o,{emit:e}){const s=new x(ro,new oo),{entidad:u,disabled:v,listadosAuxiliares:b,accion:f,listado:i}=s.useReferencias(),{setValidador:q,obtenerListados:$o,cargarVista:So,listar:g}=s.useComportamiento(),{onReestablecer:yo,onGuardado:w,onConsultado:Co,onModificado:Eo}=s.useHooks(),{confirmar:E,prompt:ko,notificarCorrecto:k,notificarError:O}=j(),I=z(),T="PREVENTIVO",N="CORRECTIVO",B={nombre:{required:C},tipo:{required:C},intervalo:{requiredIf:X(()=>u.tipo==T),integer:Y},notificar_antes:{required:C}},h=eo(B,u);q(h.value),w((r,t)=>{e("cerrar-modal",!1),e("guardado",{formulario:"ServicioPage",id:r,modelo:t.modelo})});async function R(r){switch(r){case T:g({tipo:r});break;case N:g({tipo:r});break;default:g()}}return{mixin:s,servicio:u,disabled:v,accion:f,v$:h,configuracionColumnas:so,tiposServicios:io,tabOptionsServicios:ao,filtrarServicios:R,btnDesactivar:{titulo:"Desactivar",color:"negative",icono:"bi-toggle2-off",tooltip:"Desactivar servicio",accion:({entidad:r,posicion:t})=>{E("\xBFEst\xE1 seguro de desactivar el servicio?",async()=>{try{const{result:l}=await new A().anular(r.id);l.estado||(k("Servicio desactivado con \xE9xito"),i.value.splice(t,1,l))}catch{O("No se pudo desactivar el servicio")}})},visible:({entidad:r,posicion:t})=>r.estado&&I.esAdministradorVehiculos},btnActivar:{titulo:"Activar",color:"positive",icono:"bi-toggle2-on",tooltip:"Activar Servicio",accion:({entidad:r,posicion:t})=>{E("\xBFEst\xE1 seguro de activar el servicio?",async()=>{try{const{result:l}=await new A().anular(r.id);l.estado&&(k("Servicio activado con \xE9xito"),i.value.splice(t,1,l))}catch{O("No se pudo activar el servicio")}})},visible:({entidad:r,posicion:t})=>!r.estado&&I.esAdministradorVehiculos}}}});const lo={class:"row q-col-gutter-sm q-py-md"},no={class:"col-12 col-md-3"},co={class:"col-12 col-md-3 q-mb-md"},uo={class:"error-msg"},mo={class:"col-12 col-md-3 q-mb-md"},po={class:"error-msg"},vo={class:"col-12 col-md-3 q-mb-md"},bo={class:"error-msg"},fo={class:"col-12 col-md-3"};function go(o,e,s,u,v,b){const f=H("tab-layout-filter-tabs2");return d(),K(f,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,ajustarCeldas:!0,"tab-options":o.tabOptionsServicios,tabDefecto:"PREVENTIVO",filtrar:o.filtrarServicios,"titulo-pagina":"Servicios de Mantenimientos",accion1:o.btnDesactivar,accion2:o.btnActivar,mostrarListado:o.mostrarListado,forzarListar:!o.mostrarListado},{formulario:c(()=>[m(W,{onSubmit:e[5]||(e[5]=G(()=>{},["prevent"]))},{default:c(()=>[a("div",lo,[a("div",no,[e[6]||(e[6]=a("label",{class:"q-mb-sm block"},"Tipo",-1)),m(P,{modelValue:o.servicio.tipo,"onUpdate:modelValue":e[0]||(e[0]=i=>o.servicio.tipo=i),options:o.tiposServicios,"transition-show":"jump-up","transition-hide":"jump-down",disable:o.disabled,"options-dense":"",dense:"",outlined:"","error-message":"Debes seleccionar un tipo de mantenimiento","option-value":i=>i.value,"option-label":i=>i.label,"emit-value":"","map-options":""},null,8,["modelValue","options","disable","option-value","option-label"])]),a("div",co,[e[7]||(e[7]=a("label",{class:"q-mb-sm block"},"Nombre",-1)),m(V,{modelValue:o.servicio.nombre,"onUpdate:modelValue":e[1]||(e[1]=i=>o.servicio.nombre=i),placeholder:"Obligatorio",disable:o.disabled,error:!!o.v$.nombre.$errors.length,outlined:"",dense:""},{error:c(()=>[(d(!0),p($,null,S(o.v$.nombre.$errors,i=>(d(),p("div",{key:i.$uid},[a("div",uo,y(i.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])]),a("div",mo,[e[9]||(e[9]=a("label",{class:"q-mb-sm block"},"Realizar cada ",-1)),m(V,{modelValue:o.servicio.intervalo,"onUpdate:modelValue":e[2]||(e[2]=i=>o.servicio.intervalo=i),placeholder:"Opcional",hint:"Campo obligatorio si el tipo es preventivo",type:"number",step:"100",min:"0",disable:o.disabled,error:!!o.v$.intervalo.$errors.length,"error-mesagge":"Ingresa solo n\xFAmeros enteros",onBlur:o.v$.intervalo.$touch,outlined:"",dense:""},{error:c(()=>[(d(!0),p($,null,S(o.v$.intervalo.$errors,i=>(d(),p("div",{key:i.$uid},[a("div",po,y(i.$message),1)]))),128))]),append:c(()=>e[8]||(e[8]=[a("div",null,"km",-1)])),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",vo,[e[11]||(e[11]=a("label",{class:"q-mb-sm block"},"Notificar faltando",-1)),m(V,{modelValue:o.servicio.notificar_antes,"onUpdate:modelValue":e[3]||(e[3]=i=>o.servicio.notificar_antes=i),placeholder:"Opcional",hint:"Establece la cantidad de km donde se notificar\xE1 el servicio",type:"number",step:"100",min:"0",disable:o.disabled,outlined:"",dense:"",error:!!o.v$.notificar_antes.$errors.length,onBlur:o.v$.intervalo.$touch},{error:c(()=>[(d(!0),p($,null,S(o.v$.notificar_antes.$errors,i=>(d(),p("div",{key:i.$uid},[a("div",bo,y(i.$message),1)]))),128))]),append:c(()=>e[10]||(e[10]=[a("div",null,"km",-1)])),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",fo,[e[12]||(e[12]=a("label",{class:"q-mb-sm block"},"Estado",-1)),m(J,{label:o.servicio.estado?"ACTIVO":"INACTIVO",modelValue:o.servicio.estado,"onUpdate:modelValue":e[4]||(e[4]=i=>o.servicio.estado=i),color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear",disable:o.disabled},null,8,["label","modelValue","disable"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","filtrar","accion1","accion2","mostrarListado","forzarListar"])}var Vo=F(to,[["render",go]]),Mo=Object.freeze(Object.defineProperty({__proto__:null,default:Vo},Symbol.toStringTag,{value:"Module"}));export{Vo as S,Mo as a,so as c};

import{Q as F}from"./QSelect.b920278b.js";import{Q as re,a as ie}from"./QItemSection.ec4cc512.js";import{d as ne,R as ce,c as w,dv as R,e as ue,q as T,A as me,bG as de,s as pe,_ as fe,t as G,v as r,P as f,F as s,z as a,y as l,be as B,x as u,G as N,H as I,K as $,D as A,J as n,I as x,B as y,j as z,O as k,a5 as be}from"./index.b8e09611.js";import{Q as D,a as M,C as H}from"./QPopupProxy.685eacb5.js";import{Q as ve}from"./QBtnGroup.7d38eecd.js";import{a as he,Q as j}from"./QTabPanels.1776fc83.js";import{Q as ge}from"./QPage.e6f8825d.js";import{Q as Ce,a as Ve}from"./QLayout.9e55ed7f.js";import{r as K}from"./i18n-validators.06abe774.js";import{u as we}from"./index.70965bc7.js";import{E as ye}from"./EssentialTable.23af6cc8.js";import{G as ke}from"./GraficoGenerico.884603b4.js";import{S as _e,v as Qe,A as J}from"./utils.9344cd7e.js";import{C as W}from"./CombustibleController.8c064315.js";import{C as qe}from"./ContenedorSimpleMixin.4e22246b.js";import{C as Be}from"./Combustible.d039307e.js";import{u as Ne}from"./filtrosListadosGenerales.87fcb144.js";import{V as Ie}from"./VehiculoController.30a3b5a2.js";import{o as $e}from"./graficoGenerico.2759c2ea.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./touch.9135741d.js";import"./QScrollObserver.8813f664.js";import"./QResizeObserver.1422c274.js";import"./index.ea415f98.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBadge.89898cd2.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./chart.2729d76a.js";import"./entidadAuditable.75a46700.js";var Ee=ne({components:{EssentialTable:ye,GraficoGenerico:ke},setup(){const e=new qe(Be,new W),{listadosAuxiliares:t}=e.useReferencias(),{notificarError:E,notificarAdvertencia:P}=ce(),m=new _e,v="COMBUSTIBLE",b="VEHICULO",h=[v,b],g=w(!0),C=w(R.grafico),o=ue({tipo:null,fecha_inicio:null,fecha_fin:"",vehiculo:null,todos:!1}),d=w(),c=w([]),{combustibles:L,filtrarCombustibles:X,vehiculos:U,filtrarVehiculos:Y}=Ne(t);o.fecha_fin=Qe(T);const Z=[{name:"combustible",field:"combustible",label:"Combustible",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"center",sortable:!0},{name:"recorrido",field:"recorrido",label:"Km Recorridos",align:"left",sortable:!0}],ee=[{name:"vehiculo",field:"vehiculo",label:"Veh\xEDculo",align:"left",sortable:!0},{name:"combustible",field:"combustible",label:"Combustible",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"center",sortable:!0},{name:"recorrido",field:"recorrido",label:"Km Recorridos",align:"left",sortable:!0}],S=we({tipo:{required:K},fecha_inicio:{required:K}},o);async function oe(){m.activar();const i=await new W().listar();t.combustibles=i.result,L.value=i.result,m.desactivar()}async function te(){m.activar();const i=await new Ie().listar();t.vehiculos=i.result,U.value=i.result,m.desactivar()}async function se(i){switch(d.value=null,i){case v:await oe();break;case b:await te();break;default:console.log(i)}}async function ae(i,p,_){if(await S.value.$validate())try{m.activar();const V=me.getInstance(),Q=de.URL_BASE+"/"+V.getEndpoint(pe.reporte_combustibles),O="reporte_conductores";switch(i){case"excel":return p.accion="excel",J(Q,"POST","blob","xlsx",O,p),_;case"pdf":return p.accion="pdf",J(Q,"POST","blob","pdf",O,p),_;default:p.accion="";const q=await V.post(Q,p);return q.data.results?(q.data.results.length<1&&P("No se obtuvieron resultados"),q.data.results):_}}catch(V){console.log(V),E("Error al obtener el reporte")}finally{m.desactivar()}}async function le(i){d.value=await ae(i,o,c.value),c.value=d.value.results}return{reporte:o,v$:S,maskFecha:T,tabs:C,opcionesGrafico:R,optionsPie:$e,results:d,configuracionColumnasVehiculos:ee,configuracionColumnasCombustibles:Z,modoUnaColumna:g,COMBUSTIBLE:v,VEHICULO:b,listado:c,opciones:h,combustibles:L,filtrarCombustibles:X,vehiculos:U,filtrarVehiculos:Y,consultarListado:se,buscarReporte:le}}});const Pe={class:"col"},Le={class:"row q-col-gutter-sm q-pa-sm q-py-md"},Ue={class:"col-12 col-md-3"},Se={class:"error-msg"},Oe={key:0,class:"col-12 col-md-3 col-sm-6 q-mb-md"};const Fe={class:"col-12 col-md-3"},Re={class:"row items-center justify-end"},Te={class:"error-msg"},Ge={class:"col-12 col-md-3"},Ae={class:"row items-center justify-end"},xe={class:"col-12 col-md-12 q-mt-md"},ze={class:"text-center"},De={class:"text-subtitle2 q-mb-lg"},Me={class:"row q-col-gutter-sm q-py-md q-mb-lg"},He={class:"col-12"},je={class:"row q-col-gutter-sm q-py-md q-mb-lg"},Ke={class:"col-12"};function Je(e,t,E,P,m,v){const b=G("grafico-generico"),h=G("essential-table");return r(),f(Ve,null,{default:s(()=>[a(Ce,null,{default:s(()=>[a(ge,{padding:""},{default:s(()=>{var g,C;return[l("div",Pe,[a(B,{class:"rounded-card custom-shadow"},{default:s(()=>[l("div",Le,[l("div",Ue,[t[13]||(t[13]=l("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),a(F,{modelValue:e.reporte.tipo,"onUpdate:modelValue":[t[0]||(t[0]=o=>e.reporte.tipo=o),t[1]||(t[1]=o=>e.consultarListado(e.reporte.tipo))],options:e.opciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",error:!!e.v$.tipo.$errors.length,"emit-value":"","map-options":""},{error:s(()=>[(r(!0),u(N,null,I(e.v$.tipo.$errors,o=>(r(),u("div",{key:o.$uid},[l("div",Se,$(o.$message),1)]))),128))]),_:1},8,["modelValue","options","error"])]),e.reporte.tipo===e.COMBUSTIBLE?(r(),u("div",Oe,[t[15]||(t[15]=l("label",{class:"q-mb-sm block"},"Tipo de combustible",-1)),a(F,{modelValue:e.reporte.combustible,"onUpdate:modelValue":t[2]||(t[2]=o=>e.reporte.combustible=o),options:e.combustibles,"transition-show":"scale","transition-hide":"scale",hint:"OPCIONAL","options-dense":"",clearable:"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarCombustibles,"option-label":o=>o.nombre,"option-value":o=>o.id,"emit-value":"","map-options":""},{"no-option":s(()=>[a(re,null,{default:s(()=>[a(ie,{class:"text-grey"},{default:s(()=>t[14]||(t[14]=[A(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),n("",!0),l("div",Fe,[t[18]||(t[18]=l("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),a(x,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":t[5]||(t[5]=o=>e.reporte.fecha_inicio=o),error:!!e.v$.fecha_inicio.$errors.length,placeholder:"Opcional",outlined:"",dense:""},{append:s(()=>[a(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(M,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":t[4]||(t[4]=o=>e.reporte.fecha_inicio=o),mask:e.maskFecha,"today-btn":""},{default:s(()=>[l("div",Re,[z(a(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:s(()=>[(r(!0),u(N,null,I(e.v$.fecha_inicio.$errors,o=>(r(),u("div",{key:o.$uid},[l("div",Te,$(o.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),l("div",Ge,[t[19]||(t[19]=l("label",{class:"q-mb-sm block"},"Fecha fin ",-1)),a(x,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":t[7]||(t[7]=o=>e.reporte.fecha_fin=o),placeholder:"Opcional",outlined:"",dense:""},{append:s(()=>[a(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(M,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":t[6]||(t[6]=o=>e.reporte.fecha_fin=o),mask:e.maskFecha,"today-btn":""},{default:s(()=>[l("div",Ae,[z(a(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",xe,[l("div",ze,[a(ve,{push:""},{default:s(()=>[a(k,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:t[8]||(t[8]=o=>e.buscarReporte("consulta"))},{default:s(()=>[a(y,{name:"bi-search",size:"xs",class:"q-pr-sm"}),t[20]||(t[20]=l("span",null,"Buscar",-1))]),_:1}),n("",!0),n("",!0)]),_:1})])])])]),_:1}),e.reporte.tipo==e.COMBUSTIBLE&&((g=e.results)==null?void 0:g.results.length)?(r(),f(B,{key:0,class:"q-mb-md q-mt-sm rounded no-border custom-shadow"},{default:s(()=>[t[24]||(t[24]=l("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Gr\xE1ficos Estad\xEDsticos ",-1)),a(he,{modelValue:e.tabs,"onUpdate:modelValue":t[12]||(t[12]=o=>e.tabs=o),animated:"","transition-prev":"scale","transition-next":"scale","keep-alive":""},{default:s(()=>[a(j,{name:e.opcionesGrafico.grafico},{default:s(()=>{var o,d;return[e.results!==null?(r(),u("div",{key:0,class:be(["q-col-gutter-y-xl q-col-gutter-x-xs q-mb-xl",{row:!e.modoUnaColumna,column:e.modoUnaColumna}])},[(r(!0),u(N,null,I((o=e.results)==null?void 0:o.graficos,c=>(r(),u("div",{class:"col-12 col-md-6 text-center",key:c.id},[l("div",De,$(c.encabezado),1),l("div",null,[c?(r(),f(b,{key:0,data:c,options:e.optionsPie},null,8,["data","options"])):n("",!0)])]))),128))],2)):n("",!0),l("div",Me,[l("div",He,[(d=e.results.results)!=null&&d.length?(r(),f(h,{key:0,titulo:"Valores",configuracionColumnas:e.configuracionColumnasCombustibles,datos:e.results.results,altoFijo:!1},null,8,["configuracionColumnas","datos"])):n("",!0)])])]}),_:1},8,["name"]),a(j,{name:e.opcionesGrafico.listado},{default:s(()=>[a(k,{color:"primary",onClick:t[11]||(t[11]=o=>e.tabs=e.opcionesGrafico.grafico),glossy:"","no-caps":"",rounded:"",unelevated:"",class:"q-mx-auto block"},{default:s(()=>[a(y,{name:"bi-arrow-left"}),t[23]||(t[23]=A(" Regresar al gr\xE1fico"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"])]),_:1})):n("",!0),e.reporte.tipo==e.VEHICULO&&((C=e.results)==null?void 0:C.results.length)?(r(),f(B,{key:1,class:"q-mb-md q-mt-sm rounded no-border custom-shadow"},{default:s(()=>{var o;return[l("div",je,[l("div",Ke,[(o=e.results.results)!=null&&o.length?(r(),f(h,{key:0,titulo:"Valores",configuracionColumnas:e.configuracionColumnasVehiculos,datos:e.results.results,mostrarExportar:"",altoFijo:!1},null,8,["configuracionColumnas","datos"])):n("",!0)])])]}),_:1})):n("",!0)])]}),_:1})]),_:1})]),_:1})}var Go=fe(Ee,[["render",Je]]);export{Go as default};

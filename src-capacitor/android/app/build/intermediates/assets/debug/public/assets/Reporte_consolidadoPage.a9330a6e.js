var wo=Object.defineProperty;var go=(o,e,f)=>e in o?wo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var g=(o,e,f)=>(go(o,typeof e!="symbol"?e+"":e,f),f);import{bw as Fo,s as N,d as So,m as P,c as v,d6 as B,E as j,a0 as V,q as C,d7 as ho,a1 as yo,A as _o,d5 as G,bE as z,_ as Io,v as p,P as Ao,F as l,z as i,bc as M,y as d,x as m,H as $,G as k,D as F,J as E,O as S,B as h,I as H,j as J,L as K,Q as Oo,c8 as Vo,bb as $o,K as T}from"./index.6449c167.js";import{Q as D,a as L}from"./QItemSection.9a955ec6.js";import{Q}from"./QSelect.6ce302d7.js";import{Q as X,a as W,C as Y}from"./QPopupProxy.72ff1d6d.js";import{Q as ko}from"./QPage.5d173a8a.js";import{T as Eo}from"./TabLayout.0bce4313.js";import{b as To,u as Do,Q as Z,I as Lo,H as y,w as Qo,B as x}from"./utils.521b98f3.js";import{u as Ro}from"./index.490dde02.js";import{C as No}from"./ContenedorSimpleMixin.09c9bed5.js";import{T as Uo}from"./TipoFonfoController.f781a23b.js";import{E as qo}from"./entidadAuditable.75a46700.js";import{r as R}from"./i18n-validators.29e2545c.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTable.00c17e97.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./EssentialTablePagination.d5c1010a.js";import"./index.0198dd12.js";class Po extends qo{constructor(){super();g(this,"empleado");g(this,"tipo_saldo");g(this,"fecha_inicio");g(this,"fecha_fin");this.empleado=null,this.tipo_saldo=null,this.fecha_inicio=null,this.fecha_fin=null}}class Bo extends Fo{constructor(){super(N.fondo_rotativo_autorizaciones_fecha_pdf)}}var jo=So({components:{TabLayout:Eo},setup(){To().setQuasar(P()),Do().setQuasar(P());const o=new No(Po,new Bo),{entidad:e,disabled:f,accion:U,listadosAuxiliares:t}=o.useReferencias(),{setValidador:q,obtenerListados:s,cargarVista:oo}=o.useComportamiento(),eo={tipo_saldo:{required:R},fecha_inicio:{required:R},fecha_fin:{required:R}},A=v(!1),so=v(!1),w=v();w.value=B,t.tipos_saldos=w;const O=Ro(eo,e);q(O.value);const b=v([]),c=v(),_=v([]),I=v([]);b.value=t.usuarios,oo(async()=>{await s({usuarios:{controller:new j,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Uo,params:{campos:"id,descripcion"}}}),b.value=t.usuarios,c.value=V.getItem("usuariosInactivos")==null?[]:JSON.parse(V.getItem("usuariosInactivos").toString()),t.usuariosInactivos=c.value,_.value=t.tiposFondos,I.value=t.tiposFondoRotativoFechas;const a=Z(new Date),n=Lo(a,-1),r=Z(n);e.fecha_inicio=y(r,C),e.fecha_fin=y(n,C)});function ao(a,n){if(a===""){n(()=>{b.value=t.usuarios});return}n(()=>{const r=a.toLowerCase();b.value=t.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(r)>-1||u.apellidos.toLowerCase().indexOf(r)>-1)})}function io(a,n){if(a===""){n(()=>{c.value=t.usuariosInactivos});return}n(()=>{const r=a.toLowerCase();c.value=t.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(r)>-1||u.apellidos.toLowerCase().indexOf(r)>-1)})}function lo(a,n){if(a===""){n(()=>{_.value=t.tiposFondos});return}n(()=>{const r=a.toLowerCase();_.value=t.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(r)>-1)})}function no(a,n){if(a===""){n(()=>{I.value=t.tiposFondoRotativoFechas});return}n(()=>{const r=a.toLowerCase();I.value=t.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(r)>-1)})}function to(a,n){if(a===""){n(()=>{t.tipos_saldos=B,w.value=t.tipos_saldos});return}n(()=>{const r=a.toLowerCase();w.value=t.tipos_saldos.filter(u=>u.label.toLowerCase().indexOf(r)>-1)})}function ro(){const a=b.value.filter(n=>n.id===e.empleado)[0];return(a==null?void 0:a.nombres)+" "+(a==null?void 0:a.apellidos)}async function uo(a,n){if(await O.value.$validate()){const r=_o.getInstance(),u="Reporte consolidado de "+ro()+" del "+a.fecha_inicio+" al "+a.fecha_fin;switch(n){case G.EXCEL:const bo=z.URL_BASE+"/"+r.getEndpoint(N.consolidado_excel);x(bo,"POST","blob","xlsx",u,a);break;case G.PDF:const Co=z.URL_BASE+"/"+r.getEndpoint(N.consolidado_pdf);x(Co,"POST","blob","pdf",u,a);break}}}function po(){e.empleado=null,console.log(A.value)}async function mo(){c.value=(await new j().listar({campos:"id,nombres,apellidos",estado:0})).result,t.usuariosInactivos=c.value,V.set("usuariosInactivos",JSON.stringify(c.value))}function fo(a){const n=y(new Date,C);return a<=n}function co(a){const n=y(new Date,C),r=y(e.fecha_inicio!==null?e.fecha_inicio:new Date,C);return a>=r&&a<=n}function vo(){A.value=!1}return{mixin:o,consolidado:e,disabled:f,accion:U,v$:O,maskFecha:C,usuarios:b,usuariosInactivos:c,tiposFondos:_,tiposFondoRotativoFechas:I,tipos_saldos_consolidado:w,tipo_saldo:ho,is_all_empleados:A,is_inactivo:so,ordenarLista:Qo,generar_reporte:uo,filtrarUsuarios:ao,filtrarUsuariosInactivos:io,filtrarTiposFondos:lo,filtrarTiposFondoRotativoFechas:no,filtarTiposSaldos:to,mostrarEmpleados:po,watchEffect:yo,optionsFechaInicio:fo,optionsFechaFin:co,recargarEmpleadosInactivos:mo,limpiar:vo}}});const Go={class:"col-12 col-md-3"},zo={class:"error-msg"},Mo={key:0,class:"col-12 col-md-3"},Ho={key:1,class:"col-12 col-md-3"},Jo={class:"col-6 col-md-3"},Ko={class:"row items-center justify-end"},Xo={class:"error-msg"},Wo={class:"col-6 col-md-3"},Yo={class:"row items-center justify-end"},Zo={class:"error-msg"},xo={key:2,class:"col-12 col-md-3"},oe={class:"col-12 col-md-3"},ee={class:"col-md-6"},se={class:"col-md-6"};function ae(o,e,f,U,t,q){return p(),Ao(ko,{padding:"",class:"flex flex-center"},{default:l(()=>[i($o,{flat:"",bordered:"",class:"my-card bg-desenfoque"},{default:l(()=>[i(M,null,{default:l(()=>e[15]||(e[15]=[d("div",{class:"row items-center no-wrap"},[d("div",{class:"col"},[d("div",{class:"text-h6"},"Generar Reporte Consolidado de Saldo")])],-1)])),_:1}),i(M,null,{default:l(()=>[d("div",Go,[e[17]||(e[17]=d("label",{class:"q-mb-sm block"},"Tipo de Reporte",-1)),i(Q,{modelValue:o.consolidado.tipo_saldo,"onUpdate:modelValue":[e[0]||(e[0]=s=>o.consolidado.tipo_saldo=s),e[2]||(e[2]=s=>o.limpiar())],options:o.tipos_saldos_consolidado,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.tipo_saldo.$errors.length,"error-message":"Debes seleccionar un tipo de saldo","use-input":"","input-debounce":"0",onPopupShow:e[1]||(e[1]=s=>o.ordenarLista(o.tipos_saldos_consolidado,"label")),onBlur:o.v$.tipo_saldo.$touch,onFilter:o.filtarTiposSaldos,"option-value":s=>s.value,"option-label":s=>s.label,"emit-value":"","map-options":""},{error:l(()=>[(p(!0),m(k,null,$(o.v$.tipo_saldo.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",zo,T(s.$message),1)]))),128))]),"no-option":l(()=>[i(D,null,{default:l(()=>[i(L,{class:"text-grey"},{default:l(()=>e[16]||(e[16]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),(o.consolidado.tipo_saldo==o.tipo_saldo.ACREDITACIONES||o.consolidado.tipo_saldo==o.tipo_saldo.GASTO||o.consolidado.tipo_saldo==o.tipo_saldo.GASTOS_FOTOGRAFIA||o.consolidado.tipo_saldo==o.tipo_saldo.CONSOLIDADO||o.consolidado.tipo_saldo==o.tipo_saldo.ESTADO_CUENTA||o.consolidado.tipo_saldo==o.tipo_saldo.TRANSFERENCIA_SALDOS)&&!o.is_inactivo?(p(),m("div",Mo,[e[19]||(e[19]=d("label",{class:"q-mb-sm block"},"Empleado",-1)),i(Q,{modelValue:o.consolidado.empleado,"onUpdate:modelValue":e[3]||(e[3]=s=>o.consolidado.empleado=s),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onFilter:o.filtrarUsuarios,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":l(()=>[i(D,null,{default:l(()=>[i(L,{class:"text-grey"},{default:l(()=>e[18]||(e[18]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])])):E("",!0),(o.consolidado.tipo_saldo==o.tipo_saldo.ACREDITACIONES||o.consolidado.tipo_saldo==o.tipo_saldo.GASTO||o.consolidado.tipo_saldo==o.tipo_saldo.GASTOS_FOTOGRAFIA||o.consolidado.tipo_saldo==o.tipo_saldo.CONSOLIDADO||o.consolidado.tipo_saldo==o.tipo_saldo.ESTADO_CUENTA||o.consolidado.tipo_saldo==o.tipo_saldo.TRANSFERENCIA_SALDOS)&&o.is_inactivo?(p(),m("div",Ho,[e[21]||(e[21]=d("label",{class:"q-mb-sm block"},"Empleado",-1)),i(Q,{modelValue:o.consolidado.empleado,"onUpdate:modelValue":e[5]||(e[5]=s=>o.consolidado.empleado=s),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":s=>s.id,"option-label":s=>s.nombres+" "+s.apellidos,"emit-value":"","map-options":""},{"no-option":l(()=>[i(D,null,{default:l(()=>[i(L,{class:"text-grey"},{default:l(()=>e[20]||(e[20]=[F(" No hay resultados ")])),_:1})]),_:1})]),after:l(()=>[i(S,{color:"positive",onClick:e[4]||(e[4]=s=>o.recargarEmpleadosInactivos())},{default:l(()=>[i(h,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onFilter","option-value","option-label"])])):E("",!0),d("div",Jo,[e[22]||(e[22]=d("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(H,{modelValue:o.consolidado.fecha_inicio,"onUpdate:modelValue":e[7]||(e[7]=s=>o.consolidado.fecha_inicio=s),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:l(()=>[i(h,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(W,{modelValue:o.consolidado.fecha_inicio,"onUpdate:modelValue":e[6]||(e[6]=s=>o.consolidado.fecha_inicio=s),mask:o.maskFecha,"today-btn":""},{default:l(()=>[d("div",Ko,[J(i(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[Y]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(p(!0),m(k,null,$(o.v$.fecha_inicio.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",Xo,T(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),d("div",Wo,[e[23]||(e[23]=d("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(H,{modelValue:o.consolidado.fecha_fin,"onUpdate:modelValue":e[9]||(e[9]=s=>o.consolidado.fecha_fin=s),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:l(()=>[i(h,{name:"event",class:"cursor-pointer"},{default:l(()=>[i(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[i(W,{modelValue:o.consolidado.fecha_fin,"onUpdate:modelValue":e[8]||(e[8]=s=>o.consolidado.fecha_fin=s),mask:o.maskFecha,"today-btn":""},{default:l(()=>[d("div",Yo,[J(i(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[Y]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(p(!0),m(k,null,$(o.v$.fecha_fin.$errors,s=>(p(),m("div",{key:s.$uid},[d("div",Zo,T(s.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),o.consolidado.tipo_saldo==1||o.consolidado.tipo_saldo==2||o.consolidado.tipo_saldo==6?(p(),m("div",xo,[i(K,{modelValue:o.is_all_empleados,"onUpdate:modelValue":[e[10]||(e[10]=s=>o.is_all_empleados=s),e[11]||(e[11]=s=>o.mostrarEmpleados())],color:"secondary",label:"Todos los empleados","true-value":!0,"false-value":!1},null,8,["modelValue"])])):E("",!0),d("div",oe,[i(K,{modelValue:o.is_inactivo,"onUpdate:modelValue":e[12]||(e[12]=s=>o.is_inactivo=s),color:"secondary",label:"Inactivo"},null,8,["modelValue"])])]),_:1}),i(Oo),i(Vo,{align:"around",class:"row q-col-gutter-xs"},{default:l(()=>[d("div",ee,[i(S,{color:"positive",onClick:e[13]||(e[13]=s=>o.generar_reporte(o.consolidado,"excel")),class:"full-width",unelevated:"",square:""},{default:l(()=>[i(h,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[24]||(e[24]=F("Excel"))]),_:1})]),d("div",se,[i(S,{color:"negative",onClick:e[14]||(e[14]=s=>o.generar_reporte(o.consolidado,"pdf")),class:"full-width",unelevated:"",square:""},{default:l(()=>[i(h,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[25]||(e[25]=F("PDF"))]),_:1})])]),_:1})]),_:1})]),_:1})}var Ne=Io(jo,[["render",ae]]);export{Ne as default};

var ra=Object.defineProperty;var na=(e,a,r)=>a in e?ra(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var i=(e,a,r)=>(na(e,typeof a!="symbol"?a+"":a,r),r);import{Q as sa}from"./QPage.5d173a8a.js";import{A as ia,s as T,bD as y,bw as R,d as F,m as $,u as U,c as M,_ as D,t as _,v as c,P as G,F as f,z as n,a4 as ta,y as s,x as m,I as g,J as v,G as la,H as ua,K as N,L as ca,O as A,B as k,D as E,bf as da,d1 as ma,p as fa,d2 as I}from"./index.6449c167.js";import{E as pa}from"./EssentialTableTabs.586dbdfc.js";import{C as H}from"./ContenedorSimpleMixin.09c9bed5.js";import{G as ba}from"./Gasto.2946018b.js";import{b as j,S as J,a as va,u as ga}from"./utils.521b98f3.js";import{M as Ta}from"./ModalEntidad.168b465e.js";import{C as Ea,a as za}from"./ComponenteModal.domain.50e59f97.js";import{Q as Ca}from"./QForm.ca56f146.js";import{T as Va}from"./TabLayout.0bce4313.js";import{S as _a}from"./EssentialTable.00c17e97.js";import{u as wa}from"./index.490dde02.js";import{r as q,b as L}from"./i18n-validators.29e2545c.js";import{u as K,c as Sa}from"./transferenciaSaldo.a7aaa0aa.js";import{E as ha}from"./entidadAuditable.75a46700.js";import"./QBadge.e6f320cd.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QSelect.6ce302d7.js";import"./QChip.95469f73.js";import"./QItemSection.9a955ec6.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./EssentialTablePagination.d5c1010a.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./buttonSubmits.fe817da3.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./index.0198dd12.js";const ya=[{name:"usuario_envia_info",field:"usuario_envia_info",label:"Enviado por",align:"left",sortable:!0},{name:"usuario_recibe_info",field:"usuario_recibe_info",label:"Recibido por",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"left",sortable:!0},{name:"motivo",field:"motivo",label:"Motivo",align:"left",sortable:!0}];class Aa{constructor(){i(this,"axios");this.axios=ia.getInstance()}async aprobarTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.aprobar_trnasferencia),a)}catch(r){const t=r;throw new y(t)}}async rechazarTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.rechazar_transferencia),a)}catch(r){const t=r;throw new y(t)}}async anularTransferencia(a){try{await this.axios.post(this.axios.getEndpoint(T.anular_transferencia),a)}catch(r){const t=r;throw new y(t)}}}class ka extends R{constructor(){super(T.transferencia)}}class qa extends ha{constructor(){super();i(this,"usuario_envia_info");i(this,"usuario_recibe_info");i(this,"usuario_envia");i(this,"usuario_recibe");i(this,"monto");i(this,"motivo");i(this,"cuenta");i(this,"tarea");i(this,"tarea_info");i(this,"comprobante");i(this,"estado_info");i(this,"es_devolucion");this.comprobante=null,this.usuario_envia_info=null,this.es_devolucion=!1,this.usuario_envia=null,this.usuario_recibe=null,this.monto=null,this.motivo="DEVOLUCION",this.cuenta=null,this.usuario_recibe_info=null,this.tarea=null,this.tarea_info=null,this.estado_info=null}}var $a=F({components:{TabLayout:Va,SelectorImagen:_a},emits:["guardado","cerrar-modal"],setup(e,{emit:a}){j().setQuasar($());const t=U().user,p=K(),u=new J,d=new H(qa,new ka),l=new Aa,{entidad:o,disabled:w,accion:S}=d.useReferencias(),{setValidador:b,consultar:z}=d.useComportamiento(),{confirmar:C,prompt:W,notificarCorrecto:X,notificarAdvertencia:B,notificarError:h}=va(),P=M(!0),Y=M(!1),Z={usuario_recibe:{requiredIf:o.es_devolucion},monto:{required:q,maxLength:L(50)},cuenta:{required:q,maxLength:L(50)},tarea:{requiredIf:o.es_devolucion},comprobante:{required:q}},x=wa(Z,o);b(x.value),p.id_transferencia&&(z({id:p.id_transferencia}),P.value=!1,Y.value=!0);async function aa(V,ea){switch(ea){case"aprobar":try{u.activar(),await l.aprobarTransferencia(V),X("Se aprob\xF3 la Transferencia Exitosamente"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{h("No se pudo aprobar, debes ingresar un motivo para la anulaci\xF3n")}break;case"rechazar":C("\xBFEst\xE1 seguro de rechazar la transferencia?",async()=>{try{u.activar(),await l.rechazarTransferencia(V),B("Se rechazado Transferencia Exitosamente"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{h("No se pudo rechazar, debes ingresar un motivo para la anulaci\xF3n")}});break;case"anular":C("\xBFEst\xE1 seguro de anular la transferencia?",()=>{W({titulo:"Anular Transferencia",mensaje:"Ingrese motivo de anulacion",accion:async oa=>{try{u.activar(),V.detalle_estado=oa,await l.anularTransferencia(V),B("Se anulado Transferencia Exitosamente"),a("cerrar-modal"),u.desactivar(),a("cerrar-modal",!1),a("guardado")}catch{h("No se pudo anular, debes ingresar un motivo para la anulaci\xF3n")}}})});break}}return{mixin:d,transferencia:o,disabled:w,accion:S,v$:x,usuario:t,mostrarListado:P,actualizarTransferencia:aa,configuracionColumnas:Sa}}});const Ma={class:"row q-col-gutter-sm q-mb-md"},Na={key:0,class:"col-12 col-md-3 q-mb-md"},Ba={key:1,class:"col-12 col-md-3 q-mb-md"},Pa={class:"col-12 col-md-3"},xa={class:"col-12 col-md-3"},Qa={class:"error-msg"},Ia={key:2,class:"col-12 col-md-3"},La={class:"col-12 col-md-3"},Oa={class:"col-12 col-md-3 q-mb-xl"},Ra={key:0,class:"q-pa-md q-gutter-sm flex flex-center"},Fa={key:1,class:"q-pa-md q-gutter-sm flex flex-center"};function Ua(e,a,r,t,p,u){const d=_("selector-imagen"),l=_("tab-layout");return c(),G(l,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,mostrarListado:!1,mostrarButtonSubmits:!1},{formulario:f(()=>[n(Ca,{onSubmit:a[7]||(a[7]=ta(()=>{},["prevent"]))},{default:f(()=>[s("div",Ma,[e.transferencia.usuario_envia_info?(c(),m("div",Na,[a[11]||(a[11]=s("label",{class:"q-mb-sm block"},"Empleado Emisor",-1)),n(g,{modelValue:e.transferencia.usuario_envia_info,"onUpdate:modelValue":a[0]||(a[0]=o=>e.transferencia.usuario_envia_info=o),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):v("",!0),e.transferencia.es_devolucion?v("",!0):(c(),m("div",Ba,[a[12]||(a[12]=s("label",{class:"q-mb-sm block"},"Empleado Receptor",-1)),n(g,{modelValue:e.transferencia.usuario_recibe_info,"onUpdate:modelValue":a[1]||(a[1]=o=>e.transferencia.usuario_recibe_info=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])),s("div",Pa,[a[13]||(a[13]=s("label",{class:"q-mb-sm block"},"Monto:",-1)),n(g,{modelValue:e.transferencia.monto,"onUpdate:modelValue":a[2]||(a[2]=o=>e.transferencia.monto=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])]),s("div",xa,[a[14]||(a[14]=s("label",{class:"q-mb-sm block"},"Cuenta:",-1)),n(g,{modelValue:e.transferencia.cuenta,"onUpdate:modelValue":a[3]||(a[3]=o=>e.transferencia.cuenta=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},{error:f(()=>[(c(!0),m(la,null,ua(e.v$.cuenta.$errors,o=>(c(),m("div",{key:o.$uid},[s("div",Qa,N(o.$message),1)]))),128))]),_:1},8,["modelValue"])]),e.transferencia.es_devolucion?v("",!0):(c(),m("div",Ia,[a[15]||(a[15]=s("label",{class:"q-mb-sm block"},"Tareas",-1)),n(g,{modelValue:e.transferencia.tarea_info,"onUpdate:modelValue":a[4]||(a[4]=o=>e.transferencia.tarea_info=o),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])),s("div",La,[a[16]||(a[16]=s("label",{class:"q-mb-sm block"},"Comprobante ",-1)),n(d,{imagen:e.transferencia.comprobante,disable:"","onUpdate:modelValue":a[5]||(a[5]=o=>e.transferencia.comprobante=o)},null,8,["imagen"])]),s("div",Oa,[n(ca,{class:"q-mt-lg q-pt-md",modelValue:e.transferencia.es_devolucion,"onUpdate:modelValue":a[6]||(a[6]=o=>e.transferencia.es_devolucion=o),label:"\xBFEs devolucion?",disable:"",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e.usuario.id==e.transferencia.usuario_recibe&&e.transferencia.estado_info=="POR APROBAR"?(c(),m("div",Ra,[n(A,{color:"positive",onClick:a[8]||(a[8]=o=>e.actualizarTransferencia(e.transferencia,"aprobar"))},{default:f(()=>[n(k,{name:"bi-check-circle",size:"xs"}),a[17]||(a[17]=E(" Aceptar "))]),_:1}),n(A,{color:"negative",onClick:a[9]||(a[9]=o=>e.actualizarTransferencia(e.transferencia,"rechazar"))},{default:f(()=>[n(k,{name:"bi-x-circle",size:"xs"}),a[18]||(a[18]=E(" Rechazar "))]),_:1})])):v("",!0),e.usuario.id==e.transferencia.usuario_recibe&&e.transferencia.estado_info=="APROBADO"?(c(),m("div",Fa,[n(A,{color:"negative",onClick:a[10]||(a[10]=o=>e.actualizarTransferencia(e.transferencia,"anular"))},{default:f(()=>[n(k,{name:"bi-x-circle",size:"xs"}),a[19]||(a[19]=E(" Anular "))]),_:1})])):v("",!0)]),_:1},8,["mixin","configuracionColumnas"])}var Da=D($a,[["render",Ua]]);class Ga{constructor(){i(this,"VisualizarTransferenciaPage");this.VisualizarTransferenciaPage=da(new Ea("VisualizarTransferencia",Da))}}class Ha extends za{constructor(){super(new Ga)}}class O extends R{constructor(){super(T.autorizaciones_transferencia)}}var ja=F({name:"AutorizarGastoPage",components:{EssentialTableTabs:pa,ModalEntidad:Ta},setup(){const e=new O,a=M("3"),r=new H(ba,e),{listado:t}=r.useReferencias(),p=U(),u=K();j().setQuasar($()),ga().setQuasar($());const d=new O;async function l(b){const z=new J;z.activar();const{result:C}=await d.listar({estado:b});t.value=C,a.value=b,z.desactivar()}l(I.PENDIENTE);const o=new Ha,w={titulo:"Consultar",icono:"bi-eye",color:"indigo",accion:({entidad:b})=>{u.id_transferencia=b.id,o.abrirModalEntidad("VisualizarTransferenciaPage")}};async function S(){await l(I.PENDIENTE)}return{configuracionColumnasAutorizarTransferencia:ya,listado:t,tabAutorizarTransferenciaSaldo:ma,botonVerModalTransferencia:w,accionesTabla:fa,filtrarAutorizacionesTransferencia:l,guardado:S,authenticationStore:p,modales:o}}});const Ja={class:"text-center q-pb-md"},Ka={class:"q-mb-md"},Wa={key:0,class:"q-mb-md"};function Xa(e,a,r,t,p,u){const d=_("essential-table-tabs"),l=_("modal-entidad");return c(),G(sa,{padding:!e.$q.screen.xs},{default:f(()=>{var o;return[s("div",Ja,[s("div",Ka,[a[0]||(a[0]=E(" Bienvenido, ")),s("strong",null,N(e.authenticationStore.nombreUsuario),1)]),(o=e.authenticationStore.user)!=null&&o.grupo?(c(),m("div",Wa,[a[1]||(a[1]=E(" Grupo, ")),s("strong",null,N(e.authenticationStore.user.grupo),1)])):v("",!0)]),n(d,{configuracionColumnas:[...e.configuracionColumnasAutorizarTransferencia,e.accionesTabla],datos:e.listado,accion1:e.botonVerModalTransferencia,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,permitirBuscar:!1,"mostrar-botones":!1,"tab-options":e.tabAutorizarTransferenciaSaldo,onTabSeleccionado:e.filtrarAutorizacionesTransferencia,"tab-defecto":"3"},null,8,["configuracionColumnas","datos","accion1","tab-options","onTabSeleccionado"]),n(l,{comportamiento:e.modales,persistente:!1,mostrarListado:!1,onGuardado:e.guardado},null,8,["comportamiento","onGuardado"])]}),_:1},8,["padding"])}var Le=D(ja,[["render",Xa]]);export{Le as default};

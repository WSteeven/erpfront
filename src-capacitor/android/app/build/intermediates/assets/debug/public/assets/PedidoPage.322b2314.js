var no=Object.defineProperty;var uo=(e,o,u)=>o in e?no(e,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[o]=u;var re=(e,o,u)=>(uo(e,typeof o!="symbol"?o+"":o,u),u);import{aa as po,f as Be,k as mo,ai as co,c as C,u as Le,A as bo,s as vo,d as fo,m as Ce,Z as go,$ as yo,bx as L,E as Co,a0 as Ve,be as Pe,cu as Vo,cv as Po,cw as ko,b_ as F,cs as wo,bZ as ke,_ as $o,t as Q,v as n,x as d,z as s,F as l,a4 as qo,y as t,I as q,J as m,D as f,G as E,H as T,O as te,B as we,j as Eo,L as W,bd as $e,K as g,M as So,N as Bo,cx as Lo,a2 as To,P as Ao}from"./index.6449c167.js";import{Q as k,a as w}from"./QItemSection.9a955ec6.js";import{Q as V,a as h}from"./QSelect.6ce302d7.js";import{Q as Do,a as Fo,C as Uo}from"./QPopupProxy.72ff1d6d.js";import{E as ho,S as jo,j as Io}from"./EssentialTable.00c17e97.js";import{Q as zo}from"./QForm.ca56f146.js";import{c as Ro,a as Oo}from"./VisualizarPedidoPage.8178fa2d.js";import{r as qe,a as j,h as No}from"./i18n-validators.29e2545c.js";import{u as Qo}from"./index.490dde02.js";import{u as Mo}from"./selector.9691ac4b.js";import{T as Ho}from"./TabLayoutFilterTabs2.5e702525.js";import{E as Go}from"./EssentialSelectableTable.5a9cc771.js";import{M as Jo}from"./ModalEntidad.168b465e.js";import{C as Yo}from"./ContenedorSimpleMixin.09c9bed5.js";import{P as Ko}from"./PedidoController.15257cbc.js";import{P as Zo,u as Wo}from"./pedido.c5162ee1.js";import{c as Xo,a as _o}from"./configuracionColumnasDetallesModal.0b76e70c.js";import{a as xo,b as ea,u as oa,S as aa,w as sa}from"./utils.521b98f3.js";import{f as ia}from"./index.0198dd12.js";import{C as la}from"./ClienteController.33eca86a.js";import{C as ra}from"./ComportamientoModalesPedido.82b98bf9.js";import{u as ta}from"./filtrosListadosGenerales.c3aa2da3.js";import{P as Ee}from"./ProyectoController.fd7b11f8.js";import{E as na}from"./EtapaController.dbfc00d7.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./TabLayout.0bce4313.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTablePagination.d5c1010a.js";import"./SelectorController.de8e1cd0.js";import"./EssentialTableTabs.586dbdfc.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.50e59f97.js";var da=po({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:o}){const u=Be(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>mo("tr",{class:u.value},co(o.default))}});function ua(e,o){const u=C(),r=C([]),S=C(),A=Le(),v={refListadoSeleccionable:u,listadoSeleccionable:r,endpoint:o,limpiar:()=>{e.id=null,S.value=null},seleccionar:P=>{e.listadoProductos=[...e.listadoProductos,...P]}},b=Mo(v);return{refListadoSeleccionable:u,listado:r,listar:P=>b.listar(S.value,P),limpiar:()=>v.limpiar(),seleccionar:P=>{let a=[];a=e.listadoProductos.map(D=>D.id);const z=P.filter(D=>!a.includes(D.id));z.forEach(D=>{D.solicitante=A.user.id}),v.seleccionar(z)},criterioBusqueda:S}}function pa(e){if(e===null)return!0;{const o=e.split("-"),u=new Date,r=new Date(+o[2],+o[1]-1,+o[0]);return!ia.req(e)||u<=r}}class ma{constructor(o){re(this,"pedido");this.pedido=o}async validar(){if(this.pedido.listadoProductos.length===0)throw new Error("Debe agregar al menos un producto al listado");if(this.pedido.listadoProductos.some(o=>o.cantidad==0||o.cantidad==null))throw new Error("Debe ingresar una cantidad mayor a cero en todos los elementos del listado");return!0}}class Se{constructor(){re(this,"axios");this.axios=bo.getInstance()}async marcarCompletado(o,u){return this.solicitud("/marcar-completado/",o,{motivo:u})}async anular(o,u){return this.solicitud("/anular/",o,{motivo:u})}async solicitud(o,u,r){const S=this.axios.getEndpoint(vo.pedidos)+o+u,A=await this.axios.post(S,r);return{response:A,result:A.data.modelo}}}var ca=fo({components:{TabLayoutFilterTabs2:Ho,EssentialTable:ho,EssentialSelectableTable:Go,ModalesEntidad:Jo,SelectorImagen:jo},emits:["guardado"],setup(e,{emit:o}){const u=new Yo(Zo,new Ko),{entidad:r,disabled:S,filtros:A,accion:v,listadosAuxiliares:b,listado:I}=u.useReferencias(),{setValidador:M,obtenerListados:H,cargarVista:P,listar:a,consultar:z,reestablecer:D}=u.useComportamiento(),{onReestablecer:Te,onBeforeConsultar:Ae,onConsultado:De,onGuardado:Fe}=u.useHooks(),{confirmar:X,prompt:_,notificarCorrecto:ne,notificarError:de,notificarAdvertencia:Ue}=xo(),ue=new ra;ea().setQuasar(Ce()),oa().setQuasar(Ce());const B=new aa,G=Wo(),p=Le(),he=go(),{refListadoSeleccionable:je,criterioBusqueda:Ie,listado:ze,listar:Re,limpiar:Oe,seleccionar:Ne}=ua(r,"detalles"),y=C("PENDIENTE"),x=C(!1),pe=C(!1),ee=C(!0),J=p.esCoordinador,oe=p.esBodeguero,me=p.esTecnico,ae=p.esActivosFijos,ce=p.esRecursosHumanos,Qe=p.esGerente,Me=Be(()=>{var i,c;return["inspecciones","incidentes"].includes((c=(i=yo().name)==null?void 0:i.toString())!=null?c:"")});Fe(i=>o("guardado",i)),Te(()=>{x.value=!1,ge()}),Ae(()=>ee.value=!1),De(()=>{ee.value=!0,ie.value=b.empleados,v.value===L.editar&&(J||ae||p.user.id===r.per_autoriza_id)&&(x.value=!0),ye(),Z(r.proyecto,!1)});const He=C(!0),Ge=C(!1),Je=C(!1),se=C([]),Ye=C("only_sucursal"),Ke=[{label:"Solo bodega seleccionada",value:"only_sucursal"},{label:"Solo perteneciente al cliente de la tarea",value:"only_cliente_tarea"},{label:"Todos los elementos",value:"todos"}],{empleados:ie,filtrarEmpleados:Ze,clientes:be,filtrarClientes:We,proyectos:le,filtrarProyectos:Xe,etapas:R,filtrarEtapas:_e,tareas:Y,filtrarTareas:xe,sucursales:ve,filtrarSucursales:eo,incidentes:as,filtrarIncidentes:ss}=ta(b);P(async()=>{ge(),await H({empleados:{controller:new Co,params:{campos:"id,nombres,apellidos,cargo_id",estado:1}},clientes:{controller:new la,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}},sucursales:JSON.parse(Ve.getItem("sucursales").toString())}),ie.value=b.empleados,Y.value=b.tareas,be.value=b.clientes,ve.value=b.sucursales});const oo={justificacion:{required:qe},observacion_aut:{requiredIfCoordinador:j(()=>r.tiene_observacion_aut)},sucursal:{required:qe},per_retira:{requiredIfCheck:j(()=>r.retira_tercero)},responsable:{requiredIfCoordinador:j(()=>(J||!me||ce)&&!r.para_cliente)},etapa:{requiredIf:j(()=>{if(R.value)return R.value.length&&r.proyecto})},tarea:{requiredIfTarea:j(()=>r.es_tarea)},fecha_limite:{required:j(()=>v.value===L.nuevo),fechaMenor:No.withMessage("La fecha l\xEDmite debe ser mayor a la fecha actual",pa)&&v.value===L.nuevo}},fe=Qo(oo,r);M(fe.value);const ao=new ma(r);u.agregarValidaciones(ao);async function so(i){y.value=i,await a({estado:i,paginate:!0}),A.fields={estado:i},pe.value=(J||ae||p.esJefeTecnico||Qe||p.esCompras||p.esRecursosHumanos||p.can("puede.autorizar.pedidos"))&&y.value===F.pendiente}function ge(){r.solicitante=p.user.id,r.responsable=p.user.id}async function ye(){B.activar();const i=await new Ee().listar({empleado_id:r.responsable,campos:"id,nombre,codigo_proyecto",finalizado:0});b.proyectos=i.result,le.value=i.result,v.value==L.nuevo?await O(null):await O(r.etapa,!1),B.desactivar()}function K(i=!1,c=!1){v.value==L.nuevo&&(i&&(r.etapa=null),c&&(r.tarea=null))}async function Z(i,c){if(B.activar(),r.proyecto){K(i,c);const $=await new na().listar({etapas_empleado:1,empleado_id:r.responsable,proyecto_id:r.proyecto});if(se.value=$.result,$.result.length<1)await O(null,!1);else{const U=await new Pe().listar({activas_empleado:1,empleado_id:r.responsable,proyecto_id:r.proyecto});b.tareas=U.result,Y.value=U.result}b.etapas=se.value,R.value=se.value}else R.value=[],K(!0,!0),await O(null,!1);B.desactivar()}async function O(i,c=!0){B.activar(),K(!1,c);const $=await new Pe().listar({activas_empleado:1,proyecto_id:r.proyecto,etapa_id:i,empleado_id:r.responsable,campos:"id,codigo_tarea,titulo",finalizado:0});b.tareas=$.result,Y.value=$.result,B.desactivar()}async function io(){const i=b.tareas.filter(c=>c.id==r.tarea)[0];i&&(r.cliente_id=i.cliente_id,r.proyecto==null&&(r.proyecto=i.proyecto_id,await Z(!0,!0)),r.etapa=i.etapa_id,r.tarea=i.id)}async function lo(i=!0){if(i&&(r.proyecto=null),K(!0,!0),B.activar(),r.responsable){const c=await new Ee().listar({empleado_id:r.responsable,finalizado:0});b.proyectos=c.result,le.value=c.result,await Z(!1,!1)}else r.es_tarea=!1;B.desactivar()}async function ro(){const i=(await new wo().listar({campos:"id,lugar"})).result;Ve.set("sucursales",JSON.stringify(i))}function to({posicion:i}){X("\xBFEst\xE1 seguro de continuar?",()=>r.listadoProductos.splice(i,1))}return{mixin:u,pedido:r,disabled:S,accion:v,v$:fe,acciones:L,configuracionColumnas:Ro,tablaRefrescada:ee,clientes:be,filtrarClientes:We,proyectos:le,filtrarProyectos:Xe,etapas:R,filtrarEtapas:_e,tareas:Y,filtrarTareas:xe,sucursales:ve,filtrarSucursales:eo,empleados:ie,filtrarEmpleados:Ze,estados:Vo,autorizaciones:Po,refListado:je,criterioBusquedaProducto:Ie,listadoProductos:ze,listarProductos:Re,limpiarProducto:Oe,seleccionarProducto:Ne,configuracionColumnasDetallesModal:Xo,configuracionColumnasProductosSeleccionados:_o,configuracionColumnasProductosSeleccionadosDespachado:Oo,botonEditarCantidad:{titulo:"Cantidad",icono:"bi-pencil",accion:({posicion:i})=>{const c={titulo:"Modifica",mensaje:"Ingresa la cantidad",tipo:"number",defecto:r.listadoProductos[i].cantidad,accion:$=>r.listadoProductos[i].cantidad=$};_(c)},visible:()=>v.value!=L.consultar},botonCorregir:{titulo:"Corregir pedido",color:"amber-3",icono:"bi-gear",accion:({entidad:i})=>{G.pedido=i,ue.abrirModalEntidad("CorregirPedidoPage")},visible:({entidad:i})=>(y.value=="APROBADO"||y.value=="PARCIAL")&&(oe||i.per_autoriza_id==p.user.id)&&i.estado!=F.completa},botonEliminar:{titulo:"Quitar",color:"negative",icono:"bi-x",accion:({posicion:i})=>to({posicion:i}),visible:()=>v.value!=L.consultar},botonImprimir:{titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:i})=>{G.idPedido=i.id,await G.imprimirPdf()},visible:()=>y.value=="APROBADO"||y.value=="PARCIAL"||y.value=="COMPLETA"},botonDespachar:{titulo:"Despachar",color:"primary",icono:"bi-pencil-square",accion:({entidad:i})=>{G.pedido=i,he.push("transacciones-egresos")},visible:({entidad:i})=>(y.value=="APROBADO"||y.value=="PARCIAL")&&(oe||p.esBodegueroTelconet)&&i.estado!=F.completa},botonAnularAutorizacion:{titulo:"Anular",color:"negative",icono:"bi-x",accion:({entidad:i,posicion:c})=>{X("\xBFEst\xE1 seguro de anular el pedido?",()=>{_({titulo:"Causa de anulaci\xF3n",mensaje:"Ingresa el motivo de la anulaci\xF3n",accion:async U=>{try{const{result:N}=await new Se().anular(i.id,U);N.autorizacion===ke.cancelado&&(ne("Pedido anulado con \xE9xito"),I.value.splice(c,1))}catch{de("No se pudo anular, debes ingresar un motivo para la anulaci\xF3n")}}})})},visible:({entidad:i})=>(y.value===ke.aprobado||y.value===F.parcial)&&((i.per_autoriza_id===p.user.id||i.solicitante_id===p.user.id)&&i.estado===F.pendiente||p.esActivosFijos)||p.esAdministrador},botonMarcarComoCompletado:{titulo:"Marcar Completado",color:"green-6",icono:"bi-check-circle-fill",tooltip:"Marcar pedido como completado",accion:({entidad:i,posicion:c})=>{X("\xBFEst\xE1 seguro de marcar el pedido como completado?",()=>{_({titulo:"Observaci\xF3n",mensaje:"Ingresa el motivo de marcar como completo el pedido",accion:async U=>{try{const{result:N}=await new Se().marcarCompletado(i.id,U);N.estado===F.completa&&(ne("Pedido marcado completado con \xE9xito"),I.value.splice(c,1))}catch{de("No se pudo completar el pedido, debes ingresar un motivo para la anulaci\xF3n")}}})})},visible:()=>y.value===F.parcial&&p.esBodeguero&&p.esCoordinadorBodega},store:p,modales:ue,soloLectura:x,all:He,only_sucursal:Ge,only_cliente_tarea:Je,group:Ye,options_groups:Ke,tabOptionsPedidos:ko,tabSeleccionado:y,puedeEditar:pe,esCoordinador:J,esCoordinadorBackup:p.esCoordinadorBackup,esBodeguero:oe,esTecnico:me,esActivosFijos:ae,esRRHH:ce,obtenerProyectosTareasTecnico:lo,obtenerEtapasProyecto:Z,obtenerTareasEtapa:O,checkEvidencia(i){i||(r.evidencia1="",r.evidencia2="")},checkCliente(i){i?(r.per_retira=null,r.responsable=null):r.cliente=null},checkRetiraTercero(i){i||(r.per_retira=null)},checkEsTarea(i){i?r.responsable?ye():(Ue("Debes seleccionar primero un empleado (t\xE9cnico) responsable"),r.es_tarea=!1):r.tarea=null},ordenarLista:sa,onRowClick:i=>alert(`${i.name} clicked`),obtenerDatosTareaSeleccionada:io,filtrarPedidos:so,recargarSucursales:ro,enRutaInspeccionIncidente:Me,consultar:z,reestablecer:D}}});const ba={class:"row q-col-gutter-sm q-py-md"},va={key:0,class:"col-12 col-md-3"},fa={key:1,class:"col-12 col-md-3"},ga={key:2,class:"col-12 col-md-3"},ya={class:"col-12 col-md-3"},Ca={class:"error-msg"},Va={class:"col-12 col-md-6"},Pa={class:"error-msg"},ka={class:"col-12 col-md-3"},wa={class:"row items-center justify-end"},$a={class:"error-msg"},qa={class:"col-12 col-md-3 q-mb-xl"},Ea={key:3,class:"col-12 col-md-3"},Sa={key:4,class:"col-12 col-md-3"},Ba={class:"error-msg"},La={class:"col-12 col-md-3 q-mb-xl"},Ta={key:5,class:"col-12 col-md-3"},Aa={class:"error-msg"},Da={key:6,class:"col-12 col-md-3 q-mb-xl"},Fa={key:7,class:"col-12 col-md-3"},Ua={key:8,class:"col-12 col-md-3"},ha={class:"error-msg"},ja={key:9,class:"col-12 col-md-3"},Ia={class:"error-msg"},za={key:10,class:"col-12 col-md-3"},Ra={key:11,class:"col-12 col-md-3 q-mb-md"},Oa={key:12,class:"col-12 col-md-3"},Na={class:"error-msg"},Qa={key:13,class:"col-12 col-md-3 q-mb-md"},Ma={class:"col-12 col-md-3 q-mb-xl"},Ha={key:14,class:"col-12 col-md-3"},Ga={key:15,class:"col-12 col-md-3"},Ja={key:16,class:"col-12 col-md-3"},Ya={key:17,class:"col-12 col-md-3"},Ka={key:18,class:"col-12 col-md-3"},Za={key:19,class:"col-12 col-md-12"},Wa={class:"col-12 col-md-12"},Xa={class:"row q-col-gutter-x-xs"},_a={class:"col-12 col-md-10 q-mb-md"},xa={class:"col-12 col-md-2"},es={class:"col-12"};function os(e,o,u,r,S,A){const v=Q("selector-imagen"),b=Q("essential-table"),I=Q("essential-selectable-table"),M=Q("tab-layout-filter-tabs2"),H=Q("modales-entidad");return n(),d(E,null,[s(M,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Pedido","tab-options":e.tabOptionsPedidos,tabDefecto:e.tabSeleccionado,filtrar:e.filtrarPedidos,permitirEditar:e.puedeEditar,"permitir-cancelar":!e.enRutaInspeccionIncidente,ajustarCeldas:"",paginate:"","mostrar-listado":!e.enRutaInspeccionIncidente,accion1:e.botonDespachar,accion2:e.botonAnularAutorizacion,accion3:e.botonCorregir,accion4:e.botonMarcarComoCompletado,accion5:e.botonImprimir},{formulario:l(()=>[s(zo,{onSubmit:o[37]||(o[37]=qo(()=>{},["prevent"]))},{default:l(()=>{var P;return[t("div",ba,[e.pedido.id?(n(),d("div",va,[o[38]||(o[38]=t("label",{class:"q-mb-sm block"},"Pedido N\xB0",-1)),s(q,{modelValue:e.pedido.id,"onUpdate:modelValue":o[0]||(o[0]=a=>e.pedido.id=a),placeholder:"Obligatorio",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable"])])):m("",!0),e.pedido.created_at?(n(),d("div",fa,[o[39]||(o[39]=t("label",{class:"q-mb-sm block"},"Fecha",-1)),s(q,{modelValue:e.pedido.created_at,"onUpdate:modelValue":o[1]||(o[1]=a=>e.pedido.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),e.pedido.solicitante?(n(),d("div",ga,[o[41]||(o[41]=t("label",{class:"q-mb-sm block"},"Solicitante",-1)),s(V,{modelValue:e.pedido.solicitante,"onUpdate:modelValue":o[2]||(o[2]=a=>e.pedido.solicitante=a),options:e.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[40]||(o[40]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):m("",!0),t("div",ya,[o[42]||(o[42]=t("label",{class:"q-mb-sm block"},"Sucursal",-1)),s(V,{modelValue:e.pedido.sucursal,"onUpdate:modelValue":o[3]||(o[3]=a=>e.pedido.sucursal=a),options:e.sucursales,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.soloLectura,error:!!e.v$.sucursal.$errors.length,"error-message":"Debes seleccionar una sucursal","use-input":"","input-debounce":"0",onFilter:e.filtrarSucursales,onPopupShow:o[4]||(o[4]=a=>e.ordenarLista(e.sucursales,"lugar")),"option-label":a=>a.lugar,"option-value":a=>a.id,"emit-value":"","map-options":""},{error:l(()=>[(n(!0),d(E,null,T(e.v$.sucursal.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Ca,g(a.$message),1)]))),128))]),after:l(()=>[s(te,{color:"positive",onClick:e.recargarSucursales},{default:l(()=>[s(we,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disable","error","onFilter","option-label","option-value"])]),t("div",Va,[o[43]||(o[43]=t("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),s(q,{type:"textarea",autogrow:"",modelValue:e.pedido.justificacion,"onUpdate:modelValue":o[5]||(o[5]=a=>e.pedido.justificacion=a),placeholder:"Obligatorio",disable:e.disabled&&!e.store.esAdministrador||e.soloLectura&&!e.store.esAdministrador,error:!!e.v$.justificacion.$errors.length,outlined:"",dense:"",onBlur:e.v$.justificacion.$touch},{error:l(()=>[(n(!0),d(E,null,T(e.v$.justificacion.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Pa,g(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),t("div",ka,[o[44]||(o[44]=t("label",{class:"q-mb-sm block"},"Fecha limite",-1)),s(q,{modelValue:e.pedido.fecha_limite,"onUpdate:modelValue":o[7]||(o[7]=a=>e.pedido.fecha_limite=a),placeholder:"Obligatorio",error:!!e.v$.fecha_limite.$errors.length,onBlur:e.v$.fecha_limite.$touch,disable:e.disabled||e.soloLectura,outlined:"",dense:""},{append:l(()=>[s(we,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(Do,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(Fo,{modelValue:e.pedido.fecha_limite,"onUpdate:modelValue":o[6]||(o[6]=a=>e.pedido.fecha_limite=a),mask:"DD-MM-YYYY","today-btn":""},{default:l(()=>[t("div",wa,[Eo(s(te,{label:"Cerrar",color:"primary",flat:""},null,512),[[Uo]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),error:l(()=>[(n(!0),d(E,null,T(e.v$.fecha_limite.$errors,a=>(n(),d("div",{style:{clear:"inherit"},key:a.$uid},[t("div",$a,g(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur","disable"])]),t("div",qa,[s(W,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.para_cliente,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.pedido.para_cliente=a),e.checkCliente],label:"\xBFEs material para el cliente?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])]),e.pedido.para_cliente?(n(),d("div",Ea,[o[45]||(o[45]=t("label",{class:"q-mb-sm block"},"Cliente",-1)),s(V,{modelValue:e.pedido.cliente,"onUpdate:modelValue":o[9]||(o[9]=a=>e.pedido.cliente=a),options:e.clientes,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarClientes,onPopupShow:o[10]||(o[10]=a=>e.ordenarLista(e.clientes,"razon_social")),"option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])])):m("",!0),(e.esCoordinador||e.esCoordinadorBackup)&&!e.pedido.para_cliente||e.esRRHH&&!e.pedido.para_cliente||!e.esTecnico&&!e.pedido.para_cliente?(n(),d("div",Sa,[o[47]||(o[47]=t("label",{class:"q-mb-sm block"},"Responsable",-1)),s(V,{modelValue:e.pedido.responsable,"onUpdate:modelValue":[o[11]||(o[11]=a=>e.pedido.responsable=a),e.obtenerProyectosTareasTecnico],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:o[12]||(o[12]=a=>e.ordenarLista(e.empleados,"apellidos")),"error-message":"Debes seleccionar el responsable de los materiales",error:!!e.v$.responsable.$errors.length,disable:e.disabled||e.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[46]||(o[46]=[f(" No hay resultados ")])),_:1})]),_:1})]),error:l(()=>[(n(!0),d(E,null,T(e.v$.responsable.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Ba,g(a.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","error","disable","option-label","option-value"])])):m("",!0),t("div",La,[s(W,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.retira_tercero,"onUpdate:modelValue":[o[13]||(o[13]=a=>e.pedido.retira_tercero=a),e.checkRetiraTercero],label:"\xBFRetira otra persona?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])]),e.pedido.retira_tercero?(n(),d("div",Ta,[o[49]||(o[49]=t("label",{class:"q-mb-sm block"},"Persona que retira",-1)),s(V,{modelValue:e.pedido.per_retira,"onUpdate:modelValue":o[14]||(o[14]=a=>e.pedido.per_retira=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:o[15]||(o[15]=a=>e.ordenarLista(e.empleados,"apellidos")),"error-message":"Debes seleccionar la persona que retira los materiales",error:!!e.v$.per_retira.$errors.length,disable:e.disabled||e.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[48]||(o[48]=[f(" No hay resultados ")])),_:1})]),_:1})]),error:l(()=>[(n(!0),d(E,null,T(e.v$.per_retira.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Aa,g(a.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","error","disable","option-label","option-value"])])):m("",!0),e.pedido.es_tarea||e.accion==="NUEVO"?(n(),d("div",Da,[s(W,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.es_tarea,"onUpdate:modelValue":[o[16]||(o[16]=a=>e.pedido.es_tarea=a),e.checkEsTarea],label:"\xBFEs material de proyecto/tarea?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])])):m("",!0),e.pedido.es_tarea||e.pedido.proyecto?(n(),d("div",Fa,[o[51]||(o[51]=t("label",{class:"q-mb-sm block"},"Proyecto",-1)),s(V,{modelValue:e.pedido.proyecto,"onUpdate:modelValue":[o[17]||(o[17]=a=>e.pedido.proyecto=a),o[18]||(o[18]=a=>e.obtenerEtapasProyecto(!0,!0))],options:e.proyectos,onFilter:e.filtrarProyectos,"transition-show":"scale","transition-hide":"scale",hint:"Opcional","options-dense":"",dense:"",outlined:"",clearable:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",disable:e.disabled||e.soloLectura},{option:l(a=>[s(k,$e(a.itemProps,{class:"q-my-sm"}),{default:l(()=>[s(w,null,{default:l(()=>[s(h,{class:"text-bold text-primary"},{default:l(()=>[f(g(a.opt.codigo_proyecto),1)]),_:2},1024),s(h,{caption:""},{default:l(()=>[f(g(a.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[50]||(o[50]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value","disable"])])):m("",!0),((P=e.etapas)==null?void 0:P.length)||e.pedido.etapa?(n(),d("div",Ua,[o[53]||(o[53]=t("label",{class:"q-mb-sm block"},"Etapa",-1)),s(V,{modelValue:e.pedido.etapa,"onUpdate:modelValue":[o[19]||(o[19]=a=>e.pedido.etapa=a),o[20]||(o[20]=a=>e.obtenerTareasEtapa(e.pedido.etapa))],options:e.etapas,onFilter:e.filtrarEtapas,"transition-show":"scale","transition-hide":"scale",hint:"Obligatorio","options-dense":"",dense:"",clearable:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",disable:e.disabled||e.soloLectura,onBlur:e.v$.etapa.$touch,error:!!e.v$.etapa.$errors.length},{option:l(a=>[s(k,$e(a.itemProps,{class:"q-my-sm"}),{default:l(()=>[s(w,null,{default:l(()=>[s(h,{class:"text-bold text-primary"},{default:l(()=>[f(g(a.opt.nombre),1)]),_:2},1024),s(h,{caption:""},{default:l(()=>[f("Supervisor: "+g(a.opt.supervisor_responsable),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[52]||(o[52]=[f(" No hay resultados ")])),_:1})]),_:1})]),error:l(()=>[(n(!0),d(E,null,T(e.v$.etapa.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",ha,g(a.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","option-label","option-value","disable","onBlur","error"])])):m("",!0),e.pedido.es_tarea?(n(),d("div",ja,[o[55]||(o[55]=t("label",{class:"q-mb-sm block"},"Tarea",-1)),s(V,{modelValue:e.pedido.tarea,"onUpdate:modelValue":[o[21]||(o[21]=a=>e.pedido.tarea=a),e.obtenerDatosTareaSeleccionada],options:e.tareas,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Obligatorio",dense:"",outlined:"",disable:e.disabled||e.soloLectura,error:!!e.v$.tarea.$errors.length,"use-input":"","input-debounce":"0",onFilter:e.filtrarTareas,"error-message":"Debe seleccionar una tarea","option-label":a=>a.codigo_tarea+" - "+a.titulo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[s(k,So(Bo(a.itemProps)),{default:l(()=>[s(w,null,{default:l(()=>[s(h,null,{default:l(()=>[f(g(a.opt.codigo_tarea),1)]),_:2},1024),s(h,{caption:""},{default:l(()=>[f(g(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:l(()=>[(n(!0),d(E,null,T(e.v$.tarea.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Ia,g(a.$message),1)]))),128))]),"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[54]||(o[54]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onFilter","onUpdate:modelValue","option-label","option-value"])])):m("",!0),e.pedido.per_autoriza?(n(),d("div",za,[o[56]||(o[56]=t("label",{class:"q-mb-sm block"},"Persona que autoriza",-1)),s(V,{modelValue:e.pedido.per_autoriza,"onUpdate:modelValue":o[22]||(o[22]=a=>e.pedido.per_autoriza=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])])):m("",!0),e.pedido.autorizacion?(n(),d("div",Ra,[o[58]||(o[58]=t("label",{class:"q-mb-sm block"},"Autorizacion",-1)),s(V,{modelValue:e.pedido.autorizacion,"onUpdate:modelValue":o[23]||(o[23]=a=>e.pedido.autorizacion=a),options:e.autorizaciones,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.store.user.id!=e.pedido.per_autoriza_id&&!e.store.esCoordinadorBodega,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{"no-option":l(()=>[s(k,null,{default:l(()=>[s(w,{class:"text-grey"},{default:l(()=>o[57]||(o[57]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","option-value","option-label"])])):m("",!0),e.store.user.id===e.pedido.per_autoriza_id?(n(),d("div",Oa,[o[59]||(o[59]=t("label",{class:"q-mb-sm block"},"Observacion",-1)),s(q,{autogrow:"",modelValue:e.pedido.observacion_aut,"onUpdate:modelValue":o[24]||(o[24]=a=>e.pedido.observacion_aut=a),placeholder:"Opcional",disable:e.disabled||e.soloLectura&&!(e.esCoordinador||e.esActivosFijos||e.store.user.id==e.pedido.per_autoriza_id),error:!!e.v$.observacion_aut.$errors.length,outlined:"",dense:""},{error:l(()=>[(n(!0),d(E,null,T(e.v$.observacion_aut.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Na,g(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])])):m("",!0),e.pedido.estado||e.accion===e.acciones.consultar?(n(),d("div",Qa,[o[60]||(o[60]=t("label",{class:"q-mb-sm block"},"Estado del despacho",-1)),s(V,{modelValue:e.pedido.estado,"onUpdate:modelValue":o[25]||(o[25]=a=>e.pedido.estado=a),options:e.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:"","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):m("",!0),t("div",Ma,[s(W,{class:"q-mt-lg q-pt-md",modelValue:e.pedido.tiene_evidencia,"onUpdate:modelValue":[o[26]||(o[26]=a=>e.pedido.tiene_evidencia=a),e.checkEvidencia],label:"\xBFTiene evidencia fotogr\xE1fica?",disable:e.disabled||e.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable","onUpdate:modelValue"])]),e.pedido.tiene_evidencia||e.pedido.evidencia1?(n(),d("div",Ha,[o[61]||(o[61]=t("label",{class:"q-mb-sm block"},"Evidencia 1 ",-1)),s(v,{file_extensiones:".jpg, image/*",imagen:e.pedido.evidencia1,alto:"200px","onUpdate:modelValue":o[27]||(o[27]=a=>e.pedido.evidencia1=a)},null,8,["imagen"])])):m("",!0),e.pedido.tiene_evidencia||e.pedido.evidencia2?(n(),d("div",Ga,[o[62]||(o[62]=t("label",{class:"q-mb-sm block"},"Evidencia 2",-1)),s(v,{file_extensiones:".jpg, image/*",imagen:e.pedido.evidencia2,alto:"200px","onUpdate:modelValue":o[28]||(o[28]=a=>e.pedido.evidencia2=a)},null,8,["imagen"])])):m("",!0),e.pedido.observacion_est||e.accion===e.acciones.nuevo?(n(),d("div",Ja,[o[63]||(o[63]=t("label",{class:"q-mb-sm block"},"Observacion",-1)),s(q,{autogrow:"",modelValue:e.pedido.observacion_est,"onUpdate:modelValue":o[29]||(o[29]=a=>e.pedido.observacion_est=a),placeholder:"Opcional",disable:e.disabled||e.soloLectura&&!e.esCoordinador,outlined:"",dense:""},null,8,["modelValue","disable"])])):m("",!0),e.pedido.observacion_bodega?(n(),d("div",Ya,[o[64]||(o[64]=t("label",{class:"q-mb-sm block"},"Observacion del bodeguero",-1)),s(q,{autogrow:"",modelValue:e.pedido.observacion_bodega,"onUpdate:modelValue":o[30]||(o[30]=a=>e.pedido.observacion_bodega=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),e.pedido.estado_orden_compra?(n(),d("div",Ka,[o[65]||(o[65]=t("label",{class:"q-mb-sm block"},"Estado Orden de Compra",-1)),s(q,{autogrow:"",modelValue:e.pedido.estado_orden_compra,"onUpdate:modelValue":o[31]||(o[31]=a=>e.pedido.estado_orden_compra=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),e.accion==e.acciones.nuevo?(n(),d("div",Za,[s(Lo,{modelValue:e.group,"onUpdate:modelValue":o[32]||(o[32]=a=>e.group=a),options:e.options_groups,color:"primary"},null,8,["modelValue","options"])])):m("",!0),t("div",Wa,[o[67]||(o[67]=t("label",{class:"q-mb-sm block"},"Agregar productos",-1)),t("div",Xa,[t("div",_a,[s(q,{modelValue:e.criterioBusquedaProducto,"onUpdate:modelValue":o[33]||(o[33]=a=>e.criterioBusquedaProducto=a),disable:e.disabled,placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",onKeydown:o[34]||(o[34]=To(a=>e.listarProductos({tipo_busqueda:e.group,search:e.criterioBusquedaProducto,sucursal_id:e.pedido.sucursal,cliente_id:e.pedido.cliente||e.pedido.cliente_id,stock:!0}),["enter"])),onBlur:o[35]||(o[35]=a=>e.criterioBusquedaProducto===""?e.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","disable"])]),t("div",xa,[s(te,{onClick:o[36]||(o[36]=a=>e.listarProductos({tipo_busqueda:e.group,search:e.criterioBusquedaProducto,sucursal_id:e.pedido.sucursal,cliente_id:e.pedido.cliente||e.pedido.cliente_id,stock:!0})),icon:"search",unelevated:"",color:"positive",class:"full-width",style:{height:"40px"},disable:e.disabled,"no-caps":"",glossy:""},{default:l(()=>o[66]||(o[66]=[f("Buscar")])),_:1},8,["disable"])])])]),t("div",es,[e.tablaRefrescada?(n(),Ao(b,{key:0,titulo:"Productos Seleccionados",configuracionColumnas:e.accion===e.acciones.nuevo||e.accion===e.acciones.editar?e.configuracionColumnasProductosSeleccionados:e.configuracionColumnasProductosSeleccionadosDespachado,datos:e.pedido.listadoProductos,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarBotones:!1,accion1:e.botonEditarCantidad,accion2:e.botonEliminar,ajustarCeldas:!0,altoFijo:!1},{body:l(a=>[s(da,{props:a,onClick:z=>e.onRowClick(a.row)},{default:l(()=>[s(Io,{key:"name",props:a},{default:l(()=>[f(g(a.row.name),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["configuracionColumnas","datos","accion1","accion2"])):m("",!0)])])]}),_:1}),s(I,{ref:"refListado","configuracion-columnas":e.configuracionColumnasDetallesModal,datos:e.listadoProductos,"tipo-seleccion":"multiple",onSelected:e.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar","permitirEditar","permitir-cancelar","mostrar-listado","accion1","accion2","accion3","accion4","accion5"]),s(H,{comportamiento:e.modales},null,8,["comportamiento"])],64)}var ni=$o(ca,[["render",os]]);export{ni as default};

var O=Object.defineProperty;var I=(o,e,s)=>e in o?O(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var n=(o,e,s)=>(I(o,typeof e!="symbol"?e+"":e,s),s);import{Q as T,a as _}from"./QItemSection.9a955ec6.js";import{Q as U}from"./QSelect.6ce302d7.js";import{A as j,s as H,d as M,m as R,u as z,c as E,bx as G,_ as J,t as K,v as i,P as W,F as l,z as u,y as a,x as d,H as V,G as h,D as X,I as w,J as Y,a4 as Z,K as y}from"./index.6449c167.js";import{Q as x}from"./QForm.ca56f146.js";import{E as oo}from"./entidadAuditable.75a46700.js";import{T as eo}from"./TabLayoutFilterTabs2.5e702525.js";import{b as ro,S as to,a as ao}from"./utils.521b98f3.js";import{u as so}from"./index.490dde02.js";import{C as io}from"./ContenedorSimpleMixin.09c9bed5.js";import{P as lo}from"./ProductoVentasController.6d25793c.js";import{P as no}from"./PlanesController.71566c58.js";import{t as uo}from"./ventas.utils.b757673b.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./QPage.5d173a8a.js";import"./EssentialTableTabs.586dbdfc.js";import"./QBadge.e6f320cd.js";import"./EssentialTablePagination.d5c1010a.js";import"./EssentialTable.00c17e97.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./buttonSubmits.fe817da3.js";class co extends oo{constructor(){super();n(this,"plan");n(this,"plan_info");n(this,"nombre");n(this,"bundle");n(this,"precio");n(this,"activo");this.plan=null,this.plan_info=null,this.nombre=null,this.bundle=null,this.precio=null,this.activo=!0}}const po=[{name:"plan_info",field:"plan_info",label:"Plan",align:"left",sortable:!0},{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"bundle",field:"bundle",label:"Bundle",align:"left",sortable:!0},{name:"precio",field:"precio",label:"Precio",align:"left",sortable:!0},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class N{constructor(){n(this,"axios");this.axios=j.getInstance()}async anular(e){return this.solicitud("/desactivar/",e)}async solicitud(e,s,m){const f=this.axios.getEndpoint(H.productos_ventas)+e+s,b=await this.axios.post(f,m);return{response:b,result:b.data.modelo}}}var mo=M({components:{TabLayoutFilterTabs2:eo},setup(){ro().setQuasar(R());const o=new to,e=z(),s=new io(co,new lo),{entidad:m,disabled:f,accion:b,listadosAuxiliares:v,listado:r}=s.useReferencias(),{setValidador:Q,obtenerListados:A,cargarVista:q,listar:S}=s.useComportamiento(),{confirmar:C,notificarCorrecto:P,notificarError:B}=ao(),g=E([]),k=E("1");q(async()=>{await A({planes:{controller:new no,params:{campos:"id,nombre"}}}),g.value=v.planes});const D=so({plan:{required:!0},nombre:{required:!0},bundle:{required:!0},precio:{required:!0}},m);Q(D.value);function F(t){k.value=t,S({activo:t})}function L(t,c){if(t===""){c(()=>{g.value=v.planes});return}c(()=>{const p=t.toLowerCase();g.value=v.planes.filter($=>$.nombres.toLowerCase().indexOf(p)>-1||$.apellidos.toLowerCase().indexOf(p)>-1)})}return{mixin:s,producto:m,filtrarPlanes:L,planes:g,tabDefecto:k,disabled:f,accion:b,v$:D,acciones:G,configuracionColumnas:po,tabOptionsProductos:uo,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar",accion:({entidad:t,posicion:c})=>{C("\xBFEst\xE1 seguro de desactivar este producto?",async()=>{try{o.activar();const{result:p,response:$}=await new N().anular(t.id);r.value.splice(c,1),P("Desactivado correctamente")}catch{B("No se pudo desactivar el producto!")}finally{o.desactivar()}})},visible:({entidad:t})=>!t.activo&&e.can("puede.activar.productos_ventas")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar",accion:({entidad:t,posicion:c})=>{C("\xBFEst\xE1 seguro de desactivar este producto?",async()=>{try{o.activar();const{result:p,response:$}=await new N().anular(t.id);r.value.splice(c,1),P("Desactivado correctamente")}catch{B("No se pudo desactivar el producto!")}finally{o.desactivar()}})},visible:({entidad:t})=>t.activo&&e.can("puede.desactivar.productos_ventas")},filtrarProductos:F}}});const bo={class:"row q-col-gutter-sm q-mb-md"},vo={class:"col-12 col-md-3"},fo={class:"error-msg"},go={class:"col-12 col-md-3"},$o={class:"error-msg"},Vo={class:"col-12 col-md-3"},ho={class:"error-msg"},yo={class:"col-12 col-md-3"},wo={class:"error-msg"};function Co(o,e,s,m,f,b){const v=K("tab-layout-filter-tabs-2");return i(),W(v,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,ajustarCeldas:!0,accion1:o.btnDesactivar,accion2:o.btnActivar,"tab-options":o.tabOptionsProductos,tabDefecto:o.tabDefecto,filtrar:o.filtrarProductos},{formulario:l(()=>[u(x,{onSubmit:e[5]||(e[5]=Z(()=>{},["prevent"]))},{default:l(()=>[a("div",bo,[a("div",vo,[e[7]||(e[7]=a("label",{class:"q-mb-sm block"},"Plan",-1)),u(U,{modelValue:o.producto.plan,"onUpdate:modelValue":e[0]||(e[0]=r=>o.producto.plan=r),options:o.planes,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.plan.$errors.length,onBlur:o.v$.plan.$touch,"error-message":"Debes seleccionar un plan","use-input":"","input-debounce":"0",onFilter:o.filtrarPlanes,"option-value":r=>r.id,"option-label":r=>r.nombre,"emit-value":"","map-options":""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.plan.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",fo,y(r.$message),1)]))),128))]),"no-option":l(()=>[u(T,null,{default:l(()=>[u(_,{class:"text-grey"},{default:l(()=>e[6]||(e[6]=[X(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),a("div",go,[e[8]||(e[8]=a("label",{class:"q-mb-sm block"},"Nombre",-1)),u(w,{modelValue:o.producto.nombre,"onUpdate:modelValue":e[1]||(e[1]=r=>o.producto.nombre=r),placeholder:"Obligatorio",disable:o.disabled,error:!!o.v$.nombre.$errors.length,autogrow:"",onBlur:o.v$.nombre.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.nombre.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",$o,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",Vo,[e[9]||(e[9]=a("label",{class:"q-mb-sm block"},"Bundle",-1)),u(w,{modelValue:o.producto.bundle,"onUpdate:modelValue":e[2]||(e[2]=r=>o.producto.bundle=r),placeholder:"Obligatorio",type:"textarea",disable:o.disabled,error:!!o.v$.bundle.$errors.length,autogrow:"",onBlur:o.v$.bundle.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.bundle.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",ho,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),a("div",yo,[e[10]||(e[10]=a("label",{class:"q-mb-sm block"},"Precio",-1)),u(w,{modelValue:o.producto.precio,"onUpdate:modelValue":e[3]||(e[3]=r=>o.producto.precio=r),placeholder:"Obligatorio",type:"number",disable:o.disabled,error:!!o.v$.precio.$errors.length,onBlur:o.v$.precio.$touch,outlined:"",dense:""},{error:l(()=>[(i(!0),d(h,null,V(o.v$.precio.$errors,r=>(i(),d("div",{key:r.$uid},[a("div",wo,y(r.$message),1)]))),128))]),_:1},8,["modelValue","disable","error","onBlur"])]),Y("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var ce=J(mo,[["render",Co]]);export{ce as default};

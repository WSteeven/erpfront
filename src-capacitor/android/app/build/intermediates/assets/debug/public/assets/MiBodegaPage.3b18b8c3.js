import{a as Y,Q as M}from"./QTabs.6c234f27.js";import{Q as f,a as k}from"./QSelect.6ce302d7.js";import{Q as T,a as w}from"./QItemSection.9a955ec6.js";import{d as Z,m as L,u as x,c as h,h as ee,e as E,w as oe,f as ae,_ as te,t as se,v as b,P as ie,F as s,y as i,D as l,z as t,bb as re,a3 as le,M as ne,N as de,K as C,O as n,B as m,x as V,J as q,bd as pe,j as ue,b0 as me,I as ce}from"./index.6449c167.js";import{a as v}from"./QToolbar.8dbe891b.js";import{a as fe,Q as S}from"./QTabPanels.49d2362a.js";import{Q as be}from"./QPage.5d173a8a.js";import{u as ve,c as ye}from"./UseMaterialesTarea.478e3218.js";import{a as ge,F as Pe,u as ke}from"./FiltroMiBodegaEmpleado.6f29e11b.js";import{d as y}from"./tareas.utils.309e0dff.js";import{E as Te}from"./EssentialTable.00c17e97.js";import{F as we,u as Ee}from"./FiltroMiBodegaProyecto.bd0cdd05.js";import{u as Ce}from"./filtrosListadosGenerales.c3aa2da3.js";import{b as Ve,u as qe,a as Me}from"./utils.521b98f3.js";import{F as Se}from"./FiltroMiBodega.25018dcd.js";import"./QResizeObserver.9af84680.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./listadoMaterialesDevolucion.d0f286be.js";import"./ClienteMaterialEmpleadoController.7d9b9472.js";import"./entidadAuditable.75a46700.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./EtapaController.dbfc00d7.js";import"./ProyectoController.fd7b11f8.js";var Qe=Z({components:{EssentialTable:Te},setup(){const a=ge();Ve().setQuasar(L()),qe().setQuasar(L());const o=x(),{notificarAdvertencia:Q}=Me(),c=h();ee(()=>{c.value=y.personal,P.value=e.proyectos});const p=E(new Se),r=E(new we),g=E(new Pe),e=E({productos:[],productosTarea:[],productosProyectosEtapas:[],productosStock:[],clientesMaterialesTarea:[],clientesMaterialesEmpleado:[],tareas:[],proyectos:[],etapas:[]}),{consultarProductosTarea:A,consultarClientesMaterialesTarea:u,consultarTareasClienteFinalMantenimiento:_}=ve(p,e),{consultarProductosEmpleado:N,consultarClientesMaterialesEmpleado:F}=ke(g,e),{consultarProyectos:$,consultarEtapas:z,consultarProductosProyecto:U}=Ee(r,e);function j(d){switch(d){case"proyectos":$().then(()=>P.value=e.proyectos);break;case"clientes":r.etapa_id?u({proyecto_id:r.proyecto_id,etapa_id:r.etapa_id,filtrar_por_etapa:!0}):u({proyecto_id:r.proyecto_id,etapa_id:r.etapa_id,filtrar_por_proyecto:!0});break}}function I(d){switch(d){case"tareas":_(o.user.id);break;case"clientes":u({tarea_id:p.tarea_id,filtrar_por_tarea:1});break}}function R(d){switch(d){case"clientes":F();break}}function D(){e.productos=[],p.cliente_id=void 0,e.tareas.find(d=>d.id===p.tarea_id),u({tarea_id:p.tarea_id,filtrar_por_tarea:1})}async function O(){r.proyecto_id?(await z(r.proyecto_id),B.value=e.etapas,e.proyectos.find(d=>d.id===r.proyecto_id),r.cliente_id=void 0,a.codigoTarea=null):e.etapas=[],e.productosProyectosEtapas=[],e.productos=[],r.etapa_id=null,p.cliente_id=null,e.etapas.length||u({proyecto_id:r.proyecto_id,filtrar_por_proyecto:1})}function J(){u({proyecto_id:r.proyecto_id,etapa_id:r.etapa_id,filtrar_por_etapa:1})}function K(){if(e.etapas.length&&!r.etapa_id)return Q("Debe seleccionar una etapa");U()}u({filtrar_por_tarea:!0}),F(),_(o.user.id),$().then(()=>P.value=e.proyectos),oe(c,()=>{switch(c.value){case y.paraClienteFinal:e.productos=e.productosTarea,a.listadoMateriales=e.productosTarea;break;case y.paraProyecto:e.productos=e.productosProyectosEtapas,a.listadoMateriales=e.productosProyectosEtapas;break;case"personal":e.productos=e.productosStock,a.listadoMateriales=e.productosStock;break}});const{tareas:G,filtrarTareas:H,proyectos:P,filtrarProyectos:W,etapas:B,filtrarEtapas:X}=Ce(e);return{tab:c,configuracionColumnasMaterialEmpleadoTarea:ye,listadosAuxiliares:e,filtro:p,filtroProyecto:r,filtroEmpleado:g,destinosTareas:y,transferenciaProductoEmpleadoStore:a,consultarEtapas:z,tareas:G,proyectos:P,etapas:B,filtrarTareas:H,filtrarProyectos:W,filtrarEtapas:X,seleccionarTarea:D,seleccionarProyecto:O,seleccionarEtapa:J,consultarProductosTarea:A,consultarProductosProyectoEtapa:K,consultarProductosEmpleado:N,refrescarListadosProyectos:j,refrescarListadosTareas:I,refrescarListadosEmpleado:R,mostrarBtnTransferirStockPersonal:ae(()=>c.value===y.paraClienteFinal)}}});const _e={class:"row q-col-gutter-sm q-pa-sm q-mb-md"},Fe={class:"col-12 col-md-6"},$e={key:0,class:"col-12 col-md-6"},ze={class:"row q-mb-lg"},Be={class:"col-12"},Le={class:"row q-col-gutter-sm q-pa-sm q-mb-md"},Ae={class:"col-12 col-md-4"},Ne={class:"col-12 col-md-4"},Ue={key:0,class:"col-12 col-md-4"},je={key:1,class:"col-12 col-md-4"},Ie={class:"row q-mb-lg"},Re={class:"col-12"},De={class:"row justify-center q-gutter-sm q-mb-md"},Oe={class:"col-12"},Je={class:"col-12"},Ke={key:0,class:"row q-pt-md"},Ge={class:"col-12 row justify-center q-gutter-sm q-mb-md"},He={class:"col-12 q-px-md q-mb-md"};function We(a,o,Q,c,p,r){const g=se("essential-table");return b(),ie(be,{padding:""},{default:s(()=>[o[40]||(o[40]=i("div",{class:"column q-mb-md text-center"},[i("div",{class:"q-mb-md text-primary"},"Mi bodega"),i("small",null,[l("Conoce el material que tienes a tu disposici\xF3n para utilizar en tus trabajos. "),i("br"),l(" El material puede ser asignado para la tarea o a tu stock personal.")])],-1)),t(re,{class:"rounded-card custom-shadow"},{default:s(()=>[t(Y,{modelValue:a.tab,"onUpdate:modelValue":o[0]||(o[0]=e=>a.tab=e),class:le(["text-primary",{"bg-grey-3":!a.$q.dark.isActive}]),"active-color":"primary",align:"justify","no-caps":"","inline-label":""},{default:s(()=>[t(M,{name:a.destinosTareas.personal,label:"Stock personal",icon:"bi-person"},null,8,["name"]),t(M,{name:a.destinosTareas.paraClienteFinal,label:"Material para cliente final y mantenimiento",icon:"bi-pin-angle"},null,8,["name"]),t(M,{name:a.destinosTareas.paraProyecto,label:"Material para proyectos",icon:"bi-diagram-2"},null,8,["name"])]),_:1},8,["modelValue","class"]),t(fe,{modelValue:a.tab,"onUpdate:modelValue":o[19]||(o[19]=e=>a.tab=e),animated:""},{default:s(()=>[t(S,{name:a.destinosTareas.paraClienteFinal},{default:s(()=>[i("div",_e,[i("div",Fe,[o[21]||(o[21]=i("label",{class:"q-mb-sm block"},"Seleccione una tarea",-1)),t(f,{modelValue:a.filtro.tarea_id,"onUpdate:modelValue":[o[2]||(o[2]=e=>a.filtro.tarea_id=e),o[3]||(o[3]=e=>a.seleccionarTarea())],options:a.tareas,onFilter:a.filtrarTareas,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.codigo_tarea+" - "+e.titulo,"option-value":e=>e.id,"emit-value":"","map-options":""},{option:s(e=>[t(T,ne(de(e.itemProps)),{default:s(()=>[t(w,null,{default:s(()=>[t(k,null,{default:s(()=>[l(C(e.opt.codigo_tarea),1)]),_:2},1024),t(k,{caption:""},{default:s(()=>[l(C(e.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[1]||(o[1]=e=>a.refrescarListadosTareas("tareas"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[20]||(o[20]=[l("Recargar tareas")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),a.filtro.tarea_id?(b(),V("div",$e,[o[23]||(o[23]=i("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material",-1)),t(f,{modelValue:a.filtro.cliente_id,"onUpdate:modelValue":o[5]||(o[5]=e=>a.filtro.cliente_id=e),options:a.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.razon_social,"option-value":e=>e.cliente_id,"emit-value":"","map-options":""},{after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[4]||(o[4]=e=>a.refrescarListadosTareas("clientes"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[22]||(o[22]=[l("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):q("",!0)]),i("div",ze,[i("div",Be,[t(n,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:o[6]||(o[6]=e=>a.consultarProductosTarea())},{default:s(()=>o[24]||(o[24]=[l("Consultar")])),_:1})])])]),_:1},8,["name"]),t(S,{name:a.destinosTareas.paraProyecto},{default:s(()=>[i("div",Le,[i("div",Ae,[o[27]||(o[27]=i("label",{class:"q-mb-sm block"},"Todos los proyectos asignados",-1)),t(f,{modelValue:a.filtroProyecto.proyecto_id,"onUpdate:modelValue":[o[8]||(o[8]=e=>a.filtroProyecto.proyecto_id=e),o[9]||(o[9]=e=>a.seleccionarProyecto())],options:a.proyectos,onFilter:a.filtrarProyectos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",clearable:""},{option:s(e=>[t(T,pe(e.itemProps,{class:"q-my-sm"}),{default:s(()=>[t(w,null,{default:s(()=>[t(k,{class:"text-bold text-primary"},{default:s(()=>[l(C(e.opt.codigo_proyecto),1)]),_:2},1024),t(k,{caption:""},{default:s(()=>[l(C(e.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[7]||(o[7]=e=>a.refrescarListadosProyectos("proyectos"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[25]||(o[25]=[l("Recargar proyectos")])),_:1})]),_:1})]),"no-option":s(()=>[t(T,null,{default:s(()=>[t(w,{class:"text-grey"},{default:s(()=>o[26]||(o[26]=[l(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])]),ue(i("div",Ne,[o[29]||(o[29]=i("label",{class:"q-mb-sm block"},"Seleccione una etapa",-1)),t(f,{modelValue:a.filtroProyecto.etapa_id,"onUpdate:modelValue":[o[10]||(o[10]=e=>a.filtroProyecto.etapa_id=e),o[11]||(o[11]=e=>a.seleccionarEtapa())],options:a.etapas,onFilter:a.filtrarEtapas,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{"no-option":s(()=>[t(T,null,{default:s(()=>[t(w,{class:"text-grey"},{default:s(()=>o[28]||(o[28]=[l(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])],512),[[me,a.filtroProyecto.proyecto_id&&a.etapas.length]]),a.filtroProyecto.proyecto_id?(b(),V("div",Ue,[o[31]||(o[31]=i("label",{class:"q-mb-sm block"},"Cliente propietario del material de proyecto/etapa",-1)),t(f,{modelValue:a.filtroProyecto.cliente_id,"onUpdate:modelValue":o[13]||(o[13]=e=>a.filtroProyecto.cliente_id=e),options:a.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.razon_social,"option-value":e=>e.cliente_id,"emit-value":"","map-options":""},{after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[12]||(o[12]=e=>a.refrescarListadosProyectos("clientes"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[30]||(o[30]=[l("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])])):q("",!0),a.transferenciaProductoEmpleadoStore.codigoTarea?(b(),V("div",je,[o[32]||(o[32]=i("label",{class:"q-mb-sm block"},"Tarea",-1)),t(ce,{modelValue:a.transferenciaProductoEmpleadoStore.codigoTarea,"onUpdate:modelValue":o[14]||(o[14]=e=>a.transferenciaProductoEmpleadoStore.codigoTarea=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):q("",!0)]),i("div",Ie,[i("div",Re,[t(n,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:o[15]||(o[15]=e=>a.consultarProductosProyectoEtapa())},{default:s(()=>o[33]||(o[33]=[l("Consultar")])),_:1})])])]),_:1},8,["name"]),t(S,{name:a.destinosTareas.personal},{default:s(()=>[i("div",De,[i("div",Oe,[o[35]||(o[35]=i("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material",-1)),t(f,{modelValue:a.filtroEmpleado.cliente_id,"onUpdate:modelValue":o[17]||(o[17]=e=>a.filtroEmpleado.cliente_id=e),options:a.listadosAuxiliares.clientesMaterialesEmpleado,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":e=>e.razon_social,"option-value":e=>e.cliente_id,"emit-value":"","map-options":""},{after:s(()=>[t(n,{color:"positive",unelevated:"",onClick:o[16]||(o[16]=e=>a.refrescarListadosEmpleado("clientes"))},{default:s(()=>[t(m,{size:"xs",name:"bi-arrow-clockwise"}),t(v,null,{default:s(()=>o[34]||(o[34]=[l("Recargar clientes")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),i("div",Je,[t(n,{color:"primary",icon:"bi-search",class:"full-width","no-caps":"",unelevated:"",onClick:o[18]||(o[18]=e=>a.consultarProductosEmpleado())},{default:s(()=>o[36]||(o[36]=[l("Consultar")])),_:1})])])]),_:1},8,["name"])]),_:1},8,["modelValue"]),a.listadosAuxiliares.productos.length?(b(),V("div",Ke,[o[39]||(o[39]=i("div",{class:"col-12 text-center"},[i("label",{class:"q-mb-sm block text-bold"},"Opciones de devoluci\xF3n de material sobrante de la tarea")],-1)),i("div",Ge,[t(n,{class:"bg-grey-4 text-primary","no-caps":"",unelevated:"",rounded:"",to:{name:"devoluciones"}},{default:s(()=>[t(m,{name:"bi-building",size:"xs",class:"q-pr-sm"}),o[37]||(o[37]=i("span",null,"Devolver a bodega matriz",-1))]),_:1}),t(n,{"no-caps":"",class:"bg-grey-4 text-primary",unelevated:"",rounded:"",to:{name:"transferencia_producto_empleado"}},{default:s(()=>[t(m,{name:"bi-box-arrow-up-right",size:"xs",class:"q-pr-sm"}),o[38]||(o[38]=i("span",null,"Transferir a otro empleado",-1))]),_:1})]),i("div",He,[t(g,{titulo:"Productos",configuracionColumnas:a.configuracionColumnasMaterialEmpleadoTarea,datos:a.listadosAuxiliares.productos,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"alto-fijo":!1,"ajustar-celdas":!0,"mostrar-exportar":!0},null,8,["configuracionColumnas","datos"])])])):q("",!0)]),_:1})]),_:1})}var $o=te(Qe,[["render",We]]);export{$o as default};

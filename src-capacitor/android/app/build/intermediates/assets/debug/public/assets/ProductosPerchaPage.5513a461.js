var A=Object.defineProperty;var K=(e,o,s)=>o in e?A(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s;var S=(e,o,s)=>(K(e,typeof o!="symbol"?o+"":o,s),s);import{Q as C,a as w}from"./QItemSection.9a955ec6.js";import{Q as h,a as P}from"./QSelect.6ce302d7.js";import{bw as M,s as O,c as b,d as R,cs as z,_ as G,t as q,v as f,P as H,F as i,z as n,y as t,D as g,I as B,a2 as J,O as W,M as X,N as Y,K as v,x as I,H as E,G as L,a4 as Z}from"./index.6449c167.js";import{Q as x}from"./QForm.ca56f146.js";import{r as k,c as oo}from"./index.0198dd12.js";import{u as eo}from"./index.490dde02.js";import{c as ao}from"./configuracionColumnasInventarios.ec051713.js";import{T as so}from"./TabLayout.0bce4313.js";import{E as io}from"./EssentialSelectableTable.5a9cc771.js";import{C as no}from"./ContenedorSimpleMixin.09c9bed5.js";import{E as to}from"./entidadAuditable.75a46700.js";import{U as ro}from"./UbicacionController.99acdf7e.js";import{S as lo}from"./SelectorController.de8e1cd0.js";import{S as uo,a as co}from"./utils.521b98f3.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPopupProxy.72ff1d6d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTable.00c17e97.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./EssentialTablePagination.d5c1010a.js";const mo=[{name:"inventario",field:"inventario",label:"Item",align:"left",sortable:!0},{name:"stock",field:"stock",label:"Cantidad",align:"left",sortable:!0},{name:"ubicacion",field:"ubicacion",label:"Ubicaci\xF3n",align:"left",sortable:!0}];class po extends to{constructor(){super();S(this,"stock");S(this,"ubicacion");S(this,"inventario");this.stock=null,this.ubicacion=null,this.inventario=null}}class vo extends M{constructor(){super(O.productos_perchas)}}function bo(e){const o=new lo(e.endpoint),s=new uo;return{listar:async(r,l)=>{const p={search:r};let a;if(r||delete p.search,l){s.activar();const{response:u}=await o.listar(l);a=u.data.results,s.desactivar()}else{s.activar();const{response:u}=await o.listar(p);a=u.data.results,s.desactivar()}if(a.length===0){const{notificarAdvertencia:u}=co();u("No se encontraron coincidencias");return}e.listadoSeleccionable.value=[...a],e.refListadoSeleccionable.value.mostrar()},seleccionar:async r=>{s.activar();const{result:l}=await o.consultar(r);e.seleccionar(l),s.desactivar()}}}function fo(e,o){const s=b(),c=b([]),d=b(),r={refListadoSeleccionable:s,listadoSeleccionable:c,endpoint:o,limpiar:()=>{e.inventario=null,d.value=null},seleccionar:m=>{e.inventario=m[0].id,d.value=m[0].producto}},l=bo(r);return{refListadoSeleccionable:s,listado:c,listar:m=>l.listar(d.value,m),limpiar:()=>r.limpiar(),seleccionar:m=>{r.seleccionar(m)},criterioBusqueda:d}}var go=R({components:{TabLayout:so,EssentialSelectableTable:io},setup(){const e=new no(po,new vo),{entidad:o,disabled:s,listadosAuxiliares:c}=e.useReferencias(),{setValidador:d,obtenerListados:r,cargarVista:l}=e.useComportamiento(),{onGuardado:p,onReestablecer:a}=e.useHooks();let u=b();const{refListadoSeleccionable:m,criterioBusqueda:Q,listado:U,listar:N,limpiar:T,seleccionar:_}=fo(o,"inventarios"),j={inventario:{required:k},ubicacion:{required:k},stock:{required:k,minimo:oo(1)}},V=eo(j,o);d(V.value);const y=b([]),$=b([]);l(async()=>{await r({sucursales:{controller:new z,params:{campos:"id,lugar"}}})}),y.value=c.ubicaciones,$.value=c.sucursales,p(()=>{u.value=""}),a(()=>{u.value=""});function D(F){l(async()=>{await r({ubicaciones:{controller:new ro,params:{sucursal:u.value}}}),y.value=c.ubicaciones})}return{mixin:e,producto_percha:o,v$:V,disabled:s,configuracionColumnas:mo,opciones_ubicaciones:y,opciones_sucursales:$,sucursal:u,refListadoSeleccionableInventarios:m,criterioBusquedaInventario:Q,listadoInventarios:U,listarInventarios:N,limpiarInventario:T,seleccionarInventario:_,configuracionColumnasInventarios:ao,SucursalSeleccionada(F){D()}}}});const So={class:"row q-col-gutter-sm q-py-md"},Io={class:"col-12 col-md-6"},yo={class:"col-12 col-md-6"},Co={class:"row"},wo={class:"col-12 col-md-8 q-mb-md"},ko={class:"col-12 col-md-4"},Vo={class:"col-12 col-md-6"},$o={class:"error-msg"},ho={class:"col-12 col-md-6"},Po={class:"error-msg"};function qo(e,o,s,c,d,r){const l=q("essential-selectable-table"),p=q("tab-layout");return f(),H(p,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Control de productos en perchas"},{formulario:i(()=>[n(x,{onSubmit:o[7]||(o[7]=Z(()=>{},["prevent"]))},{default:i(()=>[t("div",So,[t("div",Io,[o[9]||(o[9]=t("label",{class:"q-mb-sm block"},"Sucursal",-1)),n(h,{modelValue:e.sucursal,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.sucursal=a),e.SucursalSeleccionada],options:e.opciones_sucursales,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","error-message":"Debes seleccionar una sucursal","option-label":a=>a.lugar,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":i(()=>[n(C,null,{default:i(()=>[n(w,{class:"text-grey"},{default:i(()=>o[8]||(o[8]=[g(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","option-label","option-value"])]),t("div",yo,[o[11]||(o[11]=t("label",{class:"q-mb-sm block"},"Inventario",-1)),t("div",Co,[t("div",wo,[n(B,{modelValue:e.criterioBusquedaInventario,"onUpdate:modelValue":o[1]||(o[1]=a=>e.criterioBusquedaInventario=a),placeholder:"Producto del inventario",hint:"Presiona Enter para seleccionar un producto",onKeydown:o[2]||(o[2]=J(a=>e.listarInventarios({sucursal_id:e.sucursal}),["enter"])),onBlur:o[3]||(o[3]=a=>e.criterioBusquedaInventario===""?e.limpiarInventario():null),dense:"",outlined:""},null,8,["modelValue"])]),t("div",ko,[n(W,{onClick:o[4]||(o[4]=a=>e.listarInventarios({sucursal_id:e.sucursal})),icon:"search",unelevated:"",color:"secondary",class:"full-width",style:{height:"40px"},"no-caps":""},{default:i(()=>o[10]||(o[10]=[g("Buscar")])),_:1})])])]),t("div",Vo,[o[13]||(o[13]=t("label",{class:"q-mb-sm block"},"Ubicaci\xF3n",-1)),n(h,{modelValue:e.producto_percha.ubicacion,"onUpdate:modelValue":o[5]||(o[5]=a=>e.producto_percha.ubicacion=a),options:e.opciones_ubicaciones,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",error:!!e.v$.ubicacion.$errors.length,"error-message":"Debes seleccionar una ubicaci\xF3n","option-label":a=>a.codigo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:i(a=>[n(C,X(Y(a.itemProps)),{default:i(()=>[n(w,null,{default:i(()=>[n(P,null,{default:i(()=>[g(v(a.opt.codigo),1)]),_:2},1024),n(P,{caption:""},{default:i(()=>[g("Piso:"+v(a.opt.piso)+" | Percha:"+v(a.opt.percha)+" | Sucursal:"+v(a.opt.sucursal),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:i(()=>[(f(!0),I(L,null,E(e.v$.ubicacion.$errors,a=>(f(),I("div",{key:a.$uid},[t("div",$o,v(a.$message),1)]))),128))]),"no-option":i(()=>[n(C,null,{default:i(()=>[n(w,{class:"text-grey"},{default:i(()=>o[12]||(o[12]=[g(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","error","option-label","option-value"])]),t("div",ho,[o[14]||(o[14]=t("label",{class:"q-mb-sm block"},"Cantidad",-1)),n(B,{type:"number",modelValue:e.producto_percha.stock,"onUpdate:modelValue":o[6]||(o[6]=a=>e.producto_percha.stock=a),placeholder:"Obligatorio",readonly:e.disabled,error:!!e.v$.stock.$errors.length,outlined:"",dense:""},{error:i(()=>[(f(!0),I(L,null,E(e.v$.stock.$errors,a=>(f(),I("div",{key:a.$uid},[t("div",Po,v(a.$message),1)]))),128))]),_:1},8,["modelValue","readonly","error"])])])]),_:1}),n(l,{ref:"refListadoSeleccionableInventarios","configuracion-columnas":e.configuracionColumnasInventarios,datos:e.listadoInventarios,onSelected:e.seleccionarInventario},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas"])}var me=G(go,[["render",qo]]);export{me as default};

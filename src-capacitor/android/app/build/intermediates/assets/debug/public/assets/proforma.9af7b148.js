var P=Object.defineProperty;var z=(t,i,r)=>i in t?P(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r;var a=(t,i,r)=>(z(t,typeof i!="symbol"?i+"":i,r),r);import{a as w,S as A,B as L}from"./utils.521b98f3.js";import{l as S,e as R,c as B,bx as I,bZ as f,b_ as p,A as d,bE as m,s as u}from"./index.6449c167.js";import{E as T}from"./entidadAuditable.75a46700.js";class h extends T{constructor(){super();a(this,"autorizacion_id");a(this,"autorizacion");a(this,"autorizador_id");a(this,"autorizador");a(this,"causa_anulacion");a(this,"cliente_id");a(this,"cliente");a(this,"codigo");a(this,"created_at");a(this,"descripcion");a(this,"descuento_general");a(this,"estado");a(this,"forma");a(this,"iva");a(this,"listadoProductos");a(this,"observacion_aut");a(this,"solicitante_id");a(this,"solicitante");a(this,"tiempo");a(this,"copia_proforma");a(this,"id_aux");a(this,"modificar_descuento");a(this,"modificar_iva");a(this,"tiene_pedido");a(this,"tiene_preorden");this.autorizacion=null,this.autorizacion_id=null,this.autorizador=null,this.autorizador_id=null,this.causa_anulacion=null,this.cliente=null,this.cliente_id=null,this.codigo=null,this.copia_proforma=!1,this.created_at=null,this.descripcion=null,this.descuento_general=0,this.estado=null,this.forma=null,this.id_aux=null,this.iva=15,this.listadoProductos=[],this.modificar_descuento=!1,this.modificar_iva=!1,this.observacion_aut=null,this.solicitante=null,this.solicitante_id=null,this.tiempo=null,this.tiene_pedido=!1,this.tiene_preorden=!1}}const H=S("proforma",()=>{const t=R(new h),i=new h,r=B(),{notificarAdvertencia:n,notificarError:_}=w(),v=I.nuevo,c=new A;async function g(e){const o=d.getInstance(),s=o.getEndpoint(u.proformas)+"/show-preview/"+e,l=await o.get(s);if(l.data.modelo.autorizacion===f.aprobado)return l.data.modelo}async function y(e){try{c.activar();const o=await g(e);o.autorizacion===f.aprobado&&o.estado!==p.completa?t.hydrate(o):o.estado===p.completa?(n("La proforma ya est\xE1 completada"),t.hydrate(i)):(n("La proforma no est\xE1 aprobada"),t.hydrate(i))}catch{n("Proforma no encontrada"),t.hydrate(i)}finally{c.desactivar()}}async function E(){try{const e=d.getInstance(),o=m.URL_BASE+"/"+e.getEndpoint(u.proformas)+"/imprimir/"+r.value,s="proforma_"+r.value+"_"+Date.now();await L(o,"GET","blob","pdf",s),console.log("Proforma impresa con \xE9xito")}catch(e){n("Error al imprimir la proforma. "+e)}}async function x(e){try{c.activar();const o=d.getInstance(),s=m.URL_BASE+"/"+o.getEndpoint(u.proformas)+"/anular/"+r.value;return await o.post(s,e)}catch(o){_(o)}finally{c.desactivar()}}function b(){t.hydrate(i)}return{proforma:t,accionProforma:v,idProforma:r,cargarProforma:y,anularProforma:x,resetearproforma:b,imprimirPdf:E}});export{h as P,H as u};

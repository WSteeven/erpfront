var na=Object.defineProperty;var la=(e,a,v)=>a in e?na(e,a,{enumerable:!0,configurable:!0,writable:!0,value:v}):e[a]=v;var se=(e,a,v)=>(la(e,typeof a!="symbol"?a+"":a,v),v);import{Q as ia}from"./QResizeObserver.1422c274.js";import{ac as Qe,b8 as Oe,b9 as K,ba as xe,c as V,f as b,w,i as Se,aj as ua,k as R,g as Ee,aH as da,ad as ca,aK as va,af as fa,aM as ma,aO as pa,bb as ba,n as Be,h as Fe,j as _e,b5 as Me,ak as ga,bc as ha,_ as oe,d as de,v as h,P as U,F as n,z as i,B as X,O as ae,J as le,b2 as Ae,V as Ce,x as S,y as c,m as De,D as z,a5 as ke,t as Ne,K as Q,G as j,H as W,u as Ie,bd as ya,be as Ve,bf as wa,bg as $a,I as Le,a6 as Ca,E as ka,S as Sa,a0 as _a,R as Ta,e as qa,A as za,s as Ba,bh as ye}from"./index.b8e09611.js";import{T as we}from"./TouchPan.4c6fe26a.js";import{b as ne}from"./format.8ac60962.js";import{Q as Ma}from"./QCircularProgress.c6e924d2.js";import{S as Va,a as La}from"./utils.9344cd7e.js";import{a as A,Q as G}from"./QItemSection.ec4cc512.js";import{a as ie,Q as ue}from"./QSelect.b920278b.js";import{Q as Pa}from"./QExpansionItem.795361a7.js";import{C as $e,a as Qa}from"./ComponenteModal.domain.92aacded.js";import{Q as Oa}from"./QForm.eab79b48.js";import{m as xa}from"./tareas.utils.309e0dff.js";import{r as J}from"./i18n-validators.06abe774.js";import{u as je}from"./index.70965bc7.js";import{T as Ea}from"./TabLayout.45a66130.js";import{E as He}from"./EssentialTable.23af6cc8.js";import{T as Fa}from"./TrabajoAsignadoController.98c8e93e.js";import{C as Re}from"./ContenedorSimpleMixin.4e22246b.js";import{M as Aa}from"./MovilizacionSubtareaController.2105c2e2.js";import{u as Da}from"./movilizacionSubtarea.b7993c98.js";import{M as Na}from"./MovilizacionSubtarea.9a93287f.js";import{c as Ia}from"./configuracionColumnasTarea.bcb4cc35.js";import{u as ja}from"./FiltrosListadosTarea.66a67f58.js";import{T as Ha}from"./TareaController.490ce98d.js";import{u as Ra,T as Wa}from"./tarea.83f4cb12.js";import Ua from"./ModoNoDisponiblePage.1dd5d0c4.js";var tt=Qe({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:a,emit:v}){const{proxy:{$q:g}}=Ee(),u=Oe(xe,K);if(u===K)return console.error("QHeader needs to be child of QLayout"),K;const f=V(parseInt(e.heightHint,10)),r=V(!0),s=b(()=>e.reveal===!0||u.view.value.indexOf("H")!==-1||g.platform.is.ios&&u.isContainer.value===!0),_=b(()=>{if(e.modelValue!==!0)return 0;if(s.value===!0)return r.value===!0?f.value:0;const l=f.value-u.scroll.value.position;return l>0?l:0}),O=b(()=>e.modelValue!==!0||s.value===!0&&r.value!==!0),t=b(()=>e.modelValue===!0&&O.value===!0&&e.reveal===!0),x=b(()=>"q-header q-layout__section--marginal "+(s.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(O.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),T=b(()=>{const l=u.rows.value.top,y={};return l[0]==="l"&&u.left.space===!0&&(y[g.lang.rtl===!0?"right":"left"]=`${u.left.size}px`),l[2]==="r"&&u.right.space===!0&&(y[g.lang.rtl===!0?"left":"right"]=`${u.right.size}px`),y});function $(l,y){u.update("header",l,y)}function m(l,y){l.value!==y&&(l.value=y)}function C({height:l}){m(f,l),$("size",l)}function k(l){t.value===!0&&m(r,!0),v("focusin",l)}w(()=>e.modelValue,l=>{$("space",l),m(r,!0),u.animate()}),w(_,l=>{$("offset",l)}),w(()=>e.reveal,l=>{l===!1&&m(r,e.modelValue)}),w(r,l=>{u.animate(),v("reveal",l)}),w(u.scroll,l=>{e.reveal===!0&&m(r,l.direction==="up"||l.position<=e.revealOffset||l.position-l.inflectionPoint<100)});const p={};return u.instances.header=p,e.modelValue===!0&&$("size",f.value),$("space",e.modelValue),$("offset",_.value),Se(()=>{u.instances.header===p&&(u.instances.header=void 0,$("size",0),$("offset",0),$("space",!1))}),()=>{const l=ua(a.default,[]);return e.elevated===!0&&l.push(R("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(R(ia,{debounce:0,onResize:C})),R("header",{class:x.value,style:T.value,onFocusin:k},l)}}});const Pe=150;var rt=Qe({name:"QDrawer",inheritAttrs:!1,props:{...da,...ca,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...va,"onLayout","miniState"],setup(e,{slots:a,emit:v,attrs:g}){const u=Ee(),{proxy:{$q:f}}=u,r=fa(e,f),{preventBodyScroll:s}=ha(),{registerTimeout:_,removeTimeout:O}=ma(),t=Oe(xe,K);if(t===K)return console.error("QDrawer needs to be child of QLayout"),K;let x,T=null,$;const m=V(e.behavior==="mobile"||e.behavior!=="desktop"&&t.totalWidth.value<=e.breakpoint),C=b(()=>e.mini===!0&&m.value!==!0),k=b(()=>C.value===!0?e.miniWidth:e.width),p=V(e.showIfAbove===!0&&m.value===!1?!0:e.modelValue===!0),l=b(()=>e.persistent!==!0&&(m.value===!0||We.value===!0));function y(o,d){if(ce(),o!==!1&&t.animate(),M(0),m.value===!0){const q=t.instances[te.value];q!==void 0&&q.belowBreakpoint===!0&&q.hide(!1),N(1),t.isContainer.value!==!0&&s(!0)}else N(0),o!==!1&&be(!1);_(()=>{o!==!1&&be(!0),d!==!0&&v("show",o)},Pe)}function H(o,d){ve(),o!==!1&&t.animate(),N(0),M(B.value*k.value),ge(),d!==!0?_(()=>{v("hide",o)},Pe):O()}const{show:D,hide:E}=pa({showing:p,hideOnRouteChange:l,handleShow:y,handleHide:H}),{addToHistory:ce,removeFromHistory:ve}=ba(p,E,l),Y={belowBreakpoint:m,hide:E},L=b(()=>e.side==="right"),B=b(()=>(f.lang.rtl===!0?-1:1)*(L.value===!0?1:-1)),F=V(0),P=V(!1),Z=V(!1),Te=V(k.value*B.value),te=b(()=>L.value===!0?"left":"right"),fe=b(()=>p.value===!0&&m.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:k.value:0),me=b(()=>e.overlay===!0||e.miniToOverlay===!0||t.view.value.indexOf(L.value?"R":"L")!==-1||f.platform.is.ios===!0&&t.isContainer.value===!0),ee=b(()=>e.overlay===!1&&p.value===!0&&m.value===!1),We=b(()=>e.overlay===!0&&p.value===!0&&m.value===!1),Ue=b(()=>"fullscreen q-drawer__backdrop"+(p.value===!1&&P.value===!1?" hidden":"")),Je=b(()=>({backgroundColor:`rgba(0,0,0,${F.value*.4})`})),qe=b(()=>L.value===!0?t.rows.value.top[2]==="r":t.rows.value.top[0]==="l"),Ke=b(()=>L.value===!0?t.rows.value.bottom[2]==="r":t.rows.value.bottom[0]==="l"),Ge=b(()=>{const o={};return t.header.space===!0&&qe.value===!1&&(me.value===!0?o.top=`${t.header.offset}px`:t.header.space===!0&&(o.top=`${t.header.size}px`)),t.footer.space===!0&&Ke.value===!1&&(me.value===!0?o.bottom=`${t.footer.offset}px`:t.footer.space===!0&&(o.bottom=`${t.footer.size}px`)),o}),Xe=b(()=>{const o={width:`${k.value}px`,transform:`translateX(${Te.value}px)`};return m.value===!0?o:Object.assign(o,Ge.value)}),Ye=b(()=>"q-drawer__content fit "+(t.isContainer.value!==!0?"scroll":"overflow-auto")),Ze=b(()=>`q-drawer q-drawer--${e.side}`+(Z.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(r.value===!0?" q-drawer--dark q-dark":"")+(P.value===!0?" no-transition":p.value===!0?"":" q-layout--prevent-focus")+(m.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${C.value===!0?"mini":"standard"}`+(me.value===!0||ee.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(qe.value===!0?" q-drawer--top-padding":""))),ea=b(()=>{const o=f.lang.rtl===!0?e.side:te.value;return[[we,ra,void 0,{[o]:!0,mouse:!0}]]}),aa=b(()=>{const o=f.lang.rtl===!0?te.value:e.side;return[[we,ze,void 0,{[o]:!0,mouse:!0}]]}),oa=b(()=>{const o=f.lang.rtl===!0?te.value:e.side;return[[we,ze,void 0,{[o]:!0,mouse:!0,mouseAllDir:!0}]]});function pe(){sa(m,e.behavior==="mobile"||e.behavior!=="desktop"&&t.totalWidth.value<=e.breakpoint)}w(m,o=>{o===!0?(x=p.value,p.value===!0&&E(!1)):e.overlay===!1&&e.behavior!=="mobile"&&x!==!1&&(p.value===!0?(M(0),N(0),ge()):D(!1))}),w(()=>e.side,(o,d)=>{t.instances[d]===Y&&(t.instances[d]=void 0,t[d].space=!1,t[d].offset=0),t.instances[o]=Y,t[o].size=k.value,t[o].space=ee.value,t[o].offset=fe.value}),w(t.totalWidth,()=>{(t.isContainer.value===!0||document.qScrollPrevented!==!0)&&pe()}),w(()=>e.behavior+e.breakpoint,pe),w(t.isContainer,o=>{p.value===!0&&s(o!==!0),o===!0&&pe()}),w(t.scrollbarWidth,()=>{M(p.value===!0?0:void 0)}),w(fe,o=>{I("offset",o)}),w(ee,o=>{v("onLayout",o),I("space",o)}),w(L,()=>{M()}),w(k,o=>{M(),he(e.miniToOverlay,o)}),w(()=>e.miniToOverlay,o=>{he(o,k.value)}),w(()=>f.lang.rtl,()=>{M()}),w(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(ta(),t.animate())}),w(C,o=>{v("miniState",o)});function M(o){o===void 0?Be(()=>{o=p.value===!0?0:k.value,M(B.value*o)}):(t.isContainer.value===!0&&L.value===!0&&(m.value===!0||Math.abs(o)===k.value)&&(o+=B.value*t.scrollbarWidth.value),Te.value=o)}function N(o){F.value=o}function be(o){const d=o===!0?"remove":t.isContainer.value!==!0?"add":"";d!==""&&document.body.classList[d]("q-body--drawer-toggle")}function ta(){T!==null&&clearTimeout(T),u.proxy&&u.proxy.$el&&u.proxy.$el.classList.add("q-drawer--mini-animate"),Z.value=!0,T=setTimeout(()=>{T=null,Z.value=!1,u&&u.proxy&&u.proxy.$el&&u.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function ra(o){if(p.value!==!1)return;const d=k.value,q=ne(o.distance.x,0,d);if(o.isFinal===!0){q>=Math.min(75,d)===!0?D():(t.animate(),N(0),M(B.value*d)),P.value=!1;return}M((f.lang.rtl===!0?L.value!==!0:L.value)?Math.max(d-q,0):Math.min(0,q-d)),N(ne(q/d,0,1)),o.isFirst===!0&&(P.value=!0)}function ze(o){if(p.value!==!0)return;const d=k.value,q=o.direction===e.side,re=(f.lang.rtl===!0?q!==!0:q)?ne(o.distance.x,0,d):0;if(o.isFinal===!0){Math.abs(re)<Math.min(75,d)===!0?(t.animate(),N(1),M(0)):E(),P.value=!1;return}M(B.value*re),N(ne(1-re/d,0,1)),o.isFirst===!0&&(P.value=!0)}function ge(){s(!1),be(!0)}function I(o,d){t.update(e.side,o,d)}function sa(o,d){o.value!==d&&(o.value=d)}function he(o,d){I("size",o===!0?e.miniWidth:d)}return t.instances[e.side]=Y,he(e.miniToOverlay,k.value),I("space",ee.value),I("offset",fe.value),e.showIfAbove===!0&&e.modelValue!==!0&&p.value===!0&&e["onUpdate:modelValue"]!==void 0&&v("update:modelValue",!0),Fe(()=>{v("onLayout",ee.value),v("miniState",C.value),x=e.showIfAbove===!0;const o=()=>{(p.value===!0?y:H)(!1,!0)};if(t.totalWidth.value!==0){Be(o);return}$=w(t.totalWidth,()=>{$(),$=void 0,p.value===!1&&e.showIfAbove===!0&&m.value===!1?D(!1):o()})}),Se(()=>{$!==void 0&&$(),T!==null&&(clearTimeout(T),T=null),p.value===!0&&ge(),t.instances[e.side]===Y&&(t.instances[e.side]=void 0,I("size",0),I("offset",0),I("space",!1))}),()=>{const o=[];m.value===!0&&(e.noSwipeOpen===!1&&o.push(_e(R("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),ea.value)),o.push(Me("div",{ref:"backdrop",class:Ue.value,style:Je.value,"aria-hidden":"true",onClick:E},void 0,"backdrop",e.noSwipeBackdrop!==!0&&p.value===!0,()=>oa.value)));const d=C.value===!0&&a.mini!==void 0,q=[R("div",{...g,key:""+d,class:[Ye.value,g.class]},d===!0?a.mini():ga(a.default))];return e.elevated===!0&&p.value===!0&&q.push(R("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),o.push(Me("aside",{ref:"content",class:Ze.value,style:Xe.value},q,"contentclose",e.noSwipeClose!==!0&&m.value===!0,()=>aa.value)),R("div",{class:"q-drawer-container"},o)}}});const Ja=de({setup(){const e=V(!1);function a(){window.scrollTo({top:0,behavior:"smooth"})}const v=()=>{e.value=window.scrollY>100};return Fe(()=>{window.addEventListener("scroll",v)}),Se(()=>{window.removeEventListener("scroll",v)}),{scrollToTop:a,showButton:e}}});function Ka(e,a,v,g,u,f){return e.showButton?(h(),U(ae,{key:0,onClick:e.scrollToTop,class:"scroll-to-top-button"},{default:n(()=>[i(X,{name:"bi-arrow-up-short"})]),_:1},8,["onClick"])):le("",!0)}var st=oe(Ja,[["render",Ka],["__scopeId","data-v-2e198660"]]);const Ga={class:"loading-background"},Xa={__name:"EssentialLoading",setup(e){const a=new Va;return(v,g)=>_e((h(),S("section",Ga,[i(Ma,{indeterminate:"",size:"75px",thickness:.6,color:"primary","center-color":"grey-2",class:"q-ma-md"}),g[0]||(g[0]=c("b",{class:"text-primary"},"Espere, por favor...",-1))],512)),[[Ae,Ce(a).estaCargando.value]])}};var nt=Xa;const Ya={__name:"FooterComponent",setup(e){const a=De();return(v,g)=>(h(),S("div",{class:ke(["footer q-pa-xs",{"text-right":!Ce(a).platform.is.mobile,"text-center q-mt-lg":Ce(a).platform.is.mobile}])},g[0]||(g[0]=[c("small",null,[c("strong",null,"Copyright \xA9 2023"),z(". Todos los derechos reservados por "),c("strong",null,"JPCONSTRUCRED"),z(". ")],-1)]),2))}};var lt=oe(Ya,[["__scopeId","data-v-1ccf01f1"]]);const Za=de({name:"EssentialLink",props:{title:{type:String,required:!0},link:{type:String,default:"#"},icon:{type:String,default:""},children:{type:Object,required:!1},can:{type:Boolean,default:!0},hasParent:{type:Boolean,default:!1}}}),eo={key:0};function ao(e,a,v,g,u,f){const r=Ne("EssentialLink",!0);return e.can?(h(),S("div",eo,[e.children?(h(),U(Pa,{key:1,clickable:"",tag:"a","active-class":"link-active",exact:"",class:ke({"bg-desenfoque border-white rounded q-mb-xs":!1,"border-left q-ml-lg":e.hasParent})},{header:n(()=>[e.icon?(h(),U(A,{key:0,avatar:""},{default:n(()=>[i(X,{name:e.icon,size:"xs",class:"text-color-drawer"},null,8,["name"])]),_:1})):le("",!0),i(A,null,{default:n(()=>[i(ie,{class:"text-color-drawer-bold textf-bold"},{default:n(()=>[z(Q(e.title),1)]),_:1})]),_:1})]),default:n(()=>[(h(!0),S(j,null,W(e.children,s=>{var _;return h(),S("div",{key:s.title},[i(r,{title:(_=s.title)!=null?_:"",link:s.link,icon:s.icon,children:s.children,can:s.can,hasParent:""},null,8,["title","link","icon","children","can"])])}),128))]),_:1},8,["class"])):(h(),U(G,{key:0,clickable:"",tag:"a",to:e.link,"active-class":"link-active",class:ke([{"border-left q-ml-lg":e.hasParent},"text-color-drawer"]),exact:""},{default:n(()=>[e.icon?(h(),U(A,{key:0,avatar:""},{default:n(()=>[i(X,{name:e.icon,size:"xs"},null,8,["name"])]),_:1})):le("",!0),i(A,null,{default:n(()=>[i(ie,null,{default:n(()=>[z(Q(e.title),1)]),_:1})]),_:1})]),_:1},8,["to","class"]))])):le("",!0)}var it=oe(Za,[["render",ao]]),oo=de({components:{TabLayout:Ea,EssentialTable:He},emits:["cerrar-modal"],setup(e,{emit:a}){const v=Da(),g=Ie();ya().setQuasar(De());const u=new Re(Na,new Aa),{entidad:f,disabled:r,accion:s,listadosAuxiliares:_}=u.useReferencias(),{cargarVista:O,obtenerListados:t,setValidador:x,guardar:T}=u.useComportamiento();O(async()=>{await t({subtareas:{controller:new Fa,params:{estado:"MOVILIZACION"}}}),C.value=_.subtareas});const m=je({subtarea:{required:J},motivo:{required:J},longitud:{required:J},latitud:{required:J}},f);x(m.value);const C=V();function k(y,H){if(y===""){H(()=>{C.value=_.clientes});return}H(()=>{const D=y.toLowerCase();C.value=_.subtareas.filter(E=>E.codigo_subtarea.toLowerCase().indexOf(D)>-1)})}async function p(){await T(f)&&(v.getSubtareaDestino(g.user.id),a("cerrar-modal",!1))}function l(){La(y=>{f.latitud=y.coords.latitude,f.longitud=y.coords.longitude})}return{mixin:u,movilizacion:f,disabled:r,accion:s,v$:m,filtrarSubtareas:k,subtareas:C,comenzar:p,motivosMovilizacion:xa,obtenerCoordenadas:l}}});const to={class:"row q-col-gutter-xs"},ro={class:"col-12 col-md-6"},so={class:"error-msg"},no={class:"col-12 col-md-6"},lo={class:"error-msg"},io={class:"col-12 col-md-4 q-mx-auto q-mb-xl"},uo={class:"col-12"},co={class:"error-msg"},vo={class:"col-12"},fo={class:"error-msg"},mo={class:"row"};function po(e,a,v,g,u,f){return h(),U(Oa,{onSubmit:a[6]||(a[6]=Ca(()=>{},["prevent"])),class:""},{default:n(()=>[i(Ve,{class:"rounded-card custom-shadow"},{default:n(()=>[i(wa,null,{default:n(()=>[c("div",to,[c("div",ro,[a[8]||(a[8]=c("label",{class:"q-mb-sm block"},"Me dirijo al siguiente trabajo",-1)),i(ue,{modelValue:e.movilizacion.subtarea,"onUpdate:modelValue":a[0]||(a[0]=r=>e.movilizacion.subtarea=r),options:e.subtareas,error:!!e.v$.subtarea.$errors.length,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled,"option-label":r=>r.codigo_subtarea+" - "+r.titulo,"option-value":r=>r.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{option:n(r=>[i(G,$a(r.itemProps,{class:"q-my-sm"}),{default:n(()=>[i(A,null,{default:n(()=>[i(ie,{class:"text-bold text-primary"},{default:n(()=>[z(Q(r.opt.codigo_subtarea),1)]),_:2},1024),i(ie,{caption:""},{default:n(()=>[z(Q(r.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":n(()=>[i(G,null,{default:n(()=>[i(A,{class:"text-grey"},{default:n(()=>a[7]||(a[7]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,W(e.v$.subtarea.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",so,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","options","error","disable","option-label","option-value"])]),c("div",no,[a[10]||(a[10]=c("label",{class:"q-mb-sm block"},"Motivo",-1)),i(ue,{modelValue:e.movilizacion.motivo,"onUpdate:modelValue":a[1]||(a[1]=r=>e.movilizacion.motivo=r),options:e.motivosMovilizacion,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":r=>r.descripcion,"option-value":r=>r.id,"emit-value":"","map-options":"",error:!!e.v$.motivo.$errors.length,onBlur:e.v$.motivo.$touch},{"no-option":n(()=>[i(G,null,{default:n(()=>[i(A,{class:"text-grey"},{default:n(()=>a[9]||(a[9]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,W(e.v$.motivo.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",lo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","options","option-label","option-value","error","onBlur"])]),c("div",io,[i(Ve,{flat:"",class:"custom-shadows nso-border q-pa-md"},{default:n(()=>[a[14]||(a[14]=c("label",{class:"q-mb-sm text-center block text-bold"},"Coordenadas",-1)),c("div",uo,[a[11]||(a[11]=c("label",{class:"q-mb-sm block"},"Longitud",-1)),i(Le,{modelValue:e.movilizacion.longitud,"onUpdate:modelValue":a[2]||(a[2]=r=>e.movilizacion.longitud=r),error:!!e.v$.longitud.$errors.length,outlined:"",dense:"",disable:""},{error:n(()=>[(h(!0),S(j,null,W(e.v$.longitud.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",co,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),c("div",vo,[a[12]||(a[12]=c("label",{class:"q-mb-sm block"},"Latitud",-1)),i(Le,{modelValue:e.movilizacion.latitud,"onUpdate:modelValue":a[3]||(a[3]=r=>e.movilizacion.latitud=r),error:!!e.v$.latitud.$errors.length,outlined:"",dense:"",disable:""},{error:n(()=>[(h(!0),S(j,null,W(e.v$.latitud.$errors,r=>(h(),S("div",{key:r.$uid},[c("div",fo,Q(r.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),i(ae,{color:"positive","no-caps":"","no-wrap":"",class:"full-width",onClick:a[4]||(a[4]=r=>e.obtenerCoordenadas()),disable:e.disabled},{default:n(()=>[i(X,{name:"bi-geo-alt",size:"xs",class:"q-mr-xs"}),a[13]||(a[13]=z(" Actualizar ubicaci\xF3n"))]),_:1},8,["disable"])]),_:1})])]),c("div",mo,[i(ae,{class:"col-12",color:"primary",type:"submit","no-caps":"",onClick:a[5]||(a[5]=r=>e.comenzar())},{default:n(()=>[i(X,{name:"bi-car-front-fill",size:"xs",class:"q-pr-sm"}),a[15]||(a[15]=c("span",null,"Comenzar viaje",-1))]),_:1})])]),_:1})]),_:1})]),_:1})}var bo=oe(oo,[["render",po]]),go=de({components:{EssentialTable:He},emits:["cerrar-modal","guardado"],setup(e,{emit:a}){const v=Ra(),g=Ie(),u=new Re(Wa,new Ha),{listar:f,cargarVista:r,obtenerListados:s}=u.useComportamiento(),{listado:_,listadosAuxiliares:O}=u.useReferencias();r(async()=>{await s({coordinadores:{controller:new ka,params:{rol:Sa.coordinador,campos:"id,nombres,apellidos"}}}),y.value=O.coordinadores});const t=V(),x=_a(),{notificarAdvertencia:T,notificarCorrecto:$,confirmar:m}=Ta(),C=qa({actual_coordinador:null,nuevo_coordinador:null}),k=g.esCoordinadorBackup||g.esJefeTecnico;g.esCoordinador&&!g.esCoordinadorBackup&&!g.esJefeTecnico&&(f({finalizado:!1}),C.actual_coordinador=g.user.id);const l=je({actual_coordinador:{required:J},nuevo_coordinador:{required:J}},C),{coordinadores:y,filtrarCoordinadores:H}=ja(O);async function D(B){if(!B.length)return T("Debe seleccionar al menos una tarea para transferir");if(await l.value.$validate())try{m("\xBFEst\xE1 seguro de realizar la transferencia?",async()=>{const F=za.getInstance(),P=F.getEndpoint(Ba.transferir_mis_tareas_activas),Z=await F.post(P,{nuevo_coordinador:C.nuevo_coordinador,ids_tareas:B});$(Z.data.mensaje),v.recargaTareasActivas=!0,a("cerrar-modal",!1)})}catch(F){T(F)}}function E(){f({coordinador_id:C.actual_coordinador,finalizado:!1}),t.value.clearSelection()}async function ce(){a("cerrar-modal",!1),await x.replace({name:"tareas"})}function ve(){a("cerrar-modal",!1)}return{v$:l,refTareas:t,transferencia:C,coordinadores:y,filtrarCoordinadores:H,listado:_,irControlTareas:ce,configuracionColumnasTarea:Ia,puedeSeleccionarActualCoordinador:k,transferir:D,cancelar:ve,filtrarTareasPorCoordinador:E,seleccionarTareas:()=>{t.value.seleccionar()},tareasSeleccionadas:B=>{console.log(B);const F=B.map(P=>P.id);D(F)}}}});const ho={class:"row q-col-gutter-sm"},yo={class:"col-12 col-md-6"},wo={class:"error-msg"},$o={class:"col-12 col-md-6"},Co={class:"error-msg"},ko={class:"row justify-end q-gutter-x-xs q-mb-md"},So={class:"row justify-center q-mb-md"},_o={class:"col-12"};function To(e,a,v,g,u,f){const r=Ne("essential-table");return h(),S(j,null,[c("div",ho,[c("div",yo,[a[6]||(a[6]=c("label",{class:"q-mb-sm block"},"Actual coordinador responsable",-1)),i(ue,{modelValue:e.transferencia.actual_coordinador,"onUpdate:modelValue":[a[0]||(a[0]=s=>e.transferencia.actual_coordinador=s),a[1]||(a[1]=s=>e.filtrarTareasPorCoordinador())],options:e.coordinadores,onFilter:e.filtrarCoordinadores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:!e.puedeSeleccionarActualCoordinador,"option-label":s=>s.nombres+" "+s.apellidos,"option-value":s=>s.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",onBlur:e.v$.actual_coordinador.$touch,error:!!e.v$.actual_coordinador.$errors.length},{"no-option":n(()=>[i(G,null,{default:n(()=>[i(A,{class:"text-grey"},{default:n(()=>a[5]||(a[5]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,W(e.v$.actual_coordinador.$errors,s=>(h(),S("div",{key:s.$uid},[c("div",wo,Q(s.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value","onBlur","error"])]),c("div",$o,[a[8]||(a[8]=c("label",{class:"q-mb-sm block"},"Nuevo coordinador responsable",-1)),i(ue,{modelValue:e.transferencia.nuevo_coordinador,"onUpdate:modelValue":a[2]||(a[2]=s=>e.transferencia.nuevo_coordinador=s),options:e.coordinadores,onFilter:e.filtrarCoordinadores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":s=>s.nombres+" "+s.apellidos,"option-value":s=>s.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",onBlur:e.v$.nuevo_coordinador.$touch,error:!!e.v$.nuevo_coordinador.$errors.length},{"no-option":n(()=>[i(G,null,{default:n(()=>[i(A,{class:"text-grey"},{default:n(()=>a[7]||(a[7]=[z(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(h(!0),S(j,null,W(e.v$.nuevo_coordinador.$errors,s=>(h(),S("div",{key:s.$uid},[c("div",Co,Q(s.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","option-label","option-value","onBlur","error"])])]),c("div",ko,[i(ae,{color:"primary","no-caps":"",push:"",onClick:a[3]||(a[3]=s=>e.seleccionarTareas()),disable:!e.listado.length},{default:n(()=>[i(X,{name:"bi-arrow-left-right",class:"q-mr-sm",size:"xs"}),a[9]||(a[9]=z(" Transferir al nuevo coordinador"))]),_:1},8,["disable"]),i(ae,{color:"negative","no-caps":"",push:"",icon:"bi-x",onClick:a[4]||(a[4]=s=>e.cancelar())},{default:n(()=>a[10]||(a[10]=[z("Cancelar")])),_:1})]),c("div",So,[c("div",_o,[_e(i(r,{ref:"refTareas",titulo:"Hay un total de "+e.listado.length+" tareas activas.",configuracionColumnas:e.configuracionColumnasTarea,datos:e.listado,separador:"cell",permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-botones":!1,permitirFiltrar:!1,mostrarFooter:!1,"alto-fijo":!1,"ajustar-celdas":!0,"tipo-seleccion":"multiple",onSelected:e.tareasSeleccionadas},null,8,["titulo","configuracionColumnas","datos","onSelected"]),[[Ae,e.listado.length]])])])],64)}var qo=oe(go,[["render",To]]);class zo{constructor(){se(this,"MovilizacionSubtareaPage");se(this,"TranferirTareaPage");se(this,"ModoNoDisponiblePage");this.MovilizacionSubtareaPage=ye(new $e("Movilizaci\xF3n entre trabajos",bo)),this.TranferirTareaPage=ye(new $e("Transferir tareas activas",qo)),this.ModoNoDisponiblePage=ye(new $e("Configurar modo No Disponible",Ua))}}class ut extends Qa{constructor(){super(new zo)}}export{ut as C,it as E,lt as F,tt as Q,st as S,nt as a,rt as b};

var W=Object.defineProperty;var X=(e,o,d)=>o in e?W(e,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[o]=d;var r=(e,o,d)=>(X(e,typeof o!="symbol"?o+"":o,d),d);import{Q as b,a as g}from"./QItemSection.ec4cc512.js";import{Q as V}from"./QSelect.b920278b.js";import{A as Y,s as Z,d as x,bd as ee,m as oe,u as ae,R as ie,c as de,E as te,cz as se,_ as re,t as le,v as n,P as ne,F as i,z as t,y as s,x as m,H as $,G as y,D as f,a9 as me,J as Q,I as ue,a6 as pe,K as j}from"./index.b8e09611.js";import{Q as ve}from"./QForm.eab79b48.js";import{E as ce}from"./entidadAuditable.75a46700.js";import{T as fe}from"./TabLayoutFilterTabs2.6bbaa932.js";import{u as be}from"./index.70965bc7.js";import{C as ge}from"./ContenedorSimpleMixin.4e22246b.js";import{V as Ve}from"./VendedorController.c3928f83.js";import{M as $e}from"./ModalidadController.07a0087a.js";import{r as w}from"./i18n-validators.06abe774.js";import{u as ye}from"./filtrosListadosGenerales.87fcb144.js";import{S as je,s as we}from"./utils.9344cd7e.js";import{t as Ce}from"./ventas.utils.b757673b.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPopupProxy.685eacb5.js";import"./QPage.e6f8825d.js";import"./EssentialTableTabs.03c27e34.js";import"./QBadge.89898cd2.js";import"./EssentialTablePagination.ce808cac.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBtnGroup.7d38eecd.js";import"./EssentialTable.23af6cc8.js";import"./QFile.c79664c6.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./buttonSubmits.f2d72caa.js";import"./index.ea415f98.js";class Ee extends ce{constructor(){super();r(this,"id");r(this,"empleado");r(this,"empleado_id");r(this,"empleado_info");r(this,"modalidad");r(this,"modalidad_id");r(this,"modalidad_info");r(this,"tipo_vendedor");r(this,"jefe_inmediato");r(this,"jefe_inmediato_info");r(this,"causa_desactivacion");r(this,"activo");this.id=null,this.empleado=null,this.empleado_id=null,this.empleado_info=null,this.modalidad=null,this.modalidad_id=null,this.modalidad_info=null,this.tipo_vendedor=null,this.jefe_inmediato=null,this.jefe_inmediato_info=null,this.causa_desactivacion=null,this.activo=!0}}const he=[{name:"empleado_info",field:"empleado_info",label:"Empleado",align:"left",sortable:!0},{name:"modalidad_info",field:"modalidad_info",label:"Modalidad",align:"left",sortable:!0},{name:"tipo_vendedor",field:"tipo_vendedor",label:"Tipo Vendedor",align:"left",sortable:!0},{name:"jefe_inmediato_info",field:"jefe_inmediato_info",label:"Jefe Inmediato",align:"left",sortable:!0},{name:"activo",field:"activo",label:"Estado",align:"left",sortable:!0}];class I{constructor(){r(this,"axios");this.axios=Y.getInstance()}async anular(o,d){return this.solicitud("/desactivar/",o,d)}async solicitud(o,d,p){const v=this.axios.getEndpoint(Z.vendedores_claro)+o+d,u=await this.axios.post(v,p);return{response:u,result:u.data.modelo}}}var ke=x({components:{TabLayoutFilterTabs2:fe},setup(e,{emit:o}){ee().setQuasar(oe());const d=new je,p=ae(),v=new ge(Ee,new Ve),{entidad:u,disabled:C,accion:a,listadosAuxiliares:E,listado:k}=v.useReferencias(),{setValidador:M,obtenerListados:L,cargarVista:T,listar:P}=v.useComportamiento(),{onGuardado:U,onModificado:O,onReestablecer:R}=v.useHooks(),{confirmar:D,notificarCorrecto:F,prompt:B,notificarError:q}=ie();R(()=>u.jefe_inmediato=p.user.id),U((l,c)=>{o("cerrar-modal",!1),o("guardado",{formulario:"VendedorPage",id:l,modelo:c.modelo})}),O(()=>u.jefe_inmediato=p.user.id);const A=de("1"),{empleados:N,filtrarEmpleados:H,modalidades:S,filtrarModalidades:J}=ye(E);T(async()=>{await L({empleados:{controller:new te,params:{departamento_id:9,"or[departamento_id]":13,estado:1}},modalidades:{controller:new $e,params:{campos:"id,nombre"}}}),u.jefe_inmediato=p.user.id,N.value=E.empleados,S.value=E.modalidades});const _=be({empleado:{required:w},modalidad:{required:w},tipo_vendedor:{required:w},jefe_inmediato:{required:w}},u);M(_.value);function z(l){A.value=l,P({activo:l})}return{mixin:v,vendedor:u,disabled:C,accion:a,v$:_,configuracionColumnas:he,tabOptionsVendedores:Ce,tabDefecto:A,empleados:N,modalidades:S,tipos_vendedores:se,ordenarLista:we,filtrarEmpleados:H,filtrarModalidades:J,filtrarVendedores:z,btnActivar:{titulo:"Activar",icono:"bi-toggle2-on",color:"positive",tooltip:"Activar Vendedor",accion:({entidad:l,posicion:c})=>{D("\xBFEst\xE1 seguro de activar el proveedor?",()=>{B({titulo:"Causa de activaci\xF3n",mensaje:"Ingresa el motivo por el que quieres activar este proveedor?",accion:async h=>{try{d.activar(),await new I().anular(l.id,{causa_desactivacion:h}),k.value.splice(c,1),F("Activado correctamente")}catch{q("No se pudo activar el vendedor!")}finally{d.desactivar()}}})})},visible:({entidad:l})=>!l.activo&&p.can("puede.activar.vendedores_claro")},btnDesactivar:{titulo:"Desactivar",icono:"bi-toggle2-off",color:"negative",tooltip:"Desactivar Vendedor",accion:({entidad:l,posicion:c})=>{D("\xBFEst\xE1 seguro de desactivar el vendedor?",()=>{B({titulo:"Causa de desactivaci\xF3n",mensaje:"Ingresa el motivo por el que quieres desactivar este vendedor?",accion:async h=>{try{d.activar(),await new I().anular(l.id,{causa_desactivacion:h}),k.value.splice(c,1),F("Desactivado correctamente")}catch{q("No se pudo desactivar el vendedor!")}finally{d.desactivar()}}})})},visible:({entidad:l})=>l.activo&&p.can("puede.desactivar.vendedores_claro")}}}});const De={class:"row q-col-gutter-sm q-mb-md"},Fe={class:"col-12 col-md-3 col-sm-6"},Be={class:"error-msg"},qe={class:"col-12 col-md-3 col-sm-6"},Ae={class:"error-msg"},Ne={class:"col-12 col-md-3 col-sm-6"},Se={class:"error-msg"},_e={class:"col-12 col-md-3 col-sm-6"},Qe={class:"error-msg"},Ie={key:0,class:"col-12 col-md-3"},Me={key:1,class:"col-12 col-md-3"};function Le(e,o,d,p,v,u){const C=le("tab-layout-filter-tabs-2");return n(),ne(C,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,ajustarCeldas:!0,accion1:e.btnDesactivar,accion2:e.btnActivar,puedeExportar:"","tab-options":e.tabOptionsVendedores,tabDefecto:e.tabDefecto,filtrar:e.filtrarVendedores},{formulario:i(()=>[t(ve,{onSubmit:o[8]||(o[8]=pe(()=>{},["prevent"]))},{default:i(()=>[s("div",De,[s("div",Fe,[o[10]||(o[10]=s("label",{class:"q-mb-sm block"},"Jefe inmediato",-1)),t(V,{modelValue:e.vendedor.jefe_inmediato,"onUpdate:modelValue":o[0]||(o[0]=a=>e.vendedor.jefe_inmediato=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.jefe_inmediato.$errors.length,onBlur:e.v$.jefe_inmediato.$touch,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onPopupShow:o[1]||(o[1]=a=>e.ordenarLista(e.empleados,"apellidos")),onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.jefe_inmediato.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Be,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[9]||(o[9]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",qe,[o[12]||(o[12]=s("label",{class:"q-mb-sm block"},"Empleado",-1)),t(V,{modelValue:e.vendedor.empleado,"onUpdate:modelValue":o[2]||(o[2]=a=>e.vendedor.empleado=a),options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.empleado.$errors.length,onBlur:e.v$.empleado.$touch,"error-message":"Debes seleccionar un empleado","use-input":"","input-debounce":"0",onPopupShow:o[3]||(o[3]=a=>e.ordenarLista(e.empleados,"apellidos")),onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.apellidos+" "+a.nombres,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.empleado.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Ae,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[11]||(o[11]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",Ne,[o[14]||(o[14]=s("label",{class:"q-mb-sm block"},"Modalidad",-1)),t(V,{modelValue:e.vendedor.modalidad,"onUpdate:modelValue":o[4]||(o[4]=a=>e.vendedor.modalidad=a),options:e.modalidades,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled,readonly:e.disabled,error:!!e.v$.modalidad.$errors.length,onBlur:e.v$.modalidad.$touch,"error-message":"Debes seleccionar un modalidad","use-input":"","input-debounce":"0",onFilter:e.filtrarModalidades,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.modalidad.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Se,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[13]||(o[13]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onBlur","onFilter","option-value","option-label"])]),s("div",_e,[o[16]||(o[16]=s("label",{class:"q-mb-sm block"},"Tipo de Vendedor",-1)),t(V,{modelValue:e.vendedor.tipo_vendedor,"onUpdate:modelValue":o[5]||(o[5]=a=>e.vendedor.tipo_vendedor=a),options:e.tipos_vendedores,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"","input-debounce":0,"use-input":"",hint:"Obligatorio",error:!!e.v$.tipo_vendedor.$errors.length,onBlur:e.v$.tipo_vendedor.$touch,"option-value":a=>a.nombre,"option-label":a=>a.descripcion,"emit-value":"","map-options":""},{error:i(()=>[(n(!0),m(y,null,$(e.v$.tipo_vendedor.$errors,a=>(n(),m("div",{key:a.$uid},[s("div",Qe,j(a.$message),1)]))),128))]),"no-option":i(()=>[t(b,null,{default:i(()=>[t(g,{class:"text-grey"},{default:i(()=>o[15]||(o[15]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","onBlur","option-value","option-label"])]),e.vendedor.activo?Q("",!0):(n(),m("div",Ie,[o[17]||(o[17]=s("br",null,null,-1)),t(me,{modelValue:e.vendedor.activo,"onUpdate:modelValue":o[6]||(o[6]=a=>e.vendedor.activo=a),"checked-icon":"check",disable:e.disabled,label:e.vendedor.activo?"Activo":"Inactivo",color:"positive"},null,8,["modelValue","disable","label"])])),e.vendedor.activo?Q("",!0):(n(),m("div",Me,[o[18]||(o[18]=s("label",{class:"q-mb-sm block"},"Causa de desactivaci\xF3n",-1)),t(ue,{modelValue:e.vendedor.causa_desactivacion,"onUpdate:modelValue":o[7]||(o[7]=a=>e.vendedor.causa_desactivacion=a),placeholder:"Obligatorio",autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])]))])]),_:1})]),default:i(()=>[o[19]||(o[19]=f(" > "))]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","tab-options","tabDefecto","filtrar"])}var qo=re(ke,[["render",Le]]);export{qo as default};

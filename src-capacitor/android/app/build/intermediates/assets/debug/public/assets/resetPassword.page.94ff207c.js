var k=Object.defineProperty;var A=(s,e,r)=>e in s?k(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var n=(s,e,r)=>(A(s,typeof e!="symbol"?e+"":e,r),r);import{u as V,Z as $,bD as R,d as z,e as B,c,f as F,_ as h,v as w,P as b,F as d,y as a,x as L,z as t,a6 as y,J as C,a4 as U,B as f,I as v,O as g}from"./index.6449c167.js";import{Q as N}from"./QPage.5d173a8a.js";import{V as Q}from"./style.561d4fd5.js";import{a as S,S as j,i as x,n as D}from"./utils.521b98f3.js";import{_ as q}from"./logo.4781eea2.js";import"./_commonjsHelpers.8402d862.js";import"./format.8ac60962.js";class I{constructor(){n(this,"nombreUsuario");n(this,"password_old");n(this,"password");n(this,"password_confirmation");this.nombreUsuario=null,this.password_old=null,this.password=null,this.password_confirmation=null}}class M{constructor(){n(this,"store",V());n(this,"Router",$())}async actualizarContrasena(e){try{await this.store.actualizarContrasena(e),this.Router.replace("/login")}catch(r){const u=r;throw new R(u)}}}var J=z({name:"ResetPassword",components:{LottiePlayer:Q},setup(){const s=B(new I),e=$(),r=c(!1),u=V(),P=new M,i=S(),o=new j;s.nombreUsuario=u.getNombreusuario(),s.nombreUsuario===void 0&&e.replace("/login");function p(){s.password="",s.password_confirmation=""}async function E(){r.value=!0;try{o.activar();const l=s.password,m=s.password_old;if(!m||!l){i.notificarError("Debe llenar todos los campos de contrase\xF1a.");return}if(!/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[@.\-/*]).{8,}$/.test(l)){i.notificarError("La nueva contrase\xF1a debe tener al menos 8 caracteres, 1 n\xFAmero, 1 letra (may\xFAscula o min\xFAscula) y 1 car\xE1cter especial (@.-/*)."),p();return}if(l===m){i.notificarError("La nueva contrase\xF1a no puede ser igual a la anterior."),p();return}await P.actualizarContrasena(s),i.notificarCorrecto("Contrase\xF1a actualizada correctamente")}catch(l){if(x(l)){const m=l.erroresValidacion;D(m,i)}}finally{o.desactivar(),r.value=!1}}const _=F(()=>s.password_old!==""&&s.password!==""&&s.password===s.password_confirmation);return{resetPassword:s,isPwd:c(!0),isPwdold:c(!0),isPwdConfirm:c(!0),enviando:r,enableLoginButton:_,resetearPassword:E,resetFormulario:p}}});const O={class:"row items-center"},Z={key:0,class:"col-12 col-md-8 text-center q-pa-lg"},T={class:"imagen d-flex align-items-center justify-content-center"},G={class:"col-12 col-md-4 column items-center bg-body-table justify-center window-height"},H={class:"col-12 q-mb-sm"},K={class:"col-12 q-mb-sm"},W={class:"col-12 q-mb-sm"},X={class:"col-12"};function Y(s,e,r,u,P,i){return w(),b(N,{class:""},{default:d(()=>[a("div",O,[!s.$q.screen.xs&&!s.$q.screen.sm?(w(),L("div",Z,[a("div",T,[t(y,{square:"",size:"400px"},{default:d(()=>e[8]||(e[8]=[a("img",{src:q},null,-1)])),_:1})])])):C("",!0),a("div",G,[s.$q.screen.xs?(w(),b(y,{key:0,square:"",size:"120px",class:"q-mx-auto block q-mb-md"},{default:d(()=>e[9]||(e[9]=[a("img",{src:q},null,-1)])),_:1})):C("",!0),a("form",{onSubmit:e[7]||(e[7]=U((...o)=>s.resetearPassword&&s.resetearPassword(...o),["prevent"])),class:"full-width q-px-lg"},[e[10]||(e[10]=a("div",{class:"q-mb-sm"},[a("h2",null,"Bienvenidos a JPCONSTRUCRED"),a("span",null,"Cambia tu contrase\xF1a")],-1)),a("div",H,[t(v,{modelValue:s.resetPassword.password_old,"onUpdate:modelValue":e[1]||(e[1]=o=>s.resetPassword.password_old=o),label:"Contrase\xF1a antigua",outlined:"",dense:"",type:s.isPwdold?"password":"text",hint:"Porfavor ingrese la contrase\xF1a antigua"},{append:d(()=>[t(f,{name:s.isPwdold?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[0]||(e[0]=o=>s.isPwdold=!s.isPwdold)},null,8,["name"])]),_:1},8,["modelValue","type"])]),a("div",K,[t(v,{modelValue:s.resetPassword.password,"onUpdate:modelValue":e[3]||(e[3]=o=>s.resetPassword.password=o),label:"Contrase\xF1a Nueva",outlined:"",dense:"",type:s.isPwd?"password":"text",hint:"Requisitos: M\xEDnimo 8 caracteres, 1 n\xFAmero, 1 letra, Caracter especiales ( @.-/* ), contrase\xF1a diferente a la anterior."},{append:d(()=>[t(f,{name:s.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[2]||(e[2]=o=>s.isPwd=!s.isPwd)},null,8,["name"])]),_:1},8,["modelValue","type"])]),a("div",W,[t(v,{modelValue:s.resetPassword.password_confirmation,"onUpdate:modelValue":e[5]||(e[5]=o=>s.resetPassword.password_confirmation=o),label:"Confirmar Contrase\xF1a",outlined:"",dense:"",type:s.isPwdConfirm?"password":"text",hint:"Porfavor confirme su contrase\xF1a"},{append:d(()=>[t(f,{name:s.isPwdConfirm?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[4]||(e[4]=o=>s.isPwdConfirm=!s.isPwdConfirm)},null,8,["name"])]),_:1},8,["modelValue","type"])]),a("div",X,[t(g,{color:"primary",label:"Actualizar contrase\xF1a",class:"full-width q-mb-sm",disabled:!s.enableLoginButton,"no-caps":"",unelevated:"",onClick:e[6]||(e[6]=o=>s.resetearPassword())},null,8,["disabled"]),t(g,{color:"primary",label:"Volver al inicio de sesi\xF3n",class:"full-width q-mb-sm","no-caps":"",flat:"",to:{name:"Login"}})])],32)])])]),_:1})}var ds=h(J,[["render",Y]]);export{ds as default};

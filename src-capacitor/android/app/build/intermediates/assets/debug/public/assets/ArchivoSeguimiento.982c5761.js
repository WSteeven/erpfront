import{l as x,c as a,d as R,A as V,bE as _,p as w,_ as G,t as Q,v as b,x as E,y as C,P as U,a7 as D,J as j,z as F,bF as N,G as I}from"./index.6449c167.js";import{Q as O}from"./QUploader.cca1b7bd.js";import{c as z}from"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import{a as H,l as L,r as J}from"./utils.521b98f3.js";import{E as M}from"./EssentialTable.00c17e97.js";const P=x("subtarea",()=>{const e=a(),t=a(),s=a(),u=a(),d=a(),m=a(),n=a(),l=a(),f=a(),v=a(),c=a(),h=a(),S=a(),r=a(),p=a(),g=a();return{idTarea:e,codigoTarea:t,idSubtareaSeleccionada:s,codigoTareaSeleccionada:d,codigoSubtareaSeleccionada:m,tareaTieneSubtareas:l,idCliente:n,fechaHoraSuspendido:f,motivoSuspendido:v,posicionSubtareaSeleccionada:u,accion:c,observacionTarea:h,subtareaEsVentana:S,fechaInicioTrabajo:r,horaInicioTrabajo:p,horaFinTrabajo:g}});var K=R({components:{EssentialTable:M},props:{mixin:{type:Object,required:!0},endpoint:{type:Object,required:!0},entidad:Object,disable:{type:Boolean,default:!1},permitirEliminar:{type:Boolean,default:!0},listarAlGuardar:{type:Boolean,default:!0},permitirSubir:{type:Boolean,default:!0},label:{type:String,default:"Quiero compartir archivos"},multiple:{type:Boolean,default:!0}},setup(e){const t=P(),{listado:s}=e.mixin.useReferencias(),{eliminar:u,listar:d}=e.mixin.useComportamiento(),{notificarCorrecto:m,notificarError:n,notificarAdvertencia:l,confirmar:f}=H();function v(o){d(o)}let c;const h={titulo:"Eliminar",icono:"bi-trash3",color:"negative",visible:()=>e.permitirEliminar,accion:async({entidad:o})=>{f("Esta operaci\xF3n es irreversible. El archivo se eliminar\xE1 de forma instant\xE1nea.",()=>u(o))}},S={titulo:"Descargar",icono:"bi-download",color:"positive",accion:({entidad:o})=>J(o.ruta)},r=a(),p=V.getInstance(),g=`${_.URL_BASE}/${p.getEndpoint(e.endpoint)}`,A=a(!1);async function T(o){var B;const y=new FormData;y.append("file",o[0]);for(let i in c)y.append(i,c[i]);try{const i=await p.post(g,y);o.value=[],e.listarAlGuardar&&s.value.push(i.data.modelo),m(i.data.mensaje),A.value=!1}catch(i){n((B=i.response)==null?void 0:B.data.mensaje)}}async function q(o){c=o,r.value&&(await r.value.upload(),r.value.reset(),r.value.removeUploadedFiles(),r.value.removeQueuedFiles())}function k(o){l("El tama\xF1o total de los archivos no deben exceder los 10mb.")}function $(){s.value=[]}return{listado:s,refGestor:r,extraerExtension:o=>o.split(".").at(-1),formatBytes:L,quiero_subir_archivos:A,columnas:[...z,w],codigoSubtareaSeleccionada:t.codigoSubtareaSeleccionada,onRejected:k,btnEliminar:h,btnDescargar:S,factoryFn:T,subir:q,listarArchivos:v,limpiarListado:$}}});const W={class:"col-12 col-md-3 q-mb-lg"},X={key:0,class:"col-12 q-mb-sm"},Y={key:1,class:"col-12 q-mb-sm"};function Z(e,t,s,u,d,m){const n=Q("essential-table");return b(),E(I,null,[C("div",W,[t[1]||(t[1]=C("br",null,null,-1)),e.permitirSubir?(b(),U(D,{key:0,modelValue:e.quiero_subir_archivos,"onUpdate:modelValue":t[0]||(t[0]=l=>e.quiero_subir_archivos=l),label:e.label,disable:e.disable,"checked-icon":"bi-eye",color:"positive",outlined:"",dense:""},null,8,["modelValue","label","disable"])):j("",!0)]),e.quiero_subir_archivos?(b(),E("div",X,[F(O,{ref:"refGestor",label:"Selecciona o arrastra tus archivos aqu\xED (M\xE1ximo 10mb)",multiple:e.multiple,style:{width:"100%"},flat:"",factory:e.factoryFn,class:"bg-header-collapse expansion",color:"white","text-color":"black","max-total-size":"10485760",onRejected:e.onRejected,"hide-upload-btn":""},null,8,["multiple","factory","onRejected"])])):j("",!0),N(e.$slots,"boton-subir"),e.listado.length?(b(),E("div",Y,[F(n,{titulo:`Existen ${e.listado.length} archivos compartidos hasta el momento`,configuracionColumnas:e.columnas,datos:e.listado,"alto-fijo":!1,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-footer":!1,"mostrar-botones":!1,"permitir-buscar":!1,accion1:e.btnDescargar,accion2:e.btnEliminar},null,8,["titulo","configuracionColumnas","datos","accion1","accion2"])])):j("",!0)],64)}var se=G(K,[["render",Z]]);export{se as A,P as u};

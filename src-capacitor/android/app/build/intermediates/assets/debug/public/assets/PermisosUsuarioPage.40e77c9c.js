import{Q as so}from"./QSelect.6ce302d7.js";import{bw as U,s as H,d as io,m as ao,Z as to,c as d,E as F,_ as ro,t as L,v as m,P as E,F as s,z as o,bc as u,y as t,x as p,bb as c,G as M,H as O,J as k,O as N,B as f,D as Q,K as q}from"./index.6449c167.js";import{Q as z,a as b}from"./QItemSection.9a955ec6.js";import{Q as G}from"./QScrollArea.4854d82f.js";import{Q as lo}from"./QPage.5d173a8a.js";import{E as no}from"./EssentialTable.00c17e97.js";import{M as mo}from"./ModalEntidad.168b465e.js";import{C as uo}from"./ContenedorSimpleMixin.09c9bed5.js";import{b as po,S as co}from"./utils.521b98f3.js";import{P as fo,c as vo}from"./Permiso.405aa895.js";import{P as go,C as bo}from"./ComportamientoModalesPermisoNuevo.8bb5e1ee.js";import{u as _o}from"./filtrosListadosGenerales.c3aa2da3.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QResizeObserver.9af84680.js";import"./QScrollObserver.b4b0444d.js";import"./TouchPan.5bc050d4.js";import"./touch.9135741d.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./QPopupProxy.72ff1d6d.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.50e59f97.js";import"./QForm.ca56f146.js";import"./index.490dde02.js";import"./TabLayout.0bce4313.js";import"./QTabs.6c234f27.js";import"./QTabPanels.49d2362a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTablePagination.d5c1010a.js";import"./RolController.3a4ff0d5.js";class T extends U{constructor(){super(H.permisos_roles_usuario)}}class Co extends U{constructor(){super(H.asignar_permisos_individual)}}var Po=io({components:{EssentialTable:no,ModalEntidad:mo},setup(){po().setQuasar(ao());const e=new uo(fo,new T),{entidad:i,listadosAuxiliares:v,listado:_}=e.useReferencias(),I=to(),{cargarVista:V,obtenerListados:g,listar:C}=e.useComportamiento(),a=d(),r=d(),{empleados:R,filtrarEmpleados:j,roles:h}=_o(v),J=new go,$=new Co,B=new co,P=d([]),K=d([]),S=d(),w=d();V(async()=>{await g({empleados:{controller:new F,params:{campos:"id,nombres,apellidos,identificacion",estado:1}}})}),R.value=v.empleados;async function Z(l){await C({id_rol:l,tipo:"ASIGNADOS"});const{result:n}=await J.listar({id_rol:l,tipo:"NO ASIGNADOS"});P.value=n}function x(){S.value.seleccionar(),S.value.clearSelection()}function W(){w.value.seleccionar(),w.value.clearSelection()}function X(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),A()}function Y(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),A()}const D=new bo;function oo(){D.abrirModalEntidad("PermisoNuevoPage")}const eo=()=>{I.replace("/roles")};async function A(){B.activar();const{result:l}=await new F().consultar(r.value);h.value=l.roles,a.value=[...l.permisos];const{response:n}=await new T().listar({empleado_id:r.value,tipo:"NO ASIGNADOS"});P.value=n.data.results,_.value=[...n.data.permisos_usuario],B.desactivar()}return{fecha:d(),mixin:e,permiso:i,modales:D,configuracionColumnasPermisos:vo,empleado:r,listado:_,permisosSinAsignar:P,crearRol:eo,crear_permiso:oo,obtenerPermisoRol:Z,asignarPermiso:X,eliminarPermiso:Y,botonAsignarPermisos:x,botonEliminarPermisos:W,listadosAuxiliares:v,roles:h,permisos:a,empleados:R,permisosAsignados:K,refPermisosSinAsignar:S,refPermisosAsignados:w,filtrarEmpleados:j,filtrarRolesEmpleados:A}}});const So={class:"row q-col-gutter-sm q-mb-md"},wo={class:"col-12 col-md-5"},Ao={class:"col-12 col-md-5 q-mb-md"},yo={key:0,class:"col-12 col-md-5 q-mb-md"},Eo={class:"row"},ko={key:0,class:"col-12 col-md-5"},No={key:0,class:"col-12 col-md-5 q-mb-md"},Qo={class:"q-py-xs"},qo={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},Io={class:"col-12 col-md-5 q-gutter-y-sm"},Vo={class:"col-md-2 column justify-center q-gutter-y-md"},Ro={class:"col-12 col-md-5 q-mb-md"};function ho(e,i,v,_,I,V){const g=L("essential-table"),C=L("modal-entidad");return m(),E(lo,{padding:"",class:"q-pa-lg"},{default:s(()=>[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[t("div",So,[t("div",wo,[t("div",Ao,[i[4]||(i[4]=t("label",{class:"q-mb-sm block"},null,-1)),o(so,{modelValue:e.empleado,"onUpdate:modelValue":[i[0]||(i[0]=a=>e.empleado=a),e.filtrarRolesEmpleados],options:e.empleados,"options-dense":"",dense:"",outlined:"","error-message":"Debe seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","onUpdate:modelValue","option-value","option-label"])]),e.roles?(m(),p("div",yo,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[5]||(i[5]=t("div",{class:"text-h6"},"Roles",-1)),o(G,{style:{height:"100px"}},{default:s(()=>[t("div",Eo,[(m(!0),p(M,null,O(e.roles,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"})]),_:1}),o(b,null,{default:s(()=>[Q(q(a),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)]),i[7]||(i[7]=t("div",{class:"col-12 col-md-2"},null,-1)),e.permisos?(m(),p("div",ko,[e.listado?(m(),p("div",No,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[6]||(i[6]=t("div",{class:"text-h6"}," Todos los permisos asignados (roles y directamente) ",-1)),o(G,{style:{height:"164px"}},{default:s(()=>[t("div",Qo,[(m(!0),p(M,null,O(e.permisos,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"},{default:s(()=>[Q(" \xA0"+q(r+1),1)]),_:2},1024)]),_:2},1024),o(b,null,{default:s(()=>[Q(q(a.name),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)])):k("",!0)]),t("div",qo,[t("div",Io,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[8]||(i[8]=t("div",{class:"text-h6"},"No Asignados",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,datos:e.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarHeader:!0,mostrarFooter:!0,mostrarColumnasVisibles:!1,ref:"refPermisosSinAsignar",onSelected:e.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})]),t("div",Vo,[o(N,{class:"full-width block",color:"secondary",onClick:i[1]||(i[1]=a=>e.crear_permiso())},{default:s(()=>[o(f,{name:"bi-plus"})]),_:1}),o(N,{class:"full-width block",color:"primary",onClick:i[2]||(i[2]=a=>e.botonAsignarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-right"})]),_:1}),o(N,{class:"full-width block",color:"accent",onClick:i[3]||(i[3]=a=>e.botonEliminarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-left"})]),_:1})]),t("div",Ro,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[9]||(i[9]=t("div",{class:"text-h6"},"Asignados directamente",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:e.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,ref:"refPermisosAsignados",onSelected:e.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})])])]),_:1})]),_:1}),o(C,{comportamiento:e.modales,persistente:!1},null,8,["comportamiento"])]),_:1})}var Ae=ro(Po,[["render",ho]]);export{Ae as default};

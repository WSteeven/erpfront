import{Q as O}from"./QSelect.6ce302d7.js";import{Q as re,a as ie}from"./QItemSection.9a955ec6.js";import{d as ne,c as w,dF as T,e as ce,q as R,A as ue,bE as de,s as me,_ as pe,t as x,v as r,P as f,F as s,z as a,y as l,bb as B,x as u,G as N,H as I,K as $,D as G,J as n,I as A,B as y,j as z,O as k,a3 as fe}from"./index.6449c167.js";import{Q as D,a as M,C as H}from"./QPopupProxy.72ff1d6d.js";import{E as be,c as ve}from"./EssentialTable.00c17e97.js";import{a as he,Q as j}from"./QTabPanels.49d2362a.js";import{Q as ge}from"./QPage.5d173a8a.js";import{Q as Ce,a as Ve}from"./QLayout.418abf9d.js";import{r as K}from"./i18n-validators.29e2545c.js";import{u as we}from"./index.490dde02.js";import{G as ye}from"./GraficoGenerico.8c613122.js";import{a as ke,S as _e,x as qe,B as J}from"./utils.521b98f3.js";import{C as W}from"./CombustibleController.508b8fb9.js";import{C as Qe}from"./ContenedorSimpleMixin.09c9bed5.js";import{C as Be}from"./Combustible.d039307e.js";import{u as Ne}from"./filtrosListadosGenerales.c3aa2da3.js";import{V as Ie}from"./VehiculoController.5e90ff0e.js";import{o as $e}from"./graficoGenerico.2759c2ea.js";import"./QChip.95469f73.js";import"./position-engine.70d0a89f.js";import"./format.8ac60962.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./touch.9135741d.js";import"./QScrollObserver.b4b0444d.js";import"./QResizeObserver.9af84680.js";import"./index.0198dd12.js";import"./chart.a94eb85b.js";import"./entidadAuditable.75a46700.js";var Ee=ne({components:{EssentialTable:be,GraficoGenerico:ye},setup(){const e=new Qe(Be,new W),{listadosAuxiliares:t}=e.useReferencias(),{notificarError:E,notificarAdvertencia:P}=ke(),d=new _e,v="COMBUSTIBLE",b="VEHICULO",h=[v,b],g=w(!0),C=w(T.grafico),o=ce({tipo:null,fecha_inicio:null,fecha_fin:"",vehiculo:null,todos:!1}),m=w(),c=w([]),{combustibles:L,filtrarCombustibles:X,vehiculos:U,filtrarVehiculos:Y}=Ne(t);o.fecha_fin=qe(R);const Z=[{name:"combustible",field:"combustible",label:"Combustible",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"center",sortable:!0},{name:"recorrido",field:"recorrido",label:"Km Recorridos",align:"left",sortable:!0}],ee=[{name:"vehiculo",field:"vehiculo",label:"Veh\xEDculo",align:"left",sortable:!0},{name:"combustible",field:"combustible",label:"Combustible",align:"left",sortable:!0},{name:"monto",field:"monto",label:"Monto",align:"center",sortable:!0},{name:"recorrido",field:"recorrido",label:"Km Recorridos",align:"left",sortable:!0}],S=we({tipo:{required:K},fecha_inicio:{required:K}},o);async function oe(){d.activar();const i=await new W().listar();t.combustibles=i.result,L.value=i.result,d.desactivar()}async function te(){d.activar();const i=await new Ie().listar();t.vehiculos=i.result,U.value=i.result,d.desactivar()}async function se(i){switch(m.value=null,i){case v:await oe();break;case b:await te();break;default:console.log(i)}}async function ae(i,p,_){if(await S.value.$validate())try{d.activar();const V=ue.getInstance(),q=de.URL_BASE+"/"+V.getEndpoint(me.reporte_combustibles),F="reporte_conductores";switch(i){case"excel":return p.accion="excel",J(q,"POST","blob","xlsx",F,p),_;case"pdf":return p.accion="pdf",J(q,"POST","blob","pdf",F,p),_;default:p.accion="";const Q=await V.post(q,p);return Q.data.results?(Q.data.results.length<1&&P("No se obtuvieron resultados"),Q.data.results):_}}catch(V){console.log(V),E("Error al obtener el reporte")}finally{d.desactivar()}}async function le(i){m.value=await ae(i,o,c.value),c.value=m.value.results}return{reporte:o,v$:S,maskFecha:R,tabs:C,opcionesGrafico:T,optionsPie:$e,results:m,configuracionColumnasVehiculos:ee,configuracionColumnasCombustibles:Z,modoUnaColumna:g,COMBUSTIBLE:v,VEHICULO:b,listado:c,opciones:h,combustibles:L,filtrarCombustibles:X,vehiculos:U,filtrarVehiculos:Y,consultarListado:se,buscarReporte:le}}});const Pe={class:"col"},Le={class:"row q-col-gutter-sm q-pa-sm q-py-md"},Ue={class:"col-12 col-md-3"},Se={class:"error-msg"},Fe={key:0,class:"col-12 col-md-3 col-sm-6 q-mb-md"};const Oe={class:"col-12 col-md-3"},Te={class:"row items-center justify-end"},Re={class:"error-msg"},xe={class:"col-12 col-md-3"},Ge={class:"row items-center justify-end"},Ae={class:"col-12 col-md-12 q-mt-md"},ze={class:"text-center"},De={class:"text-subtitle2 q-mb-lg"},Me={class:"row q-col-gutter-sm q-py-md q-mb-lg"},He={class:"col-12"},je={class:"row q-col-gutter-sm q-py-md q-mb-lg"},Ke={class:"col-12"};function Je(e,t,E,P,d,v){const b=x("grafico-generico"),h=x("essential-table");return r(),f(Ve,null,{default:s(()=>[a(Ce,null,{default:s(()=>[a(ge,{padding:""},{default:s(()=>{var g,C;return[l("div",Pe,[a(B,{class:"rounded-card custom-shadow"},{default:s(()=>[l("div",Le,[l("div",Ue,[t[13]||(t[13]=l("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),a(O,{modelValue:e.reporte.tipo,"onUpdate:modelValue":[t[0]||(t[0]=o=>e.reporte.tipo=o),t[1]||(t[1]=o=>e.consultarListado(e.reporte.tipo))],options:e.opciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",error:!!e.v$.tipo.$errors.length,"emit-value":"","map-options":""},{error:s(()=>[(r(!0),u(N,null,I(e.v$.tipo.$errors,o=>(r(),u("div",{key:o.$uid},[l("div",Se,$(o.$message),1)]))),128))]),_:1},8,["modelValue","options","error"])]),e.reporte.tipo===e.COMBUSTIBLE?(r(),u("div",Fe,[t[15]||(t[15]=l("label",{class:"q-mb-sm block"},"Tipo de combustible",-1)),a(O,{modelValue:e.reporte.combustible,"onUpdate:modelValue":t[2]||(t[2]=o=>e.reporte.combustible=o),options:e.combustibles,"transition-show":"scale","transition-hide":"scale",hint:"OPCIONAL","options-dense":"",clearable:"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarCombustibles,"option-label":o=>o.nombre,"option-value":o=>o.id,"emit-value":"","map-options":""},{"no-option":s(()=>[a(re,null,{default:s(()=>[a(ie,{class:"text-grey"},{default:s(()=>t[14]||(t[14]=[G(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value"])])):n("",!0),n("",!0),l("div",Oe,[t[18]||(t[18]=l("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),a(A,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":t[5]||(t[5]=o=>e.reporte.fecha_inicio=o),error:!!e.v$.fecha_inicio.$errors.length,placeholder:"Opcional",outlined:"",dense:""},{append:s(()=>[a(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(M,{modelValue:e.reporte.fecha_inicio,"onUpdate:modelValue":t[4]||(t[4]=o=>e.reporte.fecha_inicio=o),mask:e.maskFecha,"today-btn":""},{default:s(()=>[l("div",Te,[z(a(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:s(()=>[(r(!0),u(N,null,I(e.v$.fecha_inicio.$errors,o=>(r(),u("div",{key:o.$uid},[l("div",Re,$(o.$message),1)]))),128))]),_:1},8,["modelValue","error"])]),l("div",xe,[t[19]||(t[19]=l("label",{class:"q-mb-sm block"},"Fecha fin ",-1)),a(A,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":t[7]||(t[7]=o=>e.reporte.fecha_fin=o),placeholder:"Opcional",outlined:"",dense:""},{append:s(()=>[a(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(M,{modelValue:e.reporte.fecha_fin,"onUpdate:modelValue":t[6]||(t[6]=o=>e.reporte.fecha_fin=o),mask:e.maskFecha,"today-btn":""},{default:s(()=>[l("div",Ge,[z(a(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",Ae,[l("div",ze,[a(ve,{push:""},{default:s(()=>[a(k,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:t[8]||(t[8]=o=>e.buscarReporte("consulta"))},{default:s(()=>[a(y,{name:"bi-search",size:"xs",class:"q-pr-sm"}),t[20]||(t[20]=l("span",null,"Buscar",-1))]),_:1}),n("",!0),n("",!0)]),_:1})])])])]),_:1}),e.reporte.tipo==e.COMBUSTIBLE&&((g=e.results)==null?void 0:g.results.length)?(r(),f(B,{key:0,class:"q-mb-md q-mt-sm rounded no-border custom-shadow"},{default:s(()=>[t[24]||(t[24]=l("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Gr\xE1ficos Estad\xEDsticos ",-1)),a(he,{modelValue:e.tabs,"onUpdate:modelValue":t[12]||(t[12]=o=>e.tabs=o),animated:"","transition-prev":"scale","transition-next":"scale","keep-alive":""},{default:s(()=>[a(j,{name:e.opcionesGrafico.grafico},{default:s(()=>{var o,m;return[e.results!==null?(r(),u("div",{key:0,class:fe(["q-col-gutter-y-xl q-col-gutter-x-xs q-mb-xl",{row:!e.modoUnaColumna,column:e.modoUnaColumna}])},[(r(!0),u(N,null,I((o=e.results)==null?void 0:o.graficos,c=>(r(),u("div",{class:"col-12 col-md-6 text-center",key:c.id},[l("div",De,$(c.encabezado),1),l("div",null,[c?(r(),f(b,{key:0,data:c,options:e.optionsPie},null,8,["data","options"])):n("",!0)])]))),128))],2)):n("",!0),l("div",Me,[l("div",He,[(m=e.results.results)!=null&&m.length?(r(),f(h,{key:0,titulo:"Valores",configuracionColumnas:e.configuracionColumnasCombustibles,datos:e.results.results,altoFijo:!1},null,8,["configuracionColumnas","datos"])):n("",!0)])])]}),_:1},8,["name"]),a(j,{name:e.opcionesGrafico.listado},{default:s(()=>[a(k,{color:"primary",onClick:t[11]||(t[11]=o=>e.tabs=e.opcionesGrafico.grafico),glossy:"","no-caps":"",rounded:"",unelevated:"",class:"q-mx-auto block"},{default:s(()=>[a(y,{name:"bi-arrow-left"}),t[23]||(t[23]=G(" Regresar al gr\xE1fico"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"])]),_:1})):n("",!0),e.reporte.tipo==e.VEHICULO&&((C=e.results)==null?void 0:C.results.length)?(r(),f(B,{key:1,class:"q-mb-md q-mt-sm rounded no-border custom-shadow"},{default:s(()=>{var o;return[l("div",je,[l("div",Ke,[(o=e.results.results)!=null&&o.length?(r(),f(h,{key:0,titulo:"Valores",configuracionColumnas:e.configuracionColumnasVehiculos,datos:e.results.results,mostrarExportar:"",altoFijo:!1},null,8,["configuracionColumnas","datos"])):n("",!0)])])]}),_:1})):n("",!0)])]}),_:1})]),_:1})]),_:1})}var Oo=pe(Ee,[["render",Je]]);export{Oo as default};

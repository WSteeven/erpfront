var ie=Object.defineProperty;var se=(o,e,p)=>e in o?ie(o,e,{enumerable:!0,configurable:!0,writable:!0,value:p}):o[e]=p;var io=(o,e,p)=>(se(o,typeof e!="symbol"?e+"":e,p),p);import{c as g,d as le,m as go,u as ne,E as re,bx as U,cA as O,A as te,a0 as R,f as de,cu as ce,b_ as ue,cs as me,be as yo,_ as pe,t as J,v as r,x as t,z as s,F as l,a4 as be,y as n,J as m,I as P,D as f,a2 as so,L as lo,a7 as ve,M as Vo,N as Po,K as y,B as wo,j as fe,O as no,G as h,H as j}from"./index.6449c167.js";import{Q as ge,a as ye,C as Ve}from"./QPopupProxy.72ff1d6d.js";import{Q as w,a as C}from"./QItemSection.9a955ec6.js";import{Q as T,a as G}from"./QSelect.6ce302d7.js";import{E as Pe,k as we}from"./EssentialTable.00c17e97.js";import{Q as Ce}from"./QForm.ca56f146.js";import{D as ke,a as Co,b as Se,u as Te,S as qe,i as Ee,n as De,q as K,w as $e,G as ko}from"./utils.521b98f3.js";import{c as he,a as Ie}from"./VisualizarIngresoPage.0ed56aab.js";import{r as X,a as W}from"./index.0198dd12.js";import{u as Le}from"./index.490dde02.js";import{c as Ne}from"./configuracionColumnasProductos.4f52212a.js";import{u as Ue}from"./selector.9691ac4b.js";import{u as je}from"./transaccion.2fe6f8e8.js";import{u as Fe}from"./devolucion.61aed08b.js";import{T as Me}from"./TabLayout.0bce4313.js";import{E as Be}from"./EssentialSelectableTable.5a9cc771.js";import{M as Oe}from"./ModalEntidad.168b465e.js";import{C as Qe}from"./ContenedorSimpleMixin.09c9bed5.js";import{P as ze}from"./ProveedorController.1318c97c.js";import{M as Ae}from"./MotivoController.174aa97d.js";import{C as Ye}from"./ClienteController.33eca86a.js";import{T as He}from"./Transaccion.ef293505.js";import{T as Re}from"./TransaccionIngresoController.443c7c88.js";import{u as Je}from"./transferencia.5b0e0c93.js";import{C as Ge}from"./ComportamientoModalesGestionarIngreso.46139588.js";import{u as Ke}from"./filtrosListadosGenerales.c3aa2da3.js";import{i as Xe}from"./iconos.5bc406be.js";import"./format.8ac60962.js";import"./position-engine.70d0a89f.js";import"./QChip.95469f73.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./SelectorController.de8e1cd0.js";import"./entidadAuditable.75a46700.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./EssentialTablePagination.d5c1010a.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";import"./Transferencia.f2b64659.js";import"./ComponenteModal.domain.50e59f97.js";import"./DetalleProductoPage.51956a2b.js";import"./configuracionColumnasDetallesProductos.d6dcbc18.js";import"./detalle.3b72a676.js";import"./DetalleProducto.9d148d2a.js";import"./PermisoArma.2f16dcc8.js";import"./TabLayoutFilterTabs2.5e702525.js";import"./EssentialTableTabs.586dbdfc.js";import"./DetalleProductoController.ecbb9995.js";import"./ProductoController.5697e6d7.js";import"./MarcaController.5077d681.js";import"./ModeloController.b2cccd1f.js";import"./TipoFibraController.79e8576d.js";import"./HiloController.31a5852f.js";import"./DetalleProductoPage.dd2d46a7.js";import"./LabelAbrirModal.12abdec4.js";import"./PermisoArmaPage.2b9a6d74.js";import"./FormularioPermisoArma.31e6079d.js";import"./ProductoPage.0322300d.js";import"./CategoriaController.c970bebf.js";import"./UnidadMedidaController.198e0928.js";import"./MarcaPage.8e190c52.js";import"./ModeloPage.59a71dde.js";const We=[{name:"producto",field:"producto",label:"Producto",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!1},{name:"categoria",field:"categoria",label:"Categoria",align:"left",sortable:!0},{name:"condiciones",field:"condiciones",label:"Condici\xF3n",align:"left",sortable:!1},{name:"observacion",field:"observacion",label:"Observaci\xF3n",align:"left",sortable:!1},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",sortable:!1},{name:"devuelto",field:"devuelto",label:"Devuelto",align:"left",sortable:!1}],Ze=[{name:"producto",field:"producto",label:"Producto",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 600px; overflow: auto;",align:"left",sortable:!0},{name:"id",field:"id",label:"Id Detalle",align:"left",visible:!1,editable:!1},{name:"modelo",field:"modelo",label:"Modelo",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!0},{name:"fibra",field:"fibra",label:"Fibra",align:"left",sortable:!0},{name:"puntas",field:"puntas",label:"Detalles Fibra",align:"left",sortable:!0},{name:"adicionales",field:"adicionales",label:"Campos adicionales",align:"left",sortable:!0}];function _e(o,e){const p=g(),v=g([]),b=g([]),I=g(),q={refListadoSeleccionable:p,listadoPrecargado:b,listadoSeleccionable:v,endpoint:e,limpiar:()=>{o.id=null,I.value=null},seleccionarMultiple:E=>{o.listadoProductosTransaccion=[...o.listadoProductosTransaccion,...E],o.listadoProductosTransaccion.forEach(L=>{L.id=ke(o.listadoProductosTransaccion)+1})}},F=Ue(q);return{refListadoSeleccionable:p,listado:v,listar:E=>F.listar(I.value,E),limpiar:()=>q.limpiar(),seleccionar:E=>{let L=[];L=o.listadoProductosTransaccion.map(k=>{var Y;(Y=k.condiciones)!=null||k.id});const A=E.filter(k=>!L.includes(k.id));A.forEach(k=>{k.cantidad=1}),q.seleccionarMultiple(A)},criterioBusqueda:I}}class xe{constructor(e,p){io(this,"transaccion");io(this,"listadoDevolucion",g([]));this.transaccion=e,this.listadoDevolucion=p}async validar(){if(this.transaccion.listadoProductosTransaccion.length===0)throw new Error("Debe agregar al menos un producto al listado");if(this.transaccion.listadoProductosTransaccion.some(p=>p.cantidad<=0))throw new Error("La cantidad de los productos del listado debe ser mayor a 0");if(!this.transaccion.ingreso_masivo&&!this.transaccion.listadoProductosTransaccion.every(v=>v.hasOwnProperty("condiciones")))throw new Error("Debes seleccionar un estado para cada \xEDtem");return!0}}var oa=le({name:"transacciones_ingresos",components:{TabLayout:Me,EssentialTable:Pe,ModalesEntidad:Oe,EssentialSelectableTable:Be},setup(){const o=new Qe(He,new Re),{entidad:e,disabled:p,accion:v,listadosAuxiliares:b}=o.useReferencias(),{setValidador:I,obtenerListados:q,cargarVista:F,listar:Q,guardar:z,editar:a,eliminar:E,reestablecer:L}=o.useComportamiento(),{onConsultado:A,onReestablecer:k,onGuardado:Y,onBeforeGuardar:So,onBeforeModificar:To}=o.useHooks(),{confirmar:ro,prompt:to}=Co(),co=new Ge;Se().setQuasar(go()),Te().setQuasar(go());const S=ne(),D=je(),c=Fe(),N=Je(),uo=new qe,qo=S.user.roles.filter(i=>i.indexOf("BODEGA")>-1||i.indexOf("COORDINADOR")>-1).length>0;Y(()=>{V.value=[],c.resetearDevolucion()}),A(()=>{e.solicitante=e.solicitante_id,D.transaccion.hydrate(e)}),k(()=>{V.value=[],e.condicion=null,c.resetearDevolucion(),_.value=!1}),So(()=>{e.proveedor=e.proveedor_id?b.proveedores.find(i=>i.id===e.proveedor_id).razon_social:e.proveedor}),To(()=>{e.proveedor=e.proveedor_id?b.proveedores.find(i=>i.id===e.proveedor_id).razon_social:e.proveedor});const{refListadoSeleccionable:Eo,criterioBusqueda:Do,listado:$o,listar:ho,limpiar:Z,seleccionar:Io}=_e(e,"detalles"),Lo=g(!1),No=g(!0),_=g(!1),H=g(!1),V=g(),x=g([]),{clientes:M,filtrarClientes:Uo,empleados:mo,filtrarEmpleados:jo,sucursales:$,filtrarSucursales:Fo,motivos:oo,tareas:eo,proveedores:po,filtrarProveedores:Mo}=Ke(b);F(async()=>{await q({motivos:{controller:new Ae,params:{tipo_transaccion_id:1}},clientes:{controller:new Ye,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}},empleados:{controller:new re,params:{campos:"id,nombres,apellidos"}},proveedores:new ze}),c.devolucion.id?(e.tiene_devolucion=!0,e.tarea=Number.isInteger(c.devolucion.tarea)?c.devolucion.tarea:c.devolucion.tarea_id,await vo()):e.solicitante=S.user.id,po.value=b.proveedores});const Bo={justificacion:{required:X},sucursal:{required:X},motivo:{requiredIfRol:W(S.esBodeguero)},estado:{requiredIfRol:W(v.value===U.editar)},observacion_est:{requiredIfObsEstado:W(function(){return e.tiene_obs_estado})},listadoProductosTransaccion:{required:X},cliente:{required:X},condicion:{requiredIfMasivo:W(e.ingreso_masivo)}},bo=Le(Bo,e);I(bo.value);const Oo=new xe(e,V);o.agregarValidaciones(Oo);const Qo={titulo:"Agregar nuevo detalle",icono:"bi-plus-lg",color:"positive",accion:()=>{co.abrirModalEntidad("DetalleProductoPage")},visible:()=>v.value==U.nuevo||v.value==U.editar};async function zo(i){B(),Z(),ko(V.value),c.resetearDevolucion();try{await c.cargarDevolucion(i),await vo()}catch{B(),Z(),ko(V.value),c.resetearDevolucion()}}async function vo(){e.devolucion=c.devolucion.id,e.justificacion=c.devolucion.justificacion,e.solicitante=Number.isInteger(c.devolucion.solicitante)?c.devolucion.solicitante:c.devolucion.solicitante_id,e.sucursal=Number.isInteger(c.devolucion.sucursal)?c.devolucion.sucursal:c.devolucion.sucursal_id,e.cliente=Number.isInteger(c.devolucion.cliente)?c.devolucion.cliente:c.devolucion.cliente_id,e.es_para_stock=c.devolucion.es_para_stock,c.devolucion.listadoProductos.forEach(i=>i.detalle_id=i.id),V.value=[...c.devolucion.listadoProductos.filter(i=>i.cantidad!==i.devuelto)],V.value.sort((i,d)=>i.id-d.id),e.listadoProductosTransaccion=[...V.value],c.devolucion.tarea&&(e.es_tarea=!0,e.tarea=Number.isInteger(c.devolucion.tarea)?c.devolucion.tarea:c.devolucion.tarea_id)}async function Ao(i){B(),await N.cargarTransferencia(i),Yo()}function Yo(){e.sucursal=N.transferencia.sucursal_destino,e.justificacion=N.transferencia.justificacion,e.cliente=N.transferencia.cliente,e.per_autoriza=N.transferencia.per_autoriza,e.listadoProductosTransaccion=N.transferencia.listadoProductos}function B(){e.devolucion=null,e.justificacion="",e.solicitante=null,e.sucursal=null,e.listadoProductosTransaccion=[],V.value=[]}function Ho(i){const d=$.value.filter(u=>u.id===i);e.cliente=d[0].cliente_id}function Ro({entidad:i}){const d=e.listadoProductosTransaccion.findIndex(u=>u.id===i.id);ro("\xBFEsta seguro de continuar?",()=>{e.listadoProductosTransaccion.splice(d,1)})}const Jo={titulo:"Actualizar",icono:"bi-arrow-clockwise",accion:()=>{Q()},visible:()=>!1},Go={titulo:"Editar cantidad",accion:({posicion:i})=>{const d={titulo:"Confirmaci\xF3n",mensaje:"Ingresa la cantidad",defecto:e.listadoProductosTransaccion[i].cantidad,tipo:"number",validacion:u=>u>0,accion:u=>{e.listadoProductosTransaccion[i].cantidad=u}};to(d)},visible:()=>v.value===U.nuevo&&e.ingreso_masivo||v.value===U.editar&&e.ingreso_masivo||!No.value&&e.ingreso_masivo||e.ingreso_masivo},Ko={titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:i})=>{D.idTransaccion=i.id,await D.imprimirIngreso()}},Xo={titulo:"Editar fecha de compra",color:"amber-8",icono:Xe.editar,visible:({entidad:i})=>i.motivo===O.compraProveedor,accion:async({entidad:i,posicion:d})=>{var fo;const u={titulo:"Fecha de compra",mensaje:"Ingresa la nueva fecha",defecto:(fo=e.listadoProductosTransaccion[d])==null?void 0:fo.fecha_compra,tipo:"text",accion:async ee=>{try{te.getInstance().put("api/transacciones-ingresos-editar-fecha-compra/"+i.id,{fecha_compra:ee})}catch(ao){if(Ee(ao)){const ae=ao.erroresValidacion;await De(ae,Co())}}}};to(u)}},Wo={titulo:"Anular",color:"red",icono:"bi-x",accion:async({entidad:i})=>{ro("\xBFEst\xE1 seguro que desea anular la transacci\xF3n?. Esta acci\xF3n restar\xE1 al inventario los materiales ingresados previamente",async()=>{D.idTransaccion=i.id,await D.anularIngreso(),i.estado=D.transaccion.estado})},visible:({entidad:i})=>S.can("puede.anular.transacciones_ingresos")&&i.estado===ue.completa};x.value=JSON.parse(R.getItem("condiciones").toString()),$.value=JSON.parse(R.getItem("sucursales").toString()),b.sucursales=$.value,oo.value=b.motivos,eo.value=b.tareas,M.value=b.clientes,mo.value=b.empleados;const Zo=de(()=>[...he,{name:"condiciones",field:"condiciones",label:"Estado del producto",align:"left",sortable:!1,visible:!0,type:"select",options:x.value.map(i=>({label:i.nombre}))},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",type:"number",sortable:!1},{name:"acciones",field:"acciones",label:"Acciones",align:"center"}]);function _o(i){const d=b.tareas.filter(u=>u.id===i);e.cliente=d[0].cliente_id}async function xo(){const i=(await new me().listar({campos:"id,lugar"})).result;R.set("sucursales",JSON.stringify(i)),i.value=JSON.parse(R.getItem("sucursales").toString()),b.sucursales=i.value}async function oe(i=!0,d=null){uo.activar();let u;i&&(e.tarea=null),d?u=await new yo().listar({id:d}):u=await new yo().listar({activas_empleado:1,empleado_id:e.solicitante,campos:"id,codigo_tarea,titulo",finalizado:0}),b.tareas=u.result,eo.value=u.result,uo.desactivar()}return{mixin:o,transaccion:e,disabled:p,accion:v,v$:bo,soloLectura:Lo,configuracionColumnas:Ie,motivos:oo,estados:ce,tareas:eo,clientes:M,empleados:mo,filtrarEmpleados:jo,sucursales:$,filtrarSucursales:Fo,condiciones:x,listadoDevolucion:V,acciones:U,tareaSeleccionada:_o,motivoSeleccionado(i){H.value=!1;const d=b.motivos.filter(u=>u.id===i);_.value=d[0].nombre===O.compraProveedor,H.value=d[0].nombre===O.mercaderiaClienteTarea||d[0].nombre===O.devolucionTarea,e.es_transferencia=d[0].nombre==O.ingresoTransferenciaBodegas,H.value&&oe(!1,e.tarea)},checkMasivo(i){i||(e.condicion=null)},checkDevolucion(i){i||B()},configuracionColumnasProductosSeleccionadosAccion:Zo,configuracionColumnasDetallesProductosSeleccionables:Ze,botonEditarCantidad:Go,botonActualizar:Jo,botonImprimir:Ko,botonAnular:Wo,botonEditarFechaCompra:Xo,eliminarItem:Ro,configuracionColumnasListadoProductosDevolucion:We,pagination:g({rowsPerPage:0}),modales:co,abrirModalDetalle:Qo,refListadoSeleccionableProductos:Eo,criterioBusquedaProducto:Do,listadoProductos:$o,listarProductos:ho,limpiarProducto:Z,seleccionarProducto:Io,configuracionColumnasProductos:Ne,rolSeleccionado:qo,llenarTransaccion:zo,limpiarTransaccion:B,llenarTransferencia:Ao,esVisibleComprobante:_,esVisibleTarea:H,transaccionStore:D,guardar:z,editar:a,eliminar:E,reestablecer:L,esBodeguero:S.esBodeguero,esCoordinador:S.esCoordinador,seleccionarClientePropietario:Ho,recargarSucursales:xo,filtrarClientes:Uo,ordenarClientes(){S.esBodegueroTelconet?M.value=M.value.filter(i=>i.razon_social.indexOf("TELCONET")>-1):M.value.sort((i,d)=>K(i.razon_social,d.razon_social))},ordenarMotivos(){oo.value.sort((i,d)=>K(i.nombre,d.nombre))},ordenarSucursales(){if(S.esBodegueroTelconet){const i=$.value.filter(d=>d.lugar.indexOf("TELCONET")>-1);$.value=i.sort((d,u)=>K(d.lugar,u.lugar))}else $.value.sort((i,d)=>K(i.lugar,d.lugar))},ordenarLista:$e,proveedores:po,filtrarProveedores:Mo}}});const ea={class:"row q-col-gutter-sm q-py-md"},aa={key:0,class:"col col-12"},ia={key:1,class:"col-12 col-md-3"},sa={key:2,class:"col-12 col-md-3"};const la={class:"col-12 col-md-3 q-mb-md"},na={key:4,class:"col-12 col-md-3 q-mb-md"},ra={key:5,class:"col-12 col-md-3"},ta={key:6,class:"col-12 col-md-3 q-mb-md"},da={key:7,class:"col-12 col-md-3 q-mb-md"},ca={key:8,class:"col-12 col-md-3 col-sm-3"},ua={key:9,class:"col-12 col-md-3"},ma={key:10,class:"col-12 col-md-3 q-mb-md"},pa={key:11,class:"col-12 col-md-3 q-mb-md"},ba={class:"row items-center justify-end"},va={class:"col-12 col-md-3 q-mb-md"},fa={class:"error-msg"},ga={class:"col-12 col-md-3"},ya={class:"error-msg"},Va={class:"col-12 col-md-3"},Pa={key:12,class:"col-12 col-md-3"},wa={key:13,class:"col-12 col-md-3 q-mb-md"},Ca={class:"error-msg"},ka={key:14,class:"col-12 col-md-3"},Sa={key:15,class:"col-12 col-md-3"},Ta={class:"error-msg"},qa={class:"col-12 col-md-3"},Ea={class:"error-msg"},Da={key:16,class:"col-12 col-md-3"},$a={key:17,class:"col-12 col-md-3"},ha={class:"error-msg"},Ia={key:18,class:"col-12 col-md-12"},La={class:"col-12 col-md-12"},Na={class:"row q-col-gutter-xs"},Ua={class:"col-12 col-md-10 q-mb-md"},ja={class:"col-12 col-md-2"},Fa={class:"col-12"};function Ma(o,e,p,v,b,I){const q=J("essential-table"),F=J("essential-selectable-table"),Q=J("tab-layout"),z=J("modales-entidad");return r(),t(h,null,[s(Q,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Transacciones - Ingresos",permitirEditar:!1,ajustarCeldas:!0,accion1:o.botonImprimir,accion2:o.botonAnular,accion3:o.botonEditarFechaCompra,accion1Header:o.botonActualizar,paginate:""},{formulario:l(()=>[s(Ce,{onSubmit:e[33]||(e[33]=be(()=>{},["prevent"]))},{default:l(()=>[n("div",ea,[o.transaccion.es_para_stock?(r(),t("div",aa,e[34]||(e[34]=[n("span",null,"Se realizar\xE1 un egreso automatico al stock del solicitante",-1)]))):m("",!0),o.transaccion.id?(r(),t("div",ia,[e[35]||(e[35]=n("label",{class:"q-mb-sm block"},"Transacci\xF3n N\xB0",-1)),s(P,{modelValue:o.transaccion.id,"onUpdate:modelValue":e[0]||(e[0]=a=>o.transaccion.id=a),placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly","disable"])])):m("",!0),o.transaccion.created_at?(r(),t("div",sa,[e[36]||(e[36]=n("label",{class:"q-mb-sm block"},"Fecha",-1)),s(P,{modelValue:o.transaccion.created_at,"onUpdate:modelValue":e[1]||(e[1]=a=>o.transaccion.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),m("",!0),n("div",la,[e[39]||(e[39]=n("label",{class:"q-mb-sm block"},"Motivo",-1)),s(T,{modelValue:o.transaccion.motivo,"onUpdate:modelValue":[e[4]||(e[4]=a=>o.transaccion.motivo=a),o.motivoSeleccionado],options:o.motivos,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",onPopupShow:o.ordenarMotivos,readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.motivo.$errors.length,"error-message":"Debes seleccionar un motivo","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[38]||(e[38]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onPopupShow","onUpdate:modelValue","readonly","disable","error","option-value","option-label"])]),o.transaccion.es_transferencia?(r(),t("div",na,[e[40]||(e[40]=n("label",{class:"q-mb-sm block"},"N\xB0 transferencia",-1)),s(P,{type:"number",modelValue:o.transaccion.transferencia,"onUpdate:modelValue":e[5]||(e[5]=a=>o.transaccion.transferencia=a),placeholder:"Opcional",hint:"Ingresa un numero de transferencia y presiona Enter",onKeyup:e[6]||(e[6]=so(a=>o.llenarTransferencia(o.transaccion.transferencia),["enter"])),readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])])):m("",!0),o.accion==="NUEVO"&&!o.transaccion.es_transferencia&&!o.esVisibleComprobante||o.transaccion.tiene_devolucion&&!o.transaccion.es_transferencia?(r(),t("div",ra,[s(lo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.tiene_devolucion,"onUpdate:modelValue":[e[7]||(e[7]=a=>o.transaccion.tiene_devolucion=a),o.checkDevolucion],label:"\xBFHay devoluci\xF3n?",outlined:"",disable:o.disabled,dense:""},null,8,["modelValue","onUpdate:modelValue","disable"])])):m("",!0),o.transaccion.tiene_devolucion||o.transaccion.devolucion?(r(),t("div",ta,[e[41]||(e[41]=n("label",{class:"q-mb-sm block"},"N\xB0 devoluci\xF3n",-1)),s(P,{type:"number",modelValue:o.transaccion.devolucion,"onUpdate:modelValue":e[8]||(e[8]=a=>o.transaccion.devolucion=a),placeholder:"Opcional",hint:"Ingresa un numero de devoluci\xF3n y presiona Enter",onKeyup:e[9]||(e[9]=so(a=>o.llenarTransaccion(o.transaccion.devolucion),["enter"])),readonly:o.disabled,disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","readonly","disable"])])):m("",!0),o.esVisibleComprobante||o.transaccion.num_comprobante?(r(),t("div",da,[e[42]||(e[42]=n("label",{class:"q-mb-sm block"},"N\xB0 Factura/Comprobante",-1)),s(P,{modelValue:o.transaccion.num_comprobante,"onUpdate:modelValue":e[10]||(e[10]=a=>o.transaccion.num_comprobante=a),type:"number",placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,rules:[a=>a>0||"Ingresa un numero de comprobante v\xE1lido"],"lazy-rules":!0,outlined:"",dense:""},null,8,["modelValue","readonly","disable","rules"])])):m("",!0),o.esVisibleComprobante?(r(),t("div",ca,[e[43]||(e[43]=n("label",{class:"q-mb-sm block"},"Modo de selecci\xF3n de Proveedor",-1)),s(ve,{label:o.transaccion.modo_seleccion?"LISTADO":"TEXTO",modelValue:o.transaccion.modo_seleccion,"onUpdate:modelValue":[e[11]||(e[11]=a=>o.transaccion.modo_seleccion=a),e[12]||(e[12]=a=>o.transaccion.proveedor=null)],icon:"bi-check2-circle","unchecked-icon":"clear",disable:o.disabled,color:"primary","keep-color":""},null,8,["label","modelValue","disable"])])):m("",!0),o.esVisibleComprobante&&o.transaccion.modo_seleccion||o.transaccion.proveedor_id?(r(),t("div",ua,[e[45]||(e[45]=n("label",{class:"q-mb-sm block"},"Proveedor",-1)),s(T,{modelValue:o.transaccion.proveedor_id,"onUpdate:modelValue":e[13]||(e[13]=a=>o.transaccion.proveedor_id=a),options:o.proveedores,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarProveedores,disable:o.disabled||o.soloLectura,"option-label":a=>a.razon_social+" - "+a.sucursal,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[s(w,Vo(Po(a.itemProps)),{default:l(()=>[s(C,null,{default:l(()=>[s(G,null,{default:l(()=>[f(y(a.opt.razon_social),1)]),_:2},1024),s(G,{caption:""},{default:l(()=>[f(y(a.opt.nombre_comercial)+" - Sucursal: "+y(a.opt.sucursal||a.opt.direccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[44]||(e[44]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])])):m("",!0),o.esVisibleComprobante&&!o.transaccion.modo_seleccion||o.transaccion.proveedor?(r(),t("div",ma,[e[46]||(e[46]=n("label",{class:"q-mb-sm block"},"Proveedor",-1)),s(P,{modelValue:o.transaccion.proveedor,"onUpdate:modelValue":e[14]||(e[14]=a=>o.transaccion.proveedor=a),placeholder:"Obligatorio",disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","disable"])])):m("",!0),o.esVisibleComprobante||o.transaccion.fecha_compra?(r(),t("div",pa,[e[47]||(e[47]=n("label",{class:"q-mb-sm block"},"Fecha de compra",-1)),s(P,{modelValue:o.transaccion.fecha_compra,"onUpdate:modelValue":e[16]||(e[16]=a=>o.transaccion.fecha_compra=a),placeholder:"YYYY-MM-DD",hint:"Opcional",disable:o.disabled,clearable:"",outlined:"",dense:""},{append:l(()=>[s(wo,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(ge,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(ye,{modelValue:o.transaccion.fecha_compra,"onUpdate:modelValue":e[15]||(e[15]=a=>o.transaccion.fecha_compra=a),mask:"YYYY-MM-DD","today-btn":""},{default:l(()=>[n("div",ba,[fe(s(no,{label:"Cerrar",color:"primary",flat:""},null,512),[[Ve]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","disable"])])):m("",!0),n("div",va,[e[49]||(e[49]=n("label",{class:"q-mb-sm block"},"Sucursal",-1)),s(T,{modelValue:o.transaccion.sucursal,"onUpdate:modelValue":[e[17]||(e[17]=a=>o.transaccion.sucursal=a),o.seleccionarClientePropietario],options:o.sucursales,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.sucursal.$errors.length,"error-message":"Debes seleccionar una sucursal","use-input":"","input-debounce":"0",onFilter:o.filtrarSucursales,onPopupShow:o.ordenarSucursales,"option-value":a=>a.id,"option-label":a=>a.lugar,"emit-value":"","map-options":""},{error:l(()=>[(r(!0),t(h,null,j(o.v$.sucursal.$errors,a=>(r(),t("div",{key:a.$uid},[n("div",fa,y(a.$message),1)]))),128))]),"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[48]||(e[48]=[f(" No hay resultados ")])),_:1})]),_:1})]),after:l(()=>[s(no,{color:"positive",onClick:o.recargarSucursales},{default:l(()=>[s(wo,{size:"xs",class:"q-mr-sm",name:"bi-arrow-clockwise"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","readonly","disable","error","onFilter","onPopupShow","onUpdate:modelValue","option-value","option-label"])]),n("div",ga,[e[50]||(e[50]=n("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),s(P,{modelValue:o.transaccion.justificacion,"onUpdate:modelValue":e[18]||(e[18]=a=>o.transaccion.justificacion=a),placeholder:"Obligatorio",type:"textarea",autogrow:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.justificacion.$errors.length,outlined:"",dense:""},{error:l(()=>[(r(!0),t(h,null,j(o.v$.justificacion.$errors,a=>(r(),t("div",{key:a.$uid},[n("div",ya,y(a.$message),1)]))),128))]),_:1},8,["modelValue","readonly","disable","error"])]),n("div",Va,[e[52]||(e[52]=n("label",{class:"q-mb-sm block"},"Solicitante",-1)),s(T,{modelValue:o.transaccion.solicitante,"onUpdate:modelValue":e[19]||(e[19]=a=>o.transaccion.solicitante=a),options:o.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:o.disabled||o.soloLectura,"use-input":"","input-debounce":"0",onFilter:o.filtrarEmpleados,onPopupShow:e[20]||(e[20]=a=>o.ordenarLista(o.empleados,"apellidos")),readonly:o.disabled||o.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[51]||(e[51]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter","readonly","option-label","option-value"])]),o.esVisibleTarea?(r(),t("div",Pa,[e[53]||(e[53]=n("label",{class:"q-mb-sm block"},"Tarea",-1)),s(T,{modelValue:o.transaccion.tarea,"onUpdate:modelValue":[e[21]||(e[21]=a=>o.transaccion.tarea=a),o.tareaSeleccionada],options:o.tareas,"transition-show":"scale","transition-hide":"scale","options-dense":"",clearable:"",hint:"Tarea #",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,"option-label":a=>a.titulo,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:l(a=>[s(w,Vo(Po(a.itemProps)),{default:l(()=>[s(C,null,{default:l(()=>[s(G,null,{default:l(()=>[f(y(a.opt.codigo_tarea),1)]),_:2},1024),s(G,{caption:""},{default:l(()=>[f(y(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","readonly","disable","onUpdate:modelValue","option-label","option-value"])])):m("",!0),o.accion===o.acciones.consultar||o.accion===o.acciones.editar?(r(),t("div",wa,[e[55]||(e[55]=n("label",{class:"q-mb-sm block"},"Estado",-1)),s(T,{modelValue:o.transaccion.estado,"onUpdate:modelValue":e[22]||(e[22]=a=>o.transaccion.estado=a),options:o.estados,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled||o.soloLectura,disable:o.disabled||o.soloLectura,error:!!o.v$.estado.$errors.length,"error-message":"Debes seleccionar un estado para la transacci\xF3n","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[(r(!0),t(h,null,j(o.v$.estado.$errors,a=>(r(),t("div",{key:a.$uid},[n("div",Ca,y(a.$message),1)]))),128))]),"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[54]||(e[54]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","readonly","disable","error","option-value","option-label"])])):m("",!0),o.rolSeleccionado?(r(),t("div",ka,[s(lo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.tiene_obs_estado,"onUpdate:modelValue":e[23]||(e[23]=a=>o.transaccion.tiene_obs_estado=a),label:"Tiene observaci\xF3n",outlined:"",disable:o.disabled||o.soloLectura,dense:""},null,8,["modelValue","disable"])])):m("",!0),o.transaccion.tiene_obs_estado?(r(),t("div",Sa,[e[56]||(e[56]=n("label",{class:"q-mb-sm block"},"Observacion",-1)),s(P,{type:"textarea",autogrow:"",modelValue:o.transaccion.observacion_est,"onUpdate:modelValue":e[24]||(e[24]=a=>o.transaccion.observacion_est=a),placeholder:"Obligatorio",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.observacion_est.$errors.length,outlined:"",dense:""},{error:l(()=>[(r(!0),t(h,null,j(o.v$.observacion_est.$errors,a=>(r(),t("div",{key:a.$uid},[n("div",Ta,y(a.$message),1)]))),128))]),_:1},8,["modelValue","readonly","disable","error"])])):m("",!0),n("div",qa,[e[58]||(e[58]=n("label",{class:"q-mb-sm block"},"Cliente",-1)),s(T,{modelValue:o.transaccion.cliente,"onUpdate:modelValue":e[25]||(e[25]=a=>o.transaccion.cliente=a),options:o.clientes,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,disable:o.disabled||o.soloLectura,error:!!o.v$.cliente.$errors.length,"error-message":"Debes seleccionar un cliente","use-input":"","input-debounce":"0",onPopupShow:o.ordenarClientes,onFilter:o.filtrarClientes,"option-value":a=>a.id,"option-label":a=>a.razon_social,"emit-value":"","map-options":""},{error:l(()=>[(r(!0),t(h,null,j(o.v$.cliente.$errors,a=>(r(),t("div",{key:a.$uid},[n("div",Ea,y(a.$message),1)]))),128))]),"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[57]||(e[57]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","readonly","disable","error","onPopupShow","onFilter","option-value","option-label"])]),o.accion===o.acciones.nuevo?(r(),t("div",Da,[s(lo,{class:"q-mt-lg q-pt-md",modelValue:o.transaccion.ingreso_masivo,"onUpdate:modelValue":[e[26]||(e[26]=a=>o.transaccion.ingreso_masivo=a),o.checkMasivo],label:"\xBFIngreso masivo?",disable:o.disabled||o.soloLectura,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue","disable"])])):m("",!0),o.transaccion.ingreso_masivo?(r(),t("div",$a,[e[60]||(e[60]=n("label",{class:"q-mb-sm block"},"Estado de los productos",-1)),s(T,{modelValue:o.transaccion.condicion,"onUpdate:modelValue":e[27]||(e[27]=a=>o.transaccion.condicion=a),options:o.condiciones,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",readonly:o.disabled,error:!!o.v$.condicion.$errors.length,"error-message":"Debes seleccionar una condici\xF3n","option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{error:l(()=>[(r(!0),t(h,null,j(o.v$.condicion.$errors,a=>(r(),t("div",{key:a.$uid},[n("div",ha,y(a.$message),1)]))),128))]),"no-option":l(()=>[s(w,null,{default:l(()=>[s(C,{class:"text-grey"},{default:l(()=>e[59]||(e[59]=[f(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","readonly","error","option-value","option-label"])])):m("",!0),o.listadoDevolucion!==void 0&&o.listadoDevolucion.length>0?(r(),t("div",Ia,[s(we,{"flat.bordered":"",style:{height:"300px"},title:"Listado de la devoluci\xF3n",class:"bg-body-table custom-border",rows:o.listadoDevolucion,columns:o.configuracionColumnasListadoProductosDevolucion,"row-key":"id","hide-bottom":!0,pagination:o.pagination,"onUpdate:pagination":e[28]||(e[28]=a=>o.pagination=a),"rows-per-page-options":[0],"wrap-cells":"","virtual-scroll":"",dense:""},null,8,["rows","columns","pagination"])])):m("",!0),n("div",La,[e[62]||(e[62]=n("label",{class:"q-mb-sm block"},"Agregar productos",-1)),n("div",Na,[n("div",Ua,[s(P,{modelValue:o.criterioBusquedaProducto,"onUpdate:modelValue":e[29]||(e[29]=a=>o.criterioBusquedaProducto=a),placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",disable:o.disabled||o.soloLectura,onKeydown:e[30]||(e[30]=so(a=>o.listarProductos(),["enter"])),onBlur:e[31]||(e[31]=a=>o.criterioBusquedaProducto===""?o.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","disable"])]),n("div",ja,[s(no,{onClick:e[32]||(e[32]=a=>o.listarProductos()),icon:"search",unelevated:"",disable:o.disabled||o.soloLectura,color:"positive",class:"full-width",style:{height:"40px"},"no-caps":"",glossy:""},{default:l(()=>e[61]||(e[61]=[f("Buscar")])),_:1},8,["disable"])])])]),n("div",Fa,[s(q,{titulo:"Productos Seleccionados",configuracionColumnas:o.configuracionColumnasProductosSeleccionadosAccion,datos:o.transaccion.listadoProductosTransaccion,permitirConsultar:!1,permitirEditar:!o.transaccion.ingreso_masivo&&o.accion===o.acciones.nuevo,permitirEliminar:o.accion==o.acciones.nuevo||o.accion==o.acciones.editar,mostrarBotones:!1,accion1:o.botonEditarCantidad,accion1Header:o.abrirModalDetalle,altoFijo:!1,ajustarCeldas:!0,onEliminar:o.eliminarItem,permitirEditarModal:!0,modalMaximized:!1},null,8,["configuracionColumnas","datos","permitirEditar","permitirEliminar","accion1","accion1Header","onEliminar"])])])]),_:1}),s(F,{ref:"refListadoSeleccionableProductos","configuracion-columnas":o.configuracionColumnasDetallesProductosSeleccionables,datos:o.listadoProductos,"tipo-seleccion":"multiple",onSelected:o.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","accion1","accion2","accion3","accion1Header"]),s(z,{comportamiento:o.modales},null,8,["comportamiento"])],64)}var ns=pe(oa,[["render",Ma]]);export{ns as default};

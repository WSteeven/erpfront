var ro=Object.defineProperty;var no=(o,e,f)=>e in o?ro(o,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):o[e]=f;var F=(o,e,f)=>(no(o,typeof e!="symbol"?e+"":e,f),f);import{by as lo,s as Q,d as uo,bd as fo,m as S,u as po,c as b,E as mo,a2 as E,q as co,a3 as vo,A as bo,dq as R,bG as U,_ as ho,v as p,P as _o,F as s,z as i,be as Fo,bf as O,y as n,x as m,G as g,H as w,K as C,D as $,J as Y,I as q,B as y,j as P,O as k,Q as go,c7 as wo}from"./index.b8e09611.js";import{Q as A,a as B}from"./QItemSection.ec4cc512.js";import{Q as T}from"./QSelect.b920278b.js";import{Q as N,a as j,C as M}from"./QPopupProxy.685eacb5.js";import{Q as Co}from"./QPage.e6f8825d.js";import{T as $o}from"./TabLayout.45a66130.js";import{u as yo}from"./index.70965bc7.js";import{C as ko}from"./ContenedorSimpleMixin.4e22246b.js";import{T as Vo}from"./TipoFonfoController.e21e8792.js";import{E as Io}from"./entidadAuditable.75a46700.js";import{u as Qo,A as z,L as I}from"./utils.9344cd7e.js";import{a as Lo,r as G}from"./i18n-validators.06abe774.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTable.23af6cc8.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./EssentialTablePagination.ce808cac.js";import"./index.ea415f98.js";class Do extends lo{constructor(){super(Q.fondo_rotativo_fecha_pdf)}}class So extends Io{constructor(){super();F(this,"usuario");F(this,"fecha_inicio");F(this,"fecha_fin");this.usuario=null,this.fecha_inicio=null,this.fecha_fin=null}}var Eo=uo({components:{TabLayout:$o},setup(){fo().setQuasar(S()),Qo().setQuasar(S());const o=po(),e=new ko(So,new Do),{entidad:f,disabled:L,accion:D,listadosAuxiliares:l}=e.useReferencias(),{setValidador:a,obtenerListados:H,cargarVista:J}=e.useComportamiento(),K={usuario:{requiredIfUsuario:Lo(()=>o.can("puede.ver.campo.empleado.fondo_rotativo"))},fecha_inicio:{required:G},fecha_fin:{required:G}},V=yo(K,f);a(V.value);const c=b([]),v=b(),h=b([]),X=b("false"),_=b([]);c.value=l.usuarios,J(async()=>{await H({usuarios:{controller:new mo,params:{campos:"id,nombres,apellidos",estado:1}},tiposFondos:{controller:new Vo,params:{campos:"id,descripcion"}}}),c.value=l.usuarios,v.value=E.getItem("usuariosInactivos")==null?[]:JSON.parse(E.getItem("usuariosInactivos").toString()),l.usuariosInactivos=v.value,h.value=l.tiposFondos,_.value=l.tiposFondoRotativoFechas});function W(t,r){if(t===""){r(()=>{c.value=l.usuarios});return}r(()=>{const d=t.toLowerCase();c.value=l.usuarios.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function Z(t,r){if(t===""){r(()=>{v.value=l.usuariosInactivos});return}r(()=>{const d=t.toLowerCase();v.value=l.usuariosInactivos.filter(u=>u.nombres.toLowerCase().indexOf(d)>-1||u.apellidos.toLowerCase().indexOf(d)>-1)})}function x(t,r){if(t===""){r(()=>{h.value=l.tiposFondos});return}r(()=>{const d=t.toLowerCase();h.value=l.tiposFondos.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}function oo(t,r){if(t===""){r(()=>{_.value=l.tiposFondoRotativoFechas});return}r(()=>{const d=t.toLowerCase();_.value=l.tiposFondoRotativoFechas.filter(u=>u.descripcion.toLowerCase().indexOf(d)>-1)})}async function eo(t,r){if(await V.value.$validate()){const d=bo.getInstance(),u="reporte_semanal_gastos_del_"+t.fecha_inicio+"_al_"+t.fecha_fin;switch(r){case R.EXCEL:const io=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_excel);z(io,"POST","blob","xlsx",u,t);break;case R.PDF:const to=U.URL_BASE+"/"+d.getEndpoint(Q.fondo_rotativo_fecha_pdf);z(to,"POST","blob","pdf",u,t);break}}}function ao(t){const r=I(new Date,"YYYY/MM/DD");return t<=r}function so(t){const r=I(new Date,"YYYY/MM/DD"),d=I(f.fecha_inicio!==null?f.fecha_inicio:new Date,"YYYY/MM/DD");return t>=d&&t<=r}return{mixin:e,fondo_rotativo_fecha:f,disabled:L,accion:D,store:o,v$:V,usuarios:c,usuariosInactivos:v,tiposFondos:h,tiposFondoRotativoFechas:_,maskFecha:co,is_inactivo:X,generar_reporte:eo,filtrarUsuarios:W,filtrarUsuariosInactivos:Z,filtrarTiposFondos:x,filtrarTiposFondoRotativoFechas:oo,watchEffect:vo,optionsFechaInicio:ao,optionsFechaFin:so}}});const Ro={key:0,class:"col-12 col-md-3"},Uo={class:"error-msg"},Oo={key:1,class:"col-12 col-md-3"},Yo={class:"error-msg"},qo={class:"col-6 col-md-3"},Po={class:"row items-center justify-end"},Ao={class:"error-msg"},Bo={class:"col-6 col-md-3"},To={class:"row items-center justify-end"},No={class:"error-msg"};function jo(o,e,f,L,D,l){return p(),_o(Co,{class:"flex flex-center"},{default:s(()=>[i(Fo,{flat:"",bordered:"",class:"my-card bg-grey-1"},{default:s(()=>[i(O,null,{default:s(()=>e[8]||(e[8]=[n("div",{class:"row items-center no-wrap"},[n("div",{class:"col"},[n("div",{class:"text-h6"},"Generar Reporte Fondo Rotativo")])],-1)])),_:1}),i(O,null,{default:s(()=>[o.store.can("puede.ver.campo.empleado.fondo_rotativo")&&o.is_inactivo=="false"?(p(),m("div",Ro,[e[10]||(e[10]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(T,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[0]||(e[0]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuarios,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,"use-input":"","input-debounce":"0",onBlur:o.v$.usuario.$touch,onFilter:o.filtrarUsuarios,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),m(g,null,w(o.v$.usuario.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Uo,C(a.$message),1)]))),128))]),"no-option":s(()=>[i(A,null,{default:s(()=>[i(B,{class:"text-grey"},{default:s(()=>e[9]||(e[9]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","onBlur","onFilter","option-value","option-label"])])):Y("",!0),o.is_inactivo=="true"?(p(),m("div",Oo,[e[12]||(e[12]=n("label",{class:"q-mb-sm block"},"Empleado",-1)),i(T,{modelValue:o.fondo_rotativo_fecha.usuario,"onUpdate:modelValue":e[1]||(e[1]=a=>o.fondo_rotativo_fecha.usuario=a),options:o.usuariosInactivos,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:o.disabled,readonly:o.disabled,error:!!o.v$.usuario.$errors.length,"error-message":"Debes seleccionar un usuario","use-input":"","input-debounce":"0",onFilter:o.filtrarUsuariosInactivos,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},{error:s(()=>[(p(!0),m(g,null,w(o.v$.usuario.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Yo,C(a.$message),1)]))),128))]),"no-option":s(()=>[i(A,null,{default:s(()=>[i(B,{class:"text-grey"},{default:s(()=>e[11]||(e[11]=[$(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","readonly","error","onFilter","option-value","option-label"])])):Y("",!0),n("div",qo,[e[13]||(e[13]=n("label",{class:"q-mb-sm block"},"Fecha Inicio:",-1)),i(q,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),placeholder:"Obligatorio",error:!!o.v$.fecha_inicio.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(j,{modelValue:o.fondo_rotativo_fecha.fecha_inicio,"onUpdate:modelValue":e[2]||(e[2]=a=>o.fondo_rotativo_fecha.fecha_inicio=a),mask:o.maskFecha,options:o.optionsFechaInicio,"today-btn":""},{default:s(()=>[n("div",Po,[P(i(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),m(g,null,w(o.v$.fecha_inicio.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",Ao,C(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),n("div",Bo,[e[14]||(e[14]=n("label",{class:"q-mb-sm block"},"Fecha Fin:",-1)),i(q,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=a=>o.fondo_rotativo_fecha.fecha_fin=a),placeholder:"Obligatorio",error:!!o.v$.fecha_fin.$errors.length,disable:o.disabled,outlined:"",dense:""},{append:s(()=>[i(y,{name:"event",class:"cursor-pointer"},{default:s(()=>[i(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[i(j,{modelValue:o.fondo_rotativo_fecha.fecha_fin,"onUpdate:modelValue":e[4]||(e[4]=a=>o.fondo_rotativo_fecha.fecha_fin=a),mask:o.maskFecha,"today-btn":"",options:o.optionsFechaFin},{default:s(()=>[n("div",To,[P(i(k,{label:"Cerrar",color:"primary",flat:""},null,512),[[M]])])]),_:1},8,["modelValue","mask","options"])]),_:1})]),_:1})]),error:s(()=>[(p(!0),m(g,null,w(o.v$.fecha_fin.$errors,a=>(p(),m("div",{key:a.$uid},[n("div",No,C(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])])]),_:1}),i(go),i(wo,{align:"around"},{default:s(()=>[i(k,{color:"positive",onClick:e[6]||(e[6]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"excel"))},{default:s(()=>[i(y,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),e[15]||(e[15]=$("Excel"))]),_:1}),i(k,{color:"negative",onClick:e[7]||(e[7]=a=>o.generar_reporte(o.fondo_rotativo_fecha,"pdf"))},{default:s(()=>[i(y,{name:"bi-file-earmark-pdf-fill",size:"xs",class:"q-mr-sm"}),e[16]||(e[16]=$("PDF"))]),_:1})]),_:1})]),_:1})]),_:1})}var Ve=ho(Eo,[["render",jo]]);export{Ve as default};

var k=Object.defineProperty;var S=(o,a,s)=>a in o?k(o,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[a]=s;var e=(o,a,s)=>(S(o,typeof a!="symbol"?a+"":a,s),s);import{bw as Q,s as V,d as A,m as D,u as T,c as M,q as F,A as O,_ as I,t as Y,v as c,P as U,F as i,z as l,y as d,I as q,B as H,j as L,O as N,x as B,H as j,G,a4 as R,K as z}from"./index.6449c167.js";import{Q as K,a as x,C as J}from"./QPopupProxy.72ff1d6d.js";import{Q as W}from"./QForm.ca56f146.js";import{u as X}from"./index.490dde02.js";import{S as Z,E as oo}from"./EssentialTable.00c17e97.js";import{E as ao}from"./EssentialTableTabs.586dbdfc.js";import{T as eo}from"./TabLayoutFilterTabs2.5e702525.js";import{M as to}from"./ModalEntidad.168b465e.js";import{C as no}from"./ContenedorSimpleMixin.09c9bed5.js";import{a as so,u as ro,S as io,A as lo,C as mo}from"./utils.521b98f3.js";import{E as uo}from"./entidadAuditable.75a46700.js";import{d as co}from"./ventas.utils.b757673b.js";import"./format.8ac60962.js";import"./QSelect.6ce302d7.js";import"./QChip.95469f73.js";import"./QItemSection.9a955ec6.js";import"./position-engine.70d0a89f.js";import"./QToolbar.8dbe891b.js";import"./use-fullscreen.a7661f85.js";import"./QBadge.e6f320cd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.fd079679.js";import"./QFile.90d9394a.js";import"./VisorImagen.75b3c53f.js";import"./logo.4781eea2.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./i18n-validators.29e2545c.js";import"./index.0198dd12.js";import"./QTabs.6c234f27.js";import"./QResizeObserver.9af84680.js";import"./EssentialTablePagination.d5c1010a.js";import"./QTabPanels.49d2362a.js";import"./touch.9135741d.js";import"./QPage.5d173a8a.js";import"./buttonSubmits.fe817da3.js";import"./configuracion_general.37a05c0a.js";import"./ConfiguracionController.c50d9536.js";class po extends uo{constructor(){super();e(this,"id");e(this,"fecha");e(this,"vendedor");e(this,"vendedor_id");e(this,"vendedor_info");e(this,"bono_id");e(this,"bono");e(this,"bono_info");e(this,"mes");e(this,"cant_ventas");e(this,"valor");this.id=null,this.fecha=null,this.vendedor=null,this.vendedor_id=null,this.vendedor_info=null,this.bono_id=null,this.bono=null,this.bono_info=null,this.mes=null,this.cant_ventas=null,this.valor=null}}class fo extends Q{constructor(){super(V.bono_mensual_cumplimiento)}}const bo=[{name:"vendedor_info",field:"vendedor_info",label:"Vendedor",align:"left",sortable:!0},{name:"mes",field:"mes",label:"Mes",align:"left",sortable:!0},{name:"cant_ventas",field:"cant_ventas",label:"Cantidad de Ventas",align:"left",sortable:!0},{name:"valor",field:"valor",label:"Bono",align:"left",sortable:!0}];var vo=A({components:{TabLayoutFilterTabs2:eo,ModalesEntidad:to,SelectorImagen:Z,EssentialTable:oo,EssentialTableTabs:ao},setup(){const o=new no(po,new fo),{entidad:a,accion:s,disabled:p,listado:f}=o.useReferencias(),{setValidador:b,listar:m}=o.useComportamiento(),{onGuardado:t}=o.useHooks(),{confirmar:y,notificarCorrecto:E,notificarAdvertencia:Mo,notificarError:Bo}=so();ro().setQuasar(D()),T();const v=new io,g=M(!1),_=M("0"),C=X({mes:{required:!0}},a);b(C.value),t(()=>{console.log("guardado"),m({})});function $(n){_.value=n,m({pagada:n})}function w(n,r,h){g.value=r!=="month"}async function P(n){try{v.activar();const r=O.getInstance(),h=r.getEndpoint(V.bono_mensual_cumplimiento)+"/marcar-pagada/"+n,u=await r.post(h);return u.status===200&&E("Primer mes pagado correctamente"),{response:u,result:u.data.modelo}}catch(r){await mo(r)}finally{v.desactivar()}}return{removeAccents:lo,mixin:o,v$:C,is_month:g,tabDefecto:_,checkValue:w,bono_mensual_cumplimiento:a,accion:s,disabled:p,maskFecha:F,configuracionColumnas:bo,filtrarBonos:$,tabOptionsBonosMensuales:co,btnMarcarPagada:{titulo:"Marcar Pagada",icono:"fas fa-dollar-sign",color:"primary",tooltip:"Marcar como pagado",accion:({entidad:n,posicion:r})=>{y("\xBFEst\xE1s seguro de marcar este bono como pagado?",async()=>{await P(n.id),f.value.splice(r,1)})},visible:({entidad:n})=>!n.pagada}}}});const go={class:"col-12 col-md-3"},_o={class:"row items-center justify-end"},Co={class:"error-msg"};function ho(o,a,s,p,f,b){const m=Y("tab-layout-filter-tabs-2");return c(),U(m,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,puedeExportar:!0,tabOptions:o.tabOptionsBonosMensuales,tabDefecto:o.tabDefecto,filtrar:o.filtrarBonos,accion1:o.btnMarcarPagada},{formulario:i(()=>[l(W,{onSubmit:a[4]||(a[4]=R(()=>{},["prevent"]))},{default:i(()=>[d("div",go,[a[5]||(a[5]=d("label",{class:"q-mb-sm block"},"MES",-1)),l(q,{modelValue:o.bono_mensual_cumplimiento.mes,"onUpdate:modelValue":a[2]||(a[2]=t=>o.bono_mensual_cumplimiento.mes=t),placeholder:"Obligatorio",onClick:a[3]||(a[3]=t=>o.$refs.monthPicker.show()),error:!!o.v$.mes.$errors.length,disable:o.disabled,readonly:"",onBlur:o.v$.mes.$touch,outlined:"",dense:""},{append:i(()=>[l(H,{name:"event",class:"cursor-pointer"},{default:i(()=>[l(K,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:o.is_month,"onUpdate:modelValue":a[1]||(a[1]=t=>o.is_month=t)},{default:i(()=>[l(x,{modelValue:o.bono_mensual_cumplimiento.mes,"onUpdate:modelValue":[a[0]||(a[0]=t=>o.bono_mensual_cumplimiento.mes=t),o.checkValue],mask:"YYYY-MM",minimal:"","emit-immediately":"","default-view":"Years"},{default:i(()=>[d("div",_o,[L(l(N,{label:"Cerrar",color:"primary",flat:""},null,512),[[J]])])]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})]),error:i(()=>[(c(!0),B(G,null,j(o.v$.mes.$errors,t=>(c(),B("div",{key:t.$uid},[d("div",Co,z(t.$message),1)]))),128))]),_:1},8,["modelValue","error","disable","onBlur"])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tabOptions","tabDefecto","filtrar","accion1"])}var ma=I(vo,[["render",ho]]);export{ma as default};

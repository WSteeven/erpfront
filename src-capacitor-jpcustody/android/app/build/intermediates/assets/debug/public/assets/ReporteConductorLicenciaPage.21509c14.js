import{Q as w,a as m}from"./QItemSection.ec4cc512.js";import{Q as L,a as T}from"./QSelect.b920278b.js";import{d as F,bd as j,m as S,R as U,u as z,e as O,c as D,A as G,bG as H,s as M,_ as J,t as K,v as r,P as E,F as a,z as s,y as l,be as W,x as f,D as b,G as X,H as Y,K as h,J as c,a9 as I,M as Z,N as ee,O as oe,B as te}from"./index.b8e09611.js";import{Q as ae}from"./QBtnGroup.7d38eecd.js";import{Q as se}from"./QPage.e6f8825d.js";import{Q as le,a as ie}from"./QLayout.9e55ed7f.js";import{u as ne,S as re,A as R}from"./utils.9344cd7e.js";import{E as ce}from"./EssentialTable.23af6cc8.js";import{C as ue}from"./ContenedorSimpleMixin.4e22246b.js";import{C as de}from"./Conductor.978d1863.js";import{C as x}from"./ConductorController.1494aa58.js";import{u as pe}from"./filtrosListadosGenerales.87fcb144.js";import{t as me}from"./vehiculos.utils.c31e027d.js";import{a as fe}from"./i18n-validators.06abe774.js";import{u as be}from"./index.70965bc7.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QScrollObserver.8813f664.js";import"./QResizeObserver.1422c274.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBadge.89898cd2.js";import"./QPopupProxy.685eacb5.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./entidadAuditable.75a46700.js";import"./index.ea415f98.js";const ge=[{name:"conductor",field:"conductor",label:"Conductor",align:"left",sortable:!0},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0},{name:"tipo_licencia",field:"tipo_licencia",label:"Tipo Licencia",align:"left",sortable:!0},{name:"inicio_vigencia",field:"inicio_vigencia",label:"Inicio Vigencia",align:"left"},{name:"fin_vigencia",field:"fin_vigencia",label:"Fin Vigencia",align:"left"},{name:"vence",field:"vence",label:"Vencimiento",align:"left"}];var ve=F({components:{EssentialTable:ce},setup(){const t=new ue(de,new x),{listadosAuxiliares:e}=t.useReferencias(),{obtenerListados:Q,cargarVista:V}=t.useComportamiento();j().setQuasar(S()),ne().setQuasar(S());const{notificarError:k,notificarAdvertencia:B}=U();z();const u=new re,o=O({conductor:null,tipo_licencia:null,vigencia:null,todos:!1}),i=D([]),{empleados:d,filtrarEmpleados:g}=pe(e);V(async()=>{await Q({empleados:new x}),d.value=e.empleados});const $={conductor:{requiredIf:fe(()=>!o.todos)}},q=be($,o);async function P(v,n,C){if(await q.value.$validate())try{u.activar();const p=G.getInstance(),_=H.URL_BASE+"/"+p.getEndpoint(M.reporte_conductor_licencia),N="reporte_conductores";switch(v){case"excel":return n.accion="excel",R(_,"POST","blob","xlsx",N,n),C;case"pdf":return n.accion="pdf",R(_,"POST","blob","pdf",N,n),C;default:n.accion="";const y=await p.post(_,n);return y.data.results?(y.data.results.length<1&&B("No se obtuvieron resultados"),y.data.results):C}}catch(p){console.log(p),k("Error al obtener el reporte")}finally{u.desactivar()}}async function A(v){i.value=await P(v,o,i.value)}return{reporte:o,v$:q,tiposLicencias:me,configuracionColumnas:ge,listado:i,empleados:d,filtrarEmpleados:g,buscarReporte:A}}});const Ce={class:"col"},_e={class:"row q-col-gutter-sm q-pa-sm q-py-md"},ye={key:0,class:"col-12 col-md-5"},we={class:"error-msg"},he={class:"col-12 col-md-2"},Qe={class:"col-12 col-md-5"},Ve={class:"col-12 col-md-12 q-mt-md"},ke={class:"text-center"},Be={key:0,class:"row q-col-gutter-sm q-pa-sm q-py-md"},$e={class:"col-12 col-md-12"};function qe(t,e,Q,V,k,B){const u=K("essential-table");return r(),E(ie,null,{default:a(()=>[s(le,null,{default:a(()=>[s(se,{padding:""},{default:a(()=>[l("div",Ce,[s(W,{class:"rounded-card custom-shadow"},{default:a(()=>[l("div",_e,[t.reporte.todos?c("",!0):(r(),f("div",ye,[e[7]||(e[7]=l("label",{class:"q-mb-sm block"},"Conductor",-1)),s(L,{modelValue:t.reporte.conductor,"onUpdate:modelValue":e[0]||(e[0]=o=>t.reporte.conductor=o),options:t.empleados,"transition-show":"jump-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:t.filtrarEmpleados,error:!!t.v$.conductor.$errors.length,"option-value":o=>o.id,"option-label":o=>o.apellidos+" "+o.nombres,"emit-value":"","map-options":""},{"no-option":a(()=>[s(w,null,{default:a(()=>[s(m,{class:"text-grey"},{default:a(()=>e[6]||(e[6]=[b(" No hay resultados ")])),_:1})]),_:1})]),error:a(()=>[(r(!0),f(X,null,Y(t.v$.conductor.$errors,o=>(r(),f("div",{key:o.$uid},[l("div",we,h(o.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","error","option-value","option-label"])])),l("div",he,[e[8]||(e[8]=l("label",null,"Todos",-1)),e[9]||(e[9]=b()),e[10]||(e[10]=l("br",null,null,-1)),s(I,{class:"q-mt-sm",label:t.reporte.todos?"SI":"NO",modelValue:t.reporte.todos,"onUpdate:modelValue":e[1]||(e[1]=o=>t.reporte.todos=o),color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear"},null,8,["label","modelValue"])]),l("div",Qe,[e[12]||(e[12]=l("label",{class:"q-mb-sm block"},"Tipo de Licencia",-1)),s(L,{modelValue:t.reporte.tipo_licencia,"onUpdate:modelValue":e[2]||(e[2]=o=>t.reporte.tipo_licencia=o),options:t.tiposLicencias,"transition-show":"jump-up","transition-hide":"jump-down",hint:"Obligatorio","options-dense":"",dense:"",outlined:"","use-chips":"",multiple:"","error-message":"Debes seleccionar un tipo de licencia","option-value":o=>o.value,"option-label":o=>o.label,"emit-value":"","map-options":""},{option:a(({itemProps:o,opt:i,selected:d,toggleOption:g})=>[s(w,Z(ee(o)),{default:a(()=>[s(m,null,{default:a(()=>[s(T,null,{default:a(()=>[l("strong",null,h(i.label),1),b(" - "+h(i.caption),1)]),_:2},1024)]),_:2},1024),s(m,{side:""},{default:a(()=>[s(I,{"model-value":d,"onUpdate:modelValue":$=>g(i)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[s(w,null,{default:a(()=>[s(m,{class:"text-grey"},{default:a(()=>e[11]||(e[11]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-value","option-label"])]),l("div",Ve,[l("div",ke,[s(ae,{push:""},{default:a(()=>[s(oe,{color:"primary",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:e[3]||(e[3]=o=>t.buscarReporte("consulta"))},{default:a(()=>[s(te,{name:"bi-search",size:"xs",class:"q-pr-sm"}),e[13]||(e[13]=l("span",null,"Buscar",-1))]),_:1}),c("",!0),c("",!0)]),_:1})])])]),t.listado!==void 0?(r(),f("div",Be,[l("div",$e,[t.listado.length?(r(),E(u,{key:0,titulo:"Listado de proveedores",configuracionColumnas:t.configuracionColumnas,datos:t.listado,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"permitir-buscar":!0,"alto-fijo":!1,ajustarCeldas:""},null,8,["configuracionColumnas","datos"])):c("",!0)])])):c("",!0)]),_:1})])]),_:1})]),_:1})]),_:1})}var co=J(ve,[["render",qe]]);export{co as default};

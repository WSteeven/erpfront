var $o=Object.defineProperty;var Ao=(o,e,b)=>e in o?$o(o,e,{enumerable:!0,configurable:!0,writable:!0,value:b}):o[e]=b;var te=(o,e,b)=>(Ao(o,typeof e!="symbol"?e+"":e,b),b);import{Q as De}from"./QChip.f8f308fa.js";import{c as T,R as Qe,bz as f,d as qo,bd as _o,m as Te,u as Ce,f as P,E as ne,cs as zo,h as Oo,e as se,S as $e,w as Fo,_ as Bo,t as L,v as d,P as Uo,F as n,z as i,a6 as jo,y as s,D as c,K as v,Q as Ae,x as u,I as w,J as m,L as qe,O as _e,B as No,G as R,H as G,bg as ze,j as Oe,b2 as Fe,M as Be,N as Ue,a4 as Qo}from"./index.b8e09611.js";import{Q as g,a as y}from"./QItemSection.ec4cc512.js";import{Q as E,a as q}from"./QSelect.b920278b.js";import{a as Mo}from"./QToolbar.afeb6de9.js";import{Q as Io}from"./QForm.eab79b48.js";import{d as _,i as Lo,j as re}from"./tareas.utils.309e0dff.js";import{T as Ro,a as Go,c as Ko}from"./TransferenciaProductoEmpleado.0042f841.js";import{u as Jo}from"./selector.e0ee4903.js";import{u as je}from"./filtrosListadosGenerales.87fcb144.js";import{u as Ho,l as ho}from"./utils.9344cd7e.js";import{r as K}from"./i18n-validators.06abe774.js";import{u as Wo}from"./index.70965bc7.js";import{T as Xo}from"./TabLayoutFilterTabs2.6bbaa932.js";import{E as Yo}from"./EssentialSelectableTable.ac03bc90.js";import{G as Zo}from"./GestorArchivos.801d8a9f.js";import{E as xo}from"./EssentialTable.23af6cc8.js";import{C as ea}from"./CalloutComponent.faccc689.js";import{A as oa}from"./ArchivoController.b6daf863.js";import{C as aa}from"./ContenedorSimpleMixin.4e22246b.js";import{F as ia,u as ta}from"./FiltroMiBodegaProyecto.31341d8b.js";import{a as na,F as sa,u as ra}from"./FiltroMiBodegaEmpleado.0c8b713d.js";import{c as la}from"./configuracionColumnasDetallesModal.ec8d68f5.js";import{F as da}from"./FiltroMiBodega.e547cfdb.js";import{T as Ne}from"./TareaController.490ce98d.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./entidadAuditable.75a46700.js";import"./SelectorController.efbca5b9.js";import"./index.ea415f98.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPopupProxy.685eacb5.js";import"./QPage.e6f8825d.js";import"./EssentialTableTabs.03c27e34.js";import"./QBadge.89898cd2.js";import"./EssentialTablePagination.ce808cac.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QBtnGroup.7d38eecd.js";import"./buttonSubmits.f2d72caa.js";import"./QUploader.16c4ab83.js";import"./QCircularProgress.c6e924d2.js";import"./QFile.c79664c6.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./EtapaController.7c12ac90.js";import"./ProyectoController.cb4f7c6c.js";import"./listadoMaterialesDevolucion.14686f4f.js";import"./ClienteMaterialEmpleadoController.99667624.js";const ua=[{name:"producto",field:"producto",label:"Producto",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"categoria",field:"categoria",label:"Categoria",align:"left",sortable:!0},{name:"serial",field:"serial",label:"Serial",align:"left",sortable:!0},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",sortable:!1},{name:"recibido",field:"recibido",label:"Recibido",align:"left",sortable:!1},{name:"acciones",field:"acciones",label:"Acciones",align:"right",sortable:!1}];function ca(o,e){const b=T(),p=T([]),l=T(),C={refListadoSeleccionable:b,listadoSeleccionable:p,endpoint:e,limpiar:()=>{o.id=null,l.value=null},seleccionar:V=>{o.listado_productos=[...o.listado_productos,...V]}},z=Jo(C);return{refListadoSeleccionable:b,listado:p,listar:V=>z.listar(l.value,V),limpiar:()=>C.limpiar(),seleccionar:V=>{let F=[];F=o.listado_productos.map(S=>S.id),V.forEach(S=>{S.recibido=0});const B=V.filter(S=>!F.includes(S.id));C.seleccionar(B)},criterioBusqueda:l}}const pa=[{name:"producto",field:"producto",label:"Producto",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"categoria",field:"categoria",label:"Categoria",align:"left",sortable:!0},{name:"cantidad",field:"cantidad",label:"Cantidad",align:"left",sortable:!0}];function ma(o,e){const{confirmar:b,prompt:p}=Qe(),l={titulo:"Quitar",color:"negative",icono:"bi-x",accion:({posicion:k})=>{z({posicion:k})},visible:()=>e.value!=f.consultar},C={titulo:"Cantidad",icono:"bi-pencil",accion:({posicion:k})=>{const $={titulo:"Modifica",mensaje:"Ingresa la cantidad",tipo:"number",defecto:o.listado_productos[k].cantidad,accion:O=>o.listado_productos[k].cantidad=O};p($)},visible:()=>e.value!=f.consultar};function z({posicion:k}){b("\xBFEst\xE1 seguro de continuar?",()=>o.listado_productos.splice(k,1))}return{botonEliminar:l,botonEditarCantidad:C}}class fa{constructor(e,b){te(this,"transferencia");te(this,"refArchivo");this.transferencia=e,this.refArchivo=b}async validar(){if(this.transferencia.listado_productos.length==0)throw new Error("Debe agregar al menos un item al listado");if(this.refArchivo.value.refGestor==null){if(this.refArchivo.value.listadoArchivos.length<1)throw new Error("Debes adjuntar al menos un archivo")}else if(this.refArchivo.value.cantElementos===0&&this.refArchivo.value.refGestor.files.length<1&&this.refArchivo.value.listadoArchivos.length<1)throw new Error("Se requiere al menos un archivo con la autorizacion de transferir materiales entre etapas.");return!0}}var ba=qo({name:"TransferenciaProductoEmpleado",components:{TabLayoutFilterTabs2:Xo,EssentialTable:xo,EssentialSelectableTable:Yo,GestorArchivos:Zo,Callout:ea},setup(){const o=new aa(Ro,new Go,new oa),{entidad:e,disabled:b,accion:p,listadosAuxiliares:l,filtros:C}=o.useReferencias(),{setValidador:z,obtenerListados:k,cargarVista:$,listar:O}=o.useComportamiento(),{onModificado:V,onConsultado:F,onReestablecer:B,onGuardado:S}=o.useHooks(),a=na();_o().setQuasar(Te()),Ho().setQuasar(Te());const U=Ce(),{refListadoSeleccionable:Me,criterioBusqueda:Ie,listado:Le,listar:J,limpiar:Re,seleccionar:Ge}=ca(e,"materiales_empleado_consolidado"),Ke=async()=>e.cliente?e.tarea_origen?!e.proyecto_origen&&!e.etapa_origen?J({empleado_id:e.empleado_origen,cliente_id:e.cliente,tarea_id:e.tarea_origen,destino:e.tarea_destino?"TAREA":"STOCK"}):J({empleado_id:e.empleado_origen,cliente_id:e.cliente,proyecto_id:e.proyecto_origen,etapa_id:e.etapa_origen,destino:e.tarea_destino?"TAREA":"STOCK"}):await J({empleado_id:e.empleado_origen,cliente_id:e.cliente,stock_personal:1,destino:e.tarea_destino?"TAREA":"STOCK"}):he("Debe seleccionar un cliente de origen para buscar los productos a transferir."),j=T(),Je=U.esCoordinador,He=U.esCoordinadorBodega,I=T(),Z=T(),N=T(!1),H=T(!1),{notificarAdvertencia:he}=Qe(),{empleados:x,filtrarEmpleados:We,ordenarEmpleados:Xe,empleadosOrigen:h,filtrarEmpleadosOrigen:Ye,ordenarEmpleadosOrigen:Ze,tareas:le,filtrarTareas:xe,tareasDestino:de,filtrarTareasDestino:eo}=je(l),oo=P(()=>e.autorizacion===2?l.autorizaciones:l.autorizaciones.filter(t=>t.nombre!=="APROBADO"));$(async()=>{await k({empleados:{controller:new ne,params:{campos:"id,nombres,apellidos"}},autorizadores:{controller:new ne,params:{campos:"id,nombres,apellidos"}},autorizaciones:new zo,empleadosOrigen:[],productos:[],etapas:[],etapasDestino:[],tareas:[],tareasDestino:[],proyectos:[],proyectosDestino:[],clientesMaterialesEmpleado:[],clientesMaterialesTarea:[]})}),Oo(async()=>{var t,r;e.tarea_origen=(t=a.tareaId)!=null?t:null,e.proyecto_origen=a.idProyecto,e.etapa_origen=a.idEtapa,e.empleado_origen=(r=a.idEmpleado)!=null?r:Ce().user.id,e.cliente=a.cliente_id,N.value=!a.idProyecto&&!a.idEtapa&&!a.tareaId,await X(!1),await oe(!1),p.value===f.nuevo&&(H.value=!0),Q()}),e.solicitante=U.user.id;const ue=Wo({justificacion:{required:K},empleado_origen:{required:K},empleado_destino:{required:K},solicitante:{required:K},cliente:{required:K}},e);z(ue.value);const ao=new fa(e,I);o.agregarValidaciones(ao);const{proyectos:ce,filtrarProyectos:io,proyectosDestino:pe,filtrarProyectosDestino:to,etapas:me,filtrarEtapas:no,etapasDestino:fe,filtrarEtapasDestino:so}=je(l),D=se(new ia),ro=se(new sa),W=se(new da),{consultarClientesMaterialesEmpleado:ee}=ra(ro,l),{consultarProyectos:lo,consultarProyectosDestino:uo,consultarEtapas:co,consultarEtapasDestino:po,consultarClientesMaterialesTarea:be}=ta(D,l);async function X(t=!0){p.value===f.nuevo&&t&&(e.proyecto_origen=null,e.etapa_origen=null,e.tarea_origen=null,e.cliente=void 0,e.listado_productos=[]),e.empleado_origen&&p.value===f.nuevo&&(await Y(),await yo(),N.value?ee({empleado_id:e.empleado_origen}):ie()),Q()}async function oe(t=!0){t&&(e.tarea_origen=null,e.etapa_origen=null,e.cliente=null,e.listado_productos=[]);const r=e.proyecto_origen;p.value===f.nuevo&&(r?(await ye(r),await Y({proyecto_id:r})):await Y())}async function mo(){e.tarea_origen=null,e.cliente=null,e.etapa_origen&&Y({etapa_id:e.etapa_origen})}async function fo(){e.cliente=void 0;const t=e.tarea_origen;if(t){const r=l.tareas.find(A=>A.id===t);e.proyecto_origen=r==null?void 0:r.proyecto_id,e.etapa_origen=r==null?void 0:r.etapa_id,e.proyecto_origen?(D.empleado_id=e.empleado_origen,D.etapa_id=e.etapa_origen,D.proyecto_id=e.proyecto_origen,D.cliente_id=e.cliente):(W.empleado_id=e.empleado_origen,W.tarea_id=e.tarea_origen,W.cliente_id=e.cliente),e.proyecto_origen&&await ye(e.proyecto_origen),await ie(),Q()}a.listadoMateriales=[]}async function ve(){p.value===f.nuevo&&(e.proyecto_destino=null,e.etapa_destino=null,e.tarea_destino=null),e.empleado_destino&&p.value===f.nuevo&&(e.proyecto_origen&&(await Ee(),await M({para_cliente_proyecto:_.paraProyecto})),N.value?(await Ee(),await M()):M({para_cliente_proyecto:_.paraClienteFinal})),Q()}async function ge(t=!0){t&&(e.etapa_destino=null,e.tarea_destino=null);const r=e.proyecto_destino;p.value===f.nuevo&&(r?(await ae(r),await M({proyecto_id:r})):M({})),Q()}async function bo(){e.etapa_destino&&await M({etapa_id:e.etapa_destino})}async function vo(){const t=e.tarea_destino;if(t){const r=l.tareasDestino.find(A=>A.id===t);e.proyecto_destino=r==null?void 0:r.proyecto_id,e.etapa_destino=r==null?void 0:r.etapa_id,e.proyecto_destino&&await ae(e.proyecto_destino)}Q()}async function Q(){if(p.value===f.nuevo)if(e.proyecto_origen)e.proyecto_origen===e.proyecto_destino?e.autorizador=we().coordinador_id:e.autorizador=l.autorizadores.filter(t=>t.roles.includes($e.jefe_tecnico))[0].id;else if(!e.proyecto_origen&&!e.etapa_origen&&!e.tarea_origen){if(e.empleado_origen){const{result:t}=await new ne().consultar(e.empleado_origen);e.autorizador=go(t)}}else{const t=l.tareas.find(r=>r.id===e.tarea_origen);e.autorizador=t==null?void 0:t.coordinador_id}}const go=t=>t.roles.includes($e.jefe_tecnico)?typeof t.id=="string"?parseInt(t.id):t.id:typeof t.jefe=="string"?parseInt(t.jefe):t.jefe;async function yo(){D.empleado_id=e.empleado_origen,await lo(),ce.value=l.proyectos}async function ye(t){D.empleado_id=e.empleado_origen,await co(t),me.value=l.etapas}async function ae(t){D.empleado_id=e.empleado_destino,await po(t),fe.value=l.etapasDestino,Pe()&&p.value===f.nuevo&&(e.autorizador=Eo().supervisor_id)}async function Ee(){var r;D.empleado_id=e.empleado_destino,await uo();const t=Pe();pe.value=l.proyectosDestino,!t&&p.value===f.nuevo&&(e.autorizador=(r=we())==null?void 0:r.coordinador_id)}function Pe(){var t;return!!((t=l.proyectos.find(r=>r.id===e.proyecto_origen))!=null&&t.etapas.length)}function we(){return l.proyectos.find(t=>t.id===e.proyecto_origen)}function Eo(){return l.etapas.find(t=>t.id===e.etapa_origen)}const ke=T();function Ve(t){j.value=t,ke.value=[re.PENDIENTE].includes(j.value)||[re.PENDIENTE,re.VALIDADO].includes(j.value)&&He,C.fields={autorizacion_id:j},O({autorizacion_id:t,paginate:!0})}async function Y(t){if(e.empleado_origen){const r=new Ne,{result:A}=await r.listar({activas_empleado:1,empleado_id:e.empleado_origen,campos:"id,codigo_tarea",...t});l.tareas=A,le.value=A}}async function M(t){console.log("Consultando tareas destino"),await $(async()=>{if(e.empleado_destino){const r=new Ne,{result:A}=await r.listar({activas_empleado:1,empleado_id:e.empleado_destino,campos:"id,codigo_tarea",...t});l.tareasDestino=A,de.value=l.tareasDestino}})}async function Se(){await I.value.subir()}Fo(P(()=>e.proyecto_destino),t=>{t&&ae(t)}),S(t=>{Z.value=t,setTimeout(()=>{Se()},1)}),V(t=>{Ve(j.value),Z.value=t,setTimeout(()=>{Se()},1)}),F(async()=>{setTimeout(()=>{I.value.listarArchivosAlmacenados(e.id)},1),h.value=l.empleados,x.value=l.empleados,a.origenProductos=e.tarea_origen?_.paraClienteFinal:_.paraProyecto,N.value=!e.proyecto_origen,H.value=!e.proyecto_destino&&!e.etapa_destino&&!e.tarea_destino,await X(),await oe(!1),await ve(),await ge(!1)}),B(()=>{e.empleado_origen=U.user.id,H.value=!0,I.value.limpiarListado(),X()});const{botonEditarCantidad:Po,botonEliminar:wo}=ma(e,p),ko={titulo:"Imprimir",color:"positive",icono:"bi-printer",accion:async({entidad:t})=>O({export:"pdf",id:t.id,titulo:"Tranferencia #"+t.id})},Vo=P(()=>e.proyecto_origen?"Transferencia entre proyectos":!e.proyecto_origen&&e.tarea_origen?"Transferencia entre tareas":"Transferencia de stock");async function So(t){switch(t){case"clientes":await ee({empleado_id:e.empleado_origen,cliente_id:e.cliente});break}}async function Do(t){switch(t){case"clientes":await ie();break}}async function ie(){e.etapa_origen?await be({proyecto_id:e.proyecto_origen,etapa_id:e.etapa_origen,filtrar_por_etapa:!0}):await be({proyecto_id:e.proyecto_origen,etapa_id:e.etapa_origen,filtrar_por_proyecto:!0})}const To=()=>{N.value?ee({empleado_id:e.empleado_origen,cliente_id:e.cliente}):e.cliente=void 0,e.listado_productos=[]},Co=()=>{e.proyecto_destino=null,e.tarea_destino=null};return h.value=l.empleados,l.empleadosOrigen=l.empleados,x.value=l.empleados,{mixin:o,transferencia:e,disabled:b,accion:p,v$:ue,acciones:f,configuracionColumnas:Ko,listadosAuxiliares:l,authenticationStore:U,refArchivo:I,idTransferencia:Z,empleadosOrigen:h,tareas:le,tareasDestino:de,proyectos:ce,proyectosDestino:pe,etapas:me,etapasDestino:fe,filtrarProyectos:io,filtrarProyectosDestino:to,filtrarTareas:xe,filtrarEtapas:no,filtrarEtapasDestino:so,filtrarTareasDestino:eo,refListado:Me,criterioBusquedaProducto:Ie,listadoProductos:Le,listarProductos:J,limpiarProducto:Re,seleccionarProducto:Ge,configuracionColumnasDetallesModal:la,configuracionColumnasProductosSeleccionadosAccion:ua,configuracionColumnasProductosSeleccionados:pa,botonEditarCantidad:Po,botonEliminar:wo,esCoordinador:Je,puedeAutorizar:P(()=>U.can("puede.autorizar.transferencia_producto_empleado")&&[f.nuevo,f.editar].includes(p.value)),tabOptionsTransferenciaProductoEmpleado:Lo,tabSeleccionado:j,puedeEditar:ke,filtrarTransferenciasProductoEmpleado:Ve,empleados:x,filtrarEmpleados:We,ordenarEmpleados:Xe,filtrarEmpleadosOrigen:Ye,ordenarEmpleadosOrigen:Ze,transferenciaProductoEmpleadoStore:a,ordenarOpcionesEmpleados:()=>h.value.sort((t,r)=>ho(t.apellidos,r.apellidos)),mostrarOrigenTarea:P(()=>a.origenProductos===_.paraClienteFinal),mostrarOrigenProyecto:P(()=>a.origenProductos===_.paraProyecto),mostrarOrigenPersonal:P(()=>a.origenProductos==="personal"),paraTarea:P(()=>a.origenProductos===_.paraClienteFinal),paraProyecto:P(()=>a.origenProductos===_.paraProyecto),tipoTransferencia:Vo,refrescarListadosEmpleado:So,refrescarListadosProyectos:Do,esParaStock:N,esDestinoStock:H,seleccionarEsDestinoStock:Co,seleccionarEsStock:To,existenProductos:P(()=>e.listado_productos.length),filtroTarea:W,seleccionarEmpleadoOrigen:X,seleccionarProyectoOrigen:oe,seleccionarEtapaOrigen:mo,seleccionarTareaOrigen:fo,seleccionarProyectoDestino:ge,seleccionarEmpleadoDestino:ve,seleccionarEtapaDestino:bo,seleccionarTareaDestino:vo,consultarProductos:Ke,consultado:P(()=>p.value===f.editar||p.value===f.consultar),botonImprimir:ko,autorizaciones:oo,notificacionSSA:P(()=>e.listado_productos.some(t=>t.categoria==="EPP")?"Se notificar\xE1 al responsable del departamento de <b>SSA</b> que se transfirieron <b>EPPs</b>.":null)}}});const va={class:"row q-col-gutter-sm q-pa-md"},ga={class:"col-12 q-mb-md"},ya={class:"row justify-end"},Ea={class:"col-12 q-mb-md"},Pa={key:0,class:"col-12 col-md-3"},wa={key:1,class:"col-12 col-md-3"},ka={class:"col-12 col-md-3"},Va={class:"col-12 col-md-3"},Sa={class:"col-12 col-md-3"},Da={key:2,class:"col-12 col-md-3"},Ta={class:"error-msg"},Ca={key:3,class:"col-12 col-md-3"},$a={key:4,class:"col-12 col-md-3"},Aa={class:"col-12 col-md-3"},qa={key:5,class:"col-12 col-md-3"},_a={key:6,class:"col-12 col-md-3"},za={key:7,class:"col-12 col-md-3"},Oa={key:8,class:"col-12 col-md-3"},Fa={class:"error-msg"},Ba={key:9,class:"col-12 col-md-3"},Ua={class:"col-12 q-mb-md"},ja={class:"col-12 col-md-3"},Na={class:"error-msg"},Qa={class:"col-12 col-md-3"},Ma={key:10,class:"col-12 col-md-3"},Ia={key:11,class:"col-12 col-md-3"},La={class:"col-12 col-md-3"},Ra={key:12,class:"col-12 col-md-3"},Ga={key:13,class:"col-12 col-md-3"},Ka={key:14,class:"col-12 col-md-3"},Ja={class:"col-12 col-md-6"},Ha={class:"error-msg"},ha={class:"col-12 col-md-3"},Wa={key:15,class:"col-12 col-md-3 q-mb-md"},Xa={key:16,class:"col-12 col-md-3"},Ya={class:"error-msg"},Za={class:"col-12 q-mb-md"},xa={class:"col-12 col-md-12 q-mt-md"},ei={class:"row q-col-gutter-x-xs"},oi={class:"col-12 col-md-10 q-mb-md"},ai={class:"col-12 col-md-2"},ii={class:"col-12"},ti={key:17,class:"col-12"},ni={key:18,class:"col-12"};function si(o,e,b,p,l,C){const z=L("gestor-archivos"),k=L("essential-table"),$=L("callout"),O=L("essential-selectable-table"),V=L("tab-layout-filter-tabs2");return d(),Uo(V,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"tab-options":o.tabOptionsTransferenciaProductoEmpleado,tabDefecto:"1",filtrar:o.filtrarTransferenciasProductoEmpleado,ajustarCeldas:!0,permitirEditar:o.puedeEditar,accion1:o.botonImprimir,paginate:""},{formulario:n(()=>[i(Io,{onSubmit:e[45]||(e[45]=jo(()=>{},["prevent"]))},{default:n(()=>{var F,B,S;return[s("div",va,[s("div",ga,[s("div",ya,[i(De,{color:"grey-3",class:"text-green"},{default:n(()=>[c(v("\xA0"+o.tipoTransferencia),1)]),_:1})])]),s("div",Ea,[e[46]||(e[46]=s("small",{class:"text-bold"},"Origen de los productos",-1)),i(Ae)]),o.transferencia.id?(d(),u("div",Pa,[e[47]||(e[47]=s("label",{class:"q-mb-sm block"},"Transferencia N\xB0",-1)),i(w,{modelValue:o.transferencia.id,"onUpdate:modelValue":e[0]||(e[0]=a=>o.transferencia.id=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),o.transferencia.created_at?(d(),u("div",wa,[e[48]||(e[48]=s("label",{class:"q-mb-sm block"},"Fecha solicitud de transferencia",-1)),i(w,{modelValue:o.transferencia.created_at,"onUpdate:modelValue":e[1]||(e[1]=a=>o.transferencia.created_at=a),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),s("div",ka,[e[50]||(e[50]=s("label",{class:"q-mb-sm block"},"Solicitante de transferencia",-1)),i(E,{modelValue:o.transferencia.solicitante,"onUpdate:modelValue":e[2]||(e[2]=a=>o.transferencia.solicitante=a),options:o.listadosAuxiliares.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[49]||(e[49]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),s("div",Va,[e[52]||(e[52]=s("label",{class:"q-mb-sm block"},"Propietario del material",-1)),i(E,{modelValue:o.transferencia.empleado_origen,"onUpdate:modelValue":[e[3]||(e[3]=a=>o.transferencia.empleado_origen=a),e[5]||(e[5]=a=>o.seleccionarEmpleadoOrigen())],options:o.empleadosOrigen,onFilter:o.filtrarEmpleadosOrigen,"transition-show":"scale","transition-hide":"scale",disable:!o.puedeAutorizar,onPopupShow:e[4]||(e[4]=a=>o.ordenarOpcionesEmpleados()),"use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[51]||(e[51]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])]),s("div",Sa,[e[53]||(e[53]=s("label",{class:"block"},"\xA0",-1)),i(qe,{modelValue:o.esParaStock,"onUpdate:modelValue":[e[6]||(e[6]=a=>o.esParaStock=a),e[7]||(e[7]=a=>o.seleccionarEsStock())],label:"Es de stock",disable:o.accion!==o.acciones.nuevo,outlined:"",dense:""},null,8,["modelValue","disable"])]),o.esParaStock&&!o.consultado?(d(),u("div",Da,[e[55]||(e[55]=s("label",{class:"q-mb-sm block"},"Seleccione un cliente para filtrar el material de stock",-1)),i(E,{modelValue:o.transferencia.cliente,"onUpdate:modelValue":[e[9]||(e[9]=a=>o.transferencia.cliente=a),e[10]||(e[10]=a=>o.transferencia.listado_productos=[])],options:o.listadosAuxiliares.clientesMaterialesEmpleado,"transition-show":"scale","transition-hide":"scale",disable:o.accion!==o.acciones.nuevo,"use-input":"","input-debounce":"0","options-dense":"",dense:"",outlined:"","option-label":a=>a.razon_social,"option-value":a=>a.cliente_id,"emit-value":"","map-options":"",error:!!o.v$.cliente.$errors.length,onBlur:o.v$.cliente.$touch},{after:n(()=>[i(_e,{color:"positive",unelevated:"",dense:"",disable:o.accion!==o.acciones.nuevo,onClick:e[8]||(e[8]=a=>o.refrescarListadosEmpleado("clientes"))},{default:n(()=>[i(No,{size:"xs",name:"bi-arrow-clockwise"}),i(Mo,null,{default:n(()=>e[54]||(e[54]=[c("Recargar clientes")])),_:1})]),_:1},8,["disable"])]),error:n(()=>[(d(!0),u(R,null,G(o.v$.cliente.$errors,a=>(d(),u("div",{key:a.$uid},[s("div",Ta,v(a.$message),1)]))),128))]),_:1},8,["modelValue","options","disable","option-label","option-value","error","onBlur"])])):m("",!0),!o.esParaStock&&!o.consultado?(d(),u("div",Ca,[e[57]||(e[57]=s("label",{class:"q-mb-sm block"},"Proyecto origen",-1)),i(E,{modelValue:o.transferencia.proyecto_origen,"onUpdate:modelValue":[e[11]||(e[11]=a=>o.transferencia.proyecto_origen=a),e[12]||(e[12]=a=>o.seleccionarProyectoOrigen())],options:o.proyectos,onFilter:o.filtrarProyectos,"transition-show":"scale",disable:o.accion!==o.acciones.nuevo,"transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",clearable:""},{option:n(a=>[i(g,ze(a.itemProps,{class:"q-my-sm"}),{default:n(()=>[i(y,null,{default:n(()=>[i(q,{class:"text-bold text-primary"},{default:n(()=>[c(v(a.opt.codigo_proyecto),1)]),_:2},1024),i(q,{caption:""},{default:n(()=>[c(v(a.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[56]||(e[56]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])])):m("",!0),o.consultado&&!o.esParaStock?(d(),u("div",$a,[e[58]||(e[58]=s("label",{class:"q-mb-sm block"},"Proyecto de origen",-1)),i(w,{modelValue:o.transferencia.nombre_proyecto_origen,"onUpdate:modelValue":e[13]||(e[13]=a=>o.transferencia.nombre_proyecto_origen=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),Oe(s("div",Aa,[e[60]||(e[60]=s("label",{class:"q-mb-sm block"},"Etapa origen",-1)),i(E,{modelValue:o.transferencia.etapa_origen,"onUpdate:modelValue":[e[14]||(e[14]=a=>o.transferencia.etapa_origen=a),e[15]||(e[15]=a=>o.seleccionarEtapaOrigen())],options:o.etapas,onFilter:o.filtrarEtapas,disable:o.accion!==o.acciones.nuevo,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[59]||(e[59]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])],512),[[Fe,o.transferencia.proyecto_origen&&o.etapas.length&&!o.esParaStock]]),o.consultado&&!o.esParaStock?(d(),u("div",qa,[e[61]||(e[61]=s("label",{class:"q-mb-sm block"},"Etapa de origen",-1)),i(w,{modelValue:o.transferencia.nombre_etapa_origen,"onUpdate:modelValue":e[16]||(e[16]=a=>o.transferencia.nombre_etapa_origen=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),!o.esParaStock&&!o.consultado?(d(),u("div",_a,[e[63]||(e[63]=s("label",{class:"q-mb-sm block"},"Tarea origen",-1)),i(E,{modelValue:o.transferencia.tarea_origen,"onUpdate:modelValue":[e[17]||(e[17]=a=>o.transferencia.tarea_origen=a),e[18]||(e[18]=a=>o.seleccionarTareaOrigen())],options:o.listadosAuxiliares.tareas,"transition-show":"scale","transition-hide":"scale",disable:o.accion!==o.acciones.nuevo,"options-dense":"",hint:"Debe tener al menos una subtarea activa",dense:"",outlined:"","option-label":a=>a.codigo_tarea+" - "+a.titulo,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{option:n(a=>[i(g,Be(Ue(a.itemProps)),{default:n(()=>[i(y,null,{default:n(()=>[i(q,null,{default:n(()=>[c(v(a.opt.codigo_tarea),1)]),_:2},1024),i(q,{caption:""},{default:n(()=>[c(v(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[62]||(e[62]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","option-label","option-value"])])):m("",!0),o.consultado&&!o.esParaStock?(d(),u("div",za,[e[64]||(e[64]=s("label",{class:"q-mb-sm block"},"Tarea de origen",-1)),i(w,{modelValue:o.transferencia.nombre_tarea_origen,"onUpdate:modelValue":e[19]||(e[19]=a=>o.transferencia.nombre_tarea_origen=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),!o.esParaStock&&!o.consultado?(d(),u("div",Oa,[e[65]||(e[65]=s("label",{class:"q-mb-sm block"},"Cliente propietario del material de proyecto/etapa",-1)),i(E,{modelValue:o.transferencia.cliente,"onUpdate:modelValue":[e[20]||(e[20]=a=>o.transferencia.cliente=a),e[21]||(e[21]=a=>o.transferencia.listado_productos=[])],options:o.listadosAuxiliares.clientesMaterialesTarea,"transition-show":"scale","transition-hide":"scale","use-input":"","input-debounce":"0",disable:o.accion!==o.acciones.nuevo,"options-dense":"",dense:"",outlined:"","option-label":a=>a.razon_social,"option-value":a=>a.cliente_id,"emit-value":"","map-options":"",error:!!o.v$.cliente.$errors.length,onBlur:o.v$.cliente.$touch},{error:n(()=>[(d(!0),u(R,null,G(o.v$.cliente.$errors,a=>(d(),u("div",{key:a.$uid},[s("div",Fa,v(a.$message),1)]))),128))]),_:1},8,["modelValue","options","disable","option-label","option-value","error","onBlur"])])):m("",!0),o.consultado?(d(),u("div",Ba,[e[66]||(e[66]=s("label",{class:"q-mb-sm block"},"Cliente propietario del material de proyecto/etapa",-1)),i(w,{modelValue:o.transferencia.nombre_cliente,"onUpdate:modelValue":e[22]||(e[22]=a=>o.transferencia.nombre_cliente=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),s("div",Ua,[e[67]||(e[67]=s("small",{class:"text-bold"},"Destino de los productos",-1)),i(Ae,{color:""})]),s("div",ja,[e[69]||(e[69]=s("label",{class:"q-mb-sm block"},"Seleccione el empleado a transferir",-1)),i(E,{modelValue:o.transferencia.empleado_destino,"onUpdate:modelValue":[e[23]||(e[23]=a=>o.transferencia.empleado_destino=a),e[24]||(e[24]=a=>o.seleccionarEmpleadoDestino())],options:o.empleados,"transition-show":"scale","transition-hide":"scale",disable:o.accion!==o.acciones.nuevo,"options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",error:!!o.v$.empleado_destino.$errors.length,onBlur:o.v$.empleado_destino.$touch,onFilter:o.filtrarEmpleados,onPopupShow:e[25]||(e[25]=a=>o.ordenarEmpleados(o.empleados)),"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[68]||(e[68]=[c(" No hay resultados ")])),_:1})]),_:1})]),error:n(()=>[(d(!0),u(R,null,G(o.v$.empleado_destino.$errors,a=>(d(),u("div",{key:a.$uid},[s("div",Na,v(a.$message),1)]))),128))]),_:1},8,["modelValue","options","disable","error","onBlur","onFilter","option-label","option-value"])]),s("div",Qa,[e[70]||(e[70]=s("label",{class:"block"},"\xA0",-1)),i(qe,{modelValue:o.esDestinoStock,"onUpdate:modelValue":[e[26]||(e[26]=a=>o.esDestinoStock=a),e[27]||(e[27]=a=>o.seleccionarEsDestinoStock())],label:"Destino al stock del empleado a transferir",disable:o.accion!==o.acciones.nuevo,outlined:"",dense:""},null,8,["modelValue","disable"])]),!o.esDestinoStock&&!o.consultado?(d(),u("div",Ma,[e[72]||(e[72]=s("label",{class:"q-mb-sm block"},"Proyecto destino",-1)),i(E,{modelValue:o.transferencia.proyecto_destino,"onUpdate:modelValue":[e[28]||(e[28]=a=>o.transferencia.proyecto_destino=a),e[29]||(e[29]=a=>o.seleccionarProyectoDestino())],options:o.proyectosDestino,onFilter:o.filtrarProyectosDestino,"transition-show":"scale","transition-hide":"scale",disable:o.accion!==o.acciones.nuevo,clearable:"","options-dense":"",dense:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{option:n(a=>[i(g,ze(a.itemProps,{class:"q-my-sm"}),{default:n(()=>[i(y,null,{default:n(()=>[i(q,{class:"text-bold text-primary"},{default:n(()=>[c(v(a.opt.codigo_proyecto),1)]),_:2},1024),i(q,{caption:""},{default:n(()=>[c(v(a.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[71]||(e[71]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])])):m("",!0),o.consultado&&!o.esDestinoStock?(d(),u("div",Ia,[e[73]||(e[73]=s("label",{class:"q-mb-sm block"},"Proyecto de destino",-1)),i(w,{modelValue:o.transferencia.nombre_proyecto_destino,"onUpdate:modelValue":e[30]||(e[30]=a=>o.transferencia.nombre_proyecto_destino=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),Oe(s("div",La,[e[75]||(e[75]=s("label",{class:"q-mb-sm block"},"Etapa destino",-1)),i(E,{modelValue:o.transferencia.etapa_destino,"onUpdate:modelValue":[e[31]||(e[31]=a=>o.transferencia.etapa_destino=a),e[32]||(e[32]=a=>o.seleccionarEtapaDestino())],options:o.etapasDestino,onFilter:o.filtrarEtapasDestino,disable:o.accion!==o.acciones.nuevo,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[74]||(e[74]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])],512),[[Fe,!o.consultado&&o.transferencia.proyecto_destino&&o.etapasDestino.length&&(!o.esParaStock||!o.esDestinoStock)]]),o.consultado&&!o.esDestinoStock?(d(),u("div",Ra,[e[76]||(e[76]=s("label",{class:"q-mb-sm block"},"Etapa de destino",-1)),i(w,{modelValue:o.transferencia.nombre_etapa_destino,"onUpdate:modelValue":e[33]||(e[33]=a=>o.transferencia.nombre_etapa_destino=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),!o.esDestinoStock&&!o.consultado?(d(),u("div",Ga,[e[78]||(e[78]=s("label",{class:"q-mb-sm block"},"Tarea destino",-1)),i(E,{modelValue:o.transferencia.tarea_destino,"onUpdate:modelValue":[e[34]||(e[34]=a=>o.transferencia.tarea_destino=a),e[35]||(e[35]=a=>o.seleccionarTareaDestino())],options:o.tareasDestino,"transition-show":"scale","transition-hide":"scale","options-dense":"",hint:"Debe tener al menos una subtarea activa",onFilter:o.filtrarTareasDestino,clearable:"",dense:"",outlined:"",disable:o.accion!==o.acciones.nuevo,"option-label":a=>a.codigo_tarea+" - "+a.titulo,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":""},{option:n(a=>[i(g,Be(Ue(a.itemProps)),{default:n(()=>[i(y,null,{default:n(()=>[i(q,null,{default:n(()=>[c(v(a.opt.codigo_tarea),1)]),_:2},1024),i(q,{caption:""},{default:n(()=>[c(v(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[77]||(e[77]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","disable","option-label","option-value"])])):m("",!0),o.consultado&&!o.esDestinoStock?(d(),u("div",Ka,[e[79]||(e[79]=s("label",{class:"q-mb-sm block"},"Tarea de destino",-1)),i(w,{modelValue:o.transferencia.nombre_tarea_destino,"onUpdate:modelValue":e[36]||(e[36]=a=>o.transferencia.nombre_tarea_destino=a),disable:"",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])])):m("",!0),s("div",Ja,[e[80]||(e[80]=s("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),i(w,{type:"textarea",autogrow:"",modelValue:o.transferencia.justificacion,"onUpdate:modelValue":e[37]||(e[37]=a=>o.transferencia.justificacion=a),placeholder:"Obligatorio",disable:o.accion!==o.acciones.nuevo,readonly:o.disabled,error:!!o.v$.justificacion.$errors.length,outlined:"",dense:""},{error:n(()=>[(d(!0),u(R,null,G(o.v$.justificacion.$errors,a=>(d(),u("div",{key:a.$uid},[s("div",Ha,v(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","readonly","error"])]),s("div",ha,[e[81]||(e[81]=s("label",{class:"q-mb-sm block"},"Persona que autoriza",-1)),i(E,{modelValue:o.transferencia.autorizador,"onUpdate:modelValue":e[38]||(e[38]=a=>o.transferencia.autorizador=a),options:o.listadosAuxiliares.autorizadores,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.nombres+" "+a.apellidos,"option-value":a=>a.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),o.transferencia.autorizacion?(d(),u("div",Wa,[i(De,{color:"light-green-2",class:"text-positive text-bold q-mb-sm"},{default:n(()=>e[82]||(e[82]=[c("Autorizaci\xF3n")])),_:1}),i(E,{modelValue:o.transferencia.autorizacion,"onUpdate:modelValue":e[39]||(e[39]=a=>o.transferencia.autorizacion=a),options:o.autorizaciones,"transition-show":"jum-up","transition-hide":"jump-down",color:"positive","options-dense":"",dense:"",outlined:"",disable:o.disabled||o.authenticationStore.user.id!==o.transferencia.autorizador&&!o.puedeAutorizar,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{"no-option":n(()=>[i(g,null,{default:n(()=>[i(y,{class:"text-grey"},{default:n(()=>e[83]||(e[83]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","option-value","option-label"])])):m("",!0),((B=(F=o.authenticationStore)==null?void 0:F.user)==null?void 0:B.id)===o.transferencia.per_autoriza?(d(),u("div",Xa,[e[84]||(e[84]=s("label",{class:"q-mb-sm block"},"Observacion",-1)),i(w,{autogrow:"",modelValue:o.transferencia.observacion_aut,"onUpdate:modelValue":e[40]||(e[40]=a=>o.transferencia.observacion_aut=a),placeholder:"Opcional",disable:o.disabled||((S=o.authenticationStore.user)==null?void 0:S.id)!=o.transferencia.per_autoriza_id,error:!!o.v$.observacion_aut.$errors.length,outlined:"",dense:""},{error:n(()=>[(d(!0),u(R,null,G(o.v$.observacion_aut.$errors,a=>(d(),u("div",{key:a.$uid},[s("div",Ya,v(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])])):m("",!0),s("div",Za,[i(z,{ref:"refArchivo",label:"Adjuntar archivos",mixin:o.mixin,disable:o.disabled,listarAlGuardar:!1,"permitir-eliminar":o.accion==o.acciones.nuevo||o.accion==o.acciones.editar,idModelo:o.idTransferencia},{"boton-subir":n(()=>[m("",!0)]),_:1},8,["mixin","disable","permitir-eliminar","idModelo"])]),s("div",xa,[e[87]||(e[87]=s("label",{class:"q-mb-sm block"},[c("Agregar productos"),s("b",null,[s("i",null," *Primero seleccione el origen de los productos")])],-1)),s("div",ei,[s("div",oi,[i(w,{modelValue:o.criterioBusquedaProducto,"onUpdate:modelValue":e[42]||(e[42]=a=>o.criterioBusquedaProducto=a),placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",onKeydown:Qo(o.consultarProductos,["enter"]),onBlur:e[43]||(e[43]=a=>o.criterioBusquedaProducto===""?o.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","onKeydown"])]),s("div",ai,[i(_e,{onClick:e[44]||(e[44]=a=>o.consultarProductos()),icon:"search",unelevated:"",color:"primary",class:"full-width",square:"","no-caps":""},{default:n(()=>e[86]||(e[86]=[c("Buscar")])),_:1})])])]),s("div",ii,[i(k,{titulo:"Productos seleccionados",configuracionColumnas:o.configuracionColumnasProductosSeleccionadosAccion,datos:o.transferencia.listado_productos,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarBotones:!1,accion1:o.botonEditarCantidad,accion2:o.botonEliminar,ajustarCeldas:!0,altoFijo:!1},null,8,["configuracionColumnas","datos","accion1","accion2"])]),o.notificacionSSA?(d(),u("div",ti,[i($,{mensaje:o.notificacionSSA,tipo:"success"},null,8,["mensaje"])])):m("",!0),o.transferencia.listado_productos.length?(d(),u("div",ni,[i($,{mensaje:"La columna Recibido se refiere a la cantidad recibida que ha sido registrada por el empleado receptor de la transferencia.",tipo:"info"})])):m("",!0)])]}),_:1}),i(O,{ref:"refListado","configuracion-columnas":o.configuracionColumnasDetallesModal,datos:o.listadoProductos,"tipo-seleccion":"multiple",onSelected:o.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","tab-options","filtrar","permitirEditar","accion1"])}var pt=Bo(ba,[["render",si]]);export{pt as default};

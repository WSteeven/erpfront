import{d as Z,c as u,f as x,e as oo,q as eo,p as ao,_ as so,t as D,v as l,P,F as r,z as s,be as f,bf as R,y as t,B as C,D as b,I as z,j as I,O as v,x as i,G as y,H as q,K as d,M as ro,N as to,J as c,a5 as lo}from"./index.b8e09611.js";import{Q as V,a as w}from"./QItemSection.ec4cc512.js";import{Q as O,a as L}from"./QSelect.b920278b.js";import{Q as N,a as A,C as j}from"./QPopupProxy.685eacb5.js";import{Q as io}from"./QBtnGroup.7d38eecd.js";import{a as no,Q as M}from"./QTabPanels.1776fc83.js";import{Q as uo}from"./QPage.e6f8825d.js";import{u as mo}from"./index.70965bc7.js";import{r as H}from"./i18n-validators.06abe774.js";import{T as co}from"./TabLayout.45a66130.js";import{E as po,S as fo,k as bo}from"./EssentialTable.23af6cc8.js";import{M as vo}from"./ModalEntidad.54c9ab3a.js";import{G as go}from"./GraficoGenerico.884603b4.js";import{B as ho,P as Co}from"./index.d9139ad0.js";import{C as yo}from"./ContenedorSimpleMixin.4e22246b.js";import{P as qo,a as ko,u as $o,c as Po}from"./prefactura.b7a2ba47.js";import{u as Vo}from"./filtrosListadosGenerales.87fcb144.js";import{C as wo}from"./ClientesPrefacturasController.9bb7d988.js";import{v as Qo}from"./utils.9344cd7e.js";import{o as Bo}from"./graficoGenerico.2759c2ea.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./touch.9135741d.js";import"./index.ea415f98.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTablePagination.ce808cac.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBadge.89898cd2.js";import"./QFile.c79664c6.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./chart.2729d76a.js";import"./entidadAuditable.75a46700.js";var So=Z({components:{TabLayout:co,EssentialTable:po,SelectorImagen:fo,TableView:bo,Bar:ho,Pie:Co,ModalesEntidad:vo,GraficoGenerico:go},setup(){const o=new yo(qo,new ko),{listadosAuxiliares:e}=o.useReferencias(),{cargarVista:Q,obtenerListados:B}=o.useComportamiento(),S=$o(),F="PROVEEDOR",g=u(),h=u(),a=u(),m=u([]),k=u(),J=u(),U=u(),E=u(!1),K=x(()=>p.fecha_inicio&&p.fecha_fin),p=oo({fecha_inicio:"",fecha_fin:"",proveedor:null,empleado:null,todos:!1,tipo:""}),$={grafico:"grafico",listado:"listado"},_=u($.grafico),{clientes:G,filtrarClientes:W}=Vo(e);Q(async()=>{await B({clientes:new wo}),G.value=e.clientes,p.fecha_fin=Qo(eo)});const T=mo({fecha_inicio:{required:H},fecha_fin:{required:H}},p);async function X(){if(await T.value.$validate())try{const n=await S.consultarDashboard(p);g.value=n.cant_prefacturas_creadas,h.value=n.cant_prefacturas_anuladas,a.value=n.todas,k.value=n.graficos,U.value=n,E.value=!(k.value.length>1)}catch(n){console.log(n)}}function Y(n,ae){J.value=n.label,m.value=U.value[n.label.toLowerCase()],_.value=$.listado}return{v$:T,dashboard:p,configuracionColumnas:Po,accionesTabla:ao,cantPrefacturasCreadas:g,cantPrefacturasAnuladas:h,prefacturas:a,prefacturasFiltradas:m,graficos:k,optionsPie:Bo,modoUnaColumna:E,tabs:_,opcionesGrafico:$,mostrarTitulosSeccion:K,PROVEEDOR:F,clientes:G,filtrarClientes:W,consultar:X,clickGrafico:Y}}});const Fo={class:"border-1 text-primary text-bold q-mb-lg"},Uo={class:"row q-col-gutter-sm q-mb-md"},Eo={class:"col-12 col-md-3"},_o={class:"col-12 col-md-3"},Go={class:"row items-center justify-end"},To={class:"error-msg"},Do={class:"col-12 col-md-3"},Ro={class:"row items-center justify-end"},zo={class:"error-msg"},Io={key:0,class:"col-12 col-md-3"},Oo={class:"error-msg"},Lo={class:"row q-col-gutter-sm q-mb-lg"},No={class:"col-12 col-md-12 q-mb-lg"},Ao={class:"row q-col-gutter-xs"},jo={key:0,class:"col-6"},Mo={class:"text-h3 q-mb-md"},Ho={key:1,class:"col-6 col-md-3"},Jo={class:"text-h3 text-primary q-mb-md"},Ko={key:2,class:"col-6 col-md-3"},Wo={class:"text-h3 q-mb-md"},Xo={class:"q-mb-xl q-gutter-y-md column items-center"},Yo={class:"text-subtitle2 q-mb-lg"},Zo={class:"row q-col-gutter-sm q-py-md q-mb-lg"},xo={class:"col-12"};function oe(o,e,Q,B,S,F){const g=D("grafico-generico"),h=D("essential-table");return l(),P(uo,{padding:""},{default:r(()=>[s(f,{class:"q-mb-md rounded no-border custom-shadow"},{default:r(()=>[s(R,null,{default:r(()=>[t("div",Fo,[s(C,{name:"bi-graph-up-arrow",class:"q-mr-sm"}),e[14]||(e[14]=b(" An\xE1lisis de datos: Prefacturas "))]),t("div",Uo,[t("div",Eo,[e[16]||(e[16]=t("label",{class:"q-mb-sm block"},"Seleccione el cliente",-1)),s(O,{modelValue:o.dashboard.cliente,"onUpdate:modelValue":[e[0]||(e[0]=a=>o.dashboard.cliente=a),e[1]||(e[1]=a=>o.consultar())],options:o.clientes,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",clearable:"","option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":r(()=>[s(V,null,{default:r(()=>[s(w,{class:"text-grey"},{default:r(()=>e[15]||(e[15]=[b(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),t("div",_o,[e[17]||(e[17]=t("label",{class:"q-mb-sm block"},"Fecha de inicio",-1)),s(z,{modelValue:o.dashboard.fecha_inicio,"onUpdate:modelValue":e[4]||(e[4]=a=>o.dashboard.fecha_inicio=a),error:!!o.v$.fecha_inicio.$errors.length,onBlur:o.v$.fecha_inicio.$touch,outlined:"",dense:""},{append:r(()=>[s(C,{name:"event",class:"cursor-pointer"},{default:r(()=>[s(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[s(A,{modelValue:o.dashboard.fecha_inicio,"onUpdate:modelValue":[e[2]||(e[2]=a=>o.dashboard.fecha_inicio=a),e[3]||(e[3]=a=>o.consultar())],mask:o.maskFecha,"today-btn":""},{default:r(()=>[t("div",Go,[I(s(v,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:r(()=>[(l(!0),i(y,null,q(o.v$.fecha_inicio.$errors,a=>(l(),i("div",{key:a.$uid},[t("div",To,d(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])]),t("div",Do,[e[18]||(e[18]=t("label",{class:"q-mb-sm block"},"Fecha de fin",-1)),s(z,{modelValue:o.dashboard.fecha_fin,"onUpdate:modelValue":e[7]||(e[7]=a=>o.dashboard.fecha_fin=a),error:!!o.v$.fecha_fin.$errors.length,onBlur:o.v$.fecha_fin.$touch,outlined:"",dense:""},{append:r(()=>[s(C,{name:"event",class:"cursor-pointer"},{default:r(()=>[s(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[s(A,{modelValue:o.dashboard.fecha_fin,"onUpdate:modelValue":[e[5]||(e[5]=a=>o.dashboard.fecha_fin=a),e[6]||(e[6]=a=>o.consultar())],mask:o.maskFecha,"today-btn":""},{default:r(()=>[t("div",Ro,[I(s(v,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:r(()=>[(l(!0),i(y,null,q(o.v$.fecha_fin.$errors,a=>(l(),i("div",{key:a.$uid},[t("div",zo,d(a.$message),1)]))),128))]),_:1},8,["modelValue","error","onBlur"])]),o.dashboard.tipo==o.PROVEEDOR?(l(),i("div",Io,[e[20]||(e[20]=t("label",{class:"q-mb-sm block"},"Seleccione un proveedor",-1)),s(O,{modelValue:o.dashboard.proveedor,"onUpdate:modelValue":[e[8]||(e[8]=a=>o.dashboard.proveedor=a),o.consultar],options:o.proveedores,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",clearable:"","use-input":"","input-debounce":"0",error:!!o.v$.proveedor.$errors.length,onBlur:o.v$.proveedor.$touch,onFilter:o.filtrarProveedores,onPopupShow:e[9]||(e[9]=a=>o.ordenarLista(o.proveedores,"razon_social")),"option-label":a=>a.razon_social,"option-value":a=>a.id,"emit-value":"","map-options":""},{option:r(a=>[s(V,ro(to(a.itemProps)),{default:r(()=>[s(w,null,{default:r(()=>[s(L,null,{default:r(()=>[b(d(a.opt.razon_social),1)]),_:2},1024),s(L,{caption:""},{default:r(()=>[b(d(a.opt.nombre_comercial)+" - Sucursal: "+d(a.opt.sucursal||a.opt.direccion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[s(V,null,{default:r(()=>[s(w,{class:"text-grey"},{default:r(()=>e[19]||(e[19]=[b(" No hay resultados ")])),_:1})]),_:1})]),error:r(()=>[(l(!0),i(y,null,q(o.v$.proveedor.$errors,a=>(l(),i("div",{key:a.$uid},[t("div",Oo,d(a.$message),1)]))),128))]),_:1},8,["modelValue","options","error","onBlur","onFilter","onUpdate:modelValue","option-label","option-value"])])):c("",!0)])]),_:1})]),_:1}),s(f,{class:"q-mb-md rounded no-border custom-shadow"},{default:r(()=>[e[24]||(e[24]=t("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Informaci\xF3n de las prefacturas ",-1)),s(R,null,{default:r(()=>{var a;return[t("div",Lo,[t("div",No,[t("div",Ao,[((a=o.prefacturas)==null?void 0:a.length)>=0?(l(),i("div",jo,[s(f,{class:"rounded-card text-white no-border q-pa-md text-center full-height cursor-pointer bg-primary"},{default:r(()=>{var m;return[t("div",Mo,d((m=o.prefacturas)==null?void 0:m.length),1),e[21]||(e[21]=t("div",{class:"text-bold"},"Cantidad de prefacturas totales",-1))]}),_:1})])):c("",!0),o.cantPrefacturasCreadas>=0?(l(),i("div",Ho,[s(f,{class:"rounded-card q-pa-md text-center full-height"},{default:r(()=>[t("div",Jo,d(o.cantPrefacturasCreadas),1),e[22]||(e[22]=t("div",null,"Cantidad de prefacturas creadas",-1))]),_:1})])):c("",!0),o.cantPrefacturasAnuladas>=0?(l(),i("div",Ko,[s(f,{class:"rounded-card q-pa-md text-center full-height bg-negative text-white"},{default:r(()=>[t("div",Wo,d(o.cantPrefacturasAnuladas),1),e[23]||(e[23]=t("div",null,"Cantidad de prefacturas anuladas",-1))]),_:1})])):c("",!0)])])])]}),_:1})]),_:1}),s(f,{class:"q-mb-md rounded no-border custom-shadow"},{default:r(()=>[e[26]||(e[26]=t("div",{class:"row text-bold text-primary q-pa-md rounded items-center q-mb-md"}," Gr\xE1ficos estad\xEDsticos de Prefacturas ",-1)),s(no,{modelValue:o.tabs,"onUpdate:modelValue":e[13]||(e[13]=a=>o.tabs=a),animated:"","transition-prev":"scale","transition-next":"scale","keep-alive":""},{default:r(()=>[s(M,{name:o.opcionesGrafico.grafico},{default:r(()=>[t("div",Xo,[s(io,{push:""},{default:r(()=>[s(v,{push:"",label:"Una columna",icon:"bi-list","no-caps":"",onClick:e[10]||(e[10]=()=>o.modoUnaColumna=!0)}),s(v,{push:"",label:"Dos columnas",icon:"bi-grid","no-caps":"",onClick:e[11]||(e[11]=()=>o.modoUnaColumna=!1)})]),_:1})]),o.mostrarTitulosSeccion?(l(),i("div",{key:0,class:lo(["q-col-gutter-y-xl q-col-gutter-x-xs q-mb-xl",{row:!o.modoUnaColumna,column:o.modoUnaColumna}])},[(l(!0),i(y,null,q(o.graficos,a=>(l(),i("div",{class:"col-12 col-md-6 text-center",key:a.id},[t("div",Yo,d(a.encabezado),1),t("div",null,[a?(l(),P(g,{key:0,data:a,options:o.optionsPie,onClick:m=>o.clickGrafico(m,a.identificador)},null,8,["data","options","onClick"])):c("",!0)])]))),128))],2)):c("",!0)]),_:1},8,["name"]),s(M,{name:o.opcionesGrafico.listado},{default:r(()=>[s(v,{color:"primary",onClick:e[12]||(e[12]=a=>o.tabs=o.opcionesGrafico.grafico),glossy:"","no-caps":"",rounded:"",unelevated:"",class:"q-mx-auto block"},{default:r(()=>[s(C,{name:"bi-arrow-left"}),e[25]||(e[25]=b(" Regresar al gr\xE1fico"))]),_:1}),t("div",Zo,[t("div",xo,[o.prefacturasFiltradas.length?(l(),P(h,{key:0,titulo:"Ordenes de Compra",configuracionColumnas:[...o.configuracionColumnas,o.accionesTabla],datos:o.prefacturasFiltradas,permitirConsultar:!1,permitirEliminar:!1,permitirEditar:!1,mostrarBotones:!1,"alto-fijo":!1,ajustarCeldas:!0},null,8,["configuracionColumnas","datos"])):c("",!0)])])]),_:1},8,["name"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}var Je=so(So,[["render",oe]]);export{Je as default};

var Ze=Object.defineProperty;var _e=(e,o,u)=>o in e?Ze(e,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[o]=u;var n=(e,o,u)=>(_e(e,typeof o!="symbol"?o+"":o,u),u);import{Q as C,a as V}from"./QItemSection.ec4cc512.js";import{Q as k,a as W}from"./QSelect.b920278b.js";import{by as xe,s as Ve,c as g,l as eo,e as oo,A as ao,bG as io,d as ro,R as so,bd as lo,m as ve,u as to,ct as no,E as uo,bz as q,a2 as po,p as co,q as mo,dz as fo,S as B,_ as bo,t as U,v as m,x as b,z as s,F as l,a6 as go,y as t,D as c,J as z,I as T,B as ae,j as vo,O as ye,G as I,H as Q,K as E,bg as yo,M as ho,N as wo,P as Po,a4 as Co}from"./index.b8e09611.js";import{Q as Vo,a as Eo,C as $o}from"./QPopupProxy.685eacb5.js";import{Q as So}from"./QChip.f8f308fa.js";import{a as he}from"./QToolbar.afeb6de9.js";import{Q as ko}from"./QForm.eab79b48.js";import{c as qo}from"./configuracionColumnasProductos.9df91570.js";import{c as ie}from"./configuracionColumnasItemsPreingreso.b2485163.js";import{r as L,a as we}from"./i18n-validators.06abe774.js";import{u as zo}from"./index.70965bc7.js";import{T as To}from"./TabLayoutFilterTabs2.6bbaa932.js";import{T as Lo}from"./TabLayoutFilterTabs.95270e40.js";import{E as Ao,S as Fo}from"./EssentialTable.23af6cc8.js";import{E as Bo}from"./EssentialSelectableTable.ac03bc90.js";import{M as Io}from"./ModalEntidad.54c9ab3a.js";import{E as Do}from"./EssentialPopupEditableTable.ba049a88.js";import{V as No}from"./VisorImagen.29457a6f.js";import{G as Uo}from"./GestorArchivos.801d8a9f.js";import{C as Qo}from"./ContenedorSimpleMixin.4e22246b.js";import{E as Ee}from"./entidadAuditable.75a46700.js";import{u as Mo}from"./selector.e0ee4903.js";import{C as $e,A as Oo,u as jo,S as Ro,R as Pe,s as Go}from"./utils.9344cd7e.js";import{U as Jo}from"./UnidadMedidaController.afa532ef.js";import{u as Ho}from"./filtrosListadosGenerales.87fcb144.js";import{C as Ko}from"./ClienteController.6128473d.js";import{A as Wo}from"./ArchivoController.b6daf863.js";import{P as Ce}from"./ProyectoController.cb4f7c6c.js";import{T as X}from"./TareaController.490ce98d.js";import{E as Xo}from"./EtapaController.7c12ac90.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./index.ea415f98.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPage.e6f8825d.js";import"./EssentialTableTabs.03c27e34.js";import"./QBadge.89898cd2.js";import"./EssentialTablePagination.ce808cac.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QBtnGroup.7d38eecd.js";import"./buttonSubmits.f2d72caa.js";import"./QFile.c79664c6.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./QUploader.16c4ab83.js";import"./QCircularProgress.c6e924d2.js";import"./configuracionColumnasArchivoSubtarea.215f4ffd.js";import"./SelectorController.efbca5b9.js";const Yo=[{name:"id",field:"id",label:"N\xB0",align:"left",sortable:!0},{name:"fecha",field:"fecha",label:"Fecha",align:"left",sortable:!0,style:"width:100px"},{name:"num_guia",field:"num_guia",label:"N\xB0 Gu\xEDa",align:"left",sortable:!0,style:"max-width:300px; overflow: auto;"},{name:"responsable",field:"responsable",label:"Responsable",style:"max-width:250px; overflow: auto;",align:"left",sortable:!0},{name:"autorizador",field:"autorizador",label:"Autoriza",align:"left",sortable:!0},{name:"coordinador",field:"coordinador",label:"Coordinador",align:"left",sortable:!0},{name:"cliente",field:"cliente",label:"Cliente",style:"max-width:250px; overflow: auto;",align:"left",sortable:!0},{name:"tarea",field:"tarea",label:"Tarea",align:"left",sortable:!0},{name:"autorizacion",field:"autorizacion",label:"Estado",align:"left",sortable:!0}],Zo=[{name:"producto",field:"producto",label:"Producto",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",align:"left",sortable:!0},{name:"es_generico",field:"es_generico",label:"\xBFGen\xE9rico?",align:"left",sortable:!0},{name:"computadora",field:"computadora",label:"Caracteristicas",align:"left",sortable:!0},{name:"fibra",field:"fibra",label:"Fibra",align:"left",sortable:!0},{name:"adicionales",field:"adicionales",label:"Campos adicionales",align:"left",sortable:!0}];class re extends Ee{constructor(){super();n(this,"listadoProductos");n(this,"num_guia");n(this,"cliente");n(this,"cuadrilla");n(this,"tarea");n(this,"observacion");n(this,"autorizacion");n(this,"observacion_aut");n(this,"autorizador");n(this,"solicitante");n(this,"responsable");n(this,"responsable_id");n(this,"coordinador");n(this,"courier");n(this,"fecha");n(this,"proyecto");n(this,"etapa");this.cliente=null,this.cuadrilla=null,this.num_guia=null,this.observacion=null,this.tarea=null,this.autorizador=null,this.fecha=null,this.responsable=null,this.solicitante=null,this.responsable_id=null,this.coordinador=null,this.courier=null,this.autorizacion=null,this.observacion_aut=null,this.listadoProductos=[],this.proyecto=null,this.etapa=null}}class _o extends xe{constructor(){super(Ve.preingresos)}}function xo(e,o){const u=g(),i=g([]),$=g(),y={refListadoSeleccionable:u,listadoSeleccionable:i,endpoint:o,limpiar:()=>{e.id=null,$.value=null},seleccionar:P=>{e.listadoProductos=[...e.listadoProductos,...P],e.listadoProductos.forEach(f=>{f.id=$e(e.listadoProductos)+1})}},d=Mo(y);return{refListadoSeleccionable:u,listado:i,listar:P=>d.listar($.value,P),limpiar:()=>y.limpiar(),seleccionar:P=>{P.forEach(f=>{f.cantidad=1,f.producto=f.producto,f.descripcion=f.descripcion,f.condicion="NUEVO",f.serial="",f.punta_inicial="",f.punta_final=""}),y.seleccionar(P)},criterioBusqueda:$}}class ea extends Ee{constructor(){super();n(this,"preingreso");n(this,"producto");n(this,"descripcion");n(this,"descripcion_original");n(this,"cantidad");n(this,"unidad_medida");n(this,"serial");n(this,"codigo_bobina");n(this,"punta_inicial");n(this,"punta_final");n(this,"fotografia");n(this,"condicion");n(this,"nombre_alternativo");n(this,"es_generico");this.preingreso=null,this.cantidad=null,this.descripcion=null,this.descripcion_original=null,this.producto=null,this.unidad_medida=null,this.serial=null,this.codigo_bobina=null,this.punta_final=null,this.punta_inicial=null,this.fotografia=null,this.condicion=null,this.nombre_alternativo=null,this.es_generico=!1}}class oa{constructor(o,u){n(this,"preingreso");n(this,"refArchivo");this.preingreso=o,this.refArchivo=u}async validar(){if(this.preingreso.listadoProductos.length==0)throw new Error("Debe agregar al menos un item al listado");if(!this.preingreso.proyecto&&this.preingreso.listadoProductos.some(o=>o.fotografia==null||o.fotografia==null))throw new Error("Debe ingresar una fotograf\xEDa en cada elemento del listado");if(this.refArchivo.value.refGestor==null){if(this.refArchivo.value.listadoArchivos.length<1)throw new Error("Debes adjuntar al menos un archivo")}else if(this.refArchivo.value.cantElementos===0&&this.refArchivo.value.refGestor.files.length<1&&this.refArchivo.value.listadoArchivos.length<1)throw new Error("Se requiere al menos un archivo con la gu\xEDa del material recibido");return!0}}const aa=eo("preingreso",()=>{const e=oo(new re),o=new re,u=g();async function i(){const $=ao.getInstance(),y=io.URL_BASE+"/"+$.getEndpoint(Ve.preingresos)+"/imprimir/"+u.value,d="preingreso_"+u.value+"_"+Date.now();await Oo(y,"GET","blob","pdf",d)}return{preingreso:e,preingresoReset:o,idPreingreso:u,imprimirPdf:i}});var ia=ro({components:{TabLayoutFilterTabs:Lo,TabLayoutFilterTabs2:To,EssentialSelectableTable:Bo,EssentialTable:Ao,EssentialPopupEditableTable:Do,ModalesEntidad:Io,SelectorImagen:Fo,VisorImagen:No,GestorArchivos:Uo},emits:["actualizar","fila-modificada","cargado"],setup(e,{emit:o}){const u=new Qo(re,new _o,new Wo),{entidad:i,disabled:$,accion:y,listadosAuxiliares:d}=u.useReferencias(),{setValidador:M,obtenerListados:O,cargarVista:j,listar:P}=u.useComportamiento(),{onReestablecer:f,onConsultado:R,onGuardado:a,onModificado:Se,onBeforeGuardar:ke}=u.useHooks(),{confirmar:qe}=so(),se=g(),le=g(!1),Y=g(!1),te=g(),D=g(),Z=g();lo().setQuasar(ve()),jo().setQuasar(ve());const h=to(),ne=aa(),S=new Ro,{refListadoSeleccionable:ze,criterioBusqueda:Te,listado:Le,listar:Ae,limpiar:Fe,seleccionar:Be}=xo(i,"detalles_materiales"),{empleados:de,filtrarEmpleados:Ie,clientes:ue,filtrarClientes:De,proyectos:_,filtrarProyectos:Ne,etapas:A,filtrarEtapas:Ue,tareas:F,filtrarTareas:Qe}=Ho(d),G=g(!1),Me=g(),x=g([]),pe=g([]),N=g([]),J=g([]);h.esCoordinador,j(async()=>{fe(),await O({etapas:[],condiciones:new no,unidades_medidas:new Jo,empleados:{controller:new uo,params:{estado:1}},proyectos:{controller:new Ce,params:{empleado_id:i.responsable,campos:"id,nombre,codigo_proyecto,coordinador_id,cliente_id,etapas",finalizado:0}},tareas:{controller:new X,params:{activas_empleado:1,empleado_id:i.responsable,finalizado:0,proyecto_id:i.proyecto}},clientes:{controller:new Ko,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}}}),_.value=d.proyectos,de.value=d.empleados,(h.esCoordinador||h.esJefeTecnico||h.esSupervisorCampo)&&(d.tecnicos=await Pe(d.empleados,[B.tecnico,B.tecnico_lider])),d.coordinadores=await Pe(d.empleados,[B.jefe_tecnico,B.supervisor,B.coordinador,B.fiscalizador]),N.value=d.coordinadores,J.value=d.tecnicos,ue.value=d.clientes,ie.find(r=>r.field==="unidad_medida").options=d.unidades_medidas.map(r=>({label:r.nombre})),ie.find(r=>r.field==="condicion").options=d.condiciones.map(r=>({label:r.nombre})),le.value=!0}),f(()=>{G.value=!1,fe(),D.value.limpiarListado()}),R(()=>{setTimeout(()=>{D.value.listarArchivosAlmacenados(i.id)},1),y.value===q.editar&&h.user.id===i.responsable_id?G.value=!1:G.value=!0,be(!1)}),Se(r=>{Z.value=r,setTimeout(()=>{me()},1)}),ke(()=>{}),a(r=>{Z.value=r,setTimeout(()=>{me()},1)});const Oe={fecha:{required:L},cuadrilla:{required:L},num_guia:{required:L},coordinador:{required:L},courier:{required:L},observacion:{required:L},cliente:{required:L},etapa:{requiredIf:we(()=>{if(A.value)return A.value.length&&i.proyecto})},tarea:{requiredIf:we(()=>i.etapa&&F.value.length)}},ce=zo(Oe,i);M(ce.value);const je=new oa(i,D);u.agregarValidaciones(je);async function me(){await D.value.subir()}function Re(r){se.value=r,r=="1"?Y.value=!0:Y.value=!1,P({autorizacion_id:r,responsable_id:h.user.id})}function Ge({posicion:r}){qe("\xBFEst\xE1 seguro de continuar?",()=>i.listadoProductos.splice(r,1))}function fe(){i.solicitante=h.user.id,i.responsable=h.user.id,i.autorizacion=1}function H(r=!1,p=!1){y.value==q.nuevo&&(r&&(i.etapa=null),p&&(i.tarea=null))}async function ee(r,p){if(S.activar(),i.proyecto){H(r,p);const v=d.proyectos.filter(K=>K.id===i.proyecto)[0];v&&(i.cliente=v.cliente_id,i.coordinador=v.coordinador_id);const w=await new Xo().listar({etapas_empleado:1,empleado_id:i.responsable,proyecto_id:i.proyecto});if(x.value=w.result,w.result.length<1)await oe(null,!1);else{const K=await new X().listar({activas_empleado:1,proyecto_id:i.proyecto,empleado_id:i.responsable,campos:"id,codigo_tarea,titulo",finalizado:0});d.tareas=K.result,F.value=K.result}d.etapas=x.value,A.value=x.value}else A.value=[],H(!0,!0),await oe(null,!1);S.desactivar()}async function oe(r,p=!0){S.activar(),await He(r),H(!1,p),p&&(i.tarea=null);const v=await new X().listar({activas_empleado:1,proyecto_id:i.proyecto,etapa_id:r,empleado_id:i.responsable,campos:"id,codigo_tarea,titulo",finalizado:0});d.tareas=v.result,F.value=v.result,S.desactivar()}async function Je(){const r=F.value.filter(p=>p.id==i.tarea)[0];r&&(i.proyecto==null&&(i.proyecto=r.proyecto_id,await ee(!0,!0)),i.etapa==null&&(i.etapa=r.etapa_id),i.cliente==null&&(i.cliente=r.cliente_id),i.coordinador==null&&(i.coordinador=r.coordinador_id),i.tarea=r.id)}async function He(r){if(r!=null){const p=A.value.filter(w=>w.id==r)[0],v=N.value.filter(w=>w.id==p.supervisor_id)[0];v&&(i.coordinador=v.id)}}async function be(r=!0){if(r&&(i.proyecto=null),H(!0,!0),S.activar(),i.responsable){const p=await new Ce().listar({empleado_id:i.responsable,finalizado:0});d.proyectos=p.result,_.value=p.result,await ee(!1,!1),await ge()}S.desactivar()}async function ge(){if(S.activar(),i.responsable){const r=await new X().listar({activas_empleado:1,empleado_id:i.responsable,finalizado:0,proyecto_id:i.proyecto,etapa_id:i.etapa});d.tareas=r.result,F.value=r.result}S.desactivar()}const Ke={titulo:"Ver fotograf\xEDa",icono:"bi-image-fill",color:"secondary",visible:({entidad:r})=>r.fotografia,accion:async({entidad:r})=>{te.value.abrir(r.fotografia)}},We={titulo:"Eliminar",icono:"bi-trash",color:"negative",accion:({posicion:r})=>{Ge({posicion:r})},visible:()=>(y.value==q.nuevo||y.value==q.editar)&&(i.responsable==h.user.id||i.solicitante==h.user.id||i.coordinador==h.user.id)},Xe={titulo:"Agregar \xEDtem",icono:"bi-arrow-bar-down",color:"positive",tooltip:"Agregar elemento",accion:()=>{const r=new ea;r.id=i.listadoProductos.length?$e(i.listadoProductos)+1:1,r.unidad_medida=1,i.listadoProductos.push(r),o("actualizar",i.listadoProductos)},visible:()=>y.value===q.nuevo||y.value===q.editar&&i.responsable===h.user.id},Ye={titulo:"Imprimir",color:"secondary",icono:"bi-printer",accion:async({entidad:r})=>{ne.idPreingreso=r.id,await ne.imprimirPdf()},visible:()=>se.value>1};return pe.value=JSON.parse(po.getItem("autorizaciones").toString()),{refItems:Me,refVisorImagen:te,mixin:u,preingreso:i,disabled:$,accion:y,v$:ce,acciones:q,configuracionColumnas:Yo,configuracionColumnasItemPreingreso:ie,configuracionColumnasProductos:qo,configuracionColumnasDetallesProductos:Zo,puedeEditar:Y,componenteCargado:le,accionesTabla:co,store:h,soloLectura:G,refArchivo:D,idPreingreso:Z,maskFecha:mo,coordinadores:N,tecnicos:J,autorizaciones:pe,clientes:ue,filtrarClientes:De,empleados:de,filtrarEmpleados:Ie,refListado:ze,criterioBusquedaProducto:Te,listadoProductos:Le,listarProductos:Ae,limpiarProducto:Fe,seleccionarProducto:Be,tabOptionsPreingresoMateriales:fo,btnVerFotografia:Ke,btnEliminarFila:We,btnImprimir:Ye,btnAddRow:Xe,filtrarPreingresos:Re,ordenarLista:Go,proyectos:_,filtrarProyectos:Ne,etapas:A,filtrarEtapas:Ue,tareas:F,filtrarTareas:Qe,obtenerEtapasProyecto:ee,obtenerTareasTecnico:ge,obtenerTareasEtapa:oe,obtenerProyectosTareasTecnico:be,obtenerDatosTareaSeleccionada:Je,filtrarCoordinadores(r,p){if(r===""){p(()=>N.value=d.coordinadores);return}p(()=>{const v=r.toLowerCase();N.value=d.coordinadores.filter(w=>w.nombres.toLowerCase().indexOf(v)>-1||w.apellidos.toLowerCase().indexOf(v)>-1)})},filtrarTecnicos(r,p){if(r===""){p(()=>J.value=d.tecnicos);return}p(()=>{const v=r.toLowerCase();J.value=d.tecnicos.filter(w=>w.nombres.toLowerCase().indexOf(v)>-1||w.apellidos.toLowerCase().indexOf(v)>-1)})}}}});const ra={class:"row q-col-gutter-sm q-py-md"},sa={class:"col-12 col-md-3"},la={key:0,class:"col-12 col-md-3"},ta={class:"col-12 col-md-3"},na={class:"row items-center justify-end"},da={class:"error-msg"},ua={class:"col-12 col-md-3"},pa={key:1,class:"col-12 col-md-3 q-mb-md q-pt-none"},ca={key:2,class:"col-12 col-md-3"},ma={class:"col-12 col-md-3"},fa={class:"q-mb-sm block"},ba={class:"error-msg"},ga={key:3,class:"col-12 col-md-3"},va={key:4,class:"col-12 col-md-3"},ya={class:"error-msg"},ha={class:"col-12 col-md-3"},wa={class:"q-mb-sm block"},Pa={class:"error-msg"},Ca={class:"col-12 col-md-3"},Va={class:"col-12 col-md-3"},Ea={class:"error-msg"},$a={class:"col-12 col-md-3"},Sa={class:"col-12 col-md-6"},ka={class:"col-12 q-mb-md"},qa={class:"col-12 col-md-12"},za={class:"row q-col-gutter-x-xs"},Ta={class:"col-12 col-md-10 q-mb-md"},La={class:"col-12 col-md-2"},Aa={class:"col-12"};function Fa(e,o,u,i,$,y){const d=U("gestor-archivos"),M=U("essential-popup-editable-table"),O=U("essential-selectable-table"),j=U("tab-layout-filter-tabs2"),P=U("visor-imagen");return m(),b(I,null,[s(j,{mixin:e.mixin,ajustarCeldas:!0,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Registro de materiales recibidos al cliente","tab-options":e.tabOptionsPreingresoMateriales,tabDefecto:"1",filtrar:e.filtrarPreingresos,permitirEditar:e.puedeEditar,permitirEliminar:!1,accion1:e.btnImprimir},{formulario:l(()=>[s(ko,{onSubmit:o[24]||(o[24]=go(()=>{},["prevent"]))},{default:l(()=>{var f,R;return[t("div",ra,[t("div",sa,[o[26]||(o[26]=t("label",{class:"q-mb-sm block"},"Solicitante",-1)),s(k,{modelValue:e.preingreso.solicitante,"onUpdate:modelValue":o[0]||(o[0]=a=>e.preingreso.solicitante=a),options:e.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:"","option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[25]||(o[25]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","option-value"])]),e.store.esCoordinador||e.store.esCoordinadorBackup||e.store.esJefeTecnico||e.store.esSupervisorCampo||e.store.esFiscalizador?(m(),b("div",la,[o[28]||(o[28]=t("label",{class:"q-mb-sm block"},"Responsable",-1)),s(k,{modelValue:e.preingreso.responsable,"onUpdate:modelValue":[o[1]||(o[1]=a=>e.preingreso.responsable=a),e.obtenerProyectosTareasTecnico],options:e.tecnicos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.soloLectura,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"use-input":"","input-debounce":"0",onFilter:e.filtrarTecnicos,"emit-value":"","map-options":""},{"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[27]||(o[27]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","option-label","option-value","onFilter","onUpdate:modelValue"])])):z("",!0),t("div",ta,[o[29]||(o[29]=t("label",{class:"q-mb-sm block"},"Fecha de recepci\xF3n de los materiales",-1)),s(T,{modelValue:e.preingreso.fecha,"onUpdate:modelValue":o[3]||(o[3]=a=>e.preingreso.fecha=a),disable:e.disabled||e.soloLectura,outlined:"",dense:"",error:!!e.v$.fecha.$errors.length},{append:l(()=>[s(ae,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(Vo,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(Eo,{modelValue:e.preingreso.fecha,"onUpdate:modelValue":o[2]||(o[2]=a=>e.preingreso.fecha=a),mask:e.maskFecha,"today-btn":""},{default:l(()=>[t("div",na,[vo(s(ye,{label:"Cerrar",color:"primary",flat:""},null,512),[[$o]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:l(()=>[(m(!0),b(I,null,Q(e.v$.fecha.$errors,a=>(m(),b("div",{key:a.$uid},[t("div",da,E(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])]),t("div",ua,[o[30]||(o[30]=t("label",{class:"q-mb-sm block"},"Cuadrilla",-1)),s(T,{modelValue:e.preingreso.cuadrilla,"onUpdate:modelValue":o[4]||(o[4]=a=>e.preingreso.cuadrilla=a),disable:e.disabled||e.soloLectura,error:!!e.v$.cuadrilla.$errors.length,outlined:"",dense:""},null,8,["modelValue","disable","error"])]),e.preingreso.autorizacion?(m(),b("div",pa,[s(So,{color:"light-green-2",class:"text-positive text-bold q-mb-xs"},{default:l(()=>o[31]||(o[31]=[c("Autorizaci\xF3n")])),_:1}),s(k,{modelValue:e.preingreso.autorizacion,"onUpdate:modelValue":o[5]||(o[5]=a=>e.preingreso.autorizacion=a),options:e.autorizaciones,"transition-show":"jum-up","transition-hide":"jump-down",color:"positive","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.preingreso.autorizador!==e.store.user.id,"option-value":a=>a.id,"option-label":a=>a.nombre,"emit-value":"","map-options":""},{"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[32]||(o[32]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","option-value","option-label"])])):z("",!0),e.preingreso.autorizador===e.store.user.id||e.preingreso.observacion_aut?(m(),b("div",ca,[o[33]||(o[33]=t("label",{class:"q-mb-sm block"},"Observacion",-1)),s(T,{autogrow:"",modelValue:e.preingreso.observacion_aut,"onUpdate:modelValue":o[6]||(o[6]=a=>e.preingreso.observacion_aut=a),placeholder:"Opcional",disable:e.disabled||e.preingreso.autorizador!==e.store.user.id,outlined:"",dense:""},null,8,["modelValue","disable"])])):z("",!0),t("div",ma,[t("label",fa,[o[35]||(o[35]=c("N\xB0 Gu\xEDa/Documento ")),s(ae,{name:"info",color:"grey"}),s(he,{class:"bg-dark"},{default:l(()=>o[34]||(o[34]=[c("NA en caso de no haber gu\xEDa")])),_:1})]),s(T,{modelValue:e.preingreso.num_guia,"onUpdate:modelValue":o[7]||(o[7]=a=>e.preingreso.num_guia=a),disable:e.disabled||e.soloLectura,outlined:"",dense:"",error:!!e.v$.num_guia.$errors.length},{error:l(()=>[(m(!0),b(I,null,Q(e.v$.num_guia.$errors,a=>(m(),b("div",{key:a.$uid},[t("div",ba,E(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])]),((f=e.proyectos)==null?void 0:f.length)&&e.accion==e.acciones.nuevo||e.preingreso.proyecto?(m(),b("div",ga,[o[37]||(o[37]=t("label",{class:"q-mb-sm block"},"Proyecto",-1)),s(k,{modelValue:e.preingreso.proyecto,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.preingreso.proyecto=a),o[9]||(o[9]=a=>e.obtenerEtapasProyecto(!0,!0))],options:e.proyectos,onFilter:e.filtrarProyectos,"transition-show":"scale","transition-hide":"scale",hint:"Opcional","options-dense":"",dense:"",outlined:"",clearable:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",disable:e.disabled||e.soloLectura},{option:l(a=>[s(C,yo(a.itemProps,{class:"q-my-sm"}),{default:l(()=>[s(V,null,{default:l(()=>[s(W,{class:"text-bold text-primary"},{default:l(()=>[c(E(a.opt.codigo_proyecto),1)]),_:2},1024),s(W,{caption:""},{default:l(()=>[c(E(a.opt.nombre),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[36]||(o[36]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","option-label","option-value","disable"])])):z("",!0),((R=e.etapas)==null?void 0:R.length)&&e.accion==e.acciones.nuevo||e.preingreso.etapa?(m(),b("div",va,[o[39]||(o[39]=t("label",{class:"q-mb-sm block"},"Etapa",-1)),s(k,{modelValue:e.preingreso.etapa,"onUpdate:modelValue":[o[10]||(o[10]=a=>e.preingreso.etapa=a),o[11]||(o[11]=a=>e.obtenerTareasEtapa(e.preingreso.etapa))],options:e.etapas,onFilter:e.filtrarEtapas,"transition-show":"scale","transition-hide":"scale",hint:"Obligatorio","options-dense":"",dense:"",clearable:"",outlined:"","option-label":a=>a.nombre,"option-value":a=>a.id,"use-input":"","input-debounce":"0","emit-value":"","map-options":"",disable:e.disabled||e.soloLectura,onBlur:e.v$.etapa.$touch,error:!!e.v$.etapa.$errors.length},{"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[38]||(o[38]=[c(" No hay resultados ")])),_:1})]),_:1})]),error:l(()=>[(m(!0),b(I,null,Q(e.v$.etapa.$errors,a=>(m(),b("div",{key:a.$uid},[t("div",ya,E(a.$message),1)]))),128))]),_:1},8,["modelValue","options","onFilter","option-label","option-value","disable","onBlur","error"])])):z("",!0),t("div",ha,[t("label",wa,[o[41]||(o[41]=c("N\xB0 Tarea ")),s(ae,{name:"info",color:"grey"}),s(he,{class:"bg-dark"},{default:l(()=>o[40]||(o[40]=[c(E("Campo es obligatorio si el material recibido es para tarea de soporte, caso contrario se asignar\xE1 al stock del t\xE9cnico"))])),_:1})]),s(k,{modelValue:e.preingreso.tarea,"onUpdate:modelValue":[o[12]||(o[12]=a=>e.preingreso.tarea=a),e.obtenerDatosTareaSeleccionada],options:e.tareas,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",clearable:"",onFilter:e.filtrarTareas,hint:"Opcional","option-label":a=>a.codigo_tarea+" - "+a.titulo,"option-value":a=>a.id,disable:e.disabled||e.soloLectura,error:!!e.v$.tarea.$errors.length,"error-message":"Debes seleccionar una tarea","emit-value":"","map-options":""},{option:l(a=>[s(C,ho(wo(a.itemProps)),{default:l(()=>[s(V,null,{default:l(()=>[s(W,null,{default:l(()=>[c(E(a.opt.codigo_tarea),1)]),_:2},1024),s(W,{caption:""},{default:l(()=>[c(E(a.opt.titulo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),error:l(()=>[(m(!0),b(I,null,Q(e.v$.tarea.$errors,a=>(m(),b("div",{key:a.$uid},[t("div",Pa,E(a.$message),1)]))),128))]),"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[42]||(o[42]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","option-label","option-value","disable","error"])]),t("div",Ca,[o[44]||(o[44]=t("label",{class:"q-mb-sm block"},"Coordinador/Supervisor",-1)),s(k,{modelValue:e.preingreso.coordinador,"onUpdate:modelValue":o[13]||(o[13]=a=>e.preingreso.coordinador=a),options:e.coordinadores,"transition-show":"jump-up","transition-hide":"jump-up","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarCoordinadores,onPopupShow:o[14]||(o[14]=a=>e.ordenarLista(e.coordinadores,"apellidos")),error:!!e.v$.coordinador.$errors.length,"error-message":"Debes seleccionar al menos una opcion",disable:e.disabled||e.soloLectura||!!e.preingreso.proyecto,"option-label":a=>a.apellidos+" "+a.nombres,"option-value":a=>a.id,"emit-value":"","map-options":""},{"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[43]||(o[43]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter","error","disable","option-label","option-value"])]),t("div",Va,[o[46]||(o[46]=t("label",{class:"q-mb-sm block"},"Cliente",-1)),s(k,{modelValue:e.preingreso.cliente,"onUpdate:modelValue":o[15]||(o[15]=a=>e.preingreso.cliente=a),options:e.clientes,"transition-show":"jum-up","transition-hide":"jump-down","options-dense":"",dense:"",outlined:"",disable:e.disabled||e.soloLectura||!!e.preingreso.proyecto,error:!!e.v$.cliente.$errors.length,"error-message":"Debes seleccionar un cliente",onPopupShow:o[16]||(o[16]=a=>e.ordenarLista(e.clientes,"razon_social")),"option-value":a=>a.id,"option-label":a=>a.razon_social,"emit-value":"","map-options":""},{error:l(()=>[(m(!0),b(I,null,Q(e.v$.cliente.$errors,a=>(m(),b("div",{key:a.$uid},[t("div",Ea,E(a.$message),1)]))),128))]),"no-option":l(()=>[s(C,null,{default:l(()=>[s(V,{class:"text-grey"},{default:l(()=>o[45]||(o[45]=[c(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","error","option-value","option-label"])]),t("div",$a,[o[47]||(o[47]=t("label",{class:"q-mb-sm block"},"Courier",-1)),s(T,{modelValue:e.preingreso.courier,"onUpdate:modelValue":o[17]||(o[17]=a=>e.preingreso.courier=a),disable:e.disabled||e.soloLectura,error:!!e.v$.courier.$errors.length,outlined:"",dense:""},null,8,["modelValue","disable","error"])]),t("div",Sa,[o[48]||(o[48]=t("label",{class:"q-mb-sm block"},"Justificaci\xF3n",-1)),s(T,{type:"textarea",autogrow:"",modelValue:e.preingreso.observacion,"onUpdate:modelValue":o[18]||(o[18]=a=>e.preingreso.observacion=a),placeholder:"Obligatorio",disable:e.disabled||e.soloLectura,error:!!e.v$.observacion.$errors.length,outlined:"",dense:""},null,8,["modelValue","disable","error"])]),t("div",ka,[s(d,{ref:"refArchivo",label:"Adjuntar archivos",mixin:e.mixin,disable:e.disabled,listarAlGuardar:!1,"permitir-eliminar":e.accion==e.acciones.nuevo||e.accion==e.acciones.editar,idModelo:e.idPreingreso},{"boton-subir":l(()=>[z("",!0)]),_:1},8,["mixin","disable","permitir-eliminar","idModelo"])]),t("div",qa,[o[51]||(o[51]=t("label",{class:"q-mb-sm block"},"Agregar productos",-1)),t("div",za,[t("div",Ta,[s(T,{modelValue:e.criterioBusquedaProducto,"onUpdate:modelValue":o[20]||(o[20]=a=>e.criterioBusquedaProducto=a),disable:e.disabled,placeholder:"Nombre de producto",hint:"Presiona Enter para seleccionar un producto",onKeydown:o[21]||(o[21]=Co(a=>e.listarProductos({search:e.criterioBusquedaProducto,activo:1}),["enter"])),onBlur:o[22]||(o[22]=a=>e.criterioBusquedaProducto===""?e.limpiarProducto():null),outlined:"",dense:""},null,8,["modelValue","disable"])]),t("div",La,[s(ye,{onClick:o[23]||(o[23]=a=>e.listarProductos({search:e.criterioBusquedaProducto,campos:"id,producto_id,descripcion",activo:1})),icon:"search",unelevated:"",color:"positive",class:"full-width",style:{height:"40px"},disable:e.disabled,"no-caps":"",glossy:""},{default:l(()=>o[50]||(o[50]=[c("Buscar")])),_:1},8,["disable"])])])]),t("div",Aa,[e.componenteCargado?(m(),Po(M,{key:0,ref:"refItems",titulo:"Productos Seleccionados",configuracionColumnas:e.accion==e.acciones.nuevo||e.accion==e.acciones.editar&&e.preingreso.responsable_id==e.store.user.id?[...e.configuracionColumnasItemPreingreso,e.accionesTabla]:[...e.configuracionColumnasItemPreingreso,e.accionesTabla],datos:e.preingreso.listadoProductos,separador:"cell",permitirEditarCeldas:e.accion==e.acciones.nuevo||e.accion==e.acciones.editar&&(e.preingreso.solicitante==e.store.user.id||e.preingreso.responsable==e.store.user.id||e.preingreso.coordinador==e.store.user.id),permitirConsultar:!1,permitirEditar:e.accion==e.acciones.nuevo||e.accion==e.acciones.editar&&(e.preingreso.solicitante==e.store.user.id||e.preingreso.responsable==e.store.user.id||e.preingreso.coordinador==e.store.user.id),permitirEditarModal:!0,modalMaximized:!1,permitirEliminar:!1,altoFijo:!1,accion1:e.btnVerFotografia,accion2:e.btnEliminarFila},null,8,["configuracionColumnas","datos","permitirEditarCeldas","permitirEditar","accion1","accion2"])):z("",!0)])])]}),_:1}),s(O,{ref:"refListado","configuracion-columnas":e.configuracionColumnasDetallesProductos,separador:"cell",datos:e.listadoProductos,"tipo-seleccion":"multiple",onSelected:e.seleccionarProducto},null,8,["configuracion-columnas","datos","onSelected"])]),_:1},8,["mixin","configuracionColumnas","tab-options","filtrar","permitirEditar","accion1"]),s(P,{ref:"refVisorImagen"},null,512)],64)}var Ui=bo(ia,[["render",Fa]]);export{Ui as default};

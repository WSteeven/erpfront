var D=Object.defineProperty;var M=(o,a,r)=>a in o?D(o,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[a]=r;var n=(o,a,r)=>(M(o,typeof a!="symbol"?a+"":a,r),r);import{a as R}from"./QToolbar.afeb6de9.js";import{by as $,s as k,d as U,R as G,bd as Y,m as P,c as L,f as H,bz as V,p as j,A as J,bG as K,_ as O,t as y,v as s,P as z,F as u,z as l,a6 as W,y as t,x as m,D as b,O as X,B as Z,J as d,I as f,a8 as x,K as oo}from"./index.b8e09611.js";import{Q as ao}from"./QChip.f8f308fa.js";import{Q as eo}from"./QForm.eab79b48.js";import{u as io}from"./index.70965bc7.js";import{T as lo}from"./TabLayout.45a66130.js";import{G as ro}from"./GestorDocumentos.f9db56f7.js";import{E as so}from"./EssentialPopupEditableTable.ba049a88.js";import{E as to}from"./entidadAuditable.75a46700.js";import{C as no}from"./ContenedorSimpleMixin.4e22246b.js";import{u as mo,L as uo,A as co}from"./utils.9344cd7e.js";import"./position-engine.799c9136.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QSelect.b920278b.js";import"./QItemSection.ec4cc512.js";import"./QMenu.b3fb639b.js";import"./format.8ac60962.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPopupProxy.685eacb5.js";import"./QPage.e6f8825d.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTable.23af6cc8.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./i18n-validators.06abe774.js";import"./index.ea415f98.js";import"./EssentialTablePagination.ce808cac.js";import"./QUploader.16c4ab83.js";import"./QCircularProgress.c6e924d2.js";const c=[{name:"id",field:"id",label:"id",align:"left",visible:!1,sortable:!0},{name:"razon_social",field:"razon_social",label:"Raz\xF3n Social",align:"left",sortable:!0},{name:"num_documento",field:"num_documento",label:"# Doc.",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n.",align:"left",sortable:!0},{name:"fecha_emision",field:"fecha_emision",label:"F. Emisi\xF3n",align:"left",sortable:!0},{name:"fecha_vencimiento",field:"fecha_vencimiento",label:"F. Vencimiento",align:"left",sortable:!0},{name:"plazo",field:"plazo",label:"Plazo",align:"left",sortable:!0},{name:"total",field:"total",label:"Total",align:"left",sortable:!0},{name:"valor_pagar",field:"valor_pagar",label:"V. Pagar",align:"left",sortable:!0}],po=[{name:"nombre",field:"nombre",label:"Nombre",align:"left",sortable:!0},{name:"realizador",field:"realizador",label:"Subido Por",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0},{name:"cant_elementos",field:"cant_elementos",label:"Cant. Facturas",align:"left",sortable:!0}];class bo extends to{constructor(){super();n(this,"archivo");n(this,"nombre");n(this,"realizador");n(this,"estado");n(this,"cant_elementos");n(this,"listado");this.archivo=null,this.nombre=null,this.realizador=null,this.estado=null,this.cant_elementos=null,this.listado=[]}}class fo extends ${constructor(){super(k.pagos_proveedores)}}var go=U({components:{TabLayout:lo,GestorDocumentos:ro,EssentialPopupEditableTable:so},setup(){const o=new no(bo,new fo),{entidad:a,accion:r,disabled:E,listado:S}=o.useReferencias(),{setValidador:F,listar:g}=o.useComportamiento(),{confirmar:v}=G(),{onConsultado:C}=o.useHooks();Y().setQuasar(P()),mo().setQuasar(P());const i=L(),h=H(()=>a.listado.reduce((e,p)=>e+parseFloat(p.valor_pagar),0).toFixed(2)),w=io({},a);F(w.value),C(()=>{r.value==V.editar?(c.find(e=>e.field==="valor_pagar").visible=!0,c.find(e=>e.field==="valor_pagar").editable=!0,c.find(e=>e.field==="valor_pagar").type="number",c.find(e=>e.field==="valor_pagar").hint="Ingresa el valor a pagar"):c.find(e=>e.field==="valor_pagar").editable=!1});const A={titulo:"Eliminar",icono:"bi-x",color:"negative",accion:({entidad:e,posicion:p})=>{T({posicion:p})},visible:()=>r.value==V.editar},Q={titulo:"Cash",icono:"bi-file-earmark-excel-fill",color:"positive",accion:async({entidad:e})=>{await q(e)}};async function q(e){const p="pago_a_proveedores_"+uo(new Date,"D-MM-YYYY"),I=J.getInstance(),N=K.URL_BASE+"/"+I.getEndpoint(k.pagos_proveedores)+"/cash/"+e.id;await co(N,"GET","blob","xlsx",p,null)}function T({posicion:e}){v("\xBFEst\xE1 seguro de continuar?",()=>a.listado.splice(e,1))}async function _(){await i.value.subir(),console.log(i.value),g()}function B(e){e.valor_pagar=Number(e.valor_pagar).toFixed(2),e.total<e.valor_pagar&&(e.valor_pagar=e.total)}return{pago:a,mixin:o,accion:r,acciones:V,disabled:E,configuracionColumnas:po,columnasItems:c,accionesTabla:j,refArchivo:i,endpoint:k.pagos_proveedores,btnEliminarFila:A,btnCash:Q,subirArchivos:_,calcularValores:B,total:h}}});const vo={class:"row q-col-gutter-sm q-py-md"},Co={key:0,class:"col-12 col-md-12"},Vo={class:"q-mb-sm block"},yo={key:1,class:"col-12 col-md-3"},ko={key:2,class:"col-12 col-md-3"},Eo={key:3,class:"col-12 col-md-3"},Fo={key:4,class:"col-12 col-md-3"},Po={key:5,class:"col-12 col-md-3 col-sm-6"},zo={key:6,class:"col-12"};function So(o,a,r,E,S,F){const g=y("gestor-documentos"),v=y("essential-popup-editable-table"),C=y("tab-layout");return s(),z(C,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Pago a Proveedores",mostrarButtonSubmits:o.accion!=o.acciones.nuevo,accion1:o.btnCash},{formulario:u(()=>[l(eo,{onSubmit:a[5]||(a[5]=W(()=>{},["prevent"]))},{default:u(()=>[t("div",vo,[o.accion==o.acciones.nuevo?(s(),m("div",Co,[t("label",Vo,[a[7]||(a[7]=b("Reporte de contifico ")),a[8]||(a[8]=t("i",{class:"bi bi-info-circle"},null,-1)),l(R,{class:"bg-light-blue-7"},{default:u(()=>a[6]||(a[6]=[b("Suba el reporte de cartera por pagar emitida por contifico")])),_:1})]),l(g,{ref:"refArchivo",mixin:o.mixin,endpoint:o.endpoint,disable:o.disabled,"permitir-eliminar":!1,"mostrar-listado":!1,"listar-al-guardar":!1,esMultiple:!1},{"boton-subir":u(()=>[(s(),z(X,{key:0,color:"positive",push:"","no-caps":"",class:"full-width q-mb-lg",onClick:a[0]||(a[0]=i=>o.subirArchivos())},{default:u(()=>[l(Z,{name:"bi-upload",class:"q-mr-sm",size:"xs"}),a[9]||(a[9]=b(" Subir archivos seleccionados"))]),_:1}))]),_:1},8,["mixin","endpoint","disable"])])):d("",!0),o.pago.id?(s(),m("div",yo,[a[10]||(a[10]=t("label",{class:"q-mb-sm block"},"Documento N\xB0",-1)),l(f,{modelValue:o.pago.id,"onUpdate:modelValue":a[1]||(a[1]=i=>o.pago.id=i),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):d("",!0),o.pago.created_at?(s(),m("div",ko,[a[11]||(a[11]=t("label",{class:"q-mb-sm block"},"Fecha de creaci\xF3n",-1)),l(f,{modelValue:o.pago.created_at,"onUpdate:modelValue":a[2]||(a[2]=i=>o.pago.created_at=i),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):d("",!0),o.pago.nombre?(s(),m("div",Eo,[a[12]||(a[12]=t("label",{class:"q-mb-sm block"},"Archivo",-1)),l(f,{modelValue:o.pago.nombre,"onUpdate:modelValue":a[3]||(a[3]=i=>o.pago.nombre=i),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):d("",!0),o.pago.realizador?(s(),m("div",Fo,[a[13]||(a[13]=t("label",{class:"q-mb-sm block"},"Subido por",-1)),l(f,{modelValue:o.pago.realizador,"onUpdate:modelValue":a[4]||(a[4]=i=>o.pago.realizador=i),disable:"",outlined:"",dense:"",autogrow:""},null,8,["modelValue"])])):d("",!0),o.total>0?(s(),m("div",Po,[a[14]||(a[14]=t("label",{class:"q-mb-sm block"},"Total a Pagar:",-1)),l(ao,{square:""},{default:u(()=>[l(x,{icon:"bi-currency-dollar",color:"green","text-color":"white"}),b(" "+oo(o.total),1)]),_:1})])):d("",!0),o.accion!==o.acciones.nuevo?(s(),m("div",zo,[l(v,{ref:"refItems",titulo:"Facturas por pagar",configuracionColumnas:o.accion==o.acciones.consultar?o.columnasItems:[...o.columnasItems,o.accionesTabla],datos:o.pago.listado,separador:"cell",permitirEditarCeldas:o.accion==o.acciones.editar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,altoFijo:"",accion1:o.btnEliminarFila,onFilaModificada:o.calcularValores},null,8,["configuracionColumnas","datos","permitirEditarCeldas","accion1","onFilaModificada"])])):d("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","mostrarButtonSubmits","accion1"])}var ba=O(go,[["render",So]]);export{ba as default};

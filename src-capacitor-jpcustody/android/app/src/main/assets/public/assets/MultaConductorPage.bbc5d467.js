var de=Object.defineProperty;var ie=(e,o,r)=>o in e?de(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r;var i=(e,o,r)=>(ie(e,typeof o!="symbol"?o+"":o,r),r);import{Q as F,a as $}from"./QSelect.b920278b.js";import{Q as E,a as q}from"./QItemSection.ec4cc512.js";import{by as ue,s as ee,l as me,e as oe,c as b,R as pe,A as ce,bG as fe,d as be,u as ge,a2 as ve,q as Ve,E as he,_ as Ce,t as ye,v as n,P as ke,F as s,z as l,a6 as we,y as t,x as d,G as P,H as S,K as m,M as G,N as z,D as v,I as p,J as C,B as H,j as J,O as K,a9 as W}from"./index.b8e09611.js";import{Q as X}from"./QExpansionItem.795361a7.js";import{Q as Y,a as Z,C as _}from"./QPopupProxy.685eacb5.js";import{Q as $e}from"./QForm.eab79b48.js";import{r as j,a as Ee}from"./i18n-validators.06abe774.js";import{T as qe}from"./TabLayout.45a66130.js";import{C as Pe}from"./ContenedorSimpleMixin.4e22246b.js";import{E as Se}from"./entidadAuditable.75a46700.js";import{C as Ue}from"./ConductorController.1494aa58.js";import{u as Qe}from"./index.70965bc7.js";import{u as Ie}from"./filtrosListadosGenerales.87fcb144.js";import{S as ae}from"./utils.9344cd7e.js";import{E as N}from"./Empleado.20234ba0.js";import{V as Me}from"./VehiculoController.30a3b5a2.js";import{C as x}from"./Conductor.978d1863.js";const Le=[{name:"empleado",field:"empleado",label:"Conductor",align:"left",sortable:!0},{name:"fecha_infraccion",field:"fecha_infraccion",label:"Fecha Infraccion",align:"left",sortable:!0},{name:"placa",field:"placa",label:"Placa",align:"left",sortable:!0,editable:!1},{name:"puntos",field:"puntos",label:"Puntos",align:"left",sortable:!0},{name:"total",field:"total",label:"T. a Pagar",align:"left",sortable:!0},{name:"descontable",field:"descontable",label:"Se descuenta",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0},{name:"fecha_pago",field:"fecha_pago",label:"fecha_pago",align:"left",sortable:!0},{name:"comentario",field:"comentario",label:"Comentario",align:"left"}];class Fe extends Se{constructor(){super();i(this,"empleado");i(this,"empleado_id");i(this,"fecha_infraccion");i(this,"placa");i(this,"puntos");i(this,"total");i(this,"estado");i(this,"descontable");i(this,"fecha_pago");i(this,"comentario");this.empleado=null,this.empleado_id=null,this.fecha_infraccion=null,this.placa=null,this.puntos=0,this.total=null,this.estado=!1,this.descontable=!0,this.fecha_pago=null,this.comentario=null}}class je extends ue{constructor(){super(ee.multas_conductores)}}const Ne=me("conductor",()=>{const e=oe(new x),o=b(),r=b(""),c=b("formulario"),y=b(!0),V=b(),u=new ae,{notificarCorrecto:a,notificarAdvertencia:U,notificarError:Q}=pe();async function I(L){try{u.activar();const f=ce.getInstance(),k=fe.URL_BASE+"/"+f.getEndpoint(ee.multas_conductores)+"/marcar-pagada/"+V.value,h=await f.post(k,L);if(h.status=200)return a(h.data.mensaje),!0;U(h.data.mensaje)}catch(f){Q("Error al marcar como pagada la multa. "+f)}finally{u.desactivar()}return!1}function M(){e.hydrate(new x)}return{conductor:e,idConductor:o,accionMulta:r,tabs:c,mostrarListado:y,idMulta:V,resetearConductor:M,pagarMulta:I}});var Oe=be({components:{TabLayout:qe},setup(e,{emit:o}){const r=new Pe(Fe,new je),{entidad:c,disabled:y,accion:V,listadosAuxiliares:u}=r.useReferencias(),{setValidador:a,cargarVista:U,obtenerListados:Q}=r.useComportamiento(),{onConsultado:I,onReestablecer:M,onGuardado:L}=r.useHooks();ge();const f=new ae,k=Ne(),h=b(!0),w=b(!1),g=oe(new N);U(async()=>{k.conductor.info_empleado!=null?(g.hydrate(k.conductor.info_empleado),c.empleado=g.id,w.value=!0):(w.value=!1,c.empleado=null,g.hydrate(new N)),await Q({empleados:new Ue,vehiculos:{controller:new Me,params:{campos:"id,placa,modelo_id"}}}),u.cantones=JSON.parse(ve.getItem("cantones").toString())}),I(()=>{}),M(()=>{g.hydrate(new N),w.value=!1}),L(()=>{o("cerrar-modal",!1),o("guardado","MultaConductorPage")});const le={empleado:{required:j},fecha_infraccion:{required:j},fecha_pago:{requiredIf:Ee(()=>c.estado)},total:{required:j}},O=Qe(le,c);a(O.value);async function se(B){if(B!=null){f.activar();const{result:R}=await new he().consultar(B);console.log(R),g.hydrate(R),f.desactivar()}}const{empleados:A,filtrarEmpleados:te,ordenarEmpleados:ne,vehiculos:D,filtrarVehiculos:re,cantones:T}=Ie(u);return T.value=u.cantones,A.value=u.empleados,D.value=u.vehiculos,{mixin:r,multa:c,disabled:y,v$:O,accion:V,configuracionColumnas:Le,empleado:g,maskFecha:Ve,mostrarListado:h,soloLectura:w,empleados:A,filtrarEmpleados:te,ordenarEmpleados:ne,obtenerEmpleado:se,cantones:T,vehiculos:D,filtrarVehiculos:re}}});const Ae={class:"row q-col-gutter-sm q-pa-sm"},De={class:"col-12 col-md-3"},Te={class:"error-msg"},Be={key:0,class:"col-12 col-md-3"},Re={key:1,class:"col-12 col-md-3"},Ge={key:2,class:"col-12 col-md-3"},ze={key:3,class:"col-12 col-md-3"},He={key:4,class:"col-12 col-md-3"},Je={class:"row q-col-gutter-sm q-pa-sm"},Ke={class:"col-12 col-md-3"},We={class:"row items-center justify-end"},Xe={class:"error-msg"},Ye={class:"col-12 col-md-3"},Ze={class:"col-12 col-md-3"},_e={class:"col-12 col-md-3"},xe={class:"error-msg"},eo={class:"col-12 col-md-3"},oo={class:"col-12 col-md-3"},ao={class:"col-12 col-md-3"},lo={class:"row items-center justify-end"},so={class:"error-msg"},to={class:"col-12 col-md-3"};function no(e,o,r,c,y,V){const u=ye("tab-layout");return n(),ke(u,{mixin:e.mixin,configuracionColumnas:e.configuracionColumnas,"titulo-pagina":"Multas de Conductores",mostrarListado:e.mostrarListado,ajustarCeldas:""},{formulario:s(()=>[l($e,{onSubmit:o[16]||(o[16]=we(()=>{},["prevent"]))},{default:s(()=>[l(X,{class:"overflow-hidden q-mb-md expansion",label:"Informaci\xF3n del conductor","header-class":"text-bold bg-header-collapse","default-opened":""},{default:s(()=>[t("div",Ae,[t("div",De,[o[18]||(o[18]=t("label",{class:"q-mb-sm block"},"Conductor",-1)),l(F,{modelValue:e.multa.empleado,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.multa.empleado=a),e.obtenerEmpleado],options:e.empleados,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled||e.soloLectura,"options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,onPopupShow:e.ordenarEmpleados,error:!!e.v$.empleado.$errors.length,"error-message":"Debes seleccionar un empleado para convertirlo en chofer","option-value":a=>a.id,"option-label":a=>a.empleado,"emit-value":"","map-options":""},{error:s(()=>[(n(!0),d(P,null,S(e.v$.empleado.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Te,m(a.$message),1)]))),128))]),option:s(a=>[l(E,G(z(a.itemProps)),{default:s(()=>[l(q,null,{default:s(()=>[l($,null,{default:s(()=>[v(m(a.opt.empleado),1)]),_:2},1024),l($,{caption:""},{default:s(()=>[v(m(a.opt.identificacion),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":s(()=>[l(E,null,{default:s(()=>[l(q,{class:"text-grey"},{default:s(()=>o[17]||(o[17]=[v(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter","onPopupShow","onUpdate:modelValue","error","option-value","option-label"])]),e.empleado.identificacion?(n(),d("div",Be,[o[19]||(o[19]=t("label",{class:"q-mb-sm block"},"Identificacion",-1)),l(p,{mask:"#############",modelValue:e.empleado.identificacion,"onUpdate:modelValue":o[1]||(o[1]=a=>e.empleado.identificacion=a),placeholder:"Obligatorio",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):C("",!0),e.empleado.canton?(n(),d("div",Re,[o[20]||(o[20]=t("label",{class:"q-mb-sm block"},"Ciudad",-1)),l(F,{modelValue:e.empleado.canton,"onUpdate:modelValue":o[2]||(o[2]=a=>e.empleado.canton=a),options:e.cantones,disable:"",dense:"",outlined:"","option-value":a=>a.id,"option-label":a=>a.canton,"emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])])):C("",!0),e.empleado.direccion?(n(),d("div",Ge,[o[21]||(o[21]=t("label",{class:"q-mb-sm block"},"Direcci\xF3n",-1)),l(p,{modelValue:e.empleado.direccion,"onUpdate:modelValue":o[3]||(o[3]=a=>e.empleado.direccion=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):C("",!0),e.empleado.celular?(n(),d("div",ze,[o[22]||(o[22]=t("label",{class:"q-mb-sm block"},"Celular",-1)),l(p,{modelValue:e.empleado.celular,"onUpdate:modelValue":o[4]||(o[4]=a=>e.empleado.celular=a),disable:"",dense:"",outlined:""},null,8,["modelValue"])])):C("",!0),e.empleado.email?(n(),d("div",He,[o[23]||(o[23]=t("label",{class:"q-mb-sm block"},"Correo",-1)),l(p,{modelValue:e.empleado.email,"onUpdate:modelValue":o[5]||(o[5]=a=>e.empleado.email=a),autogrow:"",disable:"",outlined:"",dense:""},null,8,["modelValue"])])):C("",!0)])]),_:1}),l(X,{class:"overflow-hidden q-mb-md expansion",label:"Registro de Multas","header-class":"text-bold bg-header-collapse","default-opened":""},{default:s(()=>[t("div",Je,[t("div",Ke,[o[24]||(o[24]=t("label",{class:"q-mb-sm block"},"Fecha de Infracci\xF3n",-1)),l(p,{modelValue:e.multa.fecha_infraccion,"onUpdate:modelValue":o[7]||(o[7]=a=>e.multa.fecha_infraccion=a),placeholder:"Obligatorio",error:!!e.v$.fecha_infraccion.$errors.length,disable:e.disabled,outlined:"",dense:""},{append:s(()=>[l(H,{name:"event",class:"cursor-pointer"},{default:s(()=>[l(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[l(Z,{modelValue:e.multa.fecha_infraccion,"onUpdate:modelValue":o[6]||(o[6]=a=>e.multa.fecha_infraccion=a),mask:e.maskFecha,"today-btn":""},{default:s(()=>[t("div",We,[J(l(K,{label:"Cerrar",color:"primary",flat:""},null,512),[[_]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:s(()=>[(n(!0),d(P,null,S(e.v$.fecha_infraccion.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",Xe,m(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),t("div",Ye,[o[26]||(o[26]=t("label",{class:"q-mb-sm block"},"Placa",-1)),l(F,{modelValue:e.multa.placa,"onUpdate:modelValue":o[8]||(o[8]=a=>e.multa.placa=a),options:e.vehiculos,"transition-show":"jump-up","transition-hide":"jump-down",disable:e.disabled,"options-dense":"",dense:"",outlined:"",onFilter:e.filtrarVehiculos,"error-message":"Debes seleccionar un numero de placa","use-input":"","input-debounce":"0","option-value":a=>a.placa,"option-label":a=>a.placa,"emit-value":"","map-options":""},{option:s(a=>[l(E,G(z(a.itemProps)),{default:s(()=>[l(q,null,{default:s(()=>[l($,null,{default:s(()=>[v(m(a.opt.placa),1)]),_:2},1024),l($,{caption:""},{default:s(()=>[v(m(a.opt.marca)+": "+m(a.opt.modelo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":s(()=>[l(E,null,{default:s(()=>[l(q,{class:"text-grey"},{default:s(()=>o[25]||(o[25]=[v(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter","option-value","option-label"])]),t("div",Ze,[o[27]||(o[27]=t("label",{class:"q-mb-sm block"},"Puntos",-1)),l(p,{modelValue:e.multa.puntos,"onUpdate:modelValue":o[9]||(o[9]=a=>e.multa.puntos=a),type:"number",step:".5",placeholder:"Obligatorio",disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])]),t("div",_e,[o[28]||(o[28]=t("label",{class:"q-mb-sm block"},"Total a Pagar",-1)),l(p,{modelValue:e.multa.total,"onUpdate:modelValue":o[10]||(o[10]=a=>e.multa.total=a),placeholder:"Obligatorio",disable:e.disabled,error:!!e.v$.total.$errors.length,outlined:"",dense:""},{error:s(()=>[(n(!0),d(P,null,S(e.v$.total.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",xe,m(a.$message),1)]))),128))]),_:1},8,["modelValue","disable","error"])]),t("div",eo,[o[29]||(o[29]=t("label",{class:"q-mb-sm block"},"\xBFSe descuenta valor al Empleado?",-1)),l(W,{modelValue:e.multa.descontable,"onUpdate:modelValue":o[11]||(o[11]=a=>e.multa.descontable=a),label:e.multa.descontable?"SI":"NO",color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear",disable:e.disabled},null,8,["modelValue","label","disable"])]),t("div",oo,[o[30]||(o[30]=t("label",{class:"q-mb-sm block"},"Estado",-1)),l(W,{modelValue:e.multa.estado,"onUpdate:modelValue":o[12]||(o[12]=a=>e.multa.estado=a),label:e.multa.estado?"PAGADA":"PENDIENTE",color:"primary","keep-color":"",icon:"bi-check2-circle","unchecked-icon":"clear",disable:e.disabled},null,8,["modelValue","label","disable"])]),t("div",ao,[o[31]||(o[31]=t("label",{class:"q-mb-sm block"},"Fecha de Pago",-1)),l(p,{modelValue:e.multa.fecha_pago,"onUpdate:modelValue":o[14]||(o[14]=a=>e.multa.fecha_pago=a),placeholder:"Obligatorio",error:!!e.v$.fecha_pago.$errors.length,disable:e.disabled,outlined:"",dense:""},{append:s(()=>[l(H,{name:"event",class:"cursor-pointer"},{default:s(()=>[l(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[l(Z,{modelValue:e.multa.fecha_pago,"onUpdate:modelValue":o[13]||(o[13]=a=>e.multa.fecha_pago=a),mask:e.maskFecha,"today-btn":""},{default:s(()=>[t("div",lo,[J(l(K,{label:"Cerrar",color:"primary",flat:""},null,512),[[_]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),error:s(()=>[(n(!0),d(P,null,S(e.v$.fecha_pago.$errors,a=>(n(),d("div",{key:a.$uid},[t("div",so,m(a.$message),1)]))),128))]),_:1},8,["modelValue","error","disable"])]),t("div",to,[o[32]||(o[32]=t("label",{class:"q-mb-sm block"},"Observaci\xF3n",-1)),l(p,{modelValue:e.multa.comentario,"onUpdate:modelValue":o[15]||(o[15]=a=>e.multa.comentario=a),autogrow:"",placeholder:"Opcional",disable:e.disabled,outlined:"",dense:""},null,8,["modelValue","disable"])])])]),_:1})]),_:1})]),_:1},8,["mixin","configuracionColumnas","mostrarListado"])}var ro=Ce(Oe,[["render",no]]),Po=Object.freeze(Object.defineProperty({__proto__:null,default:ro},Symbol.toStringTag,{value:"Module"}));export{ro as M,je as a,Po as b,Ne as u};

import{Q as p}from"./QSelect.b920278b.js";import{d as E,E as w,R as $,bd as g,m as k,u as q,c as Q,e as F,q as I,A as R,bG as S,s as U,_ as D,v as A,P as L,F as r,z as s,be as O,y as t,L as T,B as j,O as z,J as n}from"./index.b8e09611.js";import"./QPopupProxy.685eacb5.js";import{Q as M}from"./QBtnGroup.7d38eecd.js";import{Q as G}from"./QPage.e6f8825d.js";import{Q as H,a as J}from"./QLayout.9e55ed7f.js";import{u as K,S as W,s as X,A as x}from"./utils.9344cd7e.js";import{M as Y}from"./ModalEntidad.54c9ab3a.js";import{E as Z}from"./EssentialTable.23af6cc8.js";import{E as ee}from"./Empleado.20234ba0.js";import{P as oe}from"./PeriodoController.f4499353.js";import{C as ae}from"./ContenedorSimpleMixin.4e22246b.js";import{u as te}from"./filtrosListadosGenerales.87fcb144.js";import{o as C}from"./recursosHumanos.utils.706e72b6.js";import"./QChip.f8f308fa.js";import"./QItemSection.ec4cc512.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QScrollObserver.8813f664.js";import"./QResizeObserver.1422c274.js";import"./QToolbar.afeb6de9.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QBadge.89898cd2.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./i18n-validators.06abe774.js";import"./index.ea415f98.js";import"./entidadAuditable.75a46700.js";var se=E({components:{EssentialTable:Z,ModalEntidad:Y},setup(){const a=new ae(ee,new w),{listadosAuxiliares:o}=a.useReferencias(),{obtenerListados:m,cargarVista:u}=a.useComportamiento(),{notificarError:f,notificarAdvertencia:h}=$();g().setQuasar(k()),K().setQuasar(k());const e=new W,B=q(),_=Q([]),v=Q([]),l=F({empleado:null,tipo:null,fecha_inicio:"",fecha_fin:"",fecha_corte:"",solicitante:null,periodo:null,sucursal:null,motivo:null,devolucion:null,todos:!1,tarea:null,transferencia:null,accion:""}),{empleados:V,filtrarEmpleados:N}=te(o);u(async()=>{await m({periodos:{controller:new oe,params:{activo:1}},empleados:{controller:new w,params:{estado:1}}}),v.value=o.periodos,V.value=o.empleados});async function y(P){try{e.activar();const c=R.getInstance(),d=S.URL_BASE+"/"+c.getEndpoint(U.vacaciones)+"/reporte",b="Reporte "+C.filter(i=>i.value==l.tipo)[0].label;switch(P){case"excel":l.accion="excel",await x(d,"POST","blob","xlsx",b,l);break;case"pdf":l.accion="pdf",e.activar(),await x(d,"POST","blob","pdf",b,l),e.desactivar();break;default:l.accion="";const i=await c.post(d,l);i.data.results&&(_.value=i.data.results,i.data.results.length<1&&h("No se obtuvieron resultados"))}e.desactivar()}catch(c){console.log(c),f("Error al obtener reporte")}finally{e.desactivar()}}return{mixin:a,reporte:l,store:B,maskFecha:I,listado:_,periodos:v,empleados:V,filtrarEmpleados:N,opcionesReporteVacaciones:C,buscarReporte:y,ordenarLista:X}}});const le={class:"row q-col-gutter-sm q-pa-sm q-py-md"},re={class:"col-12 col-md-3"},ie={class:"col-12 col-md-3"},ne={class:"col-12 col-md-3"},ce={class:"col-12 col-md-3 q-mb-xl"};const de={class:"col-12 col-md-12 q-mt-md"},pe={class:"text-center"};function me(a,o,m,u,f,h){return A(),L(J,null,{default:r(()=>[s(H,null,{default:r(()=>[s(G,{padding:""},{default:r(()=>[s(O,{class:"rounded-card custom-shadow"},{default:r(()=>[t("div",le,[t("div",re,[o[15]||(o[15]=t("label",{class:"q-mb-sm block"},"Tipo de reporte",-1)),s(p,{modelValue:a.reporte.tipo,"onUpdate:modelValue":o[0]||(o[0]=e=>a.reporte.tipo=e),options:a.opcionesReporteVacaciones,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.label,"option-value":e=>e.value,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ie,[o[16]||(o[16]=t("label",{class:"q-mb-sm block"},"Per\xEDodo",-1)),s(p,{modelValue:a.reporte.periodo,"onUpdate:modelValue":o[1]||(o[1]=e=>a.reporte.periodo=e),options:a.periodos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","option-label":e=>e.nombre,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","option-label","option-value"])]),t("div",ne,[o[17]||(o[17]=t("label",{class:"q-mb-sm block"},"Empleado",-1)),s(p,{modelValue:a.reporte.empleado,"onUpdate:modelValue":o[2]||(o[2]=e=>a.reporte.empleado=e),options:a.empleados,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"","use-input":"","input-debounce":"0",outlined:"",clearable:"",onFilter:a.filtrarEmpleados,onPopupShow:o[3]||(o[3]=e=>a.ordenarLista(a.empleados,"apellidos")),"option-label":e=>e.apellidos+" "+e.nombres,"option-value":e=>e.id,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","option-label","option-value"])]),t("div",ce,[s(T,{class:"q-mt-lg q-pt-md",modelValue:a.reporte.todos,"onUpdate:modelValue":[o[4]||(o[4]=e=>a.reporte.todos=e),o[5]||(o[5]=()=>a.reporte.empleado=a.reporte.todos?a.reporte.empleado=null:a.reporte.empleado=a.store.user.id)],label:"Todos los empleados",outlined:"",dense:""},null,8,["modelValue"])]),n("",!0),n("",!0),n("",!0),t("div",de,[t("div",pe,[s(M,{push:""},{default:r(()=>[n("",!0),s(z,{color:"positive",class:"full-width","no-caps":"","no-wrap":"",push:"",glossy:"",onClick:o[13]||(o[13]=e=>a.buscarReporte("excel"))},{default:r(()=>[s(j,{name:"bi-file-earmark-excel-fill",size:"xs",class:"q-mr-sm"}),o[22]||(o[22]=t("span",null,"Excel",-1))]),_:1}),n("",!0)]),_:1})])])])]),_:1})]),_:1})]),_:1})]),_:1})}var oo=D(se,[["render",me]]);export{oo as default};

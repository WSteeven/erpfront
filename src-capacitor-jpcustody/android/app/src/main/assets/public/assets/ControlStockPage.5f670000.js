var q=Object.defineProperty;var D=(o,e,s)=>e in o?q(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var r=(o,e,s)=>(D(o,typeof e!="symbol"?e+"":e,s),s);import{Q as p}from"./QSelect.b920278b.js";import{by as I,s as M,d as O,c as A,cx as U,_ as F,t as f,v as N,P as z,F as n,z as t,a6 as T,y as i,I as _}from"./index.b8e09611.js";import{Q as h}from"./QForm.eab79b48.js";import{r as k}from"./index.ea415f98.js";import{u as L}from"./index.70965bc7.js";import{T as R}from"./TabLayout.45a66130.js";import{M as Q}from"./ModalEntidad.54c9ab3a.js";import{C as B}from"./ContenedorSimpleMixin.4e22246b.js";import{D as H}from"./DetalleProductoController.47dbf672.js";import{E as j}from"./entidadAuditable.75a46700.js";import{C as G}from"./ClienteController.6128473d.js";import{P as J}from"./ProductoController.f12f01f0.js";import{s as K}from"./utils.9344cd7e.js";import{u as X}from"./filtrosListadosGenerales.87fcb144.js";import{E as W}from"./ErrorComponent.3c1fc91c.js";import{N as Y}from"./NoOptionComponent.9c331961.js";import"./QChip.f8f308fa.js";import"./QItemSection.ec4cc512.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QTabs.1ee2fae1.js";import"./QResizeObserver.1422c274.js";import"./QTabPanels.1776fc83.js";import"./touch.9135741d.js";import"./QPopupProxy.685eacb5.js";import"./QPage.e6f8825d.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTable.23af6cc8.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./EssentialTablePagination.ce808cac.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./i18n-validators.06abe774.js";const Z=[{name:"sucursal_id",field:"sucursal_id",label:"sucursal",align:"left",sortable:!0},{name:"detalle_id",field:"detalle_id",label:"detalle",align:"left",sortable:!0},{name:"cliente_id",field:"cliente_id",label:"Cliente",align:"left",sortable:!0},{name:"minimo",field:"minimo",label:"minimo",align:"left",sortable:!0},{name:"reorden",field:"reorden",label:"reorden",align:"left",sortable:!0},{name:"actual",field:"actual",label:"En inventario",align:"left",sortable:!0},{name:"estado",field:"estado",label:"estado",align:"left",sortable:!0}];class x extends I{constructor(){super(M.control_stocks)}}class oo extends j{constructor(){super();r(this,"producto");r(this,"sucursal_id");r(this,"detalle_id");r(this,"cliente_id");r(this,"minimo");r(this,"reorden");r(this,"actual");r(this,"estado");this.producto=null,this.sucursal_id=null,this.detalle_id=null,this.cliente_id=null,this.minimo=null,this.reorden=null,this.actual=null,this.estado=null}}var eo=O({components:{NoOptionComponent:Y,ErrorComponent:W,TabLayout:R,ModalesEntidad:Q},setup(){const o=new B(oo,new x),{entidad:e,disabled:s,listadosAuxiliares:d}=o.useReferencias(),{setValidador:g,obtenerListados:C,cargarVista:u,listar:m}=o.useComportamiento(),a=A([]),{clientes:l,productos:V,filtrarProductos:$,sucursales:c,filtrarSucursales:w}=X(d);u(async()=>{await C({sucursales:{controller:new U,params:{campos:"id,lugar,cliente_id",activo:1}},productos:{controller:new J,params:{campos:"id,nombre"}},detalles:{controller:new H,params:{campos:"id,producto_id,descripcion,modelo_id,serial"}},clientes:{controller:new G,params:{campos:"id,razon_social",requiere_bodega:1,estado:1}}})});const S=L({sucursal_id:{required:k},detalle_id:{required:k},cliente_id:{required:k}},e);g(S.value);const E={titulo:"Actualizar",tooltip:"Actualizar listado",icono:"bi-arrow-clockwise",accion:()=>{m()}},y=[{nombre:"SUFICIENTE",valor:"STOCK SUFICIENTE"},{nombre:"REORDEN",valor:"PROXIMO A AGOTARSE"},{nombre:"MINIMO",valor:"DEBAJO DEL MINIMO"}];return c.value=d.sucursales,V.value=d.productos,a.value=d.detalles,l.value=d.clientes,{mixin:o,stock:e,v$:S,disabled:s,configuracionColumnas:Z,opciones_estados:y,productos:V,filtrarProductos:$,sucursales:c,filtrarSucursales:w,opciones_detalles:a,clientes:l,ordenarLista:K,seleccionarDetalle(b){a.value=d.detalles.filter(v=>v.producto_id===b),e.detalle_id=null,a.value.length<1&&(e.detalle_id=null),a.value.length==1&&(e.detalle_id=a.value[0].id)},seleccionarPropietario(b){const v=c.value.filter(P=>P.id===b);e.cliente_id=v[0].cliente_id},btnActualizarStock:E}}});const lo={class:"row q-col-gutter-sm q-py-md"},to={class:"col-12 col-md-6"},io={class:"col-12 col-md-6"},ro={class:"col-12 col-md-6 q-mb-md"},so={class:"col-12 col-md-6 q-mb-md"},ao={class:"col-12 col-md-6"},no={class:"col-12 col-md-6"};function uo(o,e,s,d,g,C){const u=f("no-option-component"),m=f("error-component"),a=f("tab-layout");return N(),z(a,{mixin:o.mixin,configuracionColumnas:o.configuracionColumnas,"titulo-pagina":"Control de stock",ajustarCeldas:!0,accion1Header:o.btnActualizarStock},{formulario:n(()=>[t(h,{onSubmit:e[7]||(e[7]=T(()=>{},["prevent"]))},{default:n(()=>[i("div",lo,[i("div",to,[e[8]||(e[8]=i("label",{class:"q-mb-sm block"},"Producto",-1)),t(p,{modelValue:o.stock.producto,"onUpdate:modelValue":[e[0]||(e[0]=l=>o.stock.producto=l),o.seleccionarDetalle],options:o.productos,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarProductos,"option-label":l=>l.nombre,"option-value":l=>l.id,"emit-value":"","map-options":""},{"no-option":n(()=>[t(u)]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","option-label","option-value"])]),i("div",io,[e[9]||(e[9]=i("label",{class:"q-mb-sm block"},"Detalle",-1)),t(p,{modelValue:o.stock.detalle_id,"onUpdate:modelValue":e[1]||(e[1]=l=>o.stock.detalle_id=l),options:o.opciones_detalles,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"",error:!!o.v$.detalle_id.$errors.length,"error-message":"Debes seleccionar un detalle de producto","option-label":l=>l.id&&l.serial?l.modelo+" \xA0 | \xA0 "+l.descripcion+" \xA0 | \xA0 "+l.serial:l.id?l.modelo+" | "+l.descripcion:null,"option-value":l=>l.id,"emit-value":"","map-options":""},{error:n(()=>[t(m,{clave:"detalle_id",v$:o.v$},null,8,["v$"])]),"no-option":n(()=>[t(u)]),_:1},8,["modelValue","options","error","option-label","option-value"])]),i("div",ro,[e[10]||(e[10]=i("label",{class:"q-mb-sm block"},"Sucursal",-1)),t(p,{modelValue:o.stock.sucursal_id,"onUpdate:modelValue":[e[2]||(e[2]=l=>o.stock.sucursal_id=l),o.seleccionarPropietario],options:o.sucursales,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",outlined:"","use-input":"","input-debounce":"0",onFilter:o.filtrarSucursales,onPopupShow:e[3]||(e[3]=l=>o.ordenarLista(o.sucursales,"lugar")),error:!!o.v$.sucursal_id.$errors.length,"error-message":"Debes seleccionar una sucursal","option-label":l=>l.lugar,"option-value":l=>l.id,"emit-value":"","map-options":""},{"no-option":n(()=>[t(u)]),error:n(()=>[t(m,{clave:"sucursal_id",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue","error","option-label","option-value"])]),i("div",so,[e[11]||(e[11]=i("label",{class:"q-mb-sm block"},"Propietario",-1)),t(p,{modelValue:o.stock.cliente_id,"onUpdate:modelValue":e[4]||(e[4]=l=>o.stock.cliente_id=l),options:o.clientes,"transition-show":"scale","transition-hide":"scale","options-dense":"",dense:"",disable:"",outlined:"",error:!!o.v$.cliente_id.$errors.length,"error-message":"Debes seleccionar el propietario del producto","option-label":l=>l.razon_social,"option-value":l=>l.id,"emit-value":"","map-options":""},{error:n(()=>[t(m,{clave:"cliente_id",v$:o.v$},null,8,["v$"])]),_:1},8,["modelValue","options","error","option-label","option-value"])]),i("div",ao,[e[12]||(e[12]=i("label",{class:"q-mb-sm block"},"Minimo",-1)),t(_,{type:"number",mask:"####","unmasked-value":"",modelValue:o.stock.minimo,"onUpdate:modelValue":e[5]||(e[5]=l=>o.stock.minimo=l),placeholder:"Obligatorio",readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])]),i("div",no,[e[13]||(e[13]=i("label",{class:"q-mb-sm block"},"Reorden",-1)),t(_,{type:"number",mask:"####","unmasked-value":"",modelValue:o.stock.reorden,"onUpdate:modelValue":e[6]||(e[6]=l=>o.stock.reorden=l),placeholder:"Obligatorio",readonly:o.disabled,outlined:"",dense:""},null,8,["modelValue","readonly"])])])]),_:1})]),_:1},8,["mixin","configuracionColumnas","accion1Header"])}var le=F(eo,[["render",uo]]);export{le as default};

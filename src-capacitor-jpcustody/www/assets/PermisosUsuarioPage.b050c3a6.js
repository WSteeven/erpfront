import{Q as so}from"./QSelect.69d1b992.js";import{bx as U,s as H,d as io,bc as ao,m as to,$ as ro,c as d,E as F,_ as lo,t as L,v as m,P as E,F as s,z as o,be as u,y as t,x as p,bd as c,G as M,H as O,J as k,O as N,B as f,D as Q,K as q}from"./index.2ef7a81a.js";import{Q as z,a as b}from"./QItemSection.3a5d4c83.js";import{Q as G}from"./QScrollArea.0279c0c6.js";import{Q as no}from"./QPage.2bc1c297.js";import{E as mo}from"./EssentialTable.f528a579.js";import{M as uo}from"./ModalEntidad.be40edc8.js";import{C as po}from"./ContenedorSimpleMixin.617817a8.js";import{P as co,c as fo}from"./Permiso.405aa895.js";import{P as vo,C as go}from"./ComportamientoModalesPermisoNuevo.b58fa71c.js";import{S as bo}from"./utils.a862dc08.js";import{u as _o}from"./filtrosListadosGenerales.79b6e840.js";import"./QChip.c5c0b225.js";import"./QMenu.f50512a6.js";import"./position-engine.093dda28.js";import"./format.8ac60962.js";import"./QResizeObserver.8bc492d6.js";import"./QScrollObserver.42cd2ac8.js";import"./TouchPan.819070cc.js";import"./touch.9135741d.js";import"./QFile.f5c4066f.js";import"./QToolbar.ff7ff7d8.js";import"./use-fullscreen.a336d1b1.js";import"./QBadge.ebf9f349.js";import"./QPopupProxy.567210a4.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.9c11306d.js";import"./VisorImagen.12af3936.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.94e1365a.js";import"./i18n-validators.46fc4c83.js";import"./index.e1f41ef1.js";import"./configuracion_general.ca1e935d.js";import"./ConfiguracionController.337fc7d3.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.57cc3867.js";import"./QForm.e1af9500.js";import"./index.e8d8fb1e.js";import"./TabLayout.5bc8ab45.js";import"./QTabs.5cdabeb1.js";import"./QTabPanels.7f1e5320.js";import"./buttonSubmits.35676009.js";import"./EssentialTablePagination.73d42aee.js";import"./RolController.b6e95490.js";class T extends U{constructor(){super(H.permisos_roles_usuario)}}class Co extends U{constructor(){super(H.asignar_permisos_individual)}}var Po=io({components:{EssentialTable:mo,ModalEntidad:uo},setup(){ao().setQuasar(to());const e=new po(co,new T),{entidad:i,listadosAuxiliares:v,listado:_}=e.useReferencias(),I=ro(),{cargarVista:V,obtenerListados:g,listar:C}=e.useComportamiento(),a=d(),r=d(),{empleados:R,filtrarEmpleados:j,roles:h}=_o(v),x=new vo,$=new Co,B=new bo,P=d([]),J=d([]),S=d(),w=d();V(async()=>{await g({empleados:{controller:new F,params:{campos:"id,nombres,apellidos,identificacion",estado:1}}})}),R.value=v.empleados;async function K(l){await C({id_rol:l,tipo:"ASIGNADOS"});const{result:n}=await x.listar({id_rol:l,tipo:"NO ASIGNADOS"});P.value=n}function W(){S.value.seleccionar(),S.value.clearSelection()}function X(){w.value.seleccionar(),w.value.clearSelection()}function Y(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),A()}function Z(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),A()}const D=new go;function oo(){D.abrirModalEntidad("PermisoNuevoPage")}const eo=()=>{I.replace("/roles")};async function A(){B.activar();const{result:l}=await new F().consultar(r.value);h.value=l.roles,a.value=[...l.permisos];const{response:n}=await new T().listar({empleado_id:r.value,tipo:"NO ASIGNADOS"});P.value=n.data.results,_.value=[...n.data.permisos_usuario],B.desactivar()}return{fecha:d(),mixin:e,permiso:i,modales:D,configuracionColumnasPermisos:fo,empleado:r,listado:_,permisosSinAsignar:P,crearRol:eo,crear_permiso:oo,obtenerPermisoRol:K,asignarPermiso:Y,eliminarPermiso:Z,botonAsignarPermisos:W,botonEliminarPermisos:X,listadosAuxiliares:v,roles:h,permisos:a,empleados:R,permisosAsignados:J,refPermisosSinAsignar:S,refPermisosAsignados:w,filtrarEmpleados:j,filtrarRolesEmpleados:A}}});const So={class:"row q-col-gutter-sm q-mb-md"},wo={class:"col-12 col-md-5"},Ao={class:"col-12 col-md-5 q-mb-md"},yo={key:0,class:"col-12 col-md-5 q-mb-md"},Eo={class:"row"},ko={key:0,class:"col-12 col-md-5"},No={key:0,class:"col-12 col-md-5 q-mb-md"},Qo={class:"q-py-xs"},qo={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},Io={class:"col-12 col-md-5 q-gutter-y-sm"},Vo={class:"col-md-2 column justify-center q-gutter-y-md"},Ro={class:"col-12 col-md-5 q-mb-md"};function ho(e,i,v,_,I,V){const g=L("essential-table"),C=L("modal-entidad");return m(),E(no,{padding:"",class:"q-pa-lg"},{default:s(()=>[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[t("div",So,[t("div",wo,[t("div",Ao,[i[4]||(i[4]=t("label",{class:"q-mb-sm block"},null,-1)),o(so,{modelValue:e.empleado,"onUpdate:modelValue":[i[0]||(i[0]=a=>e.empleado=a),e.filtrarRolesEmpleados],options:e.empleados,"options-dense":"",dense:"",outlined:"","error-message":"Debe seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","onUpdate:modelValue","option-value","option-label"])]),e.roles?(m(),p("div",yo,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[5]||(i[5]=t("div",{class:"text-h6"},"Roles",-1)),o(G,{style:{height:"100px"}},{default:s(()=>[t("div",Eo,[(m(!0),p(M,null,O(e.roles,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"})]),_:1}),o(b,null,{default:s(()=>[Q(q(a),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)]),i[7]||(i[7]=t("div",{class:"col-12 col-md-2"},null,-1)),e.permisos?(m(),p("div",ko,[e.listado?(m(),p("div",No,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[6]||(i[6]=t("div",{class:"text-h6"}," Todos los permisos asignados (roles y directamente) ",-1)),o(G,{style:{height:"164px"}},{default:s(()=>[t("div",Qo,[(m(!0),p(M,null,O(e.permisos,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"},{default:s(()=>[Q(" \xA0"+q(r+1),1)]),_:2},1024)]),_:2},1024),o(b,null,{default:s(()=>[Q(q(a.name),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)])):k("",!0)]),t("div",qo,[t("div",Io,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[8]||(i[8]=t("div",{class:"text-h6"},"No Asignados",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,datos:e.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarHeader:!0,mostrarFooter:!0,mostrarColumnasVisibles:!1,ref:"refPermisosSinAsignar",onSelected:e.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})]),t("div",Vo,[o(N,{class:"full-width block",color:"secondary",onClick:i[1]||(i[1]=a=>e.crear_permiso())},{default:s(()=>[o(f,{name:"bi-plus"})]),_:1}),o(N,{class:"full-width block",color:"primary",onClick:i[2]||(i[2]=a=>e.botonAsignarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-right"})]),_:1}),o(N,{class:"full-width block",color:"accent",onClick:i[3]||(i[3]=a=>e.botonEliminarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-left"})]),_:1})]),t("div",Ro,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[9]||(i[9]=t("div",{class:"text-h6"},"Asignados directamente",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:e.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,ref:"refPermisosAsignados",onSelected:e.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})])])]),_:1})]),_:1}),o(C,{comportamiento:e.modales,persistente:!1},null,8,["comportamiento"])]),_:1})}var ye=lo(Po,[["render",ho]]);export{ye as default};

import{Q as so}from"./QSelect.b920278b.js";import{by as U,s as H,d as io,bd as ao,m as to,a0 as ro,c as d,E as F,_ as lo,t as L,v as m,P as E,F as s,z as o,bf as u,y as t,x as p,be as c,G as M,H as O,J as k,O as N,B as f,D as Q,K as q}from"./index.b8e09611.js";import{Q as z,a as b}from"./QItemSection.ec4cc512.js";import{Q as G}from"./QScrollArea.d528d611.js";import{Q as no}from"./QPage.e6f8825d.js";import{E as mo}from"./EssentialTable.23af6cc8.js";import{M as uo}from"./ModalEntidad.54c9ab3a.js";import{C as po}from"./ContenedorSimpleMixin.4e22246b.js";import{P as co,c as fo}from"./Permiso.405aa895.js";import{P as vo,C as go}from"./ComportamientoModalesPermisoNuevo.5090a844.js";import{S as bo}from"./utils.9344cd7e.js";import{u as _o}from"./filtrosListadosGenerales.87fcb144.js";import"./QChip.f8f308fa.js";import"./QMenu.b3fb639b.js";import"./position-engine.799c9136.js";import"./format.8ac60962.js";import"./QResizeObserver.1422c274.js";import"./QScrollObserver.8813f664.js";import"./TouchPan.4c6fe26a.js";import"./touch.9135741d.js";import"./QFile.c79664c6.js";import"./QTable.c4bfb038.js";import"./use-fullscreen.37810a50.js";import"./QToolbar.afeb6de9.js";import"./QBtnGroup.7d38eecd.js";import"./QBadge.89898cd2.js";import"./QPopupProxy.685eacb5.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.95754b62.js";import"./VisorImagen.29457a6f.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.3c1fc91c.js";import"./i18n-validators.06abe774.js";import"./index.ea415f98.js";import"./configuracion_general.1d29d94f.js";import"./ConfiguracionController.a136b041.js";import"./entidadAuditable.75a46700.js";import"./ComponenteModal.domain.92aacded.js";import"./QForm.eab79b48.js";import"./index.70965bc7.js";import"./TabLayout.45a66130.js";import"./QTabs.1ee2fae1.js";import"./QTabPanels.1776fc83.js";import"./buttonSubmits.f2d72caa.js";import"./EssentialTablePagination.ce808cac.js";import"./RolController.8b585994.js";class T extends U{constructor(){super(H.permisos_roles_usuario)}}class Co extends U{constructor(){super(H.asignar_permisos_individual)}}var Po=io({components:{EssentialTable:mo,ModalEntidad:uo},setup(){ao().setQuasar(to());const e=new po(co,new T),{entidad:i,listadosAuxiliares:v,listado:_}=e.useReferencias(),I=ro(),{cargarVista:V,obtenerListados:g,listar:C}=e.useComportamiento(),a=d(),r=d(),{empleados:R,filtrarEmpleados:j,roles:h}=_o(v),J=new vo,$=new Co,B=new bo,P=d([]),K=d([]),S=d(),w=d();V(async()=>{await g({empleados:{controller:new F,params:{campos:"id,nombres,apellidos,identificacion",estado:1}}})}),R.value=v.empleados;async function x(l){await C({id_rol:l,tipo:"ASIGNADOS"});const{result:n}=await J.listar({id_rol:l,tipo:"NO ASIGNADOS"});P.value=n}function W(){S.value.seleccionar(),S.value.clearSelection()}function X(){w.value.seleccionar(),w.value.clearSelection()}function Y(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ASIGNAR"}),A()}function Z(l){const n=l.map(y=>y.id);$.guardar({empleado_id:r.value,permisos:n,tipo_sincronizacion:"ELIMINAR"}),A()}const D=new go;function oo(){D.abrirModalEntidad("PermisoNuevoPage")}const eo=()=>{I.replace("/roles")};async function A(){B.activar();const{result:l}=await new F().consultar(r.value);h.value=l.roles,a.value=[...l.permisos];const{response:n}=await new T().listar({empleado_id:r.value,tipo:"NO ASIGNADOS"});P.value=n.data.results,_.value=[...n.data.permisos_usuario],B.desactivar()}return{fecha:d(),mixin:e,permiso:i,modales:D,configuracionColumnasPermisos:fo,empleado:r,listado:_,permisosSinAsignar:P,crearRol:eo,crear_permiso:oo,obtenerPermisoRol:x,asignarPermiso:Y,eliminarPermiso:Z,botonAsignarPermisos:W,botonEliminarPermisos:X,listadosAuxiliares:v,roles:h,permisos:a,empleados:R,permisosAsignados:K,refPermisosSinAsignar:S,refPermisosAsignados:w,filtrarEmpleados:j,filtrarRolesEmpleados:A}}});const So={class:"row q-col-gutter-sm q-mb-md"},wo={class:"col-12 col-md-5"},Ao={class:"col-12 col-md-5 q-mb-md"},yo={key:0,class:"col-12 col-md-5 q-mb-md"},Eo={class:"row"},ko={key:0,class:"col-12 col-md-5"},No={key:0,class:"col-12 col-md-5 q-mb-md"},Qo={class:"q-py-xs"},qo={class:"row q-col-gutter-sm q-mb-md q-mt-xs"},Io={class:"col-12 col-md-5 q-gutter-y-sm"},Vo={class:"col-md-2 column justify-center q-gutter-y-md"},Ro={class:"col-12 col-md-5 q-mb-md"};function ho(e,i,v,_,I,V){const g=L("essential-table"),C=L("modal-entidad");return m(),E(no,{padding:"",class:"q-pa-lg"},{default:s(()=>[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[t("div",So,[t("div",wo,[t("div",Ao,[i[4]||(i[4]=t("label",{class:"q-mb-sm block"},null,-1)),o(so,{modelValue:e.empleado,"onUpdate:modelValue":[i[0]||(i[0]=a=>e.empleado=a),e.filtrarRolesEmpleados],options:e.empleados,"options-dense":"",dense:"",outlined:"","error-message":"Debe seleccionar un empleado","use-input":"","input-debounce":"0",onFilter:e.filtrarEmpleados,"option-value":a=>a.id,"option-label":a=>a.nombres+" "+a.apellidos,"emit-value":"","map-options":""},null,8,["modelValue","options","onFilter","onUpdate:modelValue","option-value","option-label"])]),e.roles?(m(),p("div",yo,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[5]||(i[5]=t("div",{class:"text-h6"},"Roles",-1)),o(G,{style:{height:"100px"}},{default:s(()=>[t("div",Eo,[(m(!0),p(M,null,O(e.roles,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"})]),_:1}),o(b,null,{default:s(()=>[Q(q(a),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)]),i[7]||(i[7]=t("div",{class:"col-12 col-md-2"},null,-1)),e.permisos?(m(),p("div",ko,[e.listado?(m(),p("div",No,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[6]||(i[6]=t("div",{class:"text-h6"}," Todos los permisos asignados (roles y directamente) ",-1)),o(G,{style:{height:"164px"}},{default:s(()=>[t("div",Qo,[(m(!0),p(M,null,O(e.permisos,(a,r)=>(m(),E(z,{dense:"",key:r},{default:s(()=>[o(b,{avatar:""},{default:s(()=>[o(f,{name:"bi-check-circle-fill",size:"xs",color:"positive"},{default:s(()=>[Q(" \xA0"+q(r+1),1)]),_:2},1024)]),_:2},1024),o(b,null,{default:s(()=>[Q(q(a.name),1)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})])):k("",!0)])):k("",!0)]),t("div",qo,[t("div",Io,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[8]||(i[8]=t("div",{class:"text-h6"},"No Asignados",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,datos:e.permisosSinAsignar,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,mostrarHeader:!0,mostrarFooter:!0,mostrarColumnasVisibles:!1,ref:"refPermisosSinAsignar",onSelected:e.asignarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})]),t("div",Vo,[o(N,{class:"full-width block",color:"secondary",onClick:i[1]||(i[1]=a=>e.crear_permiso())},{default:s(()=>[o(f,{name:"bi-plus"})]),_:1}),o(N,{class:"full-width block",color:"primary",onClick:i[2]||(i[2]=a=>e.botonAsignarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-right"})]),_:1}),o(N,{class:"full-width block",color:"accent",onClick:i[3]||(i[3]=a=>e.botonEliminarPermisos())},{default:s(()=>[o(f,{name:"bi-arrow-left"})]),_:1})]),t("div",Ro,[o(c,null,{default:s(()=>[o(u,null,{default:s(()=>[i[9]||(i[9]=t("div",{class:"text-h6"},"Asignados directamente",-1)),o(g,{configuracionColumnas:e.configuracionColumnasPermisos,mostrarColumnasVisibles:!1,datos:e.listado,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,ref:"refPermisosAsignados",onSelected:e.eliminarPermiso,"tipo-seleccion":"multiple"},null,8,["configuracionColumnas","datos","onSelected"])]),_:1})]),_:1})])])]),_:1})]),_:1}),o(C,{comportamiento:e.modales,persistente:!1},null,8,["comportamiento"])]),_:1})}var ke=lo(Po,[["render",ho]]);export{ke as default};

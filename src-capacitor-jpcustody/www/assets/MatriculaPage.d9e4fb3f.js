import{Q as na,a as I}from"./QSelect.69d1b992.js";import{Q as S,a as N}from"./QItemSection.3a5d4c83.js";import{d as ma,R as ca,c as C,by as b,q as da,_ as pa,t as fa,v as n,P as ba,F as r,z as l,a5 as va,y as t,M as ga,N as ha,D as F,K as v,I as d,B as O,j as H,O as L,x as m,G as z,H as R,J as M}from"./index.2ef7a81a.js";import{Q as T,a as A,C as K}from"./QPopupProxy.567210a4.js";import{Q as Va}from"./QForm.e1af9500.js";import{r as W,a as G}from"./i18n-validators.46fc4c83.js";import{u as Ma}from"./index.e8d8fb1e.js";import{T as ka}from"./TabLayoutFilterTabs2.2c3270e4.js";import{C as wa}from"./ContenedorSimpleMixin.617817a8.js";import{M as Pa,a as ya}from"./MatriculaController.249d66d2.js";import{V as _a}from"./VehiculoController.cda17fd9.js";import{u as Ca}from"./filtrosListadosGenerales.79b6e840.js";import{u as Fa}from"./vehiculos.utils.c31e027d.js";import{X as $a,Y as Da,Z as qa,K as J}from"./utils.a862dc08.js";import{u as Ya}from"./vehiculo.3cd8cb74.js";import"./QChip.c5c0b225.js";import"./QMenu.f50512a6.js";import"./position-engine.093dda28.js";import"./format.8ac60962.js";import"./index.e1f41ef1.js";import"./QTabs.5cdabeb1.js";import"./QResizeObserver.8bc492d6.js";import"./QTabPanels.7f1e5320.js";import"./touch.9135741d.js";import"./QPage.2bc1c297.js";import"./EssentialTableTabs.3fb37590.js";import"./QBadge.ebf9f349.js";import"./EssentialTablePagination.73d42aee.js";import"./EssentialTable.f528a579.js";import"./QFile.f5c4066f.js";import"./QToolbar.ff7ff7d8.js";import"./use-fullscreen.a336d1b1.js";import"./_commonjsHelpers.8402d862.js";import"./QImg.9c11306d.js";import"./VisorImagen.12af3936.js";import"./seleccionContratacionPersonal.utils.e3e1ed3d.js";import"./ErrorComponent.94e1365a.js";import"./buttonSubmits.35676009.js";import"./entidadAuditable.75a46700.js";const Ua=[{name:"vehiculo",field:"vehiculo",label:"Veh\xEDculo",align:"left",sortable:!0},{name:"fecha_matricula",field:"fecha_matricula",label:"Fecha matr\xEDcula",align:"left",sortable:!0,editable:!1},{name:"valor_estimado_pagar",field:"valor_estimado_pagar",label:"Valor a Pagar",align:"left",sortable:!0},{name:"proxima_matricula",field:"proxima_matricula",label:"Pr\xF3xima matr\xEDcula",align:"left",sortable:!0},{name:"estado",field:"estado",label:"\xBFMatriculado?",align:"left",sortable:!0}];var Ea=ma({components:{TabLayoutFilterTabs2:ka},setup(){const a=new wa(Pa,new ya),{entidad:o,disabled:$,listadosAuxiliares:k,accion:c}=a.useReferencias(),{setValidador:D,obtenerListados:w,cargarVista:e,listar:p}=a.useComportamiento(),{confirmar:X,prompt:g}=ca(),h=Ya(),q=C(!1),Y=C(!1),V={matriculador:null,observacion:null,monto:null},U=C("1");e(async()=>{await w({vehiculos:{controller:new _a,params:{campos:"id,placa,modelo_id"}}})});const Z={vehiculo:{required:W},fecha_matricula:{required:W},proxima_matricula:{requiredIf:G(o.fecha_matricula)},matriculador:{requiredIf:G(o.fecha_matricula)}},E=Ma(Z,o);D(E.value);const{primerDia:Q,ultimoDia:B}=$a(da);async function j(i){switch(U.value=i,i){case"1":await p({"fecha_matricula[start]":Q,"fecha_matricula[end]":B});break;case"2":await p({matriculado:0,"fecha_matricula[operator]":"<","fecha_matricula[value]":Q});break;case"3":await p({matriculado:1});break;case"4":await p({matriculado:0,"fecha_matricula[operator]":">","fecha_matricula[value]":B});break;default:await p()}}function x(i,u){q.value=u!=="month"}function aa(i,u){Y.value=u!=="month"}function oa(){const i=Da(qa(o.placa)),u=new Date,s=new Date;s.setFullYear(s.getFullYear()+1),u.setMonth(i),s.setMonth(i),o.fecha_matricula=J.formatDate(u,"MM-YYYY"),o.proxima_matricula=J.formatDate(s,"MM-YYYY")}function ea(){const i=P.value.filter(u=>u.id==o.vehiculo);o.placa=i[0].placa,oa()}const la={titulo:"Valores a Pagar",icono:"bi-search",color:"primary",tooltip:"Valores a pagar de matricula",accion:()=>{window.open("https://srienlinea.sri.gob.ec/sri-en-linea/SriVehiculosWeb/ConsultaValoresPagarVehiculo/Consultas/consultaRubros","_blank")},visible:()=>c.value==b.nuevo||c.value==b.editar},ra={titulo:"Multas",icono:"bi-file-earmark-text-fill",color:"primary",tooltip:"Consultar multas",accion:()=>{window.open("https://consultaweb.ant.gob.ec/PortalWEB/paginas/clientes/clp_criterio_consulta.jsp","_blank")},visible:()=>c.value==b.nuevo||c.value==b.editar},ia={titulo:"Valor a Pagar",color:"primary",tooltip:"Configurar Valor a Pagar",icono:"bi-wrench",accion:({entidad:i})=>{g({titulo:"Valor estimado a Pagar",mensaje:"Ingresa el valor estimado a pagar de matricula",validacion:s=>/^(\d{1,3}(?:,\d{3})*(?:\.\d+)?|\d+)?$/.test(s),requerido:!0,accion:async s=>{h.idMatricula=i.id;const f=await h.setValorEstimadoPagar({valor_estimado_pagar:s});console.log(f),i.valor_estimado_pagar=f.valor_estimado_pagar}})}},ta={titulo:" Pagar",icono:"bi-cash-coin",color:"positive",accion:({entidad:i})=>{X("\xBFEst\xE1 seguro de marcar como pagada la matr\xEDcula?",async()=>{const u={titulo:"Pagar Matricula "+i.vehiculo,mensaje:"Persona que realiz\xF3 la matriculaci\xF3n del veh\xEDculo",requerido:!0,validacion:s=>!!s,accion:async s=>{h.idMatricula=i.id,V.matriculador=s;const f={titulo:"Pagar Matricula "+i.vehiculo,mensaje:"Observaci\xF3n",requerido:!0,validacion:y=>!!y,accion:async y=>{V.observacion=y;const ua={titulo:"Pagar Matricula "+i.vehiculo,mensaje:"Monto del pago",validacion:_=>/^(\d{1,3}(?:,\d{3})*(?:\.\d+)?|\d+)?$/.test(_),accion:async _=>{V.monto=_,await h.pagarMatricula(V)&&await j("3")}};g(ua)}};g(f)}};g(u)})},visible:({entidad:i})=>!i.matriculado},{vehiculos:P,filtrarVehiculos:sa}=Ca(k);return P.value=k.vehiculos,{mixin:a,v$:E,matricula:o,disabled:$,accion:c,acciones:b,configuracionColumnas:Ua,maskFecha:"MM-YYYY",is_month_fecha_matricula:q,is_month_proxima_matricula:Y,btnColocarValorEstimadoPagar:ia,btnConsultarMatricula:la,btnConsultarMultas:ra,btnPagarMatricula:ta,tabActual:U,tabOptionsMatriculas:Fa,vehiculos:P,filtrarVehiculos:sa,filtrarMatriculas:j,checkValueFechaMatricula:x,checkValueProximaMatricula:aa,asignarPlaca:ea}}});const Qa={class:"row q-col-gutter-sm q-py-md"},Ba={class:"col-12 col-md-3"},ja={class:"col-12 col-md-3"},Ia={class:"row items-center justify-end"},Sa={class:"error-msg"},Na={class:"col-12 col-md-3"},Oa={class:"row items-center justify-end"},Ha={class:"error-msg"},La={key:0,class:"col-12 col-md-3"},za={key:1,class:"col-12 col-md-3"},Ra={key:2,class:"col-12 col-md-3"},Ta={key:3,class:"col-12 col-md-3"};function Aa(a,o,$,k,c,D){const w=fa("tab-layout-filter-tabs2");return n(),ba(w,{mixin:a.mixin,configuracionColumnas:a.configuracionColumnas,ajustarCeldas:!0,"tab-options":a.tabOptionsMatriculas,tabDefecto:a.tabActual,filtrar:a.filtrarMatriculas,"titulo-pagina":"Matriculas de Veh\xEDculos",accion1Header:a.btnConsultarMatricula,accion2Header:a.btnConsultarMultas,permitirEditar:!1,puedeExportar:"",accion1:a.btnColocarValorEstimadoPagar,accion2:a.btnPagarMatricula},{formulario:r(()=>[l(Va,{onSubmit:o[11]||(o[11]=va(()=>{},["prevent"]))},{default:r(()=>[t("div",Qa,[t("div",Ba,[o[13]||(o[13]=t("label",{class:"q-mb-sm block"},"Placa",-1)),l(na,{modelValue:a.matricula.vehiculo,"onUpdate:modelValue":[o[0]||(o[0]=e=>a.matricula.vehiculo=e),a.asignarPlaca],options:a.vehiculos,"transition-show":"jump-up","transition-hide":"jump-down",disable:a.disabled,"options-dense":"",dense:"",outlined:"",onFilter:a.filtrarVehiculos,"error-message":"Debes seleccionar un numero de placa","use-input":"","input-debounce":"0","option-value":e=>e.id,"option-label":e=>e.placa,"emit-value":"","map-options":""},{option:r(e=>[l(S,ga(ha(e.itemProps)),{default:r(()=>[l(N,null,{default:r(()=>[l(I,null,{default:r(()=>[F(v(e.opt.placa),1)]),_:2},1024),l(I,{caption:""},{default:r(()=>[F(v(e.opt.marca)+": "+v(e.opt.modelo),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":r(()=>[l(S,null,{default:r(()=>[l(N,{class:"text-grey"},{default:r(()=>o[12]||(o[12]=[F(" No hay resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","disable","onFilter","onUpdate:modelValue","option-value","option-label"])]),t("div",ja,[o[14]||(o[14]=t("label",{class:"q-mb-sm block"},"Fecha de Matriculaci\xF3n ",-1)),l(d,{modelValue:a.matricula.fecha_matricula,"onUpdate:modelValue":o[3]||(o[3]=e=>a.matricula.fecha_matricula=e),placeholder:"Obligatorio",value:a.matricula.fecha_matricula,mask:"##-####",hint:"Fecha de ultima matriculaci\xF3n",error:!!a.v$.fecha_matricula.$errors.length,disable:a.disabled,onBlur:a.v$.fecha_matricula.$touch,outlined:"",dense:""},{append:r(()=>[l(O,{name:"event",class:"cursor-pointer"},{default:r(()=>[l(T,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:a.is_month_fecha_matricula,"onUpdate:modelValue":o[2]||(o[2]=e=>a.is_month_fecha_matricula=e)},{default:r(()=>[l(A,{modelValue:a.matricula.fecha_matricula,"onUpdate:modelValue":[o[1]||(o[1]=e=>a.matricula.fecha_matricula=e),a.checkValueFechaMatricula],minimal:"",mask:a.maskFecha,"emit-immediately":"","default-view":"Years"},{default:r(()=>[t("div",Ia,[H(l(L,{label:"Cerrar",color:"primary",flat:""},null,512),[[K]])])]),_:1},8,["modelValue","mask","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})]),error:r(()=>[(n(!0),m(z,null,R(a.v$.fecha_matricula.$errors,e=>(n(),m("div",{key:e.$uid},[t("div",Sa,v(e.$message),1)]))),128))]),_:1},8,["modelValue","value","error","disable","onBlur"])]),t("div",Na,[o[15]||(o[15]=t("label",{class:"q-mb-sm block"},"Pr\xF3xima Matr\xEDcula ",-1)),l(d,{modelValue:a.matricula.proxima_matricula,"onUpdate:modelValue":o[6]||(o[6]=e=>a.matricula.proxima_matricula=e),placeholder:"Obligatorio",value:a.matricula.proxima_matricula,mask:"##-####",hint:"Fecha de pr\xF3xima matriculaci\xF3n",error:!!a.v$.proxima_matricula.$errors.length,disable:a.disabled,onBlur:a.v$.proxima_matricula.$touch,outlined:"",dense:""},{append:r(()=>[l(O,{name:"event",class:"cursor-pointer"},{default:r(()=>[l(T,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:a.is_month_proxima_matricula,"onUpdate:modelValue":o[5]||(o[5]=e=>a.is_month_proxima_matricula=e)},{default:r(()=>[l(A,{modelValue:a.matricula.proxima_matricula,"onUpdate:modelValue":[o[4]||(o[4]=e=>a.matricula.proxima_matricula=e),a.checkValueProximaMatricula],minimal:"",mask:a.maskFecha,"emit-immediately":"","default-view":"Years"},{default:r(()=>[t("div",Oa,[H(l(L,{label:"Cerrar",color:"primary",flat:""},null,512),[[K]])])]),_:1},8,["modelValue","mask","onUpdate:modelValue"])]),_:1},8,["modelValue"])]),_:1})]),error:r(()=>[(n(!0),m(z,null,R(a.v$.proxima_matricula.$errors,e=>(n(),m("div",{key:e.$uid},[t("div",Ha,v(e.$message),1)]))),128))]),_:1},8,["modelValue","value","error","disable","onBlur"])]),a.matricula.matriculador?(n(),m("div",La,[o[16]||(o[16]=t("label",{class:"q-mb-sm block"},"Persona que realiza matriculaci\xF3n",-1)),l(d,{autogrow:"",modelValue:a.matricula.matriculador,"onUpdate:modelValue":o[7]||(o[7]=e=>a.matricula.matriculador=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0),a.matricula.observacion?(n(),m("div",za,[o[17]||(o[17]=t("label",{class:"q-mb-sm block"},"Observaci\xF3n",-1)),l(d,{autogrow:"",modelValue:a.matricula.observacion,"onUpdate:modelValue":o[8]||(o[8]=e=>a.matricula.observacion=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0),a.matricula.monto?(n(),m("div",Ra,[o[18]||(o[18]=t("label",{class:"q-mb-sm block"},"Monto",-1)),l(d,{autogrow:"",modelValue:a.matricula.monto,"onUpdate:modelValue":o[9]||(o[9]=e=>a.matricula.monto=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0),a.matricula.fecha_pago?(n(),m("div",Ta,[o[19]||(o[19]=t("label",{class:"q-mb-sm block"},"Fecha de pago",-1)),l(d,{autogrow:"",modelValue:a.matricula.fecha_pago,"onUpdate:modelValue":o[10]||(o[10]=e=>a.matricula.fecha_pago=e),disable:"",outlined:"",dense:""},null,8,["modelValue"])])):M("",!0)])]),_:1})]),_:1},8,["mixin","configuracionColumnas","tab-options","tabDefecto","filtrar","accion1Header","accion2Header","accion1","accion2"])}var Qo=pa(Ea,[["render",Aa]]);export{Qo as default};

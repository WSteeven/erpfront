var E=Object.defineProperty;var D=(a,t,n)=>t in a?E(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n;var e=(a,t,n)=>(D(a,typeof t!="symbol"?t+"":t,n),n);import{S as A,A as z}from"./utils.a862dc08.js";import{l as I,e as L,c as R,R as S,by as F,b$ as _,A as l,s as r,bG as P}from"./index.2ef7a81a.js";import{E as j}from"./entidadAuditable.75a46700.js";class v extends j{constructor(){super();e(this,"justificacion");e(this,"solicitante");e(this,"solicitante_id");e(this,"tarea");e(this,"tarea_id");e(this,"canton");e(this,"causa_anulacion");e(this,"estado");e(this,"estado_bodega");e(this,"created_at");e(this,"es_para_stock");e(this,"observacion_aut");e(this,"autorizacion");e(this,"per_autoriza");e(this,"per_autoriza_id");e(this,"sucursal");e(this,"sucursal_id");e(this,"cliente");e(this,"cliente_id");e(this,"pedido_automatico");e(this,"listadoProductos");e(this,"es_tarea");e(this,"tiene_observacion_aut");e(this,"condicion");e(this,"misma_condicion");e(this,"devolver_materiales_tecnicos");this.justificacion=null,this.solicitante=null,this.solicitante_id=null,this.observacion_aut=null,this.autorizacion=null,this.per_autoriza=null,this.per_autoriza_id=null,this.tarea=null,this.tarea_id=null,this.canton=null,this.causa_anulacion=null,this.estado=null,this.estado_bodega=null,this.created_at=null,this.es_para_stock=!1,this.listadoProductos=[],this.sucursal=null,this.sucursal_id=null,this.cliente=null,this.cliente_id=null,this.pedido_automatico=!1,this.es_tarea=!1,this.tiene_observacion_aut=!1,this.condicion=null,this.misma_condicion=!1,this.devolver_materiales_tecnicos=!1}}const B=I("devolucion",()=>{const a=L(new v),t=new v,n=R(),{notificarAdvertencia:u,notificarError:p}=S(),h=F.nuevo,d=new A;async function f(i){const o=l.getInstance(),s=o.getEndpoint(r.devoluciones)+"/"+i,c=await o.get(s);if(c.data.modelo.estado==="CREADA")return c.data.modelo;u("No se puede gestionar una devoluci\xF3n anulada")}async function m(i){try{d.activar();const o=await f(i);console.log(o),o.autorizacion==2?o.estado_bodega===_.pendiente||o.estado_bodega===_.parcial?a.hydrate(o):(u("La devoluci\xF3n ya ha sido completada"),a.hydrate(t)):(u("La devoluci\xF3n no est\xE1 aprobada"),a.hydrate(t))}catch{p("Devoluci\xF3n no encontrada"),a.hydrate(t)}finally{d.desactivar()}}async function g(){const i=l.getInstance(),o=i.getEndpoint(r.devoluciones)+"/show-preview/"+n.value,s=await i.get(o);a.hydrate(s.data.modelo)}async function y(){const i=l.getInstance(),o=P.URL_BASE+"/"+i.getEndpoint(r.devoluciones)+"/imprimir/"+n.value,s="devolucion_"+n.value+"_"+Date.now();z(o,"GET","blob","pdf",s)}async function b(i){const o=l.getInstance(),s=o.getEndpoint(r.devoluciones)+"/corregir-devolucion/"+n.value;return await o.put(s,i)}async function w(i,o){const s=l.getInstance(),c=s.getEndpoint(r.devoluciones)+"/eliminar-item";return await s.post(c,{devolucion_id:o,detalle_id:i})}function x(){a.hydrate(t)}return{devolucion:a,accionDevolucion:h,modificarDevolucion:b,eliminarDetalle:w,cargarDevolucion:m,resetearDevolucion:x,idDevolucion:n,showPreview:g,imprimirPdf:y}});export{v as D,B as u};

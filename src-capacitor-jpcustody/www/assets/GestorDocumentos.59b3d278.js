import{d as w,R as A,c as n,A as M,bG as N,p as Q,_ as T,t as U,v as l,x as f,y as C,P as L,a8 as z,J as b,z as R,bH as H,G as I}from"./index.2ef7a81a.js";import{Q as J}from"./QUploader.6e8b7051.js";import{h as P,m as K}from"./utils.a862dc08.js";import{E as W}from"./EssentialTable.f528a579.js";const X=[{name:"nombre",field:"nombre",label:"Nombre",align:"left"},{name:"tamanio_bytes",field:"tamanio_bytes",label:"Tama\xF1o",align:"left",editable:!1}];var Y=w({components:{EssentialTable:W},props:{mixin:{type:Object,required:!0},endpoint:{type:Object,required:!0},entidad:Object,disable:{type:Boolean,default:!1},permitirEliminar:{type:Boolean,default:!0},listarAlGuardar:{type:Boolean,default:!0},permitirSubir:{type:Boolean,default:!0},esObligatorio:{type:Boolean,default:!0},esMultiple:{type:Boolean,default:!0},mostrarListado:{type:Boolean,default:!0}},setup(e){const{listado:t}=e.mixin.useReferencias(),{eliminar:p,listar:v}=e.mixin.useComportamiento(),{notificarCorrecto:y,notificarError:g,notificarAdvertencia:c,confirmar:u}=A();A();function j(o){v(o)}let d;const q={titulo:"Eliminar",icono:"bi-trash3",color:"negative",visible:()=>e.permitirEliminar,accion:async({entidad:o})=>{u("Esta operaci\xF3n es irreversible. El archivo se eliminar\xE1 de forma instant\xE1nea.",()=>p(o))}},k={titulo:"Descargar",icono:"bi-download",color:"secondary",accion:({entidad:o})=>K(o.ruta)},r=n(),h=M.getInstance(),m=n(0),G=`${N.URL_BASE}/${h.getEndpoint(e.endpoint)}`,E=n(e.esObligatorio),_=n(!1);async function $(o){var s;const i=new FormData;i.append("file",o[0]);for(const a in d)i.append(a,d[a]);try{const a=await h.post(G,i);o.value=[],e.listarAlGuardar&&t.value.push(a.data.modelo),y(a.data.mensaje),E.value=e.esObligatorio}catch(a){console.log("error en el catch",a);const B=a;console.log(B),g((s=B.response)==null?void 0:s.data.message)}}async function x(o){try{d=o,r.value&&(r.value.upload(),r.value.reset(),r.value.removeUploadedFiles(),r.value.removeQueuedFiles())}catch(i){console.log(i)}}function S(o){c("El tama\xF1o total de los archivos no deben exceder los 10mb.")}function D(o){m.value+=F(o)}function O(o){m.value-=F(o)}function F(o){return o.reduce((s,a)=>s+a.size,0)}function V(){t.value=[]}return{listado:t,refGestor:r,extraerExtension:o=>o.split(".").at(-1),formatBytes:P,onFileAdded:D,onFileRemoved:O,quiero_subir_archivos:E,esConsultado:_,columnas:[...X,Q],onRejected:S,btnEliminar:q,btnDescargar:k,factoryFn:$,subir:x,listarArchivos:j,limpiarListado:V,tamanioListado:m}}});const Z={class:"col-12 col-md-3 q-mb-lg"},ee={key:0,class:"col-12 q-mb-sm"},oe={key:1,class:"col-12 q-mb-sm"};function ae(e,t,p,v,y,g){const c=U("essential-table");return l(),f(I,null,[C("div",Z,[t[1]||(t[1]=C("br",null,null,-1)),e.permitirSubir?(l(),L(z,{key:0,modelValue:e.quiero_subir_archivos,"onUpdate:modelValue":t[0]||(t[0]=u=>e.quiero_subir_archivos=u),label:"Quiero compartir archivos",disable:e.disable,"checked-icon":"bi-eye",color:"positive",outlined:"",dense:""},null,8,["modelValue","disable"])):b("",!0)]),e.quiero_subir_archivos?(l(),f("div",ee,[R(J,{ref:"refGestor",label:e.esMultiple?"Selecciona o arrastra tus archivos aqu\xED (M\xE1ximo 10mb)":"Selecciona o arrastra el archivo aqu\xED (M\xE1ximo 10mb)",multiple:e.esMultiple,style:{width:"100%"},flat:"",factory:e.factoryFn,class:"bg-header-collapse expansion",color:"white","text-color":"black","max-total-size":"10485760",onRejected:e.onRejected,onAdded:e.onFileAdded,onRemoved:e.onFileRemoved,"hide-upload-btn":""},null,8,["label","multiple","factory","onRejected","onAdded","onRemoved"])])):b("",!0),H(e.$slots,"boton-subir"),e.listado.length?(l(),f("div",oe,[R(c,{titulo:`Existen ${e.listado.length} archivos compartidos hasta el momento`,configuracionColumnas:e.columnas,datos:e.listado,"alto-fijo":!1,permitirConsultar:!1,permitirEditar:!1,permitirEliminar:!1,"mostrar-footer":!1,"mostrar-botones":!1,"permitir-buscar":!1,ajustarCeldas:"",accion1:e.btnDescargar},null,8,["titulo","configuracionColumnas","datos","accion1"])])):b("",!0)],64)}var ne=T(Y,[["render",ae]]);export{ne as G};

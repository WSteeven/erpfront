var A=Object.defineProperty;var R=(s,n,o)=>n in s?A(s,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[n]=o;var t=(s,n,o)=>(R(s,typeof n!="symbol"?n+"":n,o),o);import{bx as L,s as l,l as B,e as C,c as I,R as U,by as T,A as u,bG as f}from"./index.2ef7a81a.js";import{S as D,A as g}from"./utils.a862dc08.js";import{E as N}from"./entidadAuditable.75a46700.js";const j=[{name:"id",field:"id",label:"N\xB0",align:"left",sortable:!0},{name:"codigo",field:"codigo",label:"Codigo",align:"left",sortable:!0},{name:"created_at",field:"created_at",label:"Fecha",align:"left",sortable:!0},{name:"descripcion",field:"descripcion",label:"Descripci\xF3n",style:"max-width: 300px; overflow: auto;",align:"left",sortable:!0},{name:"solicitante",field:"solicitante",label:"Solicitante",align:"left",sortable:!0},{name:"cliente",field:"cliente",label:"Cliente",align:"left",sortable:!0},{name:"estado",field:"estado",label:"Estado",align:"left",sortable:!0}];class _ extends N{constructor(){super();t(this,"codigo");t(this,"solicitante");t(this,"cliente");t(this,"proforma");t(this,"descripcion");t(this,"forma");t(this,"tiempo");t(this,"estado");t(this,"created_at");t(this,"iva");t(this,"listadoProductos");t(this,"descuento_general");t(this,"tiene_proforma");t(this,"tiene_pedido");t(this,"modificar_iva");t(this,"modificar_descuento");this.codigo=null,this.solicitante=null,this.cliente=null,this.proforma=null,this.descripcion=null,this.forma=null,this.created_at=null,this.tiempo=null,this.estado=null,this.iva=null,this.listadoProductos=[],this.tiene_proforma=!1,this.tiene_pedido=!1,this.modificar_iva=!1,this.descuento_general=0,this.modificar_descuento=!1}}class k extends L{constructor(){super(l.prefacturas)}}const q=B("prefactura",()=>{const s=C(new _),n=new _,o=I(),{notificarAdvertencia:h,notificarError:d}=U(),v=T.nuevo,i=new D;async function x(){try{const a=u.getInstance(),e=f.URL_BASE+"/"+a.getEndpoint(l.prefacturas)+"/imprimir/"+o.value,r="prefactura_"+o.value+"_"+Date.now();await g(e,"GET","blob","pdf",r),console.log("Prefactura impresa con \xE9xito")}catch(a){h("Error al imprimir la prefactura. "+a)}}async function E(){try{i.activar();const a=u.getInstance(),e=f.URL_BASE+"/"+a.getEndpoint(l.prefacturas)+"/"+o.value,r=await a.get(e);return s.hydrate(r.data.modelo),r}catch(a){d(a)}finally{i.desactivar()}}async function y(a){try{i.activar();const e=u.getInstance(),r=f.URL_BASE+"/"+e.getEndpoint(l.prefacturas)+"/anular/"+o.value;return await e.post(r,a)}catch(e){d(e)}finally{i.desactivar()}}function w(){s.hydrate(n)}async function P(a){try{i.activar();const e=u.getInstance(),r=f.URL_BASE+"/"+e.getEndpoint(l.dashboard_ventas_empresa);return(await e.post(r,a)).data.results}catch(e){d("Error al consultar el dashboard"+e)}finally{i.desactivar()}}async function S(a,e,r){try{const c=u.getInstance(),p=f.URL_BASE+"/"+c.getEndpoint(l.prefacturas)+"/reportes",b="reporte_prefacturas";switch(a){case"excel":return e.accion="excel",await g(p,"POST","blob","xlsx",b,e),r;case"pdf":return e.accion="pdf",await g(p,"POST","blob","pdf",b,e),r;default:i.activar(),e.accion="";const m=await c.post(p,e);return m.data.results?(m.data.results.length<1&&h("No se obtuvieron resultados"),m.data.results):r}}catch(c){console.log(c),d("Error al obtener el reporte")}finally{i.desactivar()}}return{prefactura:s,accionPrefactura:v,idPrefactura:o,anularPrefactura:y,resetearprefactura:w,imprimirPdf:x,consultarDashboard:P,buscarReporte:S,consultar:E}});export{_ as P,k as a,j as c,q as u};
